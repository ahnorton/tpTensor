(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   2062852,      55943]
NotebookOptionsPosition[   1869787,      50376]
NotebookOutlinePosition[   1870629,      50405]
CellTagsIndexPosition[   1870495,      50399]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Needs", "[", "\"\<Backup`\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{"DeleteLockFile", "[", "]"}], "\[IndentingNewLine]", 
   RowBox[{"StartBackup", "[", "]"}]}]}]], "Input"],

Cell[BoxData["\<\"Backup version 1.0.3.\"\>"], "Output"],

Cell[BoxData["\<\"No lock-file was found.\"\>"], "Output"],

Cell[BoxData["\<\"Backup started.\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StopBackup", "[", "]"}]], "Input"],

Cell[BoxData["\<\"Backup stopped.\"\>"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Part 1 --  Declarations and basic fns. ", "Section"],

Cell[CellGroupData[{

Cell["Warning messages Off", "Subsection",
 CellChangeTimes->{{3.467119314622471*^9, 3.467119352821146*^9}, {
   3.476693637814482*^9, 3.476693639510118*^9}, {3.478635035907522*^9, 
   3.478635074317131*^9}, 3.478677199671947*^9, {3.479720032782098*^9, 
   3.479720041791068*^9}, {3.479721708422789*^9, 3.479721712614642*^9}, {
   3.479971484831145*^9, 3.479971517573741*^9}, {3.5180845184489603`*^9, 
   3.518084549635188*^9}, {3.611388806219406*^9, 3.611388810714518*^9}, {
   3.611389088027945*^9, 3.611389089307828*^9}}],

Cell[TextData[{
 "The following warning message is turned off due to irrelevant messages from \
code such as \n\n         sym[ ][ (f1_ /; deg[f1] === 1) \[CircleTimes] (f2_ \
/;  deg[f2] === 1) ] := ( f1\[CircleTimes]f2 + f2\[CircleTimes]f1 )/2\n       \
  \nwhich is syntactically correct but \[OpenCurlyDoubleQuote]probably wrong\
\[CloseCurlyDoubleQuote] ie., ",
 StyleBox["Mathematica ",
  FontSlant->"Italic"],
 " is being overly helpful. If not turned off, then these messages show up \
when the package is loaded,     "
}], "Text",
 CellChangeTimes->{{3.611388837748188*^9, 3.6113890534203587`*^9}, {
  3.611389100044567*^9, 3.611389171116888*^9}, {3.655319490456287*^9, 
  3.655319494007917*^9}}],

Cell[BoxData[
 RowBox[{"Off", "[", 
  RowBox[{"Syntax", "::", "bktwrn"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.611389943087966*^9, 3.611389961621545*^9}}],

Cell[BoxData[
 RowBox[{"Off", "[", 
  RowBox[{"General", "::", "bktwrn"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.611392531347969*^9, 3.611392532914468*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Utility fns", "Subsection",
 CellChangeTimes->{{3.467119314622471*^9, 3.467119352821146*^9}, {
   3.476693637814482*^9, 3.476693639510118*^9}, {3.478635035907522*^9, 
   3.478635074317131*^9}, 3.478677199671947*^9, {3.479720032782098*^9, 
   3.479720041791068*^9}, {3.479721708422789*^9, 3.479721712614642*^9}, {
   3.479971484831145*^9, 3.479971517573741*^9}, {3.5180845184489603`*^9, 
   3.518084549635188*^9}, {3.611388806219406*^9, 3.611388810714518*^9}, {
   3.611389088027945*^9, 3.611389089307828*^9}, {3.615279961199183*^9, 
   3.6152799665115232`*^9}, {3.61688415560168*^9, 3.616884160593556*^9}}],

Cell[CellGroupData[{

Cell["Timing   --   TimeLapsed[ ], ExpectedTiming[ ]", "Subsubsection",
 CellChangeTimes->{{3.616884188529458*^9, 3.616884207729638*^9}, {
   3.616884294993681*^9, 3.616884322706195*^9}, 3.6553196998454657`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LastTimeUsed", "=", 
   RowBox[{"TimeUsed", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "TimeLapsed", "]"}], "\n", 
 RowBox[{
  RowBox[{"TimeLapsed", "[", "x___", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "dt", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dt", "=", 
      RowBox[{
       RowBox[{"TimeUsed", "[", "]"}], "-", "LastTimeUsed"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"dt", ",", "\"\< CPU seconds\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{"x", "===", 
           RowBox[{"PatternSequence", "[", "]"}]}], ")"}]}], "&&", 
        RowBox[{"dt", ">", 
         RowBox[{"1.1", "x"}]}]}], ",", " ", 
       RowBox[{
       "Print", "[", "\"\<********* Slow Code Warning *********\>\"", "]"}]}],
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{"x", "===", 
           RowBox[{"PatternSequence", "[", "]"}]}], ")"}]}], "&&", 
        RowBox[{"dt", "<", 
         RowBox[{"0.9", "x"}]}]}], ",", " ", 
       RowBox[{
       "Print", "[", "\"\<********* Fast Code Warning *********\>\"", "]"}]}],
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"LastTimeUsed", "=", 
      RowBox[{"TimeUsed", "[", "]"}]}], ";"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6137905228658447`*^9, 3.6137907290504*^9}, {
   3.613790770649014*^9, 3.613790797289729*^9}, {3.613790881791791*^9, 
   3.613790903963417*^9}, {3.613790991087799*^9, 3.613791036228037*^9}, {
   3.613791067147493*^9, 3.6137911914431353`*^9}, {3.613791816503991*^9, 
   3.613791860274517*^9}, {3.613792049123089*^9, 3.613792059429151*^9}, {
   3.613792112608921*^9, 3.6137921356516314`*^9}, {3.613792209767234*^9, 
   3.613792253911971*^9}, {3.613792333097574*^9, 3.613792389290188*^9}, {
   3.613792428300887*^9, 3.613792457038578*^9}, {3.6137925301839647`*^9, 
   3.613792537982444*^9}, {3.613792594414362*^9, 3.613792633189106*^9}, {
   3.613792819080369*^9, 3.613792822662135*^9}, 3.6141090495809593`*^9, 
   3.614122161922227*^9, {3.61412220654116*^9, 3.614122232397922*^9}, {
   3.6161151307414713`*^9, 3.6161151365159082`*^9}}],

Cell["\<\
Argument  s  should be the actual time from a previous run. Warnings are \
given at 15% change.\
\>", "Text",
 CellChangeTimes->{{3.615282165832675*^9, 3.615282235737051*^9}, {
  3.615284519554357*^9, 3.615284538722167*^9}, {3.646773443271205*^9, 
  3.6467734512551537`*^9}}],

Cell["\<\
The hold is needed because otherwise the argument is evaluated before it gets \
into the body of the module, so we can\[CloseCurlyQuote]t then time its \
evaluation,\
\>", "Text",
 CellChangeTimes->{{3.6152835337420683`*^9, 3.615283585966632*^9}, {
  3.615283636894916*^9, 3.615283702079069*^9}}],

Cell[BoxData[{
 RowBox[{"SetAttributes", "[", 
  RowBox[{"ExpectedTiming", ",", "HoldAllComplete"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpectedTiming", "[", "x_", "]"}], ":=", 
  RowBox[{"ExpectedTiming", "[", 
   RowBox[{"0", ",", "x"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpectedTiming", "[", 
   RowBox[{"s_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", ",", "r"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"t", "=", 
      RowBox[{"Timing", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Round", "[", 
         RowBox[{"100", " ", 
          RowBox[{"First", "[", "t", "]"}]}], "]"}], "/", "100"}], "//", 
       "N"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
      "r", ",", 
       "\"\<\[VeryThinSpace]\[VeryThinSpace]\[VeryThinSpace]sec, at \
\[VeryThinSpace]\[VeryThinSpace]\>\"", ",", 
       RowBox[{"DateString", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Year\>\"", ",", "\"\<-\>\"", ",", "\"\<Month\>\"", ",", 
          "\"\<-\>\"", ",", "\"\<Day\>\"", ",", "\"\< \>\"", ",", 
          "\"\<Hour24\>\"", ",", "\"\<:\>\"", ",", "\"\<Minute\>\""}], "}"}], 
        "]"}], ",", "\"\<, tpTensorVer\>\"", ",", "$tpTensorVersion", ",", 
       "\"\<.\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"s", ">", 
        RowBox[{"10", "$TimeUnit"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"r", ">", 
           RowBox[{"1.15", "s"}]}], ",", "  ", 
          RowBox[{
          "Print", "[", 
           "\"\<********* Warning: slower than expected *********\>\"", 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"r", "<", 
           RowBox[{"s", "/", "1.15"}]}], ",", 
          RowBox[{
          "Print", "[", 
           "\"\<********* Warning: faster than expected *********\>\"", 
           "]"}]}], "]"}]}]}], "]"}], ";", 
     RowBox[{"t", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615280044259091*^9, 3.6152800713621807`*^9}, {
   3.6152801195545597`*^9, 3.61528017776431*^9}, {3.615280608217615*^9, 
   3.615280692603813*^9}, {3.615280904188599*^9, 3.615280976131774*^9}, {
   3.615281104741159*^9, 3.6152811079401484`*^9}, {3.615281401526638*^9, 
   3.615281423783372*^9}, {3.615281572920096*^9, 3.6152815885205193`*^9}, {
   3.615281623656392*^9, 3.6152816823938627`*^9}, {3.615281721225499*^9, 
   3.615281722857767*^9}, {3.615281789489718*^9, 3.615281797450386*^9}, {
   3.615281837083872*^9, 3.615281851945991*^9}, {3.615281911897358*^9, 
   3.615281922633399*^9}, {3.615281958649952*^9, 3.615281962953949*^9}, {
   3.615282000554199*^9, 3.615282128894288*^9}, {3.615282863487475*^9, 
   3.6152829699521637`*^9}, {3.615283051906644*^9, 3.615283067518591*^9}, {
   3.615283180193226*^9, 3.615283213825706*^9}, {3.615283306929536*^9, 
   3.6152833118420753`*^9}, {3.615283479585204*^9, 3.61528352214683*^9}, {
   3.615283740501528*^9, 3.615283755842216*^9}, {3.615283921122826*^9, 
   3.615283922480678*^9}, {3.6152839852983713`*^9, 3.615283986593526*^9}, {
   3.6152844975406713`*^9, 3.6152845017643223`*^9}, {3.6152849517025337`*^9, 
   3.6152850649984703`*^9}, {3.6152851181713753`*^9, 3.615285131079761*^9}, {
   3.615285525353405*^9, 3.615285565650021*^9}, {3.615285733696578*^9, 
   3.615285768077243*^9}, {3.615285811819743*^9, 3.615285924430397*^9}, {
   3.615700304928884*^9, 3.615700361507318*^9}, {3.646770580268539*^9, 
   3.646770881993854*^9}, {3.646770965224597*^9, 3.64677096554887*^9}, {
   3.6467710212881002`*^9, 3.646771044548554*^9}, {3.6467726663214827`*^9, 
   3.646772690097838*^9}, {3.646773015245319*^9, 3.64677303489188*^9}, {
   3.646773402902829*^9, 3.646773419752589*^9}, 3.65421989222209*^9, {
   3.654220500534184*^9, 3.654220504039063*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExpectedTiming", "[", 
  RowBox[{"0.76", ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}], "100000"], "//", "Expand"}], ";"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.615282705918201*^9, 3.615282745728529*^9}, {
   3.615283283332643*^9, 3.615283283443178*^9}, 3.615283322916378*^9, {
   3.615283368355115*^9, 3.6152833831718063`*^9}, {3.615283454948704*^9, 
   3.6152834608199*^9}, {3.615283766726941*^9, 3.615283794260633*^9}, 
   3.615283926503289*^9, 3.615283997734684*^9, {3.615285608780807*^9, 
   3.615285608864406*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.34`", "\[InvisibleSpace]", "\<\"\[VeryThinSpace]\[VeryThinSpace]\
\[VeryThinSpace]sec, at \[VeryThinSpace]\[VeryThinSpace]\"\>", 
   "\[InvisibleSpace]", "\<\"2015-09-22 12:10\"\>", 
   "\[InvisibleSpace]", "\<\", tpTensorVer\"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\".\"\>"}],
  SequenceForm[
  0.34, "\[VeryThinSpace]\[VeryThinSpace]\[VeryThinSpace]sec, at \
\[VeryThinSpace]\[VeryThinSpace]", "2015-09-22 12:10", ", tpTensorVer", 4, 
   "."],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6152833795763197`*^9, 3.61528338515644*^9}, 
   3.615283463491081*^9, 3.615283717693241*^9, {3.61528376175905*^9, 
   3.615283796230228*^9}, 3.615283927387672*^9, {3.615283990164084*^9, 
   3.6152839992874737`*^9}, {3.6152850113708897`*^9, 3.615285069943927*^9}, 
   3.615285134952647*^9, 3.615285538801756*^9, 3.615285570541988*^9, 
   3.615285610175871*^9, 3.615285772212779*^9, 3.615285894849153*^9, 
   3.61528592789716*^9, 3.6518766154683*^9}],

Cell[BoxData["\<\"********* Warning: faster than expected *********\"\>"], \
"Print",
 CellChangeTimes->{{3.6152833795763197`*^9, 3.61528338515644*^9}, 
   3.615283463491081*^9, 3.615283717693241*^9, {3.61528376175905*^9, 
   3.615283796230228*^9}, 3.615283927387672*^9, {3.615283990164084*^9, 
   3.6152839992874737`*^9}, {3.6152850113708897`*^9, 3.615285069943927*^9}, 
   3.615285134952647*^9, 3.615285538801756*^9, 3.615285570541988*^9, 
   3.615285610175871*^9, 3.615285772212779*^9, 3.615285894849153*^9, 
   3.61528592789716*^9, 3.651876615470402*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing  --   ExpectZero[ ]", "Subsubsection",
 CellChangeTimes->{{3.616884263489438*^9, 3.616884283073662*^9}, {
   3.616884324229011*^9, 3.616884331953829*^9}, 3.6553196981046743`*^9}],

Cell[BoxData[{
 RowBox[{"SetAttributes", "[", 
  RowBox[{"ExpectZero", ",", "HoldAll"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpectZero", "[", "z_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "ans", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ans", "=", "z"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"ans", "===", "0"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<ExpectZero: The expression,\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"HoldForm", "[", "z", "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", 
         "\"\<should evaluate to zero. Instead, it evaluates to:\>\"", "]"}], 
        ";", " ", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "ans", "]"}]}], ",", "\[IndentingNewLine]", 
       "ans"}], "]"}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6164012857051277`*^9, 3.616401417082686*^9}, {
  3.616401467898628*^9, 3.616401611054655*^9}, {3.6164024663340673`*^9, 
  3.6164024975816298`*^9}, {3.616402544222742*^9, 3.616402672159668*^9}, {
  3.616402748111845*^9, 3.616402804032077*^9}, {3.6164028449441423`*^9, 
  3.616402849567587*^9}, {3.616402905424843*^9, 3.616402982978037*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"z", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ExpectZero", "[", 
  RowBox[{"z", "-", "3"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "z", "]"}]}], "Input",
 CellChangeTimes->{{3.6164025128729153`*^9, 3.616402515895686*^9}, {
  3.6164038543609953`*^9, 3.616403866008834*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"ExpectZero: The expression,\"\>"], "Print",
 CellChangeTimes->{3.616403872046205*^9, 3.651876615517239*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"z", "-", "3"}],
  HoldForm]], "Print",
 CellChangeTimes->{3.616403872046205*^9, 3.651876615519477*^9}],

Cell[BoxData["\<\"should evaluate to zero. Instead, it evaluates to:\"\>"], \
"Print",
 CellChangeTimes->{3.616403872046205*^9, 3.651876615521109*^9}],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Print",
 CellChangeTimes->{3.616403872046205*^9, 3.651876615522728*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Output  --   // ShortForm", "Subsubsection",
 CellChangeTimes->{{3.61688435188971*^9, 3.616884376513838*^9}, 
   3.6168844376178837`*^9, 3.655319697273033*^9}],

Cell["\<\
This outputs the expression  x  without arguments and brackets  [ .... ].  \
The argument symbols to drop are given as the list  vars,  \
\>", "Text",
 CellChangeTimes->{{3.6168859822596416`*^9, 3.61688618963627*^9}, {
  3.616886412244622*^9, 3.6168864197326193`*^9}, {3.616886615012641*^9, 
  3.616886628084648*^9}, {3.623223942227674*^9, 3.623223993203682*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ShortForm", "[", 
   RowBox[{"x_", ",", "vars_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"f", ",", "vQ"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"f", "=", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"vars", ",", "#"}], "]"}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vQ", "=", 
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"And", ",", 
         RowBox[{"Map", "[", 
          RowBox[{"f", ",", 
           RowBox[{"{", "#", "}"}]}], "]"}]}], "]"}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"HoldForm", "[", "x", "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"X_", "[", 
          RowBox[{"s__", "?", "vQ"}], "]"}], "\[RuleDelayed]", "X"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Derivative", "[", "j_", "]"}], "[", "X_", "]"}], "[", 
          RowBox[{"s__", "?", "vQ"}], "]"}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"Derivative", "[", "j", "]"}], "[", "X", "]"}]}]}], 
       "}"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.616884399379785*^9, 3.616884421275283*^9}, {
  3.616884563675747*^9, 3.616884571835433*^9}, {3.616884607098194*^9, 
  3.616884620379793*^9}, {3.6168855192440853`*^9, 3.616885535133327*^9}, {
  3.616885653303793*^9, 3.616885725199275*^9}, {3.616885798064045*^9, 
  3.616885900160199*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{
    RowBox[{"360", " ", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", "\[Prime]",
         MultilineFunction->None], "[", 
        RowBox[{"s", ",", "r"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["M", "\[Prime]",
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "s"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["M", "\[Prime]",
         MultilineFunction->None], "[", 
        RowBox[{"s", ",", "t"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["z", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "s", "]"}]}], 
      "\[RightAngleBracket]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Rho]", "\[Prime]",
       MultilineFunction->None], "[", "s", "]"}]}], "+", 
    RowBox[{"240", " ", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", "\[Prime]",
         MultilineFunction->None], "[", "s", "]"}], ",", 
       RowBox[{
        SuperscriptBox["M", "\[Prime]",
         MultilineFunction->None], "[", "s", "]"}], ",", 
       RowBox[{
        SuperscriptBox["M", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "s", "]"}], ",", 
       RowBox[{
        SuperscriptBox["z", "\[Prime]",
         MultilineFunction->None], "[", "s", "]"}]}], 
      "\[RightAngleBracket]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Rho]", "\[Prime]",
       MultilineFunction->None], "[", "s", "]"}]}], "-", 
    RowBox[{"80", " ", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "s", "]"}], ",", 
       RowBox[{"M", "[", "s", "]"}], ",", 
       RowBox[{"M", "[", "s", "]"}], ",", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", "3", ")"}],
          Derivative],
         MultilineFunction->None], "[", "s", "]"}]}], 
      "\[RightAngleBracket]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Rho]", "\[Prime]",
       MultilineFunction->None], "[", "s", "]"}]}], "-", 
    RowBox[{"120", " ", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "s", "]"}], ",", 
       RowBox[{"M", "[", "s", "]"}], ",", 
       RowBox[{
        SuperscriptBox["M", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "s", "]"}], ",", 
       RowBox[{
        SuperscriptBox["z", "\[Prime]",
         MultilineFunction->None], "[", "s", "]"}]}], 
      "\[RightAngleBracket]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Rho]", "\[Prime]",
       MultilineFunction->None], "[", "s", "]"}]}], "-", 
    RowBox[{"80", " ", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", "3", ")"}],
          Derivative],
         MultilineFunction->None], "[", "s", "]"}], ",", 
       RowBox[{"M", "[", "s", "]"}], ",", 
       RowBox[{
        SuperscriptBox["M", "\[Prime]",
         MultilineFunction->None], "[", "s", "]"}], ",", 
       RowBox[{
        SuperscriptBox["z", "\[Prime]",
         MultilineFunction->None], "[", "s", "]"}]}], 
      "\[RightAngleBracket]"}], " ", 
     RowBox[{
      SuperscriptBox["\[Rho]", "\[Prime]",
       MultilineFunction->None], "[", "s", "]"}]}], "+", 
    RowBox[{"60", " ", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "s", "]"}], ",", 
       RowBox[{
        SuperscriptBox["z", 
         TagBox[
          RowBox[{"(", "3", ")"}],
          Derivative],
         MultilineFunction->None], "[", "s", "]"}]}], 
      "\[RightAngleBracket]"}], " ", 
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{
         RowBox[{"M", "[", "s", "]"}], ",", 
         RowBox[{"M", "[", "s", "]"}]}], "\[RightAngleBracket]"}], 
       "\[RightAngleBracket]"}], 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]], " ", 
     RowBox[{
      SuperscriptBox["\[Rho]", "\[Prime]",
       MultilineFunction->None], "[", "s", "]"}]}], "+", 
    RowBox[{"60", " ", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{
        SuperscriptBox["z", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "s", "]"}], ",", 
       RowBox[{
        SuperscriptBox["z", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "s", "]"}]}], 
      "\[RightAngleBracket]"}], " ", 
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{
         RowBox[{"M", "[", "s", "]"}], ",", 
         RowBox[{
          SuperscriptBox["M", "\[Prime]",
           MultilineFunction->None], "[", "s", "]"}]}], 
        "\[RightAngleBracket]"}], "\[RightAngleBracket]"}], 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]], " ", 
     RowBox[{
      SuperscriptBox["\[Rho]", "\[Prime]",
       MultilineFunction->None], "[", "s", "]"}]}], "-", 
    RowBox[{"20", " ", 
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{
         RowBox[{"M", "[", "s", "]"}], ",", 
         RowBox[{
          SuperscriptBox["M", 
           TagBox[
            RowBox[{"(", "3", ")"}],
            Derivative],
           MultilineFunction->None], "[", "s", "]"}]}], 
        "\[RightAngleBracket]"}], "\[RightAngleBracket]"}], 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]], " ", 
     RowBox[{
      SuperscriptBox["\[Rho]", "\[Prime]",
       MultilineFunction->None], "[", "s", "]"}]}], "+", 
    RowBox[{"30", " ", 
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{
         RowBox[{
          SuperscriptBox["M", "\[Prime]",
           MultilineFunction->None], "[", "s", "]"}], ",", 
         RowBox[{
          SuperscriptBox["M", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "s", "]"}]}], 
        "\[RightAngleBracket]"}], "\[RightAngleBracket]"}], 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]], " ", 
     RowBox[{
      SuperscriptBox["\[Rho]", "\[Prime]",
       MultilineFunction->None], "[", "s", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6168844752657537`*^9, 3.616884536421322*^9}, {
  3.616885915668427*^9, 3.616885968437463*^9}, {3.616886737257306*^9, 
  3.616886744981719*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ShortForm", "[", 
  RowBox[{"y", ",", 
   RowBox[{"{", 
    RowBox[{"s", ",", "t"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.616885930229404*^9, 3.6168859407765102`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{
   RowBox[{"240", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SuperscriptBox["z", "\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["M", "\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["M", "\[Prime]\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["z", "\[Prime]",
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "+", 
   RowBox[{"360", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["z", "\[Prime]",
        MultilineFunction->None], "[", 
       RowBox[{"s", ",", "r"}], "]"}], ",", 
      SuperscriptBox["M", "\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["M", "\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["z", "\[Prime]\[Prime]",
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "-", 
   RowBox[{"80", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SuperscriptBox["z", "\[Prime]\[Prime]",
       MultilineFunction->None], ",", "M", ",", "M", ",", 
      SuperscriptBox["z", 
       TagBox[
        RowBox[{"(", "3", ")"}],
        Derivative],
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "-", 
   RowBox[{"120", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SuperscriptBox["z", "\[Prime]\[Prime]",
       MultilineFunction->None], ",", "M", ",", 
      SuperscriptBox["M", "\[Prime]\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["z", "\[Prime]",
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "-", 
   RowBox[{"80", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SuperscriptBox["z", 
       TagBox[
        RowBox[{"(", "3", ")"}],
        Derivative],
       MultilineFunction->None], ",", "M", ",", 
      SuperscriptBox["M", "\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["z", "\[Prime]",
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "+", 
   RowBox[{"60", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SuperscriptBox["z", "\[Prime]\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["z", 
       TagBox[
        RowBox[{"(", "3", ")"}],
        Derivative],
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"M", ",", "M"}], "\[RightAngleBracket]"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "+", 
   RowBox[{"60", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SuperscriptBox["z", "\[Prime]\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["z", "\[Prime]\[Prime]",
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"M", ",", 
        SuperscriptBox["M", "\[Prime]",
         MultilineFunction->None]}], "\[RightAngleBracket]"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "-", 
   RowBox[{"20", " ", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"M", ",", 
        SuperscriptBox["M", 
         TagBox[
          RowBox[{"(", "3", ")"}],
          Derivative],
         MultilineFunction->None]}], "\[RightAngleBracket]"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "+", 
   RowBox[{"30", " ", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
        SuperscriptBox["M", "\[Prime]",
         MultilineFunction->None], ",", 
        SuperscriptBox["M", "\[Prime]\[Prime]",
         MultilineFunction->None]}], "\[RightAngleBracket]"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}]}],
  HoldForm]], "Output",
 CellChangeTimes->{{3.6168859347340403`*^9, 3.616885973082316*^9}, 
   3.6168867490853167`*^9, 3.651876615592338*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"y", "//", " ", 
  RowBox[{
   RowBox[{"ShortForm", "[", 
    RowBox[{"#", ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "t", ",", "r"}], "}"}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.616886221160452*^9, 3.61688624332098*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{
   RowBox[{"240", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SuperscriptBox["z", "\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["M", "\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["M", "\[Prime]\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["z", "\[Prime]",
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "+", 
   RowBox[{"360", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SuperscriptBox["z", "\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["M", "\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["M", "\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["z", "\[Prime]\[Prime]",
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "-", 
   RowBox[{"80", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SuperscriptBox["z", "\[Prime]\[Prime]",
       MultilineFunction->None], ",", "M", ",", "M", ",", 
      SuperscriptBox["z", 
       TagBox[
        RowBox[{"(", "3", ")"}],
        Derivative],
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "-", 
   RowBox[{"120", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SuperscriptBox["z", "\[Prime]\[Prime]",
       MultilineFunction->None], ",", "M", ",", 
      SuperscriptBox["M", "\[Prime]\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["z", "\[Prime]",
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "-", 
   RowBox[{"80", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SuperscriptBox["z", 
       TagBox[
        RowBox[{"(", "3", ")"}],
        Derivative],
       MultilineFunction->None], ",", "M", ",", 
      SuperscriptBox["M", "\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["z", "\[Prime]",
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "+", 
   RowBox[{"60", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SuperscriptBox["z", "\[Prime]\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["z", 
       TagBox[
        RowBox[{"(", "3", ")"}],
        Derivative],
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"M", ",", "M"}], "\[RightAngleBracket]"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "+", 
   RowBox[{"60", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SuperscriptBox["z", "\[Prime]\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["z", "\[Prime]\[Prime]",
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"M", ",", 
        SuperscriptBox["M", "\[Prime]",
         MultilineFunction->None]}], "\[RightAngleBracket]"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "-", 
   RowBox[{"20", " ", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"M", ",", 
        SuperscriptBox["M", 
         TagBox[
          RowBox[{"(", "3", ")"}],
          Derivative],
         MultilineFunction->None]}], "\[RightAngleBracket]"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "+", 
   RowBox[{"30", " ", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
        SuperscriptBox["M", "\[Prime]",
         MultilineFunction->None], ",", 
        SuperscriptBox["M", "\[Prime]\[Prime]",
         MultilineFunction->None]}], "\[RightAngleBracket]"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}]}],
  HoldForm]], "Output",
 CellChangeTimes->{3.616886245146532*^9, 3.651876615634094*^9}]
}, Open  ]],

Cell["This sets up a default argument list,", "Text",
 CellChangeTimes->{{3.616886257987935*^9, 3.6168862831881733`*^9}, {
  3.616886360628655*^9, 3.616886362451983*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ShortForm", "[", "x_", "]"}], ":=", 
  RowBox[{"ShortForm", "[", 
   RowBox[{"x", ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", 
      OverscriptBox["s", "_"]}], "}"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6168862967755003`*^9, 3.616886328730227*^9}, {
  3.6168866923788023`*^9, 3.616886696154327*^9}}],

Cell["and now  Short form can be easily used as postfix, ", "Text",
 CellChangeTimes->{{3.616886257987935*^9, 3.6168862831881733`*^9}, {
  3.616886360628655*^9, 3.616886394116386*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"y", "//", " ", "ShortForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{
   RowBox[{"240", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SuperscriptBox["z", "\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["M", "\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["M", "\[Prime]\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["z", "\[Prime]",
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "+", 
   RowBox[{"360", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["z", "\[Prime]",
        MultilineFunction->None], "[", 
       RowBox[{"s", ",", "r"}], "]"}], ",", 
      RowBox[{
       SuperscriptBox["M", "\[Prime]",
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "s"}], "]"}], ",", 
      RowBox[{
       SuperscriptBox["M", "\[Prime]",
        MultilineFunction->None], "[", 
       RowBox[{"s", ",", "t"}], "]"}], ",", 
      SuperscriptBox["z", "\[Prime]\[Prime]",
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "-", 
   RowBox[{"80", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SuperscriptBox["z", "\[Prime]\[Prime]",
       MultilineFunction->None], ",", "M", ",", "M", ",", 
      SuperscriptBox["z", 
       TagBox[
        RowBox[{"(", "3", ")"}],
        Derivative],
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "-", 
   RowBox[{"120", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SuperscriptBox["z", "\[Prime]\[Prime]",
       MultilineFunction->None], ",", "M", ",", 
      SuperscriptBox["M", "\[Prime]\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["z", "\[Prime]",
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "-", 
   RowBox[{"80", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SuperscriptBox["z", 
       TagBox[
        RowBox[{"(", "3", ")"}],
        Derivative],
       MultilineFunction->None], ",", "M", ",", 
      SuperscriptBox["M", "\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["z", "\[Prime]",
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "+", 
   RowBox[{"60", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SuperscriptBox["z", "\[Prime]\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["z", 
       TagBox[
        RowBox[{"(", "3", ")"}],
        Derivative],
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"M", ",", "M"}], "\[RightAngleBracket]"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "+", 
   RowBox[{"60", " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SuperscriptBox["z", "\[Prime]\[Prime]",
       MultilineFunction->None], ",", 
      SuperscriptBox["z", "\[Prime]\[Prime]",
       MultilineFunction->None]}], "\[RightAngleBracket]"}], " ", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"M", ",", 
        SuperscriptBox["M", "\[Prime]",
         MultilineFunction->None]}], "\[RightAngleBracket]"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "-", 
   RowBox[{"20", " ", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"M", ",", 
        SuperscriptBox["M", 
         TagBox[
          RowBox[{"(", "3", ")"}],
          Derivative],
         MultilineFunction->None]}], "\[RightAngleBracket]"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}], "+", 
   RowBox[{"30", " ", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
        SuperscriptBox["M", "\[Prime]",
         MultilineFunction->None], ",", 
        SuperscriptBox["M", "\[Prime]\[Prime]",
         MultilineFunction->None]}], "\[RightAngleBracket]"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]], " ", 
    SuperscriptBox["\[Rho]", "\[Prime]",
     MultilineFunction->None]}]}],
  HoldForm]], "Output",
 CellChangeTimes->{3.616886353879921*^9, 3.616886454617839*^9, 
  3.616886704755186*^9, 3.6168867879652557`*^9, 3.6518766156786823`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["General language improvements", "Subsubsection",
 CellChangeTimes->{{3.62319442059741*^9, 3.62319445968569*^9}, {
   3.623197322652714*^9, 3.6231973318367453`*^9}, {3.6232237280986557`*^9, 
   3.623223737698186*^9}, {3.624140893128172*^9, 3.624140904632186*^9}, 
   3.6241411767774057`*^9, 3.65531969646957*^9}],

Cell[CellGroupData[{

Cell["   AnyTrueQ[ ],   FirstTruePosition[ ]", "Item",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.624140923325797*^9, 3.624140929564684*^9}, {
   3.646773559749524*^9, 3.646773571381572*^9}, 3.655319670053936*^9}],

Cell["\<\
     AnyTrueQ[ ]   and    FirstTruePosition[ ]   are defined in package  \
PartialDerivative`.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.623223767314036*^9, 3.623223827042695*^9}, 
   3.6553196700539837`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["   TrigReduce[ ]", "Item",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.6241409926963787`*^9, 3.62414105804071*^9}, {
   3.624141122761064*^9, 3.624141125167842*^9}, {3.625714719936462*^9, 
   3.625714720208506*^9}, {3.6467735612852383`*^9, 3.646773561701593*^9}, 
   3.655319746645048*^9}],

Cell["\<\
In Mathematica 10.0  (and others?)  the built-in  TrigReduce  does nothing \
with  SeriesData,\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.6241409926963787`*^9, 3.62414105804071*^9}, {
   3.624141140057185*^9, 3.624141152857245*^9}, 3.65531974664509*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "TrigReduce", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"TrigReduce", "[", "x_SeriesData", "]"}], ":=", 
  RowBox[{"MapAt", "[", 
   RowBox[{"TrigReduce", ",", "x", ",", "3"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"Protect", "[", "TrigReduce", "]"}], ";"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True,
 CellChangeTimes->{{3.6241409737506742`*^9, 3.624140973752061*^9}, 
   3.655319746645158*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["   DependsQ[ ]", "Item",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.6241409926963787`*^9, 3.62414105804071*^9}, {
   3.624141122761064*^9, 3.624141125167842*^9}, {3.625714704704482*^9, 
   3.625714723376528*^9}, {3.6467735625656633`*^9, 3.646773562949367*^9}, 
   3.655319787860568*^9}],

Cell["This returns True if expression  y  depends on the symbol x,", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.542597968766034*^9, 3.542598052643159*^9}, {
   3.5425980839072657`*^9, 3.5425981579549437`*^9}, {3.542598189363426*^9, 
   3.542598219907153*^9}, {3.542598261971859*^9, 3.5425982652029657`*^9}, 
   3.655319787860615*^9}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "DependsQ", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DependsQ", "[", 
   RowBox[{"y_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"!", 
   RowBox[{"FreeQ", "[", 
    RowBox[{"y", ",", "x"}], "]"}]}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True,
 CellChangeTimes->{{3.542591269348653*^9, 3.542591315048354*^9}, 
   3.542591393818583*^9, {3.5425915682515593`*^9, 3.542591568457759*^9}, {
   3.5425917099317293`*^9, 3.542591733390504*^9}, {3.543267077170266*^9, 
   3.543267090142706*^9}, 3.655319787860681*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["   FnValueQ[ ]", "Item",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{{3.646769087234338*^9, 3.646769093393978*^9}, {
   3.6467735642615967`*^9, 3.64677356464528*^9}, 3.655319877475211*^9}],

Cell["\<\
FnValueQ[ f[n] ]   tests if the function  f  has a value for the argument \
that results from evaluating  n.
Example:  Suppose we want to test if these have values:  f[1], f[2], f[3], \
....  
We can do so by ValueQ[ f[1] ], ValueQ[ f[2] ], ...   but this wont work in a \
loop over  n   using  ValueQ[ f[n] ]  because
f[n]  will always have a value, ie.,  f[n] = f[1], f[2], ... .   The loop \
over  n  would work using  FnValueQ[ f[n] ].\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{{3.646764860925136*^9, 3.6467652203932047`*^9}, {
   3.646765252999777*^9, 3.646765466292841*^9}, 3.655319877475251*^9}],

Cell["\<\
To see how this works, take out the  ReleaseHold to see held output. The \
Flatten removes List wrapped around the evaluated arguments.
Replacing   x  by  {n}  is necessary because  ReplacePart  doesn\
\[CloseCurlyQuote]t replace a variable number of parts, so we use it to do \
just the one part  x ={n} ,\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{{3.646768612137377*^9, 3.646768938309918*^9}, {
  3.646769154802033*^9, 3.6467691649946127`*^9}, {3.655319858563531*^9, 
  3.65531987747528*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FnValueQ", "[", 
   RowBox[{"f_", "[", "n__", "]"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"ReleaseHold", "[", 
     RowBox[{"FlattenAt", "[", 
      RowBox[{
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"Hold", "[", 
          RowBox[{"ValueQ", "[", 
           RowBox[{"f", "[", "x", "]"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1", ",", "1"}], "}"}], "\[Rule]", 
          RowBox[{"{", "n", "}"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True,
 CellChangeTimes->{{3.6467684837082567`*^9, 3.646768499808329*^9}, {
   3.646768535647821*^9, 3.646768568560104*^9}, {3.6467687436774063`*^9, 
   3.646768746572825*^9}, 3.655319877475366*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["   PairQ[ ]", "Item",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{{3.655400106980754*^9, 3.655400146356224*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PairQ", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Head", "[", "x", "]"}], "===", "List"}], "&&", 
   RowBox[{
    RowBox[{"Length", "[", "x", "]"}], "===", "2"}]}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->True,
 CellChangeTimes->{{3.655399173872662*^9, 3.655399217424429*^9}, 
   3.6554001171088467`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["   TakePlus[ ] ,  TakeMinus[ ]", "Item",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}],

Cell["\<\
For selecting the sign of the first   \[PlusMinus]   in a  PlusMinus  \
expression,\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TakePlus", "[", "x_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "/.", 
     RowBox[{
      RowBox[{"PlusMinus", "[", "a_", "]"}], "\[RuleDelayed]", "a"}]}], "/.", 
    
    RowBox[{
     RowBox[{"PlusMinus", "[", 
      RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"a", "+", "b"}]}]}], "/.", 
   RowBox[{
    RowBox[{"PlusMinus", "[", 
     RowBox[{"a_", ",", "b_", ",", "c__"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"PlusMinus", "[", 
     RowBox[{
      RowBox[{"a", "+", "b"}], ",", "c"}], "]"}]}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"TakeMinus", "[", "x_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "/.", 
     RowBox[{
      RowBox[{"PlusMinus", "[", "a_", "]"}], "\[RuleDelayed]", 
      RowBox[{"-", "a"}]}]}], "/.", 
    RowBox[{
     RowBox[{"PlusMinus", "[", 
      RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"a", "-", "b"}]}]}], "/.", 
   RowBox[{
    RowBox[{"PlusMinus", "[", 
     RowBox[{"a_", ",", "b_", ",", "c__"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"PlusMinus", "[", 
     RowBox[{
      RowBox[{"a", "-", "b"}], ",", "c"}], "]"}]}]}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"TakePlus", "[", 
  RowBox[{"TakePlus", "[", 
   RowBox[{
    RowBox[{"X", "\[PlusMinus]", "Y"}], "\[PlusMinus]", "Z"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TakePlus", "[", 
  RowBox[{"TakeMinus", "[", 
   RowBox[{
    RowBox[{"X", "\[PlusMinus]", "Y"}], "\[PlusMinus]", "Z"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TakeMinus", "[", 
  RowBox[{"TakePlus", "[", 
   RowBox[{
    RowBox[{"X", "\[PlusMinus]", "Y"}], "\[PlusMinus]", "Z"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TakeMinus", "[", 
  RowBox[{"TakeMinus", "[", 
   RowBox[{
    RowBox[{"X", "\[PlusMinus]", "Y"}], "\[PlusMinus]", "Z"}], "]"}], 
  "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"X", "+", "Y", "+", "Z"}]], "Output"],

Cell[BoxData[
 RowBox[{"X", "+", "Y", "-", "Z"}]], "Output"],

Cell[BoxData[
 RowBox[{"X", "-", "Y", "+", "Z"}]], "Output"],

Cell[BoxData[
 RowBox[{"X", "-", "Y", "-", "Z"}]], "Output"]
}, Open  ]],

Cell["\<\
Also want rules for expanding products of  PlusMinus  expressions.
Want  TakePlus  and  TakeMinus   to also work on  MinusPlus.  
Want fns  TakeUpper[ ]   and  TakeLower[ ].\
\>", "Text"]
}, Closed]],

Cell[CellGroupData[{

Cell["   AddAssumption[ ] ,  RemoveAssumption [ ]", "Item",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}],

Cell["\<\
For adding and removing an assumptions to/from  $Assumptions. 
Keeps the arglist of  And[ ] clean, \
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DeleteDuplicates", "[", 
  RowBox[{"And", "[", 
   RowBox[{"a", ",", "b", ",", "a", ",", "c", ",", "a"}], "]"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"a", "&&", "b", "&&", "c"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddAssumption", "[", "a_", "]"}], ":=", 
  RowBox[{"$Assumptions", " ", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"$Assumptions", "&&", "a"}], "]"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"RemoveAssumption", "[", "a_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"$Assumptions", "===", "a"}], ",", 
    RowBox[{"$Assumptions", " ", "=", "True"}], ",", 
    RowBox[{"$Assumptions", " ", "=", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{"$Assumptions", ",", "a"}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"RemoveAssumption", "[", "a_And", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Scan", "[", 
     RowBox[{"RemoveAssumption", ",", "a"}], "]"}], ";", "$Assumptions"}], 
   ")"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AddAssumption", "[", 
  RowBox[{"a1", "&&", "a2", "&&", "a3"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddAssumption", "[", "a4", "]"}], "\[IndentingNewLine]", 
 RowBox[{"RemoveAssumption", "[", 
  RowBox[{"a3", "&&", "a2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"RemoveAssumption", "[", "a1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"RemoveAssumption", "[", "a4", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"a1", "&&", "a2", "&&", "a3"}]], "Output"],

Cell[BoxData[
 RowBox[{"a1", "&&", "a2", "&&", "a3", "&&", "a4"}]], "Output"],

Cell[BoxData[
 RowBox[{"a1", "&&", "a4"}]], "Output"],

Cell[BoxData["a4"], "Output"],

Cell[BoxData["True"], "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Define formats for symbols that can be cut-and-pasted", "Subsubsection"],

Cell[CellGroupData[{

Cell["FormatSymbol[ ] ", "Item"],

Cell["\<\
For the development code and also ideas about tensor index code, see file:  \
tensor_index_io.nb\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FormatSymbol", "[", 
   RowBox[{"var_", ",", "rep_String"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"b", ",", "s1", ",", "s2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"b", "=", 
      RowBox[{"ToString", "[", 
       RowBox[{"FullForm", "[", 
        RowBox[{"Apply", "[", 
         RowBox[{"MakeBoxes", ",", 
          RowBox[{"MakeExpression", "[", 
           RowBox[{"rep", ",", "StandardForm"}], "]"}]}], "]"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"s1", "=", 
      RowBox[{
       RowBox[{"SymbolName", "[", "var", "]"}], "<>", "\"\</:MakeBoxes[\>\"", 
       "<>", 
       RowBox[{"SymbolName", "[", "var", "]"}], "<>", 
       "\"\<,StandardForm]:=\>\"", "<>", "b"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"ToExpression", "[", "s1", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"s2", "=", 
      RowBox[{"\"\<MakeExpression[\>\"", "<>", 
       StyleBox["b",
        ShowSpecialCharacters->False,
        ShowStringCharacters->True,
        NumberMarks->True], 
       StyleBox["<>",
        ShowSpecialCharacters->False,
        ShowStringCharacters->True,
        NumberMarks->True], "\"\<,StandardForm]:=HoldComplete[\>\"", "<>", 
       RowBox[{"SymbolName", "[", "var", "]"}], "<>", "\"\<]\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", "s2", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{"s1", ",", "s2"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["Example:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FormatSymbol", "[", 
  RowBox[{
  "p0", ",", 
   "\"\<\!\(\*SubscriptBox[SuperscriptBox[\(p\), \(0\)], OverscriptBox[\(e\), \
\(_\)]]\)\>\""}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"p0/:MakeBoxes[p0,StandardForm]:=SubscriptBox[SuperscriptBox[\\\"p\\\
\", \\\"0\\\"], OverscriptBox[\\\"e\\\", \\\"_\\\"]]\"\>"},
    {"\<\"MakeExpression[SubscriptBox[SuperscriptBox[\\\"p\\\", \\\"0\\\"], \
OverscriptBox[\\\"e\\\", \\\"_\\\"]],StandardForm]:=HoldComplete[p0]\"\>"}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["p0"], "Input"],

Cell[BoxData[
 SubscriptBox[
  SuperscriptBox["p", "0"], 
  OverscriptBox["e", "_"]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "FullForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  StyleBox["p0",
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  SuperscriptBox["p", "0"], 
  OverscriptBox["e", "_"]]], "Input"],

Cell[BoxData[
 SubscriptBox[
  SuperscriptBox["p", "0"], 
  OverscriptBox["e", "_"]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "FullForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  StyleBox["p0",
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output"]
}, Open  ]]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{"UnformatSymbol", "[", "var_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"b", ",", "s1", ",", "s2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"b", "=", 
      RowBox[{"ToString", "[", 
       RowBox[{"FullForm", "[", 
        RowBox[{
         RowBox[{"MakeBoxes", "[", 
          RowBox[{"var", "//", "DisplayForm"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s1", "=", 
      RowBox[{
       RowBox[{"SymbolName", "[", "var", "]"}], "<>", "\"\</:MakeBoxes[\>\"", 
       "<>", 
       RowBox[{"SymbolName", "[", "var", "]"}], "<>", 
       "\"\<,StandardForm]=.\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", "s1", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"s2", "=", 
      RowBox[{"\"\<MakeExpression[\>\"", "<>", 
       StyleBox["b",
        ShowSpecialCharacters->False,
        ShowStringCharacters->True,
        NumberMarks->True], 
       StyleBox["<>",
        ShowSpecialCharacters->False,
        ShowStringCharacters->True,
        NumberMarks->True], "\"\<,StandardForm]=.\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", "s2", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{"s1", ",", "s2"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["Example:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FormatSymbol", "[", 
  RowBox[{
  "p0", ",", 
   "\"\<\!\(\*SubscriptBox[SuperscriptBox[\(p\), \(0\)], OverscriptBox[\(e\), \
\(_\)]]\)\>\""}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"p0/:MakeBoxes[p0,StandardForm]:=SubscriptBox[SuperscriptBox[\\\"p\\\
\", \\\"0\\\"], OverscriptBox[\\\"e\\\", \\\"_\\\"]]\"\>"},
    {"\<\"MakeExpression[SubscriptBox[SuperscriptBox[\\\"p\\\", \\\"0\\\"], \
OverscriptBox[\\\"e\\\", \\\"_\\\"]],StandardForm]:=HoldComplete[p0]\"\>"}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["p0"], "Input"],

Cell[BoxData[
 SubscriptBox[
  SuperscriptBox["p", "0"], 
  OverscriptBox["e", "_"]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "FullForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  StyleBox["p0",
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  SuperscriptBox["p", "0"], 
  OverscriptBox["e", "_"]]], "Input"],

Cell[BoxData[
 SubscriptBox[
  SuperscriptBox["p", "0"], 
  OverscriptBox["e", "_"]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "FullForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  StyleBox["p0",
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"UnformatSymbol", "[", "p0", "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"p0/:MakeBoxes[p0,StandardForm]=.\"\>"},
    {"\<\"MakeExpression[SubscriptBox[SuperscriptBox[\\\"p\\\", \\\"0\\\"], \
OverscriptBox[\\\"e\\\", \\\"_\\\"]],StandardForm]=.\"\>"}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["p0"], "Input"],

Cell[BoxData["p0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   SuperscriptBox["p", "0"], 
   OverscriptBox["e", "_"]], "//", "FullForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"Subscript", "[", 
    RowBox[{"1", ",", 
     RowBox[{"OverBar", "[", "e", "]"}]}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
OverscriptSymbol[ ] , VecSymbol[ ] , HatSymbol[ ] , BarSymbol[ ] \
\>", "Item"],

Cell["\<\
FormatSymbol[ ]  is a bit unreliable because we try to pull apart a string \
rep.  These are more reliable,\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OverscriptSymbol", "[", 
   RowBox[{"var_Symbol", ",", "under_String", ",", "over_String"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"b", ",", "s1", ",", "s2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"b", "=", 
      RowBox[{
      "\"\<OverscriptBox[\\\"\>\"", "<>", "under", "<>", "\"\<\\\",\\\"\>\"", 
       "<>", "over", "<>", "\"\<\\\"]\>\""}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"s1", "=", 
      RowBox[{
       RowBox[{"SymbolName", "[", "var", "]"}], "<>", "\"\</:MakeBoxes[\>\"", 
       "<>", 
       RowBox[{"SymbolName", "[", "var", "]"}], "<>", 
       "\"\<,StandardForm]:=\>\"", "<>", "b"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"ToExpression", "[", "s1", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"s2", "=", 
      RowBox[{"\"\<MakeExpression[\>\"", "<>", 
       StyleBox["b",
        ShowSpecialCharacters->False,
        ShowStringCharacters->True,
        NumberMarks->True], "<>", "\"\<,StandardForm]:=HoldComplete[\>\"", "<>", 
       RowBox[{"SymbolName", "[", "var", "]"}], "<>", "\"\<]\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", "s2", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{"b", ",", "s1", ",", "s2"}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["Example:", "Text"],

Cell[TextData[{
 "The arrow here is  \\[ RightArrow ]    ",
 Cell[BoxData[Cell[TextData[{
   "Alias: ",
   Cell["Esc", "KeyEvent"],
   StyleBox["\[ThinSpace]", "InlineCode"],
   StyleBox["\[SpaceIndicator]->", "InlineCode"],
   StyleBox["\[ThinSpace]", "InlineCode"],
   Cell["Esc", "KeyEvent"],
   "."
  }], "CharacterNotes"]], "CharacterImage"]
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"OverscriptSymbol", "[", 
  RowBox[{"Svec", ",", "\"\<S\>\"", ",", "\"\<\[RightArrow]\>\""}], 
  "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"OverscriptBox[\\\"S\\\",\\\"\[RightArrow]\\\"]\"\>"},
    {"\<\"Svec/:MakeBoxes[Svec,StandardForm]:=OverscriptBox[\\\"S\\\",\\\"\
\[RightArrow]\\\"]\"\>"},
    {"\<\"MakeExpression[OverscriptBox[\\\"S\\\",\\\"\[RightArrow]\\\"],\
StandardForm]:=HoldComplete[Svec]\"\>"}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["Svec"], "Input"],

Cell[BoxData[
 OverscriptBox["S", "\[RightArrow]"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  OverscriptBox["S", "\[RightArrow]"], "//", "FullForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  StyleBox["Svec",
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output"]
}, Open  ]],

Cell["The arrow is extendable,", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OverscriptSymbol", "[", 
   RowBox[{"Avec", ",", "\"\<OA\>\"", ",", "\"\<\[RightArrow]\>\""}], "]"}], 
  ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData["Avec"], "Input"],

Cell[BoxData[
 OverscriptBox["OA", "\[RightArrow]"]], "Output"]
}, Open  ]],

Cell["\<\
Clear[ ]  removes the formated output defn but not the interpreted input \
defn.  
Use UnformatSymbol[ ]\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"UnformatSymbol", "[", "Avec", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UnformatSymbol", "[", "Svec", "]"}], ";"}]}], "Input"]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{"VecSymbol", "[", 
   RowBox[{"var_Symbol", ",", "under_String"}], "]"}], ":=", 
  RowBox[{"OverscriptSymbol", "[", 
   RowBox[{"var", ",", "under", ",", "\"\<\[RightArrow]\>\""}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"HatSymbol", "[", 
   RowBox[{"var_Symbol", ",", "under_String"}], "]"}], ":=", 
  RowBox[{"OverscriptSymbol", "[", 
   RowBox[{"var", ",", "under", ",", "\"\<^\>\""}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"BarSymbol", "[", 
   RowBox[{"var_Symbol", ",", "under_String"}], "]"}], ":=", 
  RowBox[{"OverscriptSymbol", "[", 
   RowBox[{"var", ",", "under", ",", "\"\<_\>\""}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["Example:", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VecSymbol", "[", 
   RowBox[{"XYvec", ",", "\"\<XY\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HatSymbol", "[", 
   RowBox[{"XYhat", ",", "\"\<XY\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BarSymbol", "[", 
   RowBox[{"XYbar", ",", "\"\<XY\>\""}], "]"}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"XYvec", ",", "XYhat", ",", "XYbar"}], "}"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   OverscriptBox["XY", "\[RightArrow]"], ",", 
   OverscriptBox["XY", "^"], ",", 
   OverscriptBox["XY", "_"]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"UnformatSymbol", "[", "XYvec", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnformatSymbol", "[", "XYhat", "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnformatSymbol", "[", "XYbar", "]"}], ";"}], " "}]}], "Input"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Special characters:   ",
 Cell[BoxData[
  StyleBox[
   RowBox[{"{", 
    RowBox[{
     TagBox[
      RowBox[{
      "\[Lambda]", "\[NegativeThickSpace]", "\[NegativeVeryThinSpace]", 
       AdjustmentBox["\[HorizontalLine]\[HorizontalLine]",
        BoxBaselineShift->-0.93]}],
      "lambdabar"], ",", 
     TagBox[
      SubscriptBox[
       RowBox[{
       "\[Lambda]", "\[NegativeThickSpace]", "\[NegativeVeryThinSpace]", 
        AdjustmentBox["\[HorizontalLine]\[HorizontalLine]",
         BoxBaselineShift->-0.93]}], "0"],
      "lambdabar0"], ",", 
     TagBox[
      SubscriptBox[
       RowBox[{
       "\[Lambda]", "\[NegativeThickSpace]", "\[NegativeVeryThinSpace]", 
        AdjustmentBox["\[HorizontalLine]\[HorizontalLine]",
         BoxBaselineShift->-0.93]}], "e"],
      "lambdabare"], ",", 
     TagBox[
      SubscriptBox[
       RowBox[{
       "\[Lambda]", "\[NegativeThickSpace]", "\[NegativeVeryThinSpace]", 
        AdjustmentBox["\[HorizontalLine]\[HorizontalLine]",
         BoxBaselineShift->-0.93]}], "\[Mu]"],
      "lambdabar\[Mu]"], ",", 
     TagBox[
      SubscriptBox[
       RowBox[{
       "\[Lambda]", "\[NegativeThickSpace]", "\[NegativeVeryThinSpace]", 
        AdjustmentBox["\[HorizontalLine]\[HorizontalLine]",
         BoxBaselineShift->-0.93]}], "B"],
      "lambdabarB"]}], "}"}],
   FontSize->14,
   FontWeight->"Bold"]], "Output",
  FontSize->14],
 "    and   neg1space, ... neg4space,   horizontalline[ n ]"
}], "Subsubsection"],

Cell["\<\

Negative spaces, up to 4 are input as  [Esc] -    [Esc].  
Define these constants for use in code,\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"neg1space", "=", "\"\<\[NegativeVeryThinSpace]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"neg2space", "=", "\"\<\[NegativeThinSpace]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"neg3space", "=", "\"\<\[NegativeMediumSpace]\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"neg4space", "=", "\"\<\[NegativeThickSpace]\>\""}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell["Using this character:   \\[ HorizontalLine ]", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"horizontalline", "[", "n_", "]"}], ":=", 
  RowBox[{"StringRepeat", "[", 
   RowBox[{"\"\<\[HorizontalLine]\>\"", ",", "n"}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"horizontalline", "[", "1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"horizontalline", "[", "2", "]"}], "\[IndentingNewLine]", 
 RowBox[{"horizontalline", "[", "10", "]"}], "\[IndentingNewLine]", 
 RowBox[{"horizontalline", "[", "100", "]"}]}], "Input"],

Cell[BoxData["\<\"\[HorizontalLine]\"\>"], "Output"],

Cell[BoxData["\<\"\[HorizontalLine]\[HorizontalLine]\"\>"], "Output"],

Cell[BoxData["\<\"\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\"\>"], "Output"],

Cell[BoxData["\<\"\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\[HorizontalLine]\
\[HorizontalLine]\"\>"], "Output"]
}, Open  ]],

Cell["\<\
The tag is just something to look for instead of trying to match to the box \
contents, which are too messy. The tag is hidden in the output and gets \
cut-and-paste too.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]barTagBox", " ", "=", " ", 
   RowBox[{"TagBox", "[", 
    RowBox[{
     RowBox[{"RowBox", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<\[Lambda]\>\"", ",", "neg4space", ",", "neg1space", ",", 
        RowBox[{"AdjustmentBox", "[", 
         RowBox[{
          RowBox[{"horizontalline", "[", "2", "]"}], ",", 
          RowBox[{"BoxBaselineShift", "\[Rule]", 
           RowBox[{"-", "0.93"}]}]}], "]"}]}], "}"}], "]"}], ",", 
     "\"\<lambdabar\>\""}], "]"}]}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]bar0TagBox", " ", "=", " ", 
   RowBox[{"TagBox", "[", 
    RowBox[{
     RowBox[{"SubscriptBox", "[", 
      RowBox[{
       RowBox[{"RowBox", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<\[Lambda]\>\"", ",", "neg4space", ",", "neg1space", ",", 
          RowBox[{"AdjustmentBox", "[", 
           RowBox[{
            RowBox[{"horizontalline", "[", "2", "]"}], ",", 
            RowBox[{"BoxBaselineShift", "\[Rule]", 
             RowBox[{"-", "0.93"}]}]}], "]"}]}], "}"}], "]"}], ",", 
       "\"\<0\>\""}], "]"}], ",", "\"\<lambdabar0\>\""}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]bareTagBox", " ", "=", " ", 
   RowBox[{"TagBox", "[", 
    RowBox[{
     RowBox[{"SubscriptBox", "[", 
      RowBox[{
       RowBox[{"RowBox", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<\[Lambda]\>\"", ",", "neg4space", ",", "neg1space", ",", 
          RowBox[{"AdjustmentBox", "[", 
           RowBox[{
            RowBox[{"horizontalline", "[", "2", "]"}], ",", 
            RowBox[{"BoxBaselineShift", "\[Rule]", 
             RowBox[{"-", "0.93"}]}]}], "]"}]}], "}"}], "]"}], ",", 
       "\"\<e\>\""}], "]"}], ",", "\"\<lambdabare\>\""}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]bar\[Mu]TagBox", " ", "=", " ", 
   RowBox[{"TagBox", "[", 
    RowBox[{
     RowBox[{"SubscriptBox", "[", 
      RowBox[{
       RowBox[{"RowBox", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<\[Lambda]\>\"", ",", "neg4space", ",", "neg1space", ",", 
          RowBox[{"AdjustmentBox", "[", 
           RowBox[{
            RowBox[{"horizontalline", "[", "2", "]"}], ",", 
            RowBox[{"BoxBaselineShift", "\[Rule]", 
             RowBox[{"-", "0.93"}]}]}], "]"}]}], "}"}], "]"}], ",", 
       "\"\<\[Mu]\>\""}], "]"}], ",", "\"\<lambdabar\[Mu]\>\""}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Lambda]barBTagBox", " ", "=", " ", 
   RowBox[{"TagBox", "[", 
    RowBox[{
     RowBox[{"SubscriptBox", "[", 
      RowBox[{
       RowBox[{"RowBox", "[", 
        RowBox[{"{", 
         RowBox[{"\"\<\[Lambda]\>\"", ",", "neg4space", ",", "neg1space", ",", 
          RowBox[{"AdjustmentBox", "[", 
           RowBox[{
            RowBox[{"horizontalline", "[", "2", "]"}], ",", 
            RowBox[{"BoxBaselineShift", "\[Rule]", 
             RowBox[{"-", "0.93"}]}]}], "]"}]}], "}"}], "]"}], ",", 
       "\"\<B\>\""}], "]"}], ",", "\"\<lambdabarB\>\""}], "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Lambda]barTagBox", "//", "FullForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"TagBox", "[", 
    RowBox[{
     RowBox[{"RowBox", "[", 
      RowBox[{"List", "[", 
       RowBox[{
       "\"\<\\[Lambda]\>\"", ",", "\"\<\\[NegativeThickSpace]\>\"", ",", 
        "\"\<\\[NegativeVeryThinSpace]\>\"", ",", 
        RowBox[{"AdjustmentBox", "[", 
         RowBox[{"\"\<\\[HorizontalLine]\\[HorizontalLine]\>\"", ",", 
          RowBox[{"Rule", "[", 
           RowBox[{"BoxBaselineShift", ",", 
            RowBox[{"-", "0.93`"}]}], "]"}]}], "]"}]}], "]"}], "]"}], ",", 
     "\"\<lambdabar\>\""}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output"]
}, Open  ]],

Cell["This looks better with  TeXit  notebook style, ", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[Lambda]barTagBox", "//", "DisplayForm"}], "\[IndentingNewLine]", 
 RowBox[{"\[Lambda]bar0TagBox", "//", 
  "DisplayForm"}], "\[IndentingNewLine]", 
 RowBox[{"\[Lambda]bareTagBox", "//", 
  "DisplayForm"}], "\[IndentingNewLine]", 
 RowBox[{"\[Lambda]bar\[Mu]TagBox", "//", 
  "DisplayForm"}], "\[IndentingNewLine]", 
 RowBox[{"\[Lambda]barBTagBox", "//", "DisplayForm"}]}], "Input"],

Cell[BoxData[
 TagBox[
  TagBox[
   RowBox[{"\[Lambda]", "\[NegativeThickSpace]", "\[NegativeVeryThinSpace]", 
    AdjustmentBox["\[HorizontalLine]\[HorizontalLine]",
     BoxBaselineShift->-0.93]}],
   "lambdabar"],
  DisplayForm]], "Output"],

Cell[BoxData[
 TagBox[
  TagBox[
   SubscriptBox[
    RowBox[{
    "\[Lambda]", "\[NegativeThickSpace]", "\[NegativeVeryThinSpace]", 
     AdjustmentBox["\[HorizontalLine]\[HorizontalLine]",
      BoxBaselineShift->-0.93]}], "0"],
   "lambdabar0"],
  DisplayForm]], "Output"],

Cell[BoxData[
 TagBox[
  TagBox[
   SubscriptBox[
    RowBox[{
    "\[Lambda]", "\[NegativeThickSpace]", "\[NegativeVeryThinSpace]", 
     AdjustmentBox["\[HorizontalLine]\[HorizontalLine]",
      BoxBaselineShift->-0.93]}], "e"],
   "lambdabare"],
  DisplayForm]], "Output"],

Cell[BoxData[
 TagBox[
  TagBox[
   SubscriptBox[
    RowBox[{
    "\[Lambda]", "\[NegativeThickSpace]", "\[NegativeVeryThinSpace]", 
     AdjustmentBox["\[HorizontalLine]\[HorizontalLine]",
      BoxBaselineShift->-0.93]}], "\[Mu]"],
   "lambdabar\[Mu]"],
  DisplayForm]], "Output"],

Cell[BoxData[
 TagBox[
  TagBox[
   SubscriptBox[
    RowBox[{
    "\[Lambda]", "\[NegativeThickSpace]", "\[NegativeVeryThinSpace]", 
     AdjustmentBox["\[HorizontalLine]\[HorizontalLine]",
      BoxBaselineShift->-0.93]}], "B"],
   "lambdabarB"],
  DisplayForm]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[Lambda]bar", "/:", 
  RowBox[{"MakeBoxes", "[", 
   RowBox[{"\[Lambda]bar", ",", "StandardForm"}], "]"}], ":=", 
  "\[Lambda]barTagBox"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"\[Lambda]bar0", "/:", 
  RowBox[{"MakeBoxes", "[", 
   RowBox[{"\[Lambda]bar0", ",", "StandardForm"}], "]"}], ":=", 
  "\[Lambda]bar0TagBox"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"\[Lambda]bare", "/:", 
  RowBox[{"MakeBoxes", "[", 
   RowBox[{"\[Lambda]bare", ",", "StandardForm"}], "]"}], ":=", 
  "\[Lambda]bareTagBox"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"\[Lambda]bar\[Mu]", "/:", 
  RowBox[{"MakeBoxes", "[", 
   RowBox[{"\[Lambda]bar\[Mu]", ",", "StandardForm"}], "]"}], ":=", 
  "\[Lambda]bar\[Mu]TagBox"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"\[Lambda]barB", "/:", 
  RowBox[{"MakeBoxes", "[", 
   RowBox[{"\[Lambda]barB", ",", "StandardForm"}], "]"}], ":=", 
  "\[Lambda]barBTagBox"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeExpression", "[", 
   RowBox[{"\[Lambda]barTagBox", ",", "StandardForm"}], "]"}], ":=", 
  RowBox[{"HoldComplete", "[", "\[Lambda]bar", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeExpression", "[", 
   RowBox[{"\[Lambda]bar0TagBox", ",", "StandardForm"}], "]"}], ":=", 
  RowBox[{"HoldComplete", "[", "\[Lambda]bar0", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeExpression", "[", 
   RowBox[{"\[Lambda]bareTagBox", ",", "StandardForm"}], "]"}], ":=", 
  RowBox[{"HoldComplete", "[", "\[Lambda]bare", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeExpression", "[", 
   RowBox[{"\[Lambda]bar\[Mu]TagBox", ",", "StandardForm"}], "]"}], ":=", 
  RowBox[{"HoldComplete", "[", "\[Lambda]bar\[Mu]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeExpression", "[", 
   RowBox[{"\[Lambda]barBTagBox", ",", "StandardForm"}], "]"}], ":=", 
  RowBox[{"HoldComplete", "[", "\[Lambda]barB", "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "\[Lambda]bar", ",", "\[Lambda]bar0", ",", "\[Lambda]bare", ",", 
   "\[Lambda]bar\[Mu]", ",", "\[Lambda]barB"}], "}"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{
    "\[Lambda]", "\[NegativeThickSpace]", "\[NegativeVeryThinSpace]", 
     AdjustmentBox["\[HorizontalLine]\[HorizontalLine]",
      BoxBaselineShift->-0.93]}],
    "lambdabar"], ",", 
   TagBox[
    SubscriptBox[
     RowBox[{"\[Lambda]", "\[NegativeThickSpace]", "\[NegativeVeryThinSpace]", 
      AdjustmentBox["\[HorizontalLine]\[HorizontalLine]",
       BoxBaselineShift->-0.93]}], "0"],
    "lambdabar0"], ",", 
   TagBox[
    SubscriptBox[
     RowBox[{"\[Lambda]", "\[NegativeThickSpace]", "\[NegativeVeryThinSpace]", 
      AdjustmentBox["\[HorizontalLine]\[HorizontalLine]",
       BoxBaselineShift->-0.93]}], "e"],
    "lambdabare"], ",", 
   TagBox[
    SubscriptBox[
     RowBox[{"\[Lambda]", "\[NegativeThickSpace]", "\[NegativeVeryThinSpace]", 
      AdjustmentBox["\[HorizontalLine]\[HorizontalLine]",
       BoxBaselineShift->-0.93]}], "\[Mu]"],
    "lambdabar\[Mu]"], ",", 
   TagBox[
    SubscriptBox[
     RowBox[{"\[Lambda]", "\[NegativeThickSpace]", "\[NegativeVeryThinSpace]", 
      AdjustmentBox["\[HorizontalLine]\[HorizontalLine]",
       BoxBaselineShift->-0.93]}], "B"],
    "lambdabarB"]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "FullForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"List", "[", 
    RowBox[{
    "\\[Lambda]bar", ",", "\\[Lambda]bar0", ",", "\\[Lambda]bare", ",", 
     "\\[Lambda]bar\\[Mu]", ",", "\\[Lambda]barB"}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output"]
}, Open  ]],

Cell["Cut-and-paste the above output,", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{"\[Lambda]", "\[NegativeThickSpace]", "\[NegativeVeryThinSpace]", 
   AdjustmentBox["\[HorizontalLine]\[HorizontalLine]",
    BoxBaselineShift->-0.93]}],
  "lambdabar"]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"\[Lambda]", "\[NegativeThickSpace]", "\[NegativeVeryThinSpace]", 
   AdjustmentBox["\[HorizontalLine]\[HorizontalLine]",
    BoxBaselineShift->-0.93]}],
  "lambdabar"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "FullForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  StyleBox["\\[Lambda]bar",
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "-", "\[Lambda]bar"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Argument checking", "Subsection",
 CellChangeTimes->{{3.467119314622471*^9, 3.467119352821146*^9}, {
   3.476693637814482*^9, 3.476693639510118*^9}, {3.478635035907522*^9, 
   3.478635074317131*^9}, 3.478677199671947*^9, {3.479720032782098*^9, 
   3.479720041791068*^9}, {3.479721708422789*^9, 3.479721712614642*^9}, {
   3.479971484831145*^9, 3.479971517573741*^9}, {3.5180845184489603`*^9, 
   3.518084549635188*^9}, {3.611388806219406*^9, 3.611388810714518*^9}, {
   3.611389088027945*^9, 3.611389089307828*^9}, {3.615279961199183*^9, 
   3.6152799665115232`*^9}, {3.61688415560168*^9, 3.616884160593556*^9}, {
   3.649905168900571*^9, 3.649905174085545*^9}}],

Cell["\<\
This should be done from within the  Rules  package,  with groups of tagged \
rules that can be turned on/off. 
Also, the ordering of the rules should be preservable.\
\>", "Text",
 CellChangeTimes->{{3.6499053719853973`*^9, 3.649905460192801*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$ArgumentCheckingRuleNumbers", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DoArgumentChecking", "[", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"ResetRule", "[", "$ArgumentCheckingRuleNumbers", "]"}], ";"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NoArgumentChecking", "[", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"UnsetRule", "[", "$ArgumentCheckingRuleNumbers", "]"}], ";"}], 
   ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649902119603038*^9, 3.6499022772161293`*^9}, {
   3.6499023100160503`*^9, 3.649902367426516*^9}, {3.649902494510832*^9, 
   3.649902515133629*^9}, 3.6499025665261393`*^9, 3.6499026024604*^9, {
   3.649905505668977*^9, 3.649905520706761*^9}, {3.6500907523231*^9, 
   3.650090764027759*^9}}],

Cell["\<\
Wrap   ArgumentCheck[  ]   around any  AddRule[ ]  that is an argument check. \
 The  AddRule[ ]  will take effect as usual,  but its rule number will be 
added to the  list   $ArgumentCheckingRuleNumbers,\
\>", "Text",
 CellChangeTimes->{{3.649904571533723*^9, 3.649904603469805*^9}, {
   3.649905239715222*^9, 3.649905346626148*^9}, 3.650076736224306*^9, {
   3.651602582663095*^9, 3.651602595934453*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ArgumentCheck", "[", 
   RowBox[{"x_", "/;", 
    RowBox[{
     RowBox[{"Head", "[", "x", "]"}], "===", 
     RowBox[{"Defer", "[", "rule", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "n", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"First", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MemberQ", "[", 
         RowBox[{"$ArgumentCheckingRuleNumbers", ",", "n"}], "]"}]}], ",", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"$ArgumentCheckingRuleNumbers", ",", "n"}], "]"}]}], "]"}], 
     ";", "x"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649904291405349*^9, 3.64990441098033*^9}, {
  3.649904481763376*^9, 3.649904549523634*^9}, {3.649904669120872*^9, 
  3.649904673104989*^9}, {3.649904734976*^9, 3.649904737072092*^9}, {
  3.649904783135211*^9, 3.649904793329447*^9}, {3.6499054917664013`*^9, 
  3.649905528470708*^9}}],

Cell["\<\
If argument checking, then the rules for doing so should come early. \
Otherwise,  if there is a problem you might just get system messages from \
other code
that gets confused because of stupid user input.....   but if they are  \
UnsetRule / ResetRule  then they will be checked last. \
\>", "Text",
 CellChangeTimes->{{3.615496077474202*^9, 3.615496084802752*^9}, {
   3.616041191172474*^9, 3.61604133736539*^9}, 3.649902729352339*^9, {
   3.6499028582138653`*^9, 3.649902941925396*^9}}],

Cell["\<\
To allow the deferred output from AddRule to be used instead of just integer \
arguments,\
\>", "Text",
 CellChangeTimes->{{3.6507476133141117`*^9, 3.6507476550575943`*^9}, {
  3.6516024747200937`*^9, 3.6516024958721848`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"UnsetRule", "[", 
   RowBox[{
    RowBox[{"Defer", "[", "rule", "]"}], "[", "n_", "]"}], "]"}], ":=", 
  RowBox[{"UnsetRule", "[", "n", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6507474895105963`*^9, 3.650747545765481*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResetRule", "[", 
   RowBox[{
    RowBox[{"Defer", "[", "rule", "]"}], "[", "n_", "]"}], "]"}], ":=", 
  RowBox[{"ResetRule", "[", "n", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650747663236601*^9, 3.650747669747411*^9}}],

Cell["\<\
AddRule bug:   Should be able to write    AddRule[  rev[ ] :=  Sequence[ ] ]  \
                          but AddRule gets confused and then  rev[ ]  returns \
 Null.
                          This works though,            AddRule[  rev[ ] :=   \
Apply[ Sequence, { } ]  ]

.... this probably happens for any rule of the form     lhs :=  Sequence[ ... \
]    so needs to be fixed.                              \
\>", "Text",
 CellChangeTimes->{{3.650843645389947*^9, 3.6508437171162243`*^9}, {
  3.650843747356008*^9, 3.65084375756434*^9}, {3.6508437956752167`*^9, 
  3.6508438194628572`*^9}, {3.650843853114419*^9, 3.6508439645534153`*^9}, {
  3.650844102854927*^9, 3.6508441717496977`*^9}, {3.6516025372152367`*^9, 
  3.651602537727292*^9}, {3.655319948226489*^9, 3.655319949298319*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Manifold[  ],  ProductSpace[  ],  Tangent[  ],  Cotangent[  ],  Forms[  ],  \
TotalSpace[  ],  FieldType[  ]  \
\>", "Subsection",
 CellChangeTimes->{{3.652926278946062*^9, 3.6529263036029778`*^9}, {
   3.653785522458815*^9, 3.6537855438988333`*^9}, 3.653860693129974*^9, {
   3.653899471421506*^9, 3.6538995162690563`*^9}, {3.653899547836565*^9, 
   3.65389955337256*^9}, {3.653942208312146*^9, 3.6539422942469273`*^9}, {
   3.6539686431533003`*^9, 3.653968647142254*^9}, 3.6539686937607*^9, {
   3.6554038853960133`*^9, 3.6554039331552467`*^9}, {3.6554042308798923`*^9, 
   3.6554042405750837`*^9}, {3.655408879941023*^9, 3.655408886564822*^9}, {
   3.655670188999312*^9, 3.6556701989675198`*^9}}],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
--------------
Manifold[ X ]    needs to be defined for expressions (?), using SlotType[ ]  \
to get the type of the free slots of X.  And to be useful, it needs to do \
things like figure out 
that some expressions X are only defined on immersions, submanifolds, etc. 

This is one of the problems with it,\
\>", "Text",
 CellFrame->{{0, 0}, {0, 0.5}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"F", "=", 
  RowBox[{"Fext", "[", "5", "]"}]}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"Fext0", "+", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Fext1", ",", "n"}], "\[RightAngleBracket]"}], " ", "r"}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"Fext2", ",", "n"}], "\[RightAngleBracket]"}], ",", "n"}], 
     "\[RightAngleBracket]"}], " ", 
    SuperscriptBox["r", "2"]}], "+", 
   RowBox[{
    FractionBox["1", "6"], " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
        RowBox[{"\[LeftAngleBracket]", 
         RowBox[{"Fext3", ",", "n"}], "\[RightAngleBracket]"}], ",", "n"}], 
       "\[RightAngleBracket]"}], ",", "n"}], "\[RightAngleBracket]"}], " ", 
    SuperscriptBox["r", "3"]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
        RowBox[{"\[LeftAngleBracket]", 
         RowBox[{
          RowBox[{"\[LeftAngleBracket]", 
           RowBox[{"Fext4", ",", "n"}], "\[RightAngleBracket]"}], ",", "n"}], 
         "\[RightAngleBracket]"}], ",", "n"}], "\[RightAngleBracket]"}], ",", 
      "n"}], "\[RightAngleBracket]"}], " ", 
    SuperscriptBox["r", "4"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "r", "]"}], "5"],
    SeriesData[$CellContext`r, 0, {}, 0, 5, 1],
    Editable->False]}],
  SeriesData[$CellContext`r, 0, {$CellContext`Fext0, 
    AngleBracket[$CellContext`Fext1, $CellContext`n], Rational[1, 2] 
    AngleBracket[
      AngleBracket[$CellContext`Fext2, $CellContext`n], $CellContext`n], 
    Rational[1, 6] AngleBracket[
      AngleBracket[
       AngleBracket[$CellContext`Fext3, $CellContext`n], $CellContext`n], \
$CellContext`n], Rational[1, 24] AngleBracket[
      AngleBracket[
       AngleBracket[
        AngleBracket[$CellContext`Fext4, $CellContext`n], $CellContext`n], \
$CellContext`n], $CellContext`n]}, 0, 5, 1],
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Del]", "F"}]], "Input",
 CellChangeTimes->{{3.613681736942595*^9, 3.613681739376319*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Fext1", ",", "\[Eta]"}], "\[RightAngleBracket]"}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
        RowBox[{"\[LeftAngleBracket]", 
         RowBox[{"Fext2", ",", "n"}], "\[RightAngleBracket]"}], ",", 
        RowBox[{"Metric", "[", 
         RowBox[{"Manifold", "[", 
          RowBox[{"\[LeftAngleBracket]", 
           RowBox[{"Fext2", ",", "n"}], "\[RightAngleBracket]"}], "]"}], 
         "]"}]}], "\[RightAngleBracket]"}], "+", 
      SubscriptBox[
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{
         RowBox[{"\[LeftAngleBracket]", 
          RowBox[{"Fext2", ",", "\[Eta]"}], "\[RightAngleBracket]"}], 
         "\[CircleTimes]", "n"}], "\[RightAngleBracket]"}], 
       RowBox[{"{", 
        RowBox[{"3", ",", "5"}], "}"}]]}], ")"}], " ", "r"}], "+", 
   RowBox[{
    FractionBox["1", "6"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
        RowBox[{"\[LeftAngleBracket]", 
         RowBox[{
          RowBox[{"\[LeftAngleBracket]", 
           RowBox[{"Fext3", ",", "n"}], "\[RightAngleBracket]"}], ",", "n"}], 
         "\[RightAngleBracket]"}], ",", 
        RowBox[{"Metric", "[", 
         RowBox[{"Manifold", "[", 
          RowBox[{"\[LeftAngleBracket]", 
           RowBox[{
            RowBox[{"\[LeftAngleBracket]", 
             RowBox[{"Fext3", ",", "n"}], "\[RightAngleBracket]"}], ",", 
            "n"}], "\[RightAngleBracket]"}], "]"}], "]"}]}], 
       "\[RightAngleBracket]"}], "+", 
      SubscriptBox[
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{
         RowBox[{"\[LeftAngleBracket]", 
          RowBox[{
           RowBox[{"\[LeftAngleBracket]", 
            RowBox[{"Fext3", ",", "n"}], "\[RightAngleBracket]"}], ",", 
           RowBox[{"Metric", "[", 
            RowBox[{"Manifold", "[", 
             RowBox[{"\[LeftAngleBracket]", 
              RowBox[{"Fext3", ",", "n"}], "\[RightAngleBracket]"}], "]"}], 
            "]"}]}], "\[RightAngleBracket]"}], "\[CircleTimes]", "n"}], 
        "\[RightAngleBracket]"}], 
       RowBox[{"{", 
        RowBox[{"3", ",", "5"}], "}"}]], "+", 
      SubscriptBox[
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{
         RowBox[{"\[LeftAngleBracket]", 
          RowBox[{"Fext3", ",", "\[Eta]"}], "\[RightAngleBracket]"}], 
         "\[CircleTimes]", "n", "\[CircleTimes]", "n"}], 
        "\[RightAngleBracket]"}], 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "7"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "6"}], "}"}]}]]}], ")"}], " ", 
    SuperscriptBox["r", "2"]}], "+", 
   RowBox[{
    FractionBox["1", "24"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
        RowBox[{"\[LeftAngleBracket]", 
         RowBox[{
          RowBox[{"\[LeftAngleBracket]", 
           RowBox[{
            RowBox[{"\[LeftAngleBracket]", 
             RowBox[{"Fext4", ",", "n"}], "\[RightAngleBracket]"}], ",", 
            "n"}], "\[RightAngleBracket]"}], ",", "n"}], 
         "\[RightAngleBracket]"}], ",", 
        RowBox[{"Metric", "[", 
         RowBox[{"Manifold", "[", 
          RowBox[{"\[LeftAngleBracket]", 
           RowBox[{
            RowBox[{"\[LeftAngleBracket]", 
             RowBox[{
              RowBox[{"\[LeftAngleBracket]", 
               RowBox[{"Fext4", ",", "n"}], "\[RightAngleBracket]"}], ",", 
              "n"}], "\[RightAngleBracket]"}], ",", "n"}], 
           "\[RightAngleBracket]"}], "]"}], "]"}]}], "\[RightAngleBracket]"}],
       "+", 
      SubscriptBox[
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{
         RowBox[{"\[LeftAngleBracket]", 
          RowBox[{
           RowBox[{"\[LeftAngleBracket]", 
            RowBox[{
             RowBox[{"\[LeftAngleBracket]", 
              RowBox[{"Fext4", ",", "n"}], "\[RightAngleBracket]"}], ",", 
             "n"}], "\[RightAngleBracket]"}], ",", 
           RowBox[{"Metric", "[", 
            RowBox[{"Manifold", "[", 
             RowBox[{"\[LeftAngleBracket]", 
              RowBox[{
               RowBox[{"\[LeftAngleBracket]", 
                RowBox[{"Fext4", ",", "n"}], "\[RightAngleBracket]"}], ",", 
               "n"}], "\[RightAngleBracket]"}], "]"}], "]"}]}], 
          "\[RightAngleBracket]"}], "\[CircleTimes]", "n"}], 
        "\[RightAngleBracket]"}], 
       RowBox[{"{", 
        RowBox[{"3", ",", "5"}], "}"}]], "+", 
      SubscriptBox[
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{
         RowBox[{"\[LeftAngleBracket]", 
          RowBox[{
           RowBox[{"\[LeftAngleBracket]", 
            RowBox[{"Fext4", ",", "n"}], "\[RightAngleBracket]"}], ",", 
           RowBox[{"Metric", "[", 
            RowBox[{"Manifold", "[", 
             RowBox[{"\[LeftAngleBracket]", 
              RowBox[{"Fext4", ",", "n"}], "\[RightAngleBracket]"}], "]"}], 
            "]"}]}], "\[RightAngleBracket]"}], "\[CircleTimes]", "n", 
         "\[CircleTimes]", "n"}], "\[RightAngleBracket]"}], 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "7"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "6"}], "}"}]}]], "+", 
      SubscriptBox[
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{
         RowBox[{"\[LeftAngleBracket]", 
          RowBox[{"Fext4", ",", "\[Eta]"}], "\[RightAngleBracket]"}], 
         "\[CircleTimes]", "n", "\[CircleTimes]", "n", "\[CircleTimes]", 
         "n"}], "\[RightAngleBracket]"}], 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "9"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "8"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", "7"}], "}"}]}]]}], ")"}], " ", 
    SuperscriptBox["r", "3"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "r", "]"}], "4"],
    SeriesData[$CellContext`r, 0, {}, 0, 4, 1],
    Editable->False]}],
  SeriesData[$CellContext`r, 0, {
    AngleBracket[$CellContext`Fext1, $CellContext`\[Eta]], 
    Rational[1, 2] (AngleBracket[
       AngleBracket[$CellContext`Fext2, $CellContext`n], 
       $CellContext`Metric[
        $CellContext`Manifold[
         AngleBracket[$CellContext`Fext2, $CellContext`n]]]] + Subscript[
       AngleBracket[
        CircleTimes[
         AngleBracket[$CellContext`Fext2, $CellContext`\[Eta]], \
$CellContext`n]], {3, 5}]), Rational[1, 6] (AngleBracket[
       AngleBracket[
        AngleBracket[$CellContext`Fext3, $CellContext`n], $CellContext`n], 
       $CellContext`Metric[
        $CellContext`Manifold[
         AngleBracket[
          
          AngleBracket[$CellContext`Fext3, $CellContext`n], \
$CellContext`n]]]] + Subscript[
       AngleBracket[
        CircleTimes[
         AngleBracket[
          AngleBracket[$CellContext`Fext3, $CellContext`n], 
          $CellContext`Metric[
           $CellContext`Manifold[
            
            AngleBracket[$CellContext`Fext3, $CellContext`n]]]], \
$CellContext`n]], {3, 5}] + Subscript[
       AngleBracket[
        CircleTimes[
         AngleBracket[$CellContext`Fext3, $CellContext`\[Eta]], \
$CellContext`n, $CellContext`n]], {3, 7}, {4, 6}]), 
    Rational[1, 24] (AngleBracket[
       AngleBracket[
        AngleBracket[
         AngleBracket[$CellContext`Fext4, $CellContext`n], $CellContext`n], \
$CellContext`n], 
       $CellContext`Metric[
        $CellContext`Manifold[
         AngleBracket[
          AngleBracket[
           
           AngleBracket[$CellContext`Fext4, $CellContext`n], $CellContext`n], \
$CellContext`n]]]] + Subscript[
       AngleBracket[
        CircleTimes[
         AngleBracket[
          AngleBracket[
           
           AngleBracket[$CellContext`Fext4, $CellContext`n], $CellContext`n], \

          $CellContext`Metric[
           $CellContext`Manifold[
            AngleBracket[
             
             AngleBracket[$CellContext`Fext4, $CellContext`n], \
$CellContext`n]]]], $CellContext`n]], {3, 5}] + Subscript[
       AngleBracket[
        CircleTimes[
         AngleBracket[
          AngleBracket[$CellContext`Fext4, $CellContext`n], 
          $CellContext`Metric[
           $CellContext`Manifold[
            
            AngleBracket[$CellContext`Fext4, $CellContext`n]]]], \
$CellContext`n, $CellContext`n]], {3, 7}, {4, 6}] + Subscript[
       AngleBracket[
        CircleTimes[
         AngleBracket[$CellContext`Fext4, $CellContext`\[Eta]], \
$CellContext`n, $CellContext`n, $CellContext`n]], {3, 9}, {4, 8}, {5, 7}])}, 
   0, 4, 1],
  Editable->False]], "Output"]
}, Open  ]],

Cell["\<\
.... the metric compatible \[LeftAngleBracket]  \[RightAngleBracket]  can\
\[CloseCurlyQuote]t handle an assigned value for  \[Del]n  when  F is \
vector-type.

For this reason,  Manifold[ X ]  has for the moment been disabled  (since \
everything I\[CloseCurlyQuote]m doing is more-or-less on one manifold),\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Manifold", "[", "_", "]"}], ":=", 
  RowBox[{"Manifold", "[", "]"}]}]], "Input",
 InitializationCell->True],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
------------\
\>", "Text"],

Cell["\<\
Manifold[ ]   (no arg)  returns the default, last defined manifold.
Manifold[X]    returns the base manifold for the tensor bundle of which X is \
a section.\
\>", "Text",
 CellChangeTimes->{{3.655607717615102*^9, 3.655607807165946*^9}, 
   3.655669696733876*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Manifold", "[", 
   RowBox[{"X_", "?", "FieldQ"}], "]"}], ":=", 
  RowBox[{"First", "[", 
   RowBox[{"FieldType", "[", "X", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655607814227941*^9, 3.655607853373302*^9}, {
   3.655669732973228*^9, 3.655669733805296*^9}, 3.655669774796702*^9, {
   3.655676103550552*^9, 3.655676108286371*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Manifold", "[", 
   RowBox[{"\[Del]", "X_"}], "]"}], ":=", 
  RowBox[{"Manifold", "[", "X", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Manifold", "[", 
   RowBox[{"\[GothicCapitalD]", "[", "X_", "]"}], "]"}], ":=", 
  RowBox[{"Manifold", "[", "X", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Manifold", "[", 
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"X_", ",", "_"}], "]"}], "]"}], ":=", 
  RowBox[{"Manifold", "[", "X", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655607814227941*^9, 3.655607853373302*^9}, {
   3.655669732973228*^9, 3.655669733805296*^9}, 3.655669774796702*^9, {
   3.655676103550552*^9, 3.6556761407341213`*^9}, {3.655676175373559*^9, 
   3.6556762213250837`*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "NewManifold", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Manifold", "[", "]"}], ":=", "\"\<M\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ListOfManifolds", "=", 
   RowBox[{"{", "\"\<M\>\"", "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655607198085739*^9, 3.655607211131386*^9}, {
  3.655607356483739*^9, 3.6556073630966177`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewManifold", "[", 
   RowBox[{"M_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"$ListOfManifolds", ",", "M"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$ListOfManifolds", "=", 
      RowBox[{"DeleteDuplicates", "[", "$ListOfManifolds", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Manifold", "[", "]"}], ":=", "M"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dim", "[", "M", "]"}], "=", "n"}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655596867246707*^9, 3.655596874859291*^9}, {
   3.655602836221871*^9, 3.6556029012770443`*^9}, 3.655602932076405*^9, {
   3.655606916854908*^9, 3.655606923385248*^9}, 3.655607281825766*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewManifold", "[", 
   RowBox[{"M_", ",", "g_", ",", 
    RowBox[{"{", "sigs__Integer", "}"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"$ListOfManifolds", ",", "M"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$ListOfManifolds", "=", 
      RowBox[{"DeleteDuplicates", "[", "$ListOfManifolds", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Manifold", "[", "]"}], ":=", "M"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ClearMetric", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NewMetric", "[", 
      RowBox[{"g", ",", 
       RowBox[{"{", "sigs", "}"}]}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.65560603509273*^9, 3.655606055463375*^9}, {
   3.655606746608426*^9, 3.655606757963213*^9}, {3.655606884570031*^9, 
   3.65560688477743*^9}, {3.655607097687209*^9, 3.655607103479232*^9}, {
   3.6556072582610073`*^9, 3.655607276388753*^9}, 3.655607340259952*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewManifold", "[", 
   RowBox[{"M_", ",", 
    RowBox[{"{", 
     RowBox[{"g_", ",", "ginv_"}], "}"}], ",", 
    RowBox[{"{", "sigs__Integer", "}"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"$ListOfManifolds", ",", "M"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$ListOfManifolds", "=", 
      RowBox[{"DeleteDuplicates", "[", "$ListOfManifolds", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Manifold", "[", "]"}], ":=", "M"}], ";", "\[IndentingNewLine]", 
     RowBox[{"ClearMetric", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NewMetric", "[", 
      RowBox[{"M", ",", 
       RowBox[{"{", 
        RowBox[{"g", ",", "ginv"}], "}"}], ",", 
       RowBox[{"{", "sigs", "}"}]}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655596537075358*^9, 3.655596650958007*^9}, {
   3.655596687949666*^9, 3.655596860107581*^9}, {3.6555970497854853`*^9, 
   3.6555970855293427`*^9}, {3.655602941772498*^9, 3.6556029651963243`*^9}, {
   3.655603017707508*^9, 3.6556030202035522`*^9}, {3.655603082986826*^9, 
   3.6556031463778763`*^9}, {3.655604295291201*^9, 3.655604301562997*^9}, 
   3.6556044446810293`*^9, {3.6556045910151653`*^9, 3.655604595447249*^9}, {
   3.655604868659775*^9, 3.655604884163568*^9}, {3.655604918930859*^9, 
   3.6556049784342737`*^9}, {3.655605928597968*^9, 3.6556059478136053`*^9}, {
   3.655605986533204*^9, 3.655605987627006*^9}, {3.655607108150886*^9, 
   3.655607114438843*^9}, 3.655607285016137*^9, 3.655607343379908*^9}],

Cell["\<\
ProductSpace[ ]   returns nice looking output corresponding to the given \
product specification. 
Each  Vn  is a pair  { V, n }  where  V  is a vector space or vector bundle \
specifier, and  n  is the tensor product  power,\
\>", "Text",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.655397392295135*^9, 3.6553974691105003`*^9}, {
  3.65539781724999*^9, 3.655397915440765*^9}, {3.65539899721945*^9, 
  3.655399082498105*^9}, {3.655401748712747*^9, 3.655401765390891*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProductSpace", "[", 
   RowBox[{"{", 
    RowBox[{"Vn__", "?", "PairQ"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"CircleTimes", "[", 
   RowBox[{"Apply", "[", 
    RowBox[{"Sequence", ",", " ", 
     RowBox[{"Map", "[", 
      RowBox[{"ProductSpace", ",", " ", 
       RowBox[{"{", "Vn", "}"}]}], "]"}]}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6553972718770227`*^9, 3.6553973304877567`*^9}, {
  3.655397479653881*^9, 3.655397547189012*^9}, {3.655397620148217*^9, 
  3.6553976586118193`*^9}, {3.655397724435113*^9, 3.655397733586973*^9}, {
  3.655397799001878*^9, 3.655397813361752*^9}, {3.6553978495374403`*^9, 
  3.655397850785357*^9}, {3.655397935520401*^9, 3.655397941360382*^9}, {
  3.655398009743504*^9, 3.655398128222068*^9}, {3.655399091938143*^9, 
  3.655399094674179*^9}, {3.655399149969301*^9, 3.65539916672103*^9}, {
  3.655399939990924*^9, 3.655399942890768*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ProductSpace", "[", 
   RowBox[{"{", 
    RowBox[{"V_", ",", "1"}], "}"}], "]"}], ":=", 
  "V"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProductSpace", "[", 
   RowBox[{"{", 
    RowBox[{"V_", ",", "n_"}], "}"}], "]"}], ":=", 
  SuperscriptBox["V", 
   RowBox[{"\"\<\[VeryThinSpace]\[CircleTimes]\>\"", "<>", 
    RowBox[{"ToString", "[", "n", "]"}]}]]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655398191293291*^9, 3.655398229804797*^9}, {
  3.6553984102186527`*^9, 3.655398410602644*^9}, {3.6553984936843224`*^9, 
  3.655398495337555*^9}, {3.6553992379521923`*^9, 3.655399243447888*^9}, {
  3.655399323087142*^9, 3.655399331862218*^9}, {3.655406061512341*^9, 
  3.655406072952074*^9}, {3.6554061140879383`*^9, 3.6554061343591957`*^9}, {
  3.655407883953705*^9, 3.655407894209236*^9}, {3.655408430810686*^9, 
  3.655408449514312*^9}, {3.655408487706007*^9, 3.6554085133535624`*^9}}],

Cell[CellGroupData[{

Cell["Examples", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.655398561656719*^9, 3.655398564760639*^9}, {
   3.6553994015819483`*^9, 3.655399401774057*^9}, 3.655404064337986*^9}],

Cell[BoxData[{
 RowBox[{"ProductSpace", "[", 
  RowBox[{"{", 
   RowBox[{
    SubscriptBox["V", "1"], ",", "n1"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProductSpace", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["V", "1"], ",", "n1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["V", "2"], ",", "n2"}], "}"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProductSpace", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["V", "1"], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["V", "2"], ",", "1"}], "}"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProductSpace", "[", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"V", ",", "0"}], "}"}], "}"}], "]"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.655399390840404*^9, 3.655399392270125*^9}, {
   3.655399967223052*^9, 3.65539999160639*^9}, 3.655404064338112*^9, {
   3.655406317284778*^9, 3.655406336564846*^9}, {3.655407863937758*^9, 
   3.655407876689835*^9}}],

Cell[BoxData[
 SubsuperscriptBox["V", 
  "1", "\<\"\[VeryThinSpace]\[CircleTimes]n1\"\>"]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6553993928389807`*^9, {3.6553999746801987`*^9, 3.655399992775659*^9}, 
   3.655404064338182*^9, {3.655406329350761*^9, 3.655406338094557*^9}, 
   3.655407900449451*^9, 3.65540798948593*^9, 3.655408458668137*^9, 
   3.655408493977087*^9, 3.655408533833414*^9}],

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["V", "1", "\<\"\[VeryThinSpace]\[CircleTimes]n1\"\>"], 
  "\[CircleTimes]", 
  SubsuperscriptBox["V", 
   "2", "\<\"\[VeryThinSpace]\[CircleTimes]n2\"\>"]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6553993928389807`*^9, {3.6553999746801987`*^9, 3.655399992775659*^9}, 
   3.655404064338182*^9, {3.655406329350761*^9, 3.655406338094557*^9}, 
   3.655407900449451*^9, 3.65540798948593*^9, 3.655408458668137*^9, 
   3.655408493977087*^9, 3.6554085338514137`*^9}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["V", "1"], "\[CircleTimes]", 
  SubscriptBox["V", "2"]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6553993928389807`*^9, {3.6553999746801987`*^9, 3.655399992775659*^9}, 
   3.655404064338182*^9, {3.655406329350761*^9, 3.655406338094557*^9}, 
   3.655407900449451*^9, 3.65540798948593*^9, 3.655408458668137*^9, 
   3.655408493977087*^9, 3.6554085338660717`*^9}],

Cell[BoxData[
 SuperscriptBox["V", "\<\"\[VeryThinSpace]\[CircleTimes]0\"\>"]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.6553993928389807`*^9, {3.6553999746801987`*^9, 3.655399992775659*^9}, 
   3.655404064338182*^9, {3.655406329350761*^9, 3.655406338094557*^9}, 
   3.655407900449451*^9, 3.65540798948593*^9, 3.655408458668137*^9, 
   3.655408493977087*^9, 3.65540853387783*^9}],

Cell[TextData[{
 "... where  ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["V", "0"], TraditionalForm]]],
 "  is defined to be the field of the vector space coefficients (typically \
\[DoubleStruckCapitalR])."
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6554061584710693`*^9, 3.6554062301500273`*^9}, 
   3.6554085605372972`*^9}]
}, Closed]],

Cell["Notation for the tangent and cotangent bundles,", "Text",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.6553986843110723`*^9, 3.6553987039109173`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Format", "[", 
   RowBox[{
    RowBox[{"Tangent", "[", "M_", "]"}], ",", "StandardForm"}], "]"}], ":=", 
  RowBox[{"\"\<T\>\"", "[", "M", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Format", "[", 
   RowBox[{
    RowBox[{"Cotangent", "[", "M_", "]"}], ",", "StandardForm"}], "]"}], ":=", 
  RowBox[{
  "\"\<\!\(\*SuperscriptBox[\(T\), \(\(\[VeryThinSpace]\)\(*\)\)]\)\
\[NegativeThinSpace]\>\"", "[", "M", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6553957800569887`*^9, 3.655395804538727*^9}, {
  3.65539585814128*^9, 3.655395900733981*^9}, {3.6553959922643137`*^9, 
  3.655396003048023*^9}, {3.6553960930630407`*^9, 3.655396096583115*^9}, {
  3.655398598552223*^9, 3.655398599676568*^9}, {3.655398754038453*^9, 
  3.6553987659900713`*^9}, {3.6553994540132847`*^9, 3.655399455629327*^9}, {
  3.65550933991325*^9, 3.655509351736738*^9}}],

Cell["\<\
Notation for the tangent and cotangent vector spaces at  p \[Element] M,\
\>", "Text",
 CellChangeTimes->{{3.6553986843110723`*^9, 3.6553987039109173`*^9}, {
  3.655398778262031*^9, 3.655398798085929*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Format", "[", 
   RowBox[{
    RowBox[{"Tangent", "[", 
     RowBox[{"M_", ",", "p_"}], "]"}], ",", "StandardForm"}], "]"}], ":=", 
  RowBox[{
   SubscriptBox["\"\<T\>\"", "p"], "[", "M", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Format", "[", 
   RowBox[{
    RowBox[{"Cotangent", "[", 
     RowBox[{"M_", ",", "p_"}], "]"}], ",", "StandardForm"}], "]"}], ":=", 
  RowBox[{
   SubsuperscriptBox["\"\<T\>\"", "p", "\"\<\[VeryThinSpace]*\>\""], "[", "M",
    "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6553957800569887`*^9, 3.655395804538727*^9}, {
  3.65539585814128*^9, 3.655395900733981*^9}, {3.6553959922643137`*^9, 
  3.655396003048023*^9}, {3.6553960930630407`*^9, 3.655396096583115*^9}, {
  3.655398598552223*^9, 3.655398599676568*^9}, {3.655398720726737*^9, 
  3.655398744214402*^9}, {3.6553988019897203`*^9, 3.6553988518929996`*^9}, {
  3.6553995558364687`*^9, 3.655399620283197*^9}, {3.655509364677829*^9, 
  3.655509366336858*^9}}],

Cell[CellGroupData[{

Cell["Examples", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.655398561656719*^9, 3.655398564760639*^9}, {
  3.655404015986184*^9, 3.655404031666342*^9}}],

Cell[BoxData[{
 RowBox[{"ProductSpace", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Tangent", "[", "M", "]"}], ",", "n1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cotangent", "[", "M", "]"}], ",", "n2"}], "}"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProductSpace", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Tangent", "[", 
       RowBox[{"M", ",", "p"}], "]"}], ",", "n1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cotangent", "[", 
       RowBox[{"M", ",", "p"}], "]"}], ",", "n2"}], "}"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProductSpace", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Tangent", "[", "M", "]"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cotangent", "[", "M", "]"}], ",", "1"}], "}"}]}], "}"}], 
  "]"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.655398899764533*^9, 3.655398918164194*^9}, {
   3.655399426253981*^9, 3.655399428141692*^9}, {3.655399488861031*^9, 
   3.6553994960285473`*^9}, {3.6554002507233267`*^9, 3.655400256688756*^9}, 
   3.655404031666458*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"\<\"T\"\>", "[", "M", 
    "]"}], "\<\"\[VeryThinSpace]\[CircleTimes]n1\"\>"], "\[CircleTimes]", 
  SuperscriptBox[
   RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", "[", "M", 
    "]"}], "\<\"\[VeryThinSpace]\[CircleTimes]n2\"\>"]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.655398920357624*^9, 3.655398931813078*^9}, {
   3.655399433853339*^9, 3.655399496679647*^9}, 3.655400258205*^9, 
   3.655404031666519*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{
    SubscriptBox["\<\"T\"\>", "p"], "[", "M", 
    "]"}], "\<\"\[VeryThinSpace]\[CircleTimes]n1\"\>"], "\[CircleTimes]", 
  SuperscriptBox[
   RowBox[{
    SubsuperscriptBox["\<\"T\"\>", "p", "\<\"\[VeryThinSpace]*\"\>"], "[", 
    "M", "]"}], "\<\"\[VeryThinSpace]\[CircleTimes]n2\"\>"]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.655398920357624*^9, 3.655398931813078*^9}, {
   3.655399433853339*^9, 3.655399496679647*^9}, 3.6554002582177477`*^9, 
   3.655404031666559*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\<\"T\"\>", "[", "M", "]"}], "\[CircleTimes]", 
  RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \\(\\(\[VeryThinSpace]\\)\\(*\
\\)\\)]\\)\[NegativeThinSpace]\"\>", "[", "M", "]"}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.655398920357624*^9, 3.655398931813078*^9}, {
   3.655399433853339*^9, 3.655399496679647*^9}, 3.655400258227982*^9, 
   3.655404031666593*^9}]
}, Closed]],

Cell[TextData[{
 "Notation for the antisymmetric sub-bundle of the tensor bundle  ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["V", 
    RowBox[{"\[CircleTimes]", "k"}]], TraditionalForm]]],
 ","
}], "Text",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.655407113435018*^9, 3.655407170810445*^9}, {
  3.655407322008544*^9, 3.65540736893642*^9}, {3.655407480070732*^9, 
  3.655407485814721*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Format", "[", 
   RowBox[{
    RowBox[{"Forms", "[", 
     RowBox[{"V_", ",", "k_"}], "]"}], ",", "StandardForm"}], "]"}], ":=", 
  RowBox[{"Prefix", "[", 
   RowBox[{
    RowBox[{"Forms", "[", "V", "]"}], ",", 
    SuperscriptBox["\"\<\[CapitalLambda]\>\"", 
     RowBox[{"ToString", "[", "k", "]"}]]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6554072247188377`*^9, 3.655407270809146*^9}, {
  3.6554073865678*^9, 3.655407427271222*^9}, {3.6554076465005713`*^9, 
  3.6554076861800413`*^9}, {3.655407780643227*^9, 3.6554077854999943`*^9}, {
  3.655407920353115*^9, 3.6554079261450167`*^9}, {3.6554080101439657`*^9, 
  3.655408099742684*^9}}],

Cell["Example", "Text",
 CellChangeTimes->{{3.655407443815089*^9, 3.655407445462776*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Forms", "[", 
  RowBox[{"V", ",", "0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Forms", "[", 
  RowBox[{"V", ",", "k"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Forms", "[", 
  RowBox[{
   RowBox[{"Cotangent", "[", "M", "]"}], ",", "k"}], "]"}]}], "Input",
 CellChangeTimes->{{3.655407500778269*^9, 3.655407516390072*^9}, {
  3.655407943208741*^9, 3.6554079530084543`*^9}, {3.6554081245674753`*^9, 
  3.655408129342454*^9}, {3.65540859541684*^9, 3.655408598712371*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   SuperscriptBox["\<\"\[CapitalLambda]\"\>", "\<\"0\"\>"], "V"}],
  Prefix[
   $CellContext`Forms[$CellContext`V], "\[CapitalLambda]"^"0"],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.655407517003014*^9, 3.655407691033984*^9, 3.655407799830772*^9, {
   3.655407931903942*^9, 3.655407953699428*^9}, {3.655408022106576*^9, 
   3.655408040230609*^9}, {3.655408089385085*^9, 3.655408129929772*^9}, 
   3.655408599431596*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   SuperscriptBox["\<\"\[CapitalLambda]\"\>", "\<\"k\"\>"], "V"}],
  Prefix[
   $CellContext`Forms[$CellContext`V], "\[CapitalLambda]"^"k"],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.655407517003014*^9, 3.655407691033984*^9, 3.655407799830772*^9, {
   3.655407931903942*^9, 3.655407953699428*^9}, {3.655408022106576*^9, 
   3.655408040230609*^9}, {3.655408089385085*^9, 3.655408129929772*^9}, 
   3.6554085994502068`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   SuperscriptBox["\<\"\[CapitalLambda]\"\>", "\<\"k\"\>"], 
   RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", "[", "M", 
    "]"}]}],
  Prefix[
   $CellContext`Forms[
    $CellContext`Cotangent[$CellContext`M]], "\[CapitalLambda]"^"k"],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.655407517003014*^9, 3.655407691033984*^9, 3.655407799830772*^9, {
   3.655407931903942*^9, 3.655407953699428*^9}, {3.655408022106576*^9, 
   3.655408040230609*^9}, {3.655408089385085*^9, 3.655408129929772*^9}, 
   3.655408599470536*^9}]
}, Open  ]],

Cell["\<\
Given an abbreviated specification, TotalSpace[ ]  returns a full \
specification for the total space, assuming the default manifold and its \
tangent and cotangent bundles.
The input argument is a list of vector space powers (symbolic integers), as \
accepted by the 2 argument form of  NewField[ ].
The output is suitable as the 2nd argument of the 3 argument form of  \
NewField[ ].\
\>", "Text",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.655400399248917*^9, 3.655400551839416*^9}, {
  3.65540088641064*^9, 3.6554009392099447`*^9}, {3.6554011932547092`*^9, 
  3.655401260789701*^9}, {3.6554013561964817`*^9, 3.655401392596035*^9}, {
  3.655670088456716*^9, 3.655670139384083*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DefaultVectorBundle", "[", "1", "]"}], ":=", 
  RowBox[{"Tangent", "[", 
   RowBox[{"Manifold", "[", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefaultVectorBundle", "[", "2", "]"}], ":=", 
  RowBox[{"Cotangent", "[", 
   RowBox[{"Manifold", "[", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefaultVectorBundle", "[", "n_", "]"}], ":=", 
  RowBox[{"DefaultVectorBundle", "[", 
   RowBox[{"1", "+", 
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{"n", "-", "1"}], ",", "2"}], "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655400678013315*^9, 3.655400746092445*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TotalSpace", "[", 
   RowBox[{"{", "n__", "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "t", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"t", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"MapIndexed", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"DefaultVectorBundle", "[", 
              RowBox[{"First", "[", "#2", "]"}], "]"}], ",", "#1"}], "}"}], 
           "&"}], ",", " ", 
          RowBox[{"{", "n", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", "0"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"t", "===", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Tangent", "[", 
           RowBox[{"Manifold", "[", "]"}], "]"}], ",", "0"}], "}"}], "}"}], 
       ",", "t"}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655400565018055*^9, 3.655400624013982*^9}, {
   3.65540075890804*^9, 3.655400760588127*^9}, 3.6554008007637167`*^9, {
   3.655400994953179*^9, 3.655401017358918*^9}, {3.655401083687997*^9, 
   3.6554011244072638`*^9}, {3.655402300856394*^9, 3.655402336136013*^9}, {
   3.6554068824782057`*^9, 3.6554069107655907`*^9}, 3.655406963053061*^9, {
   3.655406993324761*^9, 3.655406997244711*^9}, {3.6554081481010733`*^9, 
   3.655408155022258*^9}, {3.655408295516478*^9, 3.655408323900118*^9}}],

Cell[CellGroupData[{

Cell["Examples", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.655398561656719*^9, 3.655398564760639*^9}, {
   3.6554024559425507`*^9, 3.655402456150189*^9}, 3.655404046049982*^9}],

Cell[BoxData[{
 RowBox[{"TotalSpace", "[", 
  RowBox[{"{", 
   RowBox[{"n1", ",", "n2"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"TotalSpace", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"TotalSpace", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "0"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"TotalSpace", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "2"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"TotalSpace", "[", 
  RowBox[{"{", "0", "}"}], "]"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.655401148087138*^9, 3.655401161543065*^9}, {
   3.655401270509947*^9, 3.655401293157312*^9}, {3.6554019377328367`*^9, 
   3.655401971372415*^9}, 3.655404046050074*^9, {3.6554051327474413`*^9, 
   3.655405154499627*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", "n1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
      "[", "\<\"M\"\>", "]"}], ",", "n2"}], "}"}]}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.655401162970207*^9, {3.655401280357291*^9, 3.6554012942214603`*^9}, 
   3.655401952645417*^9, 3.655402368437828*^9, 3.65540404605013*^9, {
   3.655405138905014*^9, 3.655405155211589*^9}, 3.6554081601948357`*^9, {
   3.655408315230276*^9, 3.6554083270907583`*^9}, 3.6554088004422503`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
      "[", "\<\"M\"\>", "]"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
      "[", "\<\"M\"\>", "]"}], ",", "4"}], "}"}]}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.655401162970207*^9, {3.655401280357291*^9, 3.6554012942214603`*^9}, 
   3.655401952645417*^9, 3.655402368437828*^9, 3.65540404605013*^9, {
   3.655405138905014*^9, 3.655405155211589*^9}, 3.6554081601948357`*^9, {
   3.655408315230276*^9, 3.6554083270907583`*^9}, 3.65540880045853*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", "2"}], "}"}], 
  "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.655401162970207*^9, {3.655401280357291*^9, 3.6554012942214603`*^9}, 
   3.655401952645417*^9, 3.655402368437828*^9, 3.65540404605013*^9, {
   3.655405138905014*^9, 3.655405155211589*^9}, 3.6554081601948357`*^9, {
   3.655408315230276*^9, 3.6554083270907583`*^9}, 3.655408800473551*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
     "[", "\<\"M\"\>", "]"}], ",", "2"}], "}"}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.655401162970207*^9, {3.655401280357291*^9, 3.6554012942214603`*^9}, 
   3.655401952645417*^9, 3.655402368437828*^9, 3.65540404605013*^9, {
   3.655405138905014*^9, 3.655405155211589*^9}, 3.6554081601948357`*^9, {
   3.655408315230276*^9, 3.6554083270907583`*^9}, 3.655408800487846*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", "0"}], "}"}], 
  "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.655401162970207*^9, {3.655401280357291*^9, 3.6554012942214603`*^9}, 
   3.655401952645417*^9, 3.655402368437828*^9, 3.65540404605013*^9, {
   3.655405138905014*^9, 3.655405155211589*^9}, 3.6554081601948357`*^9, {
   3.655408315230276*^9, 3.6554083270907583`*^9}, 3.655408800507883*^9}],

Cell[BoxData[{
 RowBox[{"ProductSpace", "[", 
  RowBox[{"TotalSpace", "[", 
   RowBox[{"{", 
    RowBox[{"n1", ",", "n2"}], "}"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProductSpace", "[", 
  RowBox[{"TotalSpace", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProductSpace", "[", 
  RowBox[{"TotalSpace", "[", 
   RowBox[{"{", 
    RowBox[{"2", ",", "0"}], "}"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProductSpace", "[", 
  RowBox[{"TotalSpace", "[", 
   RowBox[{"{", 
    RowBox[{"0", ",", "2"}], "}"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ProductSpace", "[", 
  RowBox[{"TotalSpace", "[", 
   RowBox[{"{", "0", "}"}], "]"}], "]"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.655401148087138*^9, 3.655401161543065*^9}, {
   3.655401270509947*^9, 3.655401293157312*^9}, {3.6554019377328367`*^9, 
   3.655401971372415*^9}, {3.655402468929099*^9, 3.655402492261652*^9}, 
   3.655404046050288*^9, {3.655406041432684*^9, 3.655406049290051*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", 
    "]"}], "\<\"\[VeryThinSpace]\[CircleTimes]n1\"\>"], "\[CircleTimes]", 
  SuperscriptBox[
   RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
    "[", "\<\"M\"\>", 
    "]"}], "\<\"\[VeryThinSpace]\[CircleTimes]n2\"\>"]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.655402494450626*^9, 3.655404046050325*^9, 
  3.655406050240692*^9, 3.655408804766552*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], "\[CircleTimes]", 
  SuperscriptBox[
   RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
    "[", "\<\"M\"\>", "]"}], "\<\"\[VeryThinSpace]\[CircleTimes]2\"\>"], 
  "\[CircleTimes]", 
  SuperscriptBox[
   RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", 
    "]"}], "\<\"\[VeryThinSpace]\[CircleTimes]3\"\>"], "\[CircleTimes]", 
  SuperscriptBox[
   RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
    "[", "\<\"M\"\>", 
    "]"}], "\<\"\[VeryThinSpace]\[CircleTimes]4\"\>"]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.655402494450626*^9, 3.655404046050325*^9, 
  3.655406050240692*^9, 3.655408804782198*^9}],

Cell[BoxData[
 SuperscriptBox[
  RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", 
   "]"}], "\<\"\[VeryThinSpace]\[CircleTimes]2\"\>"]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.655402494450626*^9, 3.655404046050325*^9, 
  3.655406050240692*^9, 3.655408804796846*^9}],

Cell[BoxData[
 SuperscriptBox[
  RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \\(\\(\[VeryThinSpace]\\)\\(*\
\\)\\)]\\)\[NegativeThinSpace]\"\>", "[", "\<\"M\"\>", 
   "]"}], "\<\"\[VeryThinSpace]\[CircleTimes]2\"\>"]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.655402494450626*^9, 3.655404046050325*^9, 
  3.655406050240692*^9, 3.655408804811446*^9}],

Cell[BoxData[
 SuperscriptBox[
  RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", 
   "]"}], "\<\"\[VeryThinSpace]\[CircleTimes]0\"\>"]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.655402494450626*^9, 3.655404046050325*^9, 
  3.655406050240692*^9, 3.6554088048252907`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TotalSpace", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
      "[", "\<\"M\"\>", "]"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
      "[", "\<\"M\"\>", "]"}], ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.655409161052446*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
    RowBox[{"TotalSpace", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.655409173085725*^9, 3.655409217184678*^9}}],

Cell[BoxData["10"], "Output",
 CellChangeTimes->{{3.6554092079308987`*^9, 3.655409217724555*^9}}]
}, Open  ]],

Cell["\<\
FieldType[ X ]   is an enquiry function that returns the base manifold on \
which  X  is declared and the  TotalSpace   of which  X  is a section. 
Specific values are set within  NewField[ ] .  The default is to return a \
message,\
\>", "Text",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.655402833121361*^9, 3.655403002959111*^9}, {
   3.655403212092701*^9, 3.6554032700117807`*^9}, 3.655670874414714*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldType", "[", 
   RowBox[{"\[GothicCapitalD]", "[", "X_", "]"}], "]"}], ":=", " ", 
  RowBox[{"FieldType", "[", "X", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655670407732613*^9, 3.6556704328524027`*^9}, {
  3.655670491155394*^9, 3.655670509667241*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldType", "[", 
   RowBox[{"\[Del]", "X_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M", ",", "t", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"M", "=", 
      RowBox[{"First", "[", 
       RowBox[{"FieldType", "[", "X", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"t", "=", 
      RowBox[{
       RowBox[{"FieldType", "[", "X", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"Last", "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cotangent", "[", "M", "]"}], ",", "n_"}], "}"}]}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Last", "[", 
          RowBox[{"Last", "[", "t", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"M", ",", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Most", "[", "t", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cotangent", "[", "M", "]"}], ",", 
              RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"M", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"t", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cotangent", "[", "M", "]"}], ",", "1"}], "}"}]}], 
          "]"}]}], "}"}]}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655670515379114*^9, 3.655670520130782*^9}, {
  3.655670554402533*^9, 3.655670608161989*^9}, {3.655670679776876*^9, 
  3.655670852686831*^9}, {3.655670925341753*^9, 3.655671215514266*^9}}],

Cell[TextData[{
 "We define  ",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    RowBox[{
     RowBox[{"grad", "[", "X", "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Del]", "#"], "X"}], " ", "=", "  ", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
        RowBox[{"\[Del]", "X"}], ",", 
        SuperscriptBox["g", 
         RowBox[{"-", "1"}]]}], "\[RightAngleBracket]"}]}]}]}], 
   TraditionalForm]],
  FormatType->"TraditionalForm"],
 " ,   ie. it adds a vector slot at the end,"
}], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldType", "[", 
   RowBox[{"grad", "[", "X_", "]"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"M", ",", "t", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"M", "=", 
      RowBox[{"First", "[", 
       RowBox[{"FieldType", "[", "X", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"t", "=", 
      RowBox[{
       RowBox[{"FieldType", "[", "X", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"Last", "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Tangent", "[", "M", "]"}], ",", "n_"}], "}"}]}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Last", "[", 
          RowBox[{"Last", "[", "t", "]"}], "]"}]}], ";", 
        RowBox[{"{", 
         RowBox[{"M", ",", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Most", "[", "t", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Tangent", "[", "M", "]"}], ",", 
              RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"M", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"t", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Tangent", "[", "M", "]"}], ",", "1"}], "}"}]}], "]"}]}],
         "}"}]}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell["Example", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6556713578001347`*^9, 3.6556713647605*^9}}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"X", ",", "Y"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], ",", "X"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], ",", "Y"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FieldType", "[", 
  RowBox[{"\[Del]", "X"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FieldType", "[", 
  RowBox[{"\[Del]", "Y"}], "]"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.655671228983149*^9, 3.655671320248857*^9}, 
   3.655671364760599*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"M\"\>", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
        "[", "\<\"M\"\>", "]"}], ",", "2"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.655671267279443*^9, {3.6556713053221197`*^9, 3.655671322600376*^9}, 
   3.655671364760659*^9, 3.655671522801135*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"M\"\>", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
        "[", "\<\"M\"\>", "]"}], ",", "1"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{
  3.655671267279443*^9, {3.6556713053221197`*^9, 3.655671322600376*^9}, 
   3.655671364760659*^9, 3.655671522803905*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldType", "[", 
   RowBox[{"pD", "[", 
    RowBox[{"X_", ",", "__"}], "]"}], "]"}], ":=", " ", 
  RowBox[{"FieldType", "[", "X", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655671409943541*^9, 3.655671415807866*^9}}],

Cell["Otherwise return a message,", "Text",
 CellChangeTimes->{{3.6556713848398113`*^9, 3.6556713972077227`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldType", "[", "_", "]"}], ":=", 
  "\"\<FieldType[\[MediumSpace]] is an enquiry function defined only for \
declared fields.\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655403006558242*^9, 3.6554030299988956`*^9}, {
   3.655403086925928*^9, 3.6554031530213118`*^9}, 3.655403197340622*^9, 
   3.655403283595986*^9, 3.65540385101225*^9, {3.65567033390958*^9, 
   3.655670373477103*^9}, 3.655671509414234*^9}],

Cell[CellGroupData[{

Cell["Old  FieldType  code  ---  nothing initialized.", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.653960218465561*^9, 3.6539603148645906`*^9}, {
   3.653963540492176*^9, 3.653963598459262*^9}, 3.653977842747735*^9, 
   3.655094383697802*^9, {3.655403452297339*^9, 3.655403465161429*^9}, {
   3.6554037141020107`*^9, 3.655403771797286*^9}, {3.655403829812688*^9, 
   3.655403845604508*^9}}],

Cell["\<\
This returns a list of the dimensions of each slot for a specified field \
type,  \
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.655403710220215*^9, 3.655403739301989*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FieldType", " ", "::", " ", "usage"}], "=", 
   "\"\<FieldType[\[VeryThinSpace]X\[VeryThinSpace]]   returns information \
about the tensor field  X  as a list of the form   { domain,  range } ,  \
giving where  X  is defined (domain)  and where it takes its values (range).\n\
\n\!\(\*
StyleBox[\"domain\",
FontSlant->\"Italic\"]\)   is the identifier for the manifold on which  X  is \
defined.  This identifier is typically a string,  eg,.  \\\"M\\\" ,  \
\\\"worldline\\\" ,  \\\"R\[Cross]\!\(\*SuperscriptBox[\(S\), \(2\)]\)\\\" , \
but could also be a symbolic expression.\n\n\!\(\*
StyleBox[\"range\",
FontSlant->\"Italic\"]\)     is a nested list of the form    { \
\!\(TraditionalForm\`{\\\ \*SubscriptBox[\(V\), \(1\)], \*SubscriptBox[\(n\), \
\(i\)]\\\ }\), {\!\(\*SubscriptBox[\(V\), \(2\)]\), \!\(\*SubscriptBox[\(n\), \
\(2\)]\)}, .... },  where the  \!\(\*SubscriptBox[\(V\), \(i\)]\)  (typically \
strings)  are identifiers for various vector spaces.  \n                 \n\
The above range specification says that  X  takes values in   \
\!\(\*SuperscriptBox[SubscriptBox[\(V\), \(1\)], SubscriptBox[\(n\), \
\(1\)]]\) \[CircleTimes] \
\!\(TraditionalForm\`\*SuperscriptBox[SubscriptBox[\(V\), \(2\)], \
SubscriptBox[\(n\), \(2\)]]\) \[CircleTimes] ....   where   \
\!\(\*SuperscriptBox[SubscriptBox[\(V\), \(i\)], SubscriptBox[\(n\), \
\(i\)]]\)  is the  \!\(\*SubscriptBox[\(n\), \(i\)]\)-fold tensor product of \
the vector space  \!\(\*SubscriptBox[\(V\), \(i\)]\).  That is,  \n\
\!\(\*SuperscriptBox[SubscriptBox[\(V\), \(i\)], SubscriptBox[\(n\), \
\(i\)]]\) = \!\(\*SubscriptBox[\(V\), \(i\)]\)\[CircleTimes] \
\!\(\*SubscriptBox[\(V\), \(i\)]\) \[CircleTimes] ...  (with  \
\!\(\*SubscriptBox[\(n\), \(i\)]\) factors).   \n\nA common case is that each \
 \!\(\*SubscriptBox[\(V\), \(i\)]\)  is either  \!\(\*SubscriptBox[\(T\), \(p\
\)]\)M  or  \!\(\*SubsuperscriptBox[\(T\), \(p\), \(*\)]\)M , the tangent or \
cotangent space at  p \[Element] M ,  where \nthe domain  M  is the base \
manifold of a vector bundle.\n\nExample:   Consider an immersion of a \
manifold  M  into a manifold  N  by    \
\!\(TraditionalForm\`\(\*SuperscriptBox[\(x\), \(j\)]\(=\)\(\\\ \
\)\(\(\*SuperscriptBox[\(z\), \(j\)]\)\\\ [\*SuperscriptBox[\(u\), \(\[Alpha]\
\)]]\)\(\\\ \)\)\) ,  where  j = 1, ..., dim[ N ],  and  \[Alpha] = 1, ..., \
dim[ M ]. \nThe projection tensor is   P =  \!\(TraditionalForm\`\(\((\\\ \
\[PartialD]\*SuperscriptBox[\(z\), \(j\)]/\[PartialD]\*SuperscriptBox[\(u\), \
\(\[Alpha]\)]\\\ )\)\(\\\ \)\)\) \!\(TraditionalForm\`\*SubscriptBox[\(\
\[PartialD]\), SuperscriptBox[\(x\), \(j\)]]\) \[CircleTimes] \
\!\(TraditionalForm\`\*SuperscriptBox[\(du\), \(\[Alpha]\)]\) .  Thus,  P  is \
defined on  M  and takes values in  TN \[CircleTimes] \
\!\(\*SuperscriptBox[\(T\), \(\(\\\ \)\(*\)\)]\)M .  In this case  FieldType[\
\[VeryThinSpace] P \[VeryThinSpace]]  would\nreturn a list such as    { \\\"M\
\\\", { { \\\"TN\\\", 1 },  { \\\"\!\(\*SuperscriptBox[\(T\), \(\(\\\ \)\(*\)\
\)]\)M\\\", 1 } } }.\n\nSee also:  ? SetFieldType ,  ? NewField \>\""}], 
  ";"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.653949732802552*^9, 3.6539497857705297`*^9}, {
   3.653949859769678*^9, 3.6539498955071487`*^9}, {3.653950006745525*^9, 
   3.653950017801094*^9}, {3.653950122713374*^9, 3.653950218985591*^9}, {
   3.653950252009555*^9, 3.6539503043289223`*^9}, {3.653950342856566*^9, 
   3.6539504655408077`*^9}, {3.653950539182897*^9, 3.65395060880112*^9}, {
   3.6539506406065397`*^9, 3.653950742347307*^9}, {3.6539507900277777`*^9, 
   3.653950842837928*^9}, {3.653950916533908*^9, 3.6539509188976994`*^9}, {
   3.6539509970129347`*^9, 3.65395100280453*^9}, {3.6539510446974*^9, 
   3.6539511029280243`*^9}, {3.653952341186143*^9, 3.653952417695805*^9}, {
   3.653952467224325*^9, 3.653952572077497*^9}, {3.6539528840752363`*^9, 
   3.6539529017216377`*^9}, {3.653952988657373*^9, 3.653953105577457*^9}, {
   3.653953242846561*^9, 3.653953263157577*^9}, {3.65395333975143*^9, 
   3.653953343101406*^9}, {3.65395372773116*^9, 3.65395389552409*^9}, {
   3.653953932594511*^9, 3.653953932821281*^9}, {3.653954031877461*^9, 
   3.653954036743293*^9}, 3.653954146710351*^9, {3.65395859985209*^9, 
   3.653958726174408*^9}, {3.6539587659011383`*^9, 3.653958808632352*^9}, {
   3.653959302374382*^9, 3.653959334963051*^9}, {3.653959384278466*^9, 
   3.6539595738118143`*^9}, {3.653968795322126*^9, 3.653969074350705*^9}, {
   3.6539691159573803`*^9, 3.65396936288547*^9}, {3.653969397141431*^9, 
   3.653969575012566*^9}, {3.6539696455707407`*^9, 3.653969750177516*^9}, {
   3.653969801199772*^9, 3.6539698955074043`*^9}, {3.653969937794505*^9, 
   3.6539699938111887`*^9}, {3.65397007043344*^9, 3.6539700867848663`*^9}, {
   3.653970172130094*^9, 3.653970196727907*^9}, {3.653970228224555*^9, 
   3.653970263071107*^9}, {3.653970300099763*^9, 3.653970327220716*^9}, {
   3.653970393660961*^9, 3.653970429569728*^9}, {3.653970476689508*^9, 
   3.653970620168298*^9}, {3.6539706670853157`*^9, 3.65397067275107*^9}, {
   3.653970738470611*^9, 3.653970767085943*^9}, {3.65397081178944*^9, 
   3.653970951608037*^9}, {3.653971084742241*^9, 3.653971116998206*^9}, {
   3.65397120870078*^9, 3.65397121666891*^9}, {3.6551018291530046`*^9, 
   3.655101996686219*^9}, 3.655403739302032*^9}],

Cell[BoxData[
 RowBox[{"?", "FieldType"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.653949902153034*^9, 3.653949902297346*^9}, 
   3.653960076677299*^9, 3.655403739302064*^9}],

Cell[BoxData[
 StyleBox["\<\"FieldType[\[VeryThinSpace]X\[VeryThinSpace]]   returns \
information about the tensor field  X  as a list of the form   { domain,  \
range } ,  giving where  X  is defined (domain)  and where it takes its \
values (range).\\n\\n\!\(\*\\nStyleBox[\\\"domain\\\",\\nFontSlant->\\\"\
Italic\\\"]\)   is the identifier for the manifold on which  X  is defined.  \
This identifier is typically a string,  eg,.  \\\"M\\\" ,  \\\"worldline\\\" \
,  \\\"R\[Cross]\!\(\*SuperscriptBox[\(S\), \(2\)]\)\\\" , but could also be \
a symbolic \
expression.\\n\\n\!\(\*\\nStyleBox[\\\"range\\\",\\nFontSlant->\\\"Italic\\\"]\
\)     is a nested list of the form    { \!\(TraditionalForm\`{\\\\ \
\*SubscriptBox[\(V\), \(1\)], \*SubscriptBox[\(n\), \(i\)]\\\\ }\), \
{\!\(\*SubscriptBox[\(V\), \(2\)]\), \!\(\*SubscriptBox[\(n\), \(2\)]\)}, \
.... },  where the  \!\(\*SubscriptBox[\(V\), \(i\)]\)  (typically strings)  \
are identifiers for various vector spaces.  \\n                 \\nThe above \
range specification says that  X  takes values in   \
\!\(\*SuperscriptBox[SubscriptBox[\(V\), \(1\)], SubscriptBox[\(n\), \
\(1\)]]\) \[CircleTimes] \
\!\(TraditionalForm\`\*SuperscriptBox[SubscriptBox[\(V\), \(2\)], \
SubscriptBox[\(n\), \(2\)]]\) \[CircleTimes] ....   where   \
\!\(\*SuperscriptBox[SubscriptBox[\(V\), \(i\)], SubscriptBox[\(n\), \
\(i\)]]\)  is the  \!\(\*SubscriptBox[\(n\), \(i\)]\)-fold tensor product of \
the vector space  \!\(\*SubscriptBox[\(V\), \(i\)]\).  That is,  \
\\n\!\(\*SuperscriptBox[SubscriptBox[\(V\), \(i\)], SubscriptBox[\(n\), \
\(i\)]]\) = \!\(\*SubscriptBox[\(V\), \(i\)]\)\[CircleTimes] \
\!\(\*SubscriptBox[\(V\), \(i\)]\) \[CircleTimes] ...  (with  \
\!\(\*SubscriptBox[\(n\), \(i\)]\) factors).   \\n\\nA common case is that \
each  \!\(\*SubscriptBox[\(V\), \(i\)]\)  is either  TM  or  \
\!\(\*SuperscriptBox[\(T\), \(*\)]\)M  (the tangent or cotangent spaces to M) \
 where the domain  M  is the base manifold of the vector \
bundle.\\n\\nExample:   Consider an immersion of a manifold  M  into a \
manifold  N  by    \!\(TraditionalForm\`\(\*SuperscriptBox[\(x\), \(j\)]\(=\)\
\(\\\\ \)\(\(\*SuperscriptBox[\(z\), \(j\)]\)\\\\ [\*SuperscriptBox[\(u\), \(\
\[Alpha]\)]]\)\(\\\\ \)\)\) ,  where  j = 1, ..., dim[ N ],  and  \[Alpha] = \
1, ..., dim[ M ]. \\nThe projection tensor is   P =  \
\!\(TraditionalForm\`\(\((\\\\ \[PartialD]\*SuperscriptBox[\(z\), \(j\)]/\
\[PartialD]\*SuperscriptBox[\(u\), \(\[Alpha]\)]\\\\ )\)\(\\\\ \)\)\) \
\!\(TraditionalForm\`\*SubscriptBox[\(\[PartialD]\), SuperscriptBox[\(x\), \
\(j\)]]\) \[CircleTimes] \!\(TraditionalForm\`\*SuperscriptBox[\(du\), \(\
\[Alpha]\)]\) .  Thus,  P  is defined on  M  and takes values in  TN \
\[CircleTimes] \!\(\*SuperscriptBox[\(T\), \(\(\\\\ \)\(*\)\)]\)M .  In this \
case  FieldType[\[VeryThinSpace] P \[VeryThinSpace]]  would\\nreturn a list \
such as    { \\\"M\\\", { { \\\"TN\\\", 1 },  { \
\\\"\!\(\*SuperscriptBox[\(T\), \(\(\\\\ \)\(*\)\)]\)M\\\", 1 } } }.\\n\\nSee \
also:  ? SetFieldType ,  ? NewField \"\>", "MSG"]], "Print", "PrintUsage",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{3.6539857525432568`*^9, 3.655403739302103*^9},
 CellTags->"Info3654025352-1410783"],

Cell["\<\
This returns a list of the dimensions of each slot for a specified field \
type,  \
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.655403710220215*^9, 3.655403739302123*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotDimensions", "[", "typ_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "t", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"t", "=", 
      RowBox[{"FieldType", "[", "typ", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"dim", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}], "&"}], ",", 
        RowBox[{"t", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}]}]}], "]"}]}]], "Input",\

 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6539567718583183`*^9, 3.653956825291382*^9}, 
   3.653956981849207*^9, {3.653957601791469*^9, 3.653957609570035*^9}, 
   3.653957653425764*^9, 3.653957732785304*^9, {3.653977726111246*^9, 
   3.65397772902258*^9}, 3.655403739302196*^9}],

Cell[BoxData[
 RowBox[{"SlotDimensions", "[", 
  RowBox[{"{", 
   RowBox[{"\"\<M\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<X\>\"", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Y\>\"", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Z\>\"", ",", "3"}], "}"}]}], "}"}]}], "}"}], 
  "]"}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6539603490092783`*^9, 3.6539605057626543`*^9}, {
   3.653977706609634*^9, 3.653977711360577*^9}, 3.655403739302288*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dim", "[", "\<\"X\"\>", "]"}], ",", 
   RowBox[{"dim", "[", "\<\"Y\"\>", "]"}], ",", 
   RowBox[{"dim", "[", "\<\"Y\"\>", "]"}], ",", 
   RowBox[{"dim", "[", "\<\"Z\"\>", "]"}], ",", 
   RowBox[{"dim", "[", "\<\"Z\"\>", "]"}], ",", 
   RowBox[{"dim", "[", "\<\"Z\"\>", "]"}]}], "}"}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.653960415287767*^9, 3.6539604266586447`*^9}, {
   3.653960459668001*^9, 3.653960465480426*^9}, 3.6539605065069227`*^9, {
   3.653977713440053*^9, 3.653977732301777*^9}, 3.653977856483164*^9, {
   3.653985551666051*^9, 3.653985581548997*^9}, 3.653985753629779*^9, 
   3.6554037393023367`*^9}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "SetFieldType", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetFieldType", "[", 
   RowBox[{"f_", ",", "typ_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "t", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ValueQ", "[", 
         RowBox[{"FieldType", "[", "f", "]"}], "]"}], "&&", " ", 
        RowBox[{"!", 
         RowBox[{
          RowBox[{"FieldType", "[", "f", "]"}], "===", 
          RowBox[{"{", "}"}]}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<The field already has a defined type:  FieldType[\>\"", ",", 
          "f", ",", "\"\<] = \>\"", ",", 
          RowBox[{"FieldType", "[", "f", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<First use either  ClearFieldType[\>\"", ",", "f", ",", 
          "\"\<]  or  ClearField[\>\"", ",", "f", ",", "\"\<].\>\""}], "]"}], 
        ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", " ", "[", 
      RowBox[{
       RowBox[{"typ", "===", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"FieldType", "[", "f", "]"}], "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"$ListOfFields", ",", 
          RowBox[{"{", "f", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"t", "=", 
         RowBox[{"FieldType", "[", "typ", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FieldType", "[", "f", "]"}], "=", "t"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deg", "[", "f", "]"}], "=", 
         RowBox[{"degOfFieldType", "[", "t", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"deg", "[", 
          RowBox[{"f", "[", "___", "]"}], "]"}], "=", 
         RowBox[{"deg", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"degsIntegerQ", "[", "t", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"$ListOfFields", ",", 
            RowBox[{"{", 
             RowBox[{"f", ",", "t", ",", 
              RowBox[{"f", "\[Element]", 
               RowBox[{"Arrays", "[", 
                RowBox[{
                 RowBox[{"SlotDimensions", "[", "t", "]"}], ",", "Reals"}], 
                "]"}]}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"$ListOfFields", ",", 
            RowBox[{"{", 
             RowBox[{"f", ",", "t"}], "}"}]}], "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Last", "[", "$ListOfFields", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.653943209232593*^9, 3.653943211900407*^9}, {
   3.653951380359796*^9, 3.653951409527639*^9}, 3.653954633075992*^9, 
   3.653954666164233*^9, {3.653954733107398*^9, 3.653954780147553*^9}, {
   3.653954962657681*^9, 3.653954986833536*^9}, {3.653955071744779*^9, 
   3.653955142207852*^9}, {3.6539552240319033`*^9, 3.653955291998879*^9}, {
   3.65395546375747*^9, 3.653955491404929*^9}, {3.653955920599051*^9, 
   3.653956073461832*^9}, 3.653956164788702*^9, {3.653956283574953*^9, 
   3.653956287762192*^9}, {3.6539563614583693`*^9, 3.6539563627537727`*^9}, {
   3.653956469409382*^9, 3.65395648308877*^9}, {3.6539565308588448`*^9, 
   3.653956541791977*^9}, 3.6539565943353043`*^9, {3.653956632031123*^9, 
   3.65395663354897*^9}, 3.653956667359971*^9, {3.653956840830576*^9, 
   3.653956841629888*^9}, {3.6539568791010847`*^9, 3.653956963596826*^9}, 
   3.653957717940495*^9, {3.653958369114427*^9, 3.653958405962186*^9}, 
   3.653959631083383*^9, 3.6539597258987207`*^9, {3.6539606035839252`*^9, 
   3.653960604446306*^9}, {3.653960644368945*^9, 3.65396066019188*^9}, 
   3.6539623055522757`*^9, {3.653962631577166*^9, 3.653962639145329*^9}, {
   3.65396267476195*^9, 3.653962677841386*^9}, {3.6539627271612263`*^9, 
   3.653962728107565*^9}, {3.65396288136762*^9, 3.6539629051766653`*^9}, {
   3.653963134325049*^9, 3.653963138069027*^9}, 3.65396317119042*^9, {
   3.6539633362425413`*^9, 3.653963348851553*^9}, {3.653964627364368*^9, 
   3.653964748114952*^9}, {3.6539648632331553`*^9, 3.65396486360284*^9}, {
   3.653964968928253*^9, 3.653964981489936*^9}, {3.65396537449224*^9, 
   3.653965567404202*^9}, {3.653965613755919*^9, 3.653965693977058*^9}, 
   3.653965724394073*^9, {3.653965761629067*^9, 3.6539657975298862`*^9}, {
   3.653965915113306*^9, 3.653965915942277*^9}, {3.653965992918583*^9, 
   3.653966041593297*^9}, {3.6539668584313602`*^9, 3.653966996395646*^9}, {
   3.653973969610034*^9, 3.653973976626677*^9}, {3.653976394340301*^9, 
   3.653976407537849*^9}, {3.653976908847481*^9, 3.6539769135358562`*^9}, 
   3.655403739302464*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearFieldType", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"FieldType", "[", "f", "]"}], "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Quiet", "[", 
      RowBox[{
       RowBox[{"deg", "[", "f", "]"}], "=."}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Quiet", "[", 
      RowBox[{
       RowBox[{"deg", "[", 
        RowBox[{"f", "[", "___", "]"}], "]"}], "=."}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$ListOfFields", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"$ListOfFields", ",", 
        RowBox[{"{", 
         RowBox[{"f", ",", "___"}], "}"}]}], "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6539647586719303`*^9, 3.653964854081586*^9}, {
   3.653964926398405*^9, 3.65396494620618*^9}, {3.653965075405545*^9, 
   3.6539650850847807`*^9}, 3.655403739302525*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Tensor degree : deg[  ]", "Subsection",
 CellChangeTimes->{{3.467119314622471*^9, 3.467119352821146*^9}, {
   3.476693637814482*^9, 3.476693639510118*^9}, {3.478635035907522*^9, 
   3.478635074317131*^9}, 3.478677199671947*^9, {3.479720032782098*^9, 
   3.479720041791068*^9}, {3.479721708422789*^9, 3.479721712614642*^9}, {
   3.655404246447475*^9, 3.655404247135116*^9}}],

Cell["\<\
Not sure if it was   deg[ ] ,  but  $RecursionLimit = 256  was not large \
enough to calculate the stress-energy tensor for the electric dipole.
Needed way bigger for charged sphere.
10 000  is too big --- if in a loop, sometimes the kernel quits before \
messages are given and an  Abort[]  is done. That makes it very difficult to \
debug ! \
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.467119110905673*^9, 3.467119177865709*^9}, {
   3.467188573688896*^9, 3.467188582726033*^9}, {3.46730184160461*^9, 
   3.467302054118773*^9}, {3.477078637482505*^9, 3.47707864722257*^9}, {
   3.477079056823587*^9, 3.477079081522389*^9}, 3.479721984971652*^9, {
   3.479723576498003*^9, 3.479723590953641*^9}, {3.479831642516894*^9, 
   3.479831651309886*^9}, {3.616529237726336*^9, 3.616529357950637*^9}, {
   3.655574423775003*^9, 3.655574459395528*^9}}],

Cell["\<\
Do not start with   Clear[ deg ]   because values for  deg[ ]  have already \
been set in the  PartialDerivative`  package.\
\>", "Text",
 CellChangeTimes->{{3.623167552459486*^9, 3.623167648746995*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$RecursionLimit", "=", "1024"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.478886521018781*^9, 3.478886526338121*^9}, {
  3.478886706701289*^9, 3.478886708017533*^9}, {3.616529219747424*^9, 
  3.616529226576356*^9}}],

Cell[BoxData[
 RowBox[{"SetAttributes", "[", 
  RowBox[{"deg", ",", "Listable"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527655091627439*^9, 3.5276551034960947`*^9}, 
   3.6152620032721643`*^9, 3.623167533775874*^9, {3.6500758956932364`*^9, 
   3.650075928604269*^9}, {3.650076111001854*^9, 3.650076146953063*^9}}],

Cell["This defn is used by the   SetmvArgLength  functions,", "Text",
 CellChangeTimes->{{3.612206694606636*^9, 3.61220670718246*^9}, {
  3.612420183584168*^9, 3.612420189180562*^9}, {3.612420219382292*^9, 
  3.612420230599886*^9}, {3.61527004347292*^9, 3.615270044064843*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "]"}], "=", "0"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6124202344317617`*^9, 3.6124202384609137`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", "expr_Wedge", "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"Plus", ",", 
    RowBox[{"Map", "[", 
     RowBox[{"deg", ",", 
      RowBox[{"Apply", "[", 
       RowBox[{"List", ",", "expr"}], "]"}]}], "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"c_", "?", "NumericQ"}], "]"}], ":=", "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", "expr_Times", "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"Plus", ",", 
    RowBox[{"Map", "[", 
     RowBox[{"deg", ",", 
      RowBox[{"Apply", "[", 
       RowBox[{"List", ",", "expr"}], "]"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", "expr_CircleTimes", "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"Plus", ",", 
    RowBox[{"Map", "[", 
     RowBox[{"deg", ",", 
      RowBox[{"Apply", "[", 
       RowBox[{"List", ",", "expr"}], "]"}]}], "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True],

Cell["\<\
If a sum of terms does not have a well defined degree  (eg, a Clifford \
expression, or it involves undeclared fields)  then deg[ ]  will return an \
ordered list 
of the degrees that appear in the sum,\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", "X_Plus", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "d", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"deg", "[", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", "X"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "d", "]"}], "===", "1"}], ",", 
       RowBox[{"First", "[", "d", "]"}], ",", "d"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell["\<\
Define  deg[ ]  for a Sequence of arguments to be the sum of their degrees.  
This is used for calculating deg of a sequence that is matched from a tensor \
product.  It\[CloseCurlyQuote]s use in this context assumes that the \
arguments of deg all have single valued degree.
Else you can end up adding lists of possibly different lengths, like in this \
error example,\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"deg", "[", 
  RowBox[{
   RowBox[{"1", "+", "X", "+", "Y"}], ",", 
   RowBox[{"X", "+", 
    RowBox[{"X", "\[CircleTimes]", "Y"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 TemplateBox[{
  "Thread","tdlen",
   "\"Objects of unequal length in \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"0\\\", \\\",\\\", RowBox[{\\\"deg\\\", \\\"[\\\", \\\"X\\\", \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"deg\\\", \\\"[\\\", \\\"Y\\\", \
\\\"]\\\"}]}], \\\"}\\\"}], \\\"+\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"deg\\\", \\\"[\\\", \\\"X\\\", \\\"]\\\"}], \\\",\\\", \
RowBox[{RowBox[{\\\"deg\\\", \\\"[\\\", \\\"X\\\", \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"deg\\\", \\\"[\\\", \\\"Y\\\", \\\"]\\\"}]}]}], \\\"}\\\"}]}]\\) \
cannot be combined.\"",2,2867,190,28427080718914807907,"Local"},
  "MessageTemplate"]], "Message", "MSG"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"deg", "[", "X", "]"}], ",", 
    RowBox[{
     RowBox[{"deg", "[", "X", "]"}], "+", 
     RowBox[{"deg", "[", "Y", "]"}]}]}], "}"}], "+", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    RowBox[{"deg", "[", "X", "]"}], ",", 
    RowBox[{"deg", "[", "Y", "]"}]}], "}"}]}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"X__", "/;", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"{", "X", "}"}], "]"}], ">", "1"}]}], "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"Plus", ",", 
    RowBox[{"Map", "[", 
     RowBox[{"deg", ",", 
      RowBox[{"{", "X", "}"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614897483648613*^9, 3.6148975054315042`*^9}, {
  3.6148975616250257`*^9, 3.6148975854028053`*^9}, {3.614897647803018*^9, 
  3.614897659836594*^9}}],

Cell[BoxData[
 RowBox[{"SetAttributes", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"deg0Q", ",", "deg1Q", ",", "deg2Q", ",", "deg3Q", ",", "deg4Q"}],
     "}"}], ",", "Listable"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527655091627439*^9, 3.5276551034960947`*^9}, 
   3.6152620032721643`*^9, 3.623167533775874*^9, {3.6500758956932364`*^9, 
   3.650075928604269*^9}, {3.650076111001854*^9, 3.650076183993395*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"deg0Q", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"deg", "[", "x", "]"}], "===", "0"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg1Q", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"deg", "[", "x", "]"}], "===", "1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg2Q", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"deg", "[", "x", "]"}], "===", "2"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg3Q", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"deg", "[", "x", "]"}], "===", "3"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg4Q", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"deg", "[", "x", "]"}], "===", "4"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg5Q", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"deg", "[", "x", "]"}], "===", "5"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg6Q", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"deg", "[", "x", "]"}], "===", "6"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg7Q", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"deg", "[", "x", "]"}], "===", "7"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg8Q", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"deg", "[", "x", "]"}], "===", "8"}]}]}], "Input",
 InitializationCell->True],

Cell["\<\
These return  True  if all arguments are of the specified degree,  and return \
 False  otherwise.
The faster definitions above take precedence if there is just one argument,\
\>", "Text",
 CellChangeTimes->{{3.615084985729064*^9, 3.615085151906172*^9}, {
  3.615085291458853*^9, 3.615085292520232*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"deg0Q", "[", "x__", "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"SameQ", ",", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"deg", "[", 
       RowBox[{"{", "x", "}"}], "]"}], ",", "0"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg1Q", "[", "x__", "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"SameQ", ",", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"deg", "[", 
       RowBox[{"{", "x", "}"}], "]"}], ",", "1"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg2Q", "[", "x__", "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"SameQ", ",", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"deg", "[", 
       RowBox[{"{", "x", "}"}], "]"}], ",", "2"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg3Q", "[", "x__", "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"SameQ", ",", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"deg", "[", 
       RowBox[{"{", "x", "}"}], "]"}], ",", "3"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg4Q", "[", "x__", "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"SameQ", ",", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"deg", "[", 
       RowBox[{"{", "x", "}"}], "]"}], ",", "4"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg5Q", "[", "x__", "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"SameQ", ",", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"deg", "[", 
       RowBox[{"{", "x", "}"}], "]"}], ",", "5"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg6Q", "[", "x__", "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"SameQ", ",", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"deg", "[", 
       RowBox[{"{", "x", "}"}], "]"}], ",", "6"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg7Q", "[", "x__", "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"SameQ", ",", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"deg", "[", 
       RowBox[{"{", "x", "}"}], "]"}], ",", "7"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg8Q", "[", "x__", "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"SameQ", ",", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"deg", "[", 
       RowBox[{"{", "x", "}"}], "]"}], ",", "8"}], "]"}]}], "]"}]}]}], "Input",\

 InitializationCell->True],

Cell["\<\
deg0or1Q[  ]   returns  True  if all its arguments are of degree 0 or 1,  and \
return  False  otherwise,\
\>", "Text",
 CellChangeTimes->{{3.615084985729064*^9, 3.615085151906172*^9}, {
  3.615085291458853*^9, 3.615085292520232*^9}, {3.616535056084777*^9, 
  3.6165351097968903`*^9}, {3.649617288812046*^9, 3.64961729842815*^9}}],

Cell[BoxData[
 RowBox[{"SetAttributes", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Same0or1Q", ",", "deg0or1Q"}], "}"}], ",", "Listable"}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527655091627439*^9, 3.5276551034960947`*^9}, 
   3.6152620032721643`*^9, 3.623167533775874*^9, {3.6500758956932364`*^9, 
   3.650075928604269*^9}, {3.650076111001854*^9, 3.650076183993395*^9}, {
   3.65007632159232*^9, 3.650076375024057*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Same0or1Q", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"x", "===", "0"}], ")"}], "||", 
   RowBox[{"(", 
    RowBox[{"x", "===", "1"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg0or1Q", "[", "x_", "]"}], ":=", " ", 
  RowBox[{"Same0or1Q", "[", 
   RowBox[{"deg", "[", "x", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg0or1Q", "[", "x__", "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"And", ",", 
    RowBox[{"Map", "[", 
     RowBox[{"Same0or1Q", ",", 
      RowBox[{"deg", "[", 
       RowBox[{"{", "x", "}"}], "]"}]}], "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.616534450548582*^9, 3.616534461719491*^9}, {
  3.616534495048719*^9, 3.6165345094809113`*^9}, {3.61653474753388*^9, 
  3.616534759892728*^9}, {3.6165349859334593`*^9, 3.616534986972889*^9}, {
  3.6496173111853523`*^9, 3.649617326704763*^9}, {3.649617380977565*^9, 
  3.649617391182706*^9}}],

Cell["\<\
deg1or2Q[  ]   returns  True  if all its arguments are of degree 1 or 2,  and \
return  False  otherwise,\
\>", "Text",
 CellChangeTimes->{{3.615084985729064*^9, 3.615085151906172*^9}, {
  3.615085291458853*^9, 3.615085292520232*^9}, {3.616535056084777*^9, 
  3.6165351097968903`*^9}}],

Cell[BoxData[
 RowBox[{"SetAttributes", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Same1or2Q", ",", "deg1or2Q"}], "}"}], ",", "Listable"}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527655091627439*^9, 3.5276551034960947`*^9}, 
   3.6152620032721643`*^9, 3.623167533775874*^9, {3.6500758956932364`*^9, 
   3.650075928604269*^9}, {3.650076111001854*^9, 3.650076183993395*^9}, {
   3.65007632159232*^9, 3.650076392373722*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Same1or2Q", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"x", "===", "2"}], ")"}], "||", 
   RowBox[{"(", 
    RowBox[{"x", "===", "1"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg1or2Q", "[", "x_", "]"}], ":=", " ", 
  RowBox[{"Same1or2Q", "[", 
   RowBox[{"deg", "[", "x", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg1or2Q", "[", "x__", "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"And", ",", 
    RowBox[{"Map", "[", 
     RowBox[{"Same1or2Q", ",", 
      RowBox[{"deg", "[", 
       RowBox[{"{", "x", "}"}], "]"}]}], "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.616534450548582*^9, 3.616534461719491*^9}, {
  3.616534495048719*^9, 3.6165345094809113`*^9}, {3.61653474753388*^9, 
  3.616534759892728*^9}, {3.6165349859334593`*^9, 3.616534986972889*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"a1", ",", "a2", ",", "a3"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{"1", ",", "a1"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"2", ",", "a2"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"3", ",", "a3"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"deg1or2Q", "[", "a1", "]"}], ",", 
   RowBox[{"deg1or2Q", "[", "a3", "]"}], ",", 
   RowBox[{"deg1or2Q", "[", 
    RowBox[{"a1", ",", "a2", ",", "a1"}], "]"}], ",", 
   RowBox[{"deg1or2Q", "[", 
    RowBox[{"a2", ",", "a2", ",", "a2"}], "]"}], ",", 
   RowBox[{"deg1or2Q", "[", 
    RowBox[{"a1", ",", "a2", ",", "a3"}], "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.6165348247772284`*^9, 3.6165348385205507`*^9}, {
  3.616534870152865*^9, 3.6165349703371897`*^9}, {3.6165350082552*^9, 
  3.616535017615608*^9}, {3.650076410218556*^9, 3.650076442969904*^9}}],

Cell[BoxData[
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"a1", ",", "a2", ",", "a3"}], "}"}], "]"}]], "Output",
 CellChangeTimes->{
  3.6165349249682093`*^9, {3.616534972915448*^9, 3.616535019200845*^9}, 
   3.651876615774448*^9}],

Cell[BoxData[
 RowBox[{"NewField", "[", 
  RowBox[{"3", ",", "a3"}], "]"}]], "Output",
 CellChangeTimes->{
  3.6165349249682093`*^9, {3.616534972915448*^9, 3.616535019200845*^9}, 
   3.651876615776155*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "False", ",", "False", ",", "False", ",", "False"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6165349249682093`*^9, {3.616534972915448*^9, 3.616535019200845*^9}, 
   3.651876615778131*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"rev", "[", "x_", "]"}], "]"}], ":=", 
  RowBox[{"deg", "[", "x", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615169547643929*^9, 3.6151695625653877`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", 
    SuperscriptBox["a_", "n_"], "]"}], "/;", 
   RowBox[{"deg0Q", "[", "a", "]"}]}], ":=", "0"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.479721984794182*^9, 3.479721984801263*^9}, {
  3.6148985857892942`*^9, 3.6148986191644087`*^9}}],

Cell["\<\
17/11/2016.  This removed to allow mixed deg tensors as in Clifford algebra, \
\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"x_Plus", "/;", 
    RowBox[{"!", "degChecking"}]}], "]"}], ":=", " ", 
  RowBox[{"deg", "[", 
   RowBox[{"First", "[", "x", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.615261153064006*^9, 3.6152611733690023`*^9}, {
  3.650077079694099*^9, 3.650077092098104*^9}, {3.650077437641625*^9, 
  3.650077437961423*^9}, {3.650078045697297*^9, 3.6500781296484833`*^9}}],

Cell["\<\
If  deg checking, then instead of the above fast defn we check that all terms \
in a sum have the same degree.
It is OK if the degrees are symbolic (not integers), they just have to be the \
same for each term in any sum.
To use mixed degrees as in Clifford algebra, one needs to set  degChecking = \
False,\
\>", "Text",
 CellChangeTimes->{{3.6152621365510883`*^9, 3.615262168503531*^9}, {
  3.650077466934651*^9, 3.650077467286635*^9}, {3.6500791855357237`*^9, 
  3.650079286382165*^9}, {3.650079349149384*^9, 3.65007935086117*^9}, {
  3.6538660694639587`*^9, 3.65386615431141*^9}, {3.653866318517605*^9, 
  3.653866322949374*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"x_Plus", "/;", "degChecking"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "ok", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ok", "=", 
      RowBox[{"Apply", "[", 
       RowBox[{"SameQ", ",", 
        RowBox[{"deg", "[", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "x"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"ok", ",", "\[IndentingNewLine]", 
       RowBox[{"deg", "[", 
        RowBox[{"First", "[", "x", "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<Indeterminate tensor degree. Set degChecking\[VeryThinSpace]\
\[VeryThinSpace]=\[VeryThinSpace]\[VeryThinSpace]False to turn off this \
degree check.\>\"", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
        "Print", "[", 
         "\"\<Output from degCheck[\[VeryThinSpace]_\[VeryThinSpace]] \
follows,\>\"", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"degCheck", "[", "x", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615261213959502*^9, 3.615261388767815*^9}, {
   3.615261428399248*^9, 3.615261448544351*^9}, {3.615261483488619*^9, 
   3.615261591156208*^9}, {3.615261761188892*^9, 3.615261877973033*^9}, {
   3.615261909653598*^9, 3.6152619666142817`*^9}, {3.6152620221665707`*^9, 
   3.615262098708151*^9}, {3.6152625714971113`*^9, 3.6152626404081993`*^9}, {
   3.6152626818649406`*^9, 3.615262715352906*^9}, {3.615262749529326*^9, 
   3.615262895415648*^9}, {3.6152631327934513`*^9, 3.615263181515965*^9}, {
   3.615263241811623*^9, 3.615263286028722*^9}, {3.650077115712138*^9, 
   3.650077143718498*^9}, {3.650077460786543*^9, 3.650077461154317*^9}, {
   3.650079402325592*^9, 3.650079506109352*^9}, {3.650079585940159*^9, 
   3.650079659731604*^9}, {3.650079706679138*^9, 3.650079711330419*^9}, 
   3.6538663976872787`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"degCheck", "[", "x_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "vars", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vars", "=", 
      RowBox[{
       RowBox[{"Variables", "[", "x", "]"}], "//", "Sort"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"vars", ",", 
          RowBox[{"deg", "[", "vars", "]"}]}], "}"}], "//", "Transpose"}], "//",
        "MatrixForm"}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5436507848122*^9, 3.543650847079455*^9}, {
  3.543650894236329*^9, 3.543650902746621*^9}, {3.5436509488004017`*^9, 
  3.543650950000326*^9}, {3.615262976162718*^9, 3.615263013602502*^9}, {
  3.615263210243217*^9, 3.61526321488269*^9}}],

Cell["Examples", "Text",
 CellChangeTimes->{{3.653866604658512*^9, 3.653866612274477*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"X", ",", "Y"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"deg", "[", 
  RowBox[{"X", "+", "Y"}], "]"}]}], "Input",
 CellChangeTimes->{{3.653866448394958*^9, 3.6538664623412743`*^9}, {
  3.6538665905480824`*^9, 3.65386659119071*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Indeterminate tensor degree. Set \
degChecking\[VeryThinSpace]\[VeryThinSpace]=\[VeryThinSpace]\[VeryThinSpace]\
False to turn off this degree check.\"\>"], "Print",
 CellChangeTimes->{3.6538665968593082`*^9}],

Cell[BoxData["\<\"Output from degCheck[\[VeryThinSpace]_\[VeryThinSpace]] \
follows,\"\>"], "Print",
 CellChangeTimes->{3.653866596864201*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"X", 
      RowBox[{"deg", "[", "X", "]"}]},
     {"Y", 
      RowBox[{"deg", "[", "Y", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{3.653866596868959*^9}]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.653866596873114*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "Y", "]"}], "=", 
   RowBox[{"deg", "[", "X", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"deg", "[", 
  RowBox[{"X", "+", "Y"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6538664843091173`*^9, 3.653866504015764*^9}}],

Cell[BoxData[
 RowBox[{"deg", "[", "X", "]"}]], "Output",
 CellChangeTimes->{3.653866505327469*^9, 3.6538665988067627`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "X", "]"}], "=", "2"}], ";", 
  RowBox[{
   RowBox[{"deg", "[", "Y", "]"}], "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"deg", "[", 
  RowBox[{"X", "+", "Y"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "X", "]"}], "=."}], ";", 
  RowBox[{
   RowBox[{"deg", "[", "Y", "]"}], "=."}], ";"}]}], "Input",
 CellChangeTimes->{{3.6152622948804827`*^9, 3.615262300874963*^9}, {
  3.615263535262875*^9, 3.61526355348885*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Indeterminate tensor degree. Set \
degChecking\[VeryThinSpace]\[VeryThinSpace]=\[VeryThinSpace]\[VeryThinSpace]\
False to turn off this degree check.\"\>"], "Print",
 CellChangeTimes->{
  3.650079303070417*^9, {3.65007951071516*^9, 3.650079516620029*^9}, 
   3.650079575237075*^9, 3.6500796250999804`*^9, 3.6500796635624247`*^9, 
   3.650079715870573*^9, 3.6518766159629707`*^9, 3.6538665826809072`*^9}],

Cell[BoxData["\<\"Output from degCheck[\[VeryThinSpace]_\[VeryThinSpace]] \
follows,\"\>"], "Print",
 CellChangeTimes->{
  3.650079303070417*^9, {3.65007951071516*^9, 3.650079516620029*^9}, 
   3.650079575237075*^9, 3.6500796250999804`*^9, 3.6500796635624247`*^9, 
   3.650079715870573*^9, 3.6518766159629707`*^9, 3.653866582686236*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"X", "2"},
     {"Y", "3"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.650079303070417*^9, {3.65007951071516*^9, 3.650079516620029*^9}, 
   3.650079575237075*^9, 3.6500796250999804`*^9, 3.6500796635624247`*^9, 
   3.650079715870573*^9, 3.6518766159629707`*^9, 3.653866582690894*^9}]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.615262702135935*^9, 3.615262718902026*^9}, {
   3.615262878900503*^9, 3.61526288128721*^9}, 3.615263186491992*^9, {
   3.6152632278841257`*^9, 3.615263289576076*^9}, 3.61526356805352*^9, 
   3.6152720320077143`*^9, 3.6152721665165863`*^9, 3.6500793031466637`*^9, {
   3.650079510757533*^9, 3.650079516659923*^9}, 3.6500795752474318`*^9, 
   3.6500796251098623`*^9, 3.650079663600197*^9, 3.65007971590578*^9, 
   3.651876615968731*^9, 3.653866582695408*^9}]
}, Open  ]],

Cell["\<\
These 2 rules can be needed when using Wedge with tensors of unspecified \
degree, where numerical factors like  deg[X] !  arise,\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"deg", "[", "_", "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{
    RowBox[{"_", "?", "deg0Q"}], "!"}], "]"}], ":=", "0"}]}], "Input",
 InitializationCell->True],

Cell["The manifold dimension function,", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"dim", "[", "_", "]"}], "]"}], ":=", "0"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"Sin", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"Cos", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"Sec", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"Csc", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"Tan", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"Cot", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"Exp", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"Log", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", "0"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.478637128287327*^9, 3.478637214341505*^9}, {
   3.47863724752233*^9, 3.4786372770192*^9}, {3.479721984979248*^9, 
   3.479721985015045*^9}, {3.480088763339409*^9, 3.480088939295525*^9}, {
   3.480088974199542*^9, 3.480089039020054*^9}, {3.480089071849062*^9, 
   3.480089269218437*^9}, 3.480089332489226*^9, {3.624124572470415*^9, 
   3.624124627390052*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"Sinh", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"Cosh", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"Tanh", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"Coth", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"Sech", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"Csch", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", "0"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.498683965234375*^9, 3.49868409271875*^9}, {
  3.624124608957576*^9, 3.624124636761323*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"ArcSin", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"ArcCos", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"ArcSec", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"ArcCsc", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"ArcTan", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"ArcCot", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", "0"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.478637128287327*^9, 3.478637214341505*^9}, {
   3.47863724752233*^9, 3.4786372770192*^9}, {3.479721984979248*^9, 
   3.479721985015045*^9}, {3.480088763339409*^9, 3.480088939295525*^9}, {
   3.480088974199542*^9, 3.480089039020054*^9}, {3.480089071849062*^9, 
   3.480089269218437*^9}, 3.480089332489226*^9, {3.624124572470415*^9, 
   3.624124627390052*^9}, {3.624124736666342*^9, 3.624124748242906*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"ArcSinh", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"ArcCosh", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"ArcTanh", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"ArcCoth", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"ArcSech", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"ArcCsch", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", "0"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.498683965234375*^9, 3.49868409271875*^9}, {
  3.624124608957576*^9, 3.624124636761323*^9}, {3.624124749790613*^9, 
  3.624124753683743*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"Floor", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"Ceiling", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", "0"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6241247682437162`*^9, 3.624124799129911*^9}, 
   3.624124832938113*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"Sign", "[", "_", "]"}], "]"}], ":=", "0"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"Abs", "[", 
    RowBox[{"f_", "?", "deg0Q"}], "]"}], "]"}], ":=", "0"}]], "Input",
 InitializationCell->True],

Cell["This is for integrals that remain un-evaluated....", "Text",
 CellChangeTimes->{{3.480092246341914*^9, 3.480092291110132*^9}, {
  3.482059464090933*^9, 3.482059498538267*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"X_", "?", "deg0Q"}], ",", "__"}], "]"}], "]"}], ":=", 
  RowBox[{"deg", "[", "X", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.624124665032166*^9}],

Cell["\<\
Could just apply to  Normal[x],  but this is quicker. Assume that SeriesData \
have self-consistent degree (since they are rarely put together by hand).
So we can return the degree of the first term in the series (if there is \
one),  \
\>", "Text",
 CellChangeTimes->{{3.480092246341914*^9, 3.480092291110132*^9}, {
  3.482059464090933*^9, 3.482059498538267*^9}, {3.527655058613555*^9, 
  3.527655088036543*^9}, {3.5426089053951063`*^9, 3.542608914529841*^9}, {
  3.542609282164331*^9, 3.542609292867114*^9}, {3.542610133528063*^9, 
  3.542610175847869*^9}, {3.54261022695577*^9, 3.5426102569059973`*^9}, {
  3.542622207091943*^9, 3.542622225329011*^9}, {3.6104983967788887`*^9, 
  3.6104984326507797`*^9}, {3.610498557516143*^9, 3.610498603499835*^9}, {
  3.610498937342149*^9, 3.610499073806938*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", "X_SeriesData", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "===", 
     RowBox[{"{", "}"}]}], ",", "0", ",", 
    RowBox[{"deg", "[", 
     RowBox[{"X", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.542608928250407*^9, 3.5426089348411093`*^9}, {
  3.542610180733674*^9, 3.542610189550116*^9}, {3.610498361040793*^9, 
  3.610498369873992*^9}, {3.610498468625128*^9, 3.610498474003042*^9}, {
  3.61049876885281*^9, 3.61049879002486*^9}, {3.610498896041567*^9, 
  3.610498933179253*^9}, {3.610499183229694*^9, 3.610499184700618*^9}}],

Cell["\<\
This should not be needed if   pD[ ]  is used in preference to  D[ ] ,\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Derivative", "[", "__", "]"}], "[", "f_", "]"}], "[", "__", 
    "]"}], "]"}], ":=", 
  RowBox[{"deg", "[", "f", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649816004854231*^9, 3.649816034188846*^9}, {
  3.649816145475143*^9, 3.649816148691288*^9}}],

Cell["\<\
However,  Derivative[ ][ ]   (without the  3rd [ ] )  is still useful as \
prime notation for unevaluated  \[GothicCapitalD][ ]  when manipulating \
equations using  Eqn[ ],\
\>", "Text",
 CellChangeTimes->{{3.6498162466572323`*^9, 3.64981635627236*^9}, {
  3.6502244638248587`*^9, 3.6502245051528883`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{
    RowBox[{"Derivative", "[", "__", "]"}], "[", "f_", "]"}], "]"}], ":=", 
  RowBox[{"deg", "[", "f", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649816004854231*^9, 3.649816034188846*^9}, 
   3.649816113028619*^9, {3.64981614397095*^9, 3.649816157475172*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Declarations :   NewConstant[  ] ,  NewField[  ],   ClearField[  ] \
\>", "Subsection",
 CellChangeTimes->{{3.467119314622471*^9, 3.467119352821146*^9}, {
  3.467370985602835*^9, 3.46737099050696*^9}, {3.478969712456913*^9, 
  3.47896975380715*^9}, {3.479402682149652*^9, 3.479402686548678*^9}, {
  3.6157640291911497`*^9, 3.6157640665185823`*^9}, {3.6553485273699303`*^9, 
  3.655348543593919*^9}, {3.6554041743682404`*^9, 3.655404229615135*^9}}],

Cell["Maintain lists of the declared fields and constants,", "Text",
 CellChangeTimes->{{3.653787358710753*^9, 3.6537874237181253`*^9}, {
  3.655346293875269*^9, 3.6553462962913322`*^9}, {3.655346852796885*^9, 
  3.65534690636552*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$ListOfFields", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$ListOfConstants", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListOfFields", "[", "]"}], ":=", 
  "$ListOfFields"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListOfConstants", "[", "]"}], ":=", "$ListOfConstants"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.653770309470139*^9, 3.653770332550654*^9}, {
  3.653770428405614*^9, 3.6537704426409388`*^9}, {3.653770484101264*^9, 
  3.653770531588397*^9}}],

Cell["\<\
If given an argument  M,  then  ListOfFields[ ]   and   ListOfConstants[  ]   \
will return only this fields/constants matching M.
M would typically be a manifold name, but could be any symbol to search for,\
\>", "Text",
 CellChangeTimes->{{3.653770918830488*^9, 3.6537709635343313`*^9}, {
  3.655404268879159*^9, 3.6554044130691223`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ListOfFields", "[", "M_", "]"}], ":=", " ", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"ListOfFields", "[", "]"}], ",", "M", ",", "Infinity"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListOfConstants", "[", "M_", "]"}], ":=", " ", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"ListOfConstants", "[", "]"}], ",", "M", ",", "Infinity"}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6537705994916983`*^9, 3.65377060608365*^9}, {
  3.6537706588669024`*^9, 3.653770661586958*^9}, {3.653770745345969*^9, 
  3.653770771729371*^9}, {3.653770866672414*^9, 3.6537709088641872`*^9}}],

Cell["NewConstant[ ]", "Text",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.655393851051244*^9, 3.65539390710576*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "NewConstant", "]"}], "=", 
   RowBox[{"{", "HoldAll", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"NewConstant", "[", 
   RowBox[{"c_", "/;", 
    RowBox[{"!", 
     RowBox[{
      RowBox[{"Head", "[", "c", "]"}], "===", "List"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ans", ",", "message"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", " ", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"AnyThingAtAll", ",", "c"}], "]"}], ",", 
       RowBox[{
       "Return", "[", 
        "\"\<Error: The identifier matches an arbitrary name.\>\"", " ", 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ValueQ", "[", 
         RowBox[{"deg", "[", "c", "]"}], "]"}], "||", 
        RowBox[{"ValueQ", "[", "c", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"message", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ValueQ", "[", "c", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<Identifier  \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Unevaluated", "[", "c", "]"}], "]"}], "<>", 
            "\"\<  is already in use (has a value).\\n\>\""}], ",", 
           "\"\<\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"message", "=", 
         RowBox[{"message", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ValueQ", "[", 
              RowBox[{"deg", "[", "c", "]"}], "]"}], "&&", 
             RowBox[{"!", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"deg", "[", "c", "]"}], "===", "0"}], ")"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<Identifier  \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Unevaluated", "[", "c", "]"}], "]"}], "<>", 
             "\"\<  is defined as a tensor field.\\n\>\"", "<>", 
             "\[IndentingNewLine]", "\"\<Currently  deg[ \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Unevaluated", "[", "c", "]"}], "]"}], "<>", 
             "\"\< ] = \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Short", "[", 
               RowBox[{"deg", "[", "c", "]"}], "]"}], "]"}], "<>", 
             "\"\<.\\n\\n\>\""}], ",", "\"\<\>\""}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"message", "=", 
         RowBox[{"message", "<>", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Del]", "c"}], "===", "0"}], ")"}], ",", 
            RowBox[{"\"\<Identifier  \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"Unevaluated", "[", "c", "]"}], "]"}], "<>", 
             "\"\<  is already defined as a constant.\\n\\n\>\""}], ",", 
            "\"\<\>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"message", "=", 
         RowBox[{"message", "<>", "\"\<To re-defined  \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Unevaluated", "[", "c", "]"}], "]"}], "<>", 
          "\"\<  as a constant, click OK.\\n\\n\>\""}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"message", "=", 
         RowBox[{
         "message", "<>", 
          "\"\<ClearField[ ] can be used to avoid this dialog.\>\""}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ans", "=", 
         RowBox[{"ChoiceDialog", "[", "message", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "ans"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Cancelled in dialog: No changes made to \>\"", ",", 
             RowBox[{"Unevaluated", "[", "c", "]"}], ",", "\"\<.\>\""}], 
            "]"}], ";", 
           RowBox[{"Return", "[", "]"}]}]}], "]"}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ValueQ", "[", 
        RowBox[{"Unevaluated", "[", "c", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Unevaluated", "[", "c", "]"}], "=."}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ClearField", "[", 
      RowBox[{"Unevaluated", "[", "c", "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FieldType", "[", "c", "]"}], "=", "\"\<constant\>\""}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "c", "]"}], "===", "Symbol"}], ",", "c", ",", 
         RowBox[{"Head", "[", "c", "]"}]}], "]"}], "]"}], "/:", 
      RowBox[{"deg", "[", "c", "]"}], "=", "0"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"\[Del]", "c"}], "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[GothicCapitalD]", "[", "c", "]"}], "=", "0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pD", "[", 
       RowBox[{"c", ",", "__"}], "]"}], "=", "0"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ConstantQ", "[", "c", "]"}], "=", "True"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"$ListOfConstants", ",", "c"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True],

Cell["\<\
If given a list of constants to declare, apply NewConstant to each,\
\>", "Text",
 CellChangeTimes->{{3.611196655902635*^9, 3.611196745051897*^9}, {
  3.61120319333634*^9, 3.61120319839144*^9}, {3.611204057227689*^9, 
  3.61120406669912*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewConstant", "[", "c_List", "]"}], ":=", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"NewConstant", ",", "c"}], "]"}], ";", "Null"}], 
   ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.611202725147299*^9, 3.611202751839397*^9}, {
  3.611203176370556*^9, 3.611203181362537*^9}, {3.61120407208665*^9, 
  3.611204081078204*^9}, {3.6112043459278393`*^9, 3.611204375284626*^9}}],

Cell[TextData[{
 "NewField[ ]  has both a 2 argument and 3 argument form:\n\n2 argument form: \
  NewField[ {n1,n2,....}, {X1,X2,...} ]   declares the  Xi  to be sections of \
the tensor bundle  { M,  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["T", "\[VeryThinSpace]"], 
     RowBox[{
      SuperscriptBox["M", 
       RowBox[{"\[CircleTimes]", "n1"}]], "\[CircleTimes]", 
      SuperscriptBox["T", 
       RowBox[{" ", "*"}]]}], 
     RowBox[{
      SuperscriptBox["M", 
       RowBox[{"\[CircleTimes]", "n2"}]], "\[CircleTimes]"}]}], "..."}], 
   TraditionalForm]]],
 " }  (alternating, tangent, cotangent factors)\n                             \
   where  M = Manifold[ ]  is the base.\n                                \n3 \
argument form:   NewField[ M, { {V1,n1}, {V2,n2},....}, {X1,X2,...} ]   \
declares the  Xi  to be sections of the tensor bundle  { M,  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["V1", 
      RowBox[{"\[CircleTimes]", "n1"}]], "\[CircleTimes]", 
     SuperscriptBox["V2", 
      RowBox[{"\[CircleTimes]", "n2"}]], "\[CircleTimes]"}], "..."}], 
   TraditionalForm]]],
 " }  where  M  is the base."
}], "Text",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.655392306005652*^9, 3.6553923576694527`*^9}, {
  3.655392459827673*^9, 3.655392969133479*^9}, {3.655404474556333*^9, 
  3.655404480364357*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"NewField", "[", 
    RowBox[{"n_Integer", ",", "X_"}], "]"}], ":=", 
   RowBox[{
   "Print", "[", 
    "\"\<The first argument should be a list of integers if 2 arguments are \
given, \nor a Manifold identifier if 3 arguments are given.  See: ? NewField  \
for more information.\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.655393062381822*^9, 3.65539312809135*^9}, 
   3.655393175706785*^9, {3.655393223674472*^9, 3.655393241193891*^9}, {
   3.655393286537318*^9, 3.6553933570165987`*^9}, {3.655393493575075*^9, 
   3.655393657444927*^9}, {3.655393700820587*^9, 3.655393767227591*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NewField", "[", 
  RowBox[{"3", ",", "X"}], "]"}]], "Input",
 CellChangeTimes->{{3.655393420279807*^9, 3.65539342311162*^9}}],

Cell[BoxData["\<\"The first argument should be a list of integers if 2 \
arguments are given, \\nor a Manifold identifier if 3 arguments are given.  \
See: ? NewField  for more information.\"\>"], "Print",
 CellChangeTimes->{
  3.655393435815682*^9, 3.6553934758559303`*^9, {3.6553935799395103`*^9, 
   3.65539360754523*^9}, 3.655393677515216*^9, 3.655393731717572*^9, 
   3.655393773204269*^9}]
}, Open  ]],

Cell["\<\
Arguments:    base  ---  a manifold identifier
                        total   ---  a specification for the total space:    \
{ {V1,n1}, {V2,n2},....}\
\>", "Text",
 CellChangeTimes->{{3.655394422027605*^9, 3.655394511715412*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "NewField", "]"}]], "Input",
 CellChangeTimes->{3.656111240080941*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "NewField", "]"}], "=", 
   RowBox[{"{", "HoldAll", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{"base_", ",", "total_", ",", 
    RowBox[{"f_", "/;", 
     RowBox[{"!", 
      RowBox[{
       RowBox[{"Head", "[", "f", "]"}], "===", "List"}]}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", ",", "ans", ",", "message", ",", "r", ",", "msg"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", " ", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"AnyThingAtAll", ",", "f"}], "]"}], ",", 
       RowBox[{
       "Return", "[", 
        "\"\<Error: The identifier matches an arbitrary name.\>\"", " ", 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ValueQ", "[", 
         RowBox[{"deg", "[", "f", "]"}], "]"}], "||", 
        RowBox[{"ValueQ", "[", "f", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"message", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ValueQ", "[", "f", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<The identifier  \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Unevaluated", "[", "f", "]"}], "]"}], "<>", 
            "\"\<  is already in use (has a value).\\n\>\""}], ",", 
           RowBox[{"\"\<The identifier  \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"Unevaluated", "[", "f", "]"}], "]"}], "<>", 
            "\"\<  is already in use.\\n\>\""}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"message", "=", 
         RowBox[{"message", "<>", "\"\<Currently  deg[ \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Unevaluated", "[", "f", "]"}], "]"}], "<>", 
          "\"\< ] = \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Short", "[", 
            RowBox[{"deg", "[", "f", "]"}], "]"}], "]"}], "<>", 
          "\"\<.\\n\\n\>\"", "<>", "\"\<To re-defined  \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"Unevaluated", "[", "f", "]"}], "]"}], "<>", 
          "\"\<  click OK.\>\""}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"message", "=", 
         RowBox[{
         "message", "<>", "\"\<\\n\\n\>\"", "<>", 
          "\"\<ClearField[ ] can be used to avoid this dialog.\>\""}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ans", "=", 
         RowBox[{"ChoiceDialog", "[", "message", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", "ans"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Cancelled in dialog: No changes made to \>\"", ",", 
             RowBox[{"Unevaluated", "[", "f", "]"}], ",", "\"\<.\>\""}], 
            "]"}], ";", 
           RowBox[{"Return", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ValueQ", "[", 
        RowBox[{"Unevaluated", "[", "f", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Unevaluated", "[", "f", "]"}], "=."}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ClearField", "[", 
      RowBox[{"Unevaluated", "[", "f", "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "f", "]"}], "===", "Symbol"}], ",", "f", ",", 
         RowBox[{"Head", "[", "f", "]"}]}], "]"}], "]"}], "/:", 
      RowBox[{"deg", "[", "f", "]"}], "=", 
      RowBox[{"Total", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", "total"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FieldQ", "[", "f", "]"}], "=", "True"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SlotType", "[", "f", "]"}], "=", 
      RowBox[{"Apply", "[", 
       RowBox[{"SlotData", ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "]"}], "&"}], ",", 
           "total"}], "]"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FieldType", "[", "f", "]"}], "=", 
      RowBox[{"{", 
       RowBox[{"base", ",", "total"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"$ListOfFields", ",", 
       RowBox[{"{", 
        RowBox[{"f", ",", 
         RowBox[{"FieldType", "[", "f", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"msg", " ", "=", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{
        "f", ",", "\"\< is a section of the tensor bundle \>\"", ",", " ", 
         RowBox[{"ProductSpace", "[", "total", "]"}], ",", "\"\< over \>\"", 
         ",", "base", ",", "\"\<.\>\""}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"total", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cotangent", "[", "base", "]"}], ",", "1"}], "}"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"msg", "=", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "f", ",", "\"\< is a section of the cotangent bundle \>\"", ",", 
           " ", 
           RowBox[{"ProductSpace", "[", "total", "]"}], ",", "\"\<.\>\""}], 
          "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"total", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Tangent", "[", "base", "]"}], ",", "1"}], "}"}], "}"}]}],
         "]"}], ",", 
       RowBox[{"msg", "=", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "f", ",", "\"\< is a section of the tangent bundle \>\"", ",", " ", 
           
           RowBox[{"ProductSpace", "[", "total", "]"}], ",", "\"\<.\>\""}], 
          "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"total", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Tangent", "[", "base", "]"}], ",", "0"}], "}"}], "}"}]}],
         "]"}], ",", 
       RowBox[{"msg", "=", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
          "f", ",", "\"\< is a scalar field on \>\"", ",", "base", ",", 
           "\"\<.\>\""}], "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]",
      "msg"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True],

Cell["\<\
If given a list of field names to declare, apply NewField to each,\
\>", "Text",
 CellChangeTimes->{{3.611196655902635*^9, 3.611196745051897*^9}, {
  3.61120319333634*^9, 3.61120319839144*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{"base_", ",", "total_", ",", "f_List"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"msg", ",", "f1"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NewField", "[", 
         RowBox[{"base", ",", "total", ",", "#"}], "]"}], "&"}], ",", "f"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "f", "]"}], "===", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f1", "=", 
         RowBox[{"First", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"msg", " ", "=", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
           "f", ",", "\"\< is a section of the tensor bundle \>\"", ",", " ", 
            
            RowBox[{"ProductSpace", "[", "total", "]"}], ",", 
            "\"\< over \>\"", ",", "base", ",", "\"\<.\>\""}], "}"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"total", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cotangent", "[", "base", "]"}], ",", "1"}], "}"}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"msg", "=", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
             "f1", ",", "\"\< is a section of the cotangent bundle \>\"", ",",
               " ", 
              RowBox[{"ProductSpace", "[", "total", "]"}], ",", "\"\<.\>\""}],
              "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"total", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Tangent", "[", "base", "]"}], ",", "1"}], "}"}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"msg", "=", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
             "f1", ",", "\"\< is a section of the tangent bundle \>\"", ",", 
              " ", 
              RowBox[{"ProductSpace", "[", "total", "]"}], ",", "\"\<.\>\""}],
              "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"total", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Tangent", "[", "base", "]"}], ",", "0"}], "}"}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"msg", "=", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
             "f1", ",", "\"\< is a scalar field on \>\"", ",", "base", ",", 
              "\"\<.\>\""}], "}"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]",
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"msg", " ", "=", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
           "f", ",", "\"\< are declared sections of the tensor bundle \>\"", 
            ",", " ", 
            RowBox[{"ProductSpace", "[", "total", "]"}], ",", 
            "\"\< over \>\"", ",", "base", ",", "\"\<.\>\""}], "}"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"total", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cotangent", "[", "base", "]"}], ",", "1"}], "}"}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"msg", "=", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
             "f", ",", "\"\< are sections of the cotangent bundle \>\"", ",", 
              " ", 
              RowBox[{"ProductSpace", "[", "total", "]"}], ",", "\"\<.\>\""}],
              "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"total", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Tangent", "[", "base", "]"}], ",", "1"}], "}"}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"msg", "=", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
             "f", ",", "\"\< are sections of the tangent bundle \>\"", ",", 
              " ", 
              RowBox[{"ProductSpace", "[", "total", "]"}], ",", "\"\<.\>\""}],
              "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"total", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Tangent", "[", "base", "]"}], ",", "0"}], "}"}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"msg", "=", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
             "f", ",", "\"\< are scalar fields on \>\"", ",", "base", ",", 
              "\"\<.\>\""}], "}"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "msg"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.611202725147299*^9, 3.611202751839397*^9}, {
   3.611203176370556*^9, 3.611203181362537*^9}, {3.653790023591318*^9, 
   3.65379002931882*^9}, {3.655404856567514*^9, 3.655404895623008*^9}, {
   3.6554049263107023`*^9, 3.655404955142125*^9}, {3.6554211923171997`*^9, 
   3.655421322415614*^9}, {3.655662216831526*^9, 3.655662218591299*^9}, {
   3.68101593735611*^9, 3.681015938905981*^9}, 3.681015992603689*^9, {
   3.68101603300161*^9, 3.6810161316263437`*^9}, {3.6810162415289087`*^9, 
   3.681016267784402*^9}, {3.681016352247262*^9, 3.681016376855337*^9}, {
   3.681016436950244*^9, 3.681016501013398*^9}}],

Cell["The abreviated 2 argument form,", "Text",
 CellChangeTimes->{{3.655404574138914*^9, 3.655404584010806*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{"n_List", ",", "f_"}], "]"}], ":=", 
  RowBox[{"NewField", "[", 
   RowBox[{
    RowBox[{"Manifold", "[", "]"}], ",", 
    RowBox[{"TotalSpace", "[", "n", "]"}], ",", "f"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.65540459037895*^9, 3.655404651817919*^9}, {
   3.655404755160717*^9, 3.655404755784719*^9}, 3.655405055860875*^9, {
   3.6554169889749527`*^9, 3.655417093117442*^9}, {3.655417137181131*^9, 
   3.655417236836401*^9}, {3.6554174610811872`*^9, 3.655417466041059*^9}, {
   3.65541763140053*^9, 3.655417634279228*^9}, {3.655417679402215*^9, 
   3.6554177157980947`*^9}, {3.655417969987262*^9, 3.655418008582274*^9}, {
   3.6554180766422043`*^9, 3.655418228240233*^9}, {3.655418327711198*^9, 
   3.655418360526641*^9}, {3.6554186677715797`*^9, 3.655418669310266*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"X0", ",", "X1", ",", "X2", ",", "X3", ",", "X4"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", "X0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", "X1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", "X2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", "X3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.655419893008686*^9, 3.655419984427352*^9}}],

Cell[BoxData[
 TemplateBox[{"X0","\" is a scalar field on \"","\"M\"","\".\""},
  "RowDefault"]], "Output",
 CellChangeTimes->{
  3.655419986560364*^9, 3.6554867253848257`*^9, {3.6554868469823103`*^9, 
   3.655486859462957*^9}, 3.655486895035767*^9, 3.655487013020813*^9}],

Cell[BoxData[
 TemplateBox[{
  "X1","\" is a section of the tangent bundle \"",
   RowBox[{"\"T\"", "[", "\"M\"", "]"}],"\".\""},
  "RowDefault"]], "Output",
 CellChangeTimes->{
  3.655419986560364*^9, 3.6554867253848257`*^9, {3.6554868469823103`*^9, 
   3.655486859462957*^9}, 3.655486895035767*^9, 3.6554870130403357`*^9}],

Cell[BoxData[
 TemplateBox[{
  "X2","\" is a section of the cotangent bundle \"",
   RowBox[{"\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"", "[", "\"M\"", 
     "]"}],"\".\""},
  "RowDefault"]], "Output",
 CellChangeTimes->{
  3.655419986560364*^9, 3.6554867253848257`*^9, {3.6554868469823103`*^9, 
   3.655486859462957*^9}, 3.655486895035767*^9, 3.6554870130573072`*^9}],

Cell[BoxData[
 TemplateBox[{"X3","\" is a section of the tensor bundle \"",RowBox[{
     RowBox[{"\"T\"", "[", "\"M\"", "]"}], "\[CircleTimes]", 
     SuperscriptBox[
      RowBox[{
       "\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"", "[", "\"M\"", 
        "]"}], "\"\[VeryThinSpace]\[CircleTimes]2\""], "\[CircleTimes]", 
     SuperscriptBox[
      RowBox[{"\"T\"", "[", "\"M\"", "]"}], 
      "\"\[VeryThinSpace]\[CircleTimes]3\""]}],"\" over \"","\"M\"","\".\""},
  "RowDefault"]], "Output",
 CellChangeTimes->{
  3.655419986560364*^9, 3.6554867253848257`*^9, {3.6554868469823103`*^9, 
   3.655486859462957*^9}, 3.655486895035767*^9, 3.655487013072577*^9}]
}, Open  ]],

Cell["Depreciated form of usage:  integer 1st argument,", "Text",
 CellChangeTimes->{{3.655535141476969*^9, 3.655535181556753*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{"n_Integer", ",", "f_"}], "]"}], ":=", 
  RowBox[{"NewField", "[", 
   RowBox[{
    RowBox[{"{", "n", "}"}], ",", "f"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.65540459037895*^9, 3.655404651817919*^9}, {
   3.655404755160717*^9, 3.655404755784719*^9}, 3.655405055860875*^9, {
   3.6554169889749527`*^9, 3.655417093117442*^9}, {3.655417137181131*^9, 
   3.655417236836401*^9}, {3.6554174610811872`*^9, 3.655417466041059*^9}, {
   3.65541763140053*^9, 3.655417634279228*^9}, {3.655417679402215*^9, 
   3.6554177157980947`*^9}, {3.655417969987262*^9, 3.655418008582274*^9}, {
   3.6554180766422043`*^9, 3.655418228240233*^9}, {3.655418327711198*^9, 
   3.655418360526641*^9}, {3.6554186677715797`*^9, 3.655418669310266*^9}, {
   3.655535189876598*^9, 3.655535222899901*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FieldType", "[", "X3", "]"}]], "Input",
 CellChangeTimes->{{3.6554871506449966`*^9, 3.65548715155764*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"M\"\>", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
        "[", "\<\"M\"\>", "]"}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", "3"}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.655487153133753*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SlotType", "[", "X3", "]"}]], "Input",
 CellChangeTimes->{{3.655487089182078*^9, 3.65548711059768*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
    "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
    "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6554871119169903`*^9}]
}, Open  ]],

Cell["\<\
Is this useful?  A one argument form to declare an arbirtary-type (hence \
arbitrary-deg) tensor field, \
\>", "Text",
 CellChangeTimes->{{3.653964087701949*^9, 3.653964170805085*^9}, {
  3.655393942337368*^9, 3.655393946601515*^9}, {3.655408939492199*^9, 
  3.655408949572196*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{"f_", "/;", 
    RowBox[{"!", 
     RowBox[{
      RowBox[{"Head", "[", "f", "]"}], "===", "List"}]}]}], "]"}], ":=", 
  RowBox[{"NewField", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "f"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.653965219722931*^9, 3.653965240475109*^9}}],

Cell["ClearField[ ]", "Text",
 CellFrame->{{0, 0}, {0, 0.5}},
 CellChangeTimes->{{3.6553939774087353`*^9, 3.655393981888742*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Attributes", "[", "ClearField", "]"}], "=", 
   RowBox[{"{", "HoldAll", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearField", "[", 
   RowBox[{"f_", "/;", 
    RowBox[{"!", 
     RowBox[{
      RowBox[{"Head", "[", "f", "]"}], "===", "List"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", " ", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"AnyThingAtAll", ",", "f"}], "]"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<Error: The identifier matches an arbitrary symbol. Maybe \
subscript-underscore miss-typed as underscore?\>\"", " ", "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ValueQ", "[", "f", "]"}], ",", 
       RowBox[{"f", "=."}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Quiet", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ValueQ", "[", 
         RowBox[{"deg", "[", "f", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"deg", "[", "f", "]"}], "=."}]}], "]"}], "]"}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ValueQ", "[", 
        RowBox[{"deg", "[", "f", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "f", "]"}], "===", "Symbol"}], ",", "f", ",", 
           RowBox[{"Head", "[", "f", "]"}]}], "]"}], "]"}], "/:", 
        RowBox[{"deg", "[", "f", "]"}], "=."}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ValueQ", "[", 
        RowBox[{"\[Del]", "f"}], "]"}], ",", 
       RowBox[{
        RowBox[{"\[Del]", "f"}], "=."}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ValueQ", "[", 
        RowBox[{"\[GothicCapitalD]", "[", "f", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"\[GothicCapitalD]", "[", "f", "]"}], "=."}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ValueQ", "[", 
        RowBox[{"pD", "[", 
         RowBox[{"f", ",", "__"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"pD", "[", 
         RowBox[{"f", ",", "__"}], "]"}], "=."}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ForgetAssumeSymmetric", "[", "f", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ForgetAssumeAntisymmetric", "[", "f", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Quiet", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"FieldQ", "[", "f", "]"}], "=."}], ";", 
        RowBox[{
         RowBox[{"ConstantQ", "[", "f", "]"}], "=."}], ";"}], ")"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"$ListOfConstants", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"$ListOfConstants", ",", "f"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$ListOfFields", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"$ListOfFields", ",", "f"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Quiet", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"FieldType", "[", "f", "]"}], "=."}], ";"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Quiet", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SlotType", "[", "f", "]"}], "=."}], ";"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True],

Cell["\<\
The above unset on   pD[f,__]  will only unset that general value, ie., for \
the case that one had done  pD[f,__] :=0.  It wont unset specific values.
If values for  pD[ f, x ]   are to be defined, then it is best to use    f /: \
 pD[ f , x ]  =  rhs ,   because then  ClearField[ f ]   will also clear \
these pD[ ] values (using  Clear[ f ] in the last line) .
And  f /:   will only work if f is a symbol, not wrapped in something like \
Subscript.\
\>", "Text",
 CellChangeTimes->{{3.649823433248972*^9, 3.649823577135273*^9}, {
  3.649840232019291*^9, 3.6498404050241737`*^9}, {3.650225908555825*^9, 
  3.650226006666438*^9}, {3.650226070618021*^9, 3.650226171863965*^9}, {
  3.653771432504376*^9, 3.653771442856309*^9}}],

Cell["\<\
If given a list of field names to clear, apply ClearField to each. The Hold \
is necessary to clear a field that has been given a value.  Usually, fields
that are declared are not given values, and doing so can be inconsistent. \
However, the name may have been used for something else (eg. a field \
expression)
and just needs to be unset before it can be re-used as a declared field,\
\>", "Text",
 CellChangeTimes->{{3.611196655902635*^9, 3.611196771786965*^9}, 
   3.611203211640396*^9, {3.615765097900366*^9, 3.615765175630534*^9}, {
   3.615765600608285*^9, 3.6157656545341387`*^9}, {3.615765747202087*^9, 
   3.615765877745468*^9}, {3.6157659092982883`*^9, 3.6157660352677717`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearField", "[", "f_List", "]"}], ":=", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"ReleaseHold", "[", 
     RowBox[{"Map", "[", 
      RowBox[{"ClearField", ",", 
       RowBox[{"Hold", "[", "f", "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "]"}], ";"}], ")"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.611196805020252*^9, 3.611196823483238*^9}, {
   3.6112032163809357`*^9, 3.611203227346396*^9}, {3.611204489398465*^9, 
   3.611204496054006*^9}, 3.612231592697653*^9, {3.615096165831626*^9, 
   3.615096172374741*^9}, {3.615765178819704*^9, 3.6157651975242577`*^9}, {
   3.6157652385648317`*^9, 3.615765240228463*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"f", ",", 
   RowBox[{"Hold", "[", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c"}], "}"}], "]"}], ",", 
   RowBox[{"{", "2", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6157642327402983`*^9, 3.6157643003501787`*^9}, {
  3.6157652527962513`*^9, 3.615765261572524*^9}}],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"f", "[", "a", "]"}], ",", 
    RowBox[{"f", "[", "b", "]"}], ",", 
    RowBox[{"f", "[", "c", "]"}]}], "}"}], "]"}]], "Output",
 CellChangeTimes->{{3.6157642503466463`*^9, 3.6157643009007883`*^9}, {
   3.615765249171823*^9, 3.615765262006826*^9}, 3.651876616059579*^9}]
}, Open  ]],

Cell["ClearConstant   is  an alias  for   ClearField ...", "Text",
 CellChangeTimes->{{3.478971175279024*^9, 3.478971204796884*^9}, {
   3.478971253045734*^9, 3.478971305163967*^9}, {3.61509607475298*^9, 
   3.6150960765930634`*^9}, 3.6150961828974257`*^9, 3.615096218161867*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearConstant", "=", "ClearField"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.478970965461688*^9, 3.478970993917647*^9}, {
  3.615096081300933*^9, 3.61509608779663*^9}, {3.615096170090107*^9, 
  3.6150961783746777`*^9}, {3.615096214501647*^9, 3.615096223861074*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["SlotType[ ]", "Subsection",
 CellChangeTimes->{{3.467119314622471*^9, 3.467119352821146*^9}, {
  3.467370985602835*^9, 3.46737099050696*^9}, {3.478969712456913*^9, 
  3.47896975380715*^9}, {3.479402682149652*^9, 3.479402686548678*^9}, {
  3.6157640291911497`*^9, 3.6157640665185823`*^9}, {3.6553485273699303`*^9, 
  3.655348543593919*^9}, {3.6554041743682404`*^9, 3.655404229615135*^9}, {
  3.655591576925708*^9, 3.655591581598984*^9}}],

Cell["\<\
SlotType[ X ]   is assigned within  NewField[ ]  at the time that  X  is \
declared.
Whenever defined,  SlotType[ X ]  returns a  SlotData[  ]  container,  which \
can be thought of as an auto-flat list.  
Using  SlotData[  ],  rather than just returning a list, allows for the \
possibility that  SlotType[ X ]  is not yet defined, but might be later.\
\>", "Text",
 CellChangeTimes->{{3.655591592550161*^9, 3.655591729228012*^9}, {
  3.6555927363194113`*^9, 3.655592744703334*^9}, {3.656107940842455*^9, 
  3.656107964058133*^9}, {3.656108548035185*^9, 3.6561085563548937`*^9}, {
  3.65610972221206*^9, 3.656109726020191*^9}, {3.656109864466517*^9, 
  3.656109865362443*^9}, {3.6561105429218073`*^9, 3.656110618792939*^9}, {
  3.656111011587887*^9, 3.656111012195817*^9}, {3.6561114313426657`*^9, 
  3.65611149050998*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Format", "[", 
   RowBox[{
    RowBox[{"SlotData", "[", "X___", "]"}], ",", "StandardForm"}], "]"}], ":=", 
  RowBox[{"{", "X", "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656197802038928*^9, 3.656197836317355*^9}}],

Cell[BoxData[
 RowBox[{"SetAttributes", "[", 
  RowBox[{"SlotData", ",", "Flat"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656110352316152*^9, 3.656110421451158*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{
   "a1", ",", "a2", ",", "a3", ",", "a4", ",", "a5", ",", "a6", ",", "a7", 
    ",", "a8"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SlotData", "[", 
  RowBox[{"a1", ",", "a2", ",", 
   RowBox[{"SlotData", "[", 
    RowBox[{"a3", ",", "a4", ",", 
     RowBox[{"SlotData", "[", 
      RowBox[{"a5", ",", "a6"}], "]"}]}], "]"}], ",", 
   RowBox[{"SlotData", "[", 
    RowBox[{"a7", ",", "a8"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6561104276792717`*^9, 3.6561104884265213`*^9}, {
  3.656111513965519*^9, 3.656111530413292*^9}}],

Cell[BoxData[
 RowBox[{"SlotData", "[", 
  RowBox[{
  "a1", ",", "a2", ",", "a3", ",", "a4", ",", "a5", ",", "a6", ",", "a7", ",",
    "a8"}], "]"}]], "Output",
 CellChangeTimes->{{3.6561104663070917`*^9, 3.656110489287883*^9}, 
   3.656111533775403*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotType", "[", 
   RowBox[{"X1_", ",", "X2__"}], "]"}], ":=", " ", 
  RowBox[{"Map", "[", 
   RowBox[{"SlotType", ",", 
    RowBox[{"SlotData", "[", 
     RowBox[{"X1", ",", "X2"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6561126804776583`*^9, 3.6561127646197987`*^9}, {
  3.656112822315029*^9, 3.6561128429704638`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotType", "[", "X_CircleTimes", "]"}], ":=", " ", 
  RowBox[{"Map", "[", 
   RowBox[{"SlotType", ",", 
    RowBox[{"Apply", "[", 
     RowBox[{"SlotData", ",", "X"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6555916791268463`*^9, 3.655591687868389*^9}, {
  3.655591733275893*^9, 3.655591843834594*^9}, {3.655592080039977*^9, 
  3.655592113015327*^9}, {3.655592350100375*^9, 3.6555923637641163`*^9}, {
  3.6555925777304373`*^9, 3.655592599777256*^9}, {3.6561088291197233`*^9, 
  3.656108834943095*^9}, {3.656109128811638*^9, 3.656109149227466*^9}, {
  3.656110680168192*^9, 3.656110737479145*^9}}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"X", ",", "Y"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"X", ",", "Y"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6561113292596197`*^9, 3.656111366063768*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SlotType", "[", 
  RowBox[{"X", "\[CircleTimes]", "Y"}], "]"}]], "Input",
 CellChangeTimes->{{3.6561091676270657`*^9, 3.6561091725710573`*^9}, {
  3.656111176225704*^9, 3.6561111797136927`*^9}}],

Cell[BoxData[
 RowBox[{"SlotData", "[", 
  RowBox[{
   RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
    "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
    "[", "\<\"M\"\>", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.6561111804990387`*^9, 3.6561113679633617`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"X", ",", "Y", ",", "Z"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SlotType", "[", 
  RowBox[{"X", "\[CircleTimes]", "Y", "\[CircleTimes]", "Z"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SlotType", "[", 
  RowBox[{"X", "\[CircleTimes]", "Y", "\[CircleTimes]", "Z"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SlotType", "[", 
   RowBox[{"X", "\[CircleTimes]", "Y", "\[CircleTimes]", "Z"}], "]"}], "[", 
  RowBox[{"[", "3", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6555918507465353`*^9, 3.655591890713943*^9}, {
  3.6555922902932577`*^9, 3.655592321668852*^9}, {3.6555927804460487`*^9, 
  3.6555927909834433`*^9}}],

Cell[BoxData[
 RowBox[{"SlotData", "[", 
  RowBox[{
   RowBox[{"SlotType", "[", "X", "]"}], ",", 
   RowBox[{"SlotType", "[", "Y", "]"}], ",", 
   RowBox[{"SlotType", "[", "Z", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.655591868056587*^9, 3.655591892052556*^9}, 
   3.655592026707659*^9, {3.6555921024151897`*^9, 3.655592115745377*^9}, {
   3.6555923132503242`*^9, 3.655592324154529*^9}, {3.655592701972517*^9, 
   3.655592724403933*^9}, 3.65559279224043*^9, 3.6555950681408043`*^9, 
   3.656111655296801*^9}],

Cell[BoxData[
 TemplateBox[{RowBox[{"{", 
     RowBox[{"X", ",", "Y", ",", "Z"}], "}"}],
   "\" are declared sections of the tensor bundle \"",RowBox[{
     RowBox[{"\"T\"", "[", "\"M\"", "]"}], "\[CircleTimes]", 
     RowBox[{
      "\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"", "[", "\"M\"", 
       "]"}]}],"\" over \"","\"M\"","\".\""},
  "RowDefault"]], "Output",
 CellChangeTimes->{{3.655591868056587*^9, 3.655591892052556*^9}, 
   3.655592026707659*^9, {3.6555921024151897`*^9, 3.655592115745377*^9}, {
   3.6555923132503242`*^9, 3.655592324154529*^9}, {3.655592701972517*^9, 
   3.655592724403933*^9}, 3.65559279224043*^9, 3.6555950681408043`*^9, 
   3.656111655300722*^9}],

Cell[BoxData[
 RowBox[{"SlotData", "[", 
  RowBox[{
   RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
    "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
    "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
    "[", "\<\"M\"\>", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.655591868056587*^9, 3.655591892052556*^9}, 
   3.655592026707659*^9, {3.6555921024151897`*^9, 3.655592115745377*^9}, {
   3.6555923132503242`*^9, 3.655592324154529*^9}, {3.655592701972517*^9, 
   3.655592724403933*^9}, 3.65559279224043*^9, 3.6555950681408043`*^9, 
   3.6561116553029737`*^9}],

Cell[BoxData[
 RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}]], "Output",
 CellChangeTimes->{{3.655591868056587*^9, 3.655591892052556*^9}, 
   3.655592026707659*^9, {3.6555921024151897`*^9, 3.655592115745377*^9}, {
   3.6555923132503242`*^9, 3.655592324154529*^9}, {3.655592701972517*^9, 
   3.655592724403933*^9}, 3.65559279224043*^9, 3.6555950681408043`*^9, 
   3.656111655304541*^9}]
}, Open  ]],

Cell["\<\
..... using  eg.,  [[3]]  is not safe if there are tensors with undefined \
type.  First and Last are OK though. 
Need a safe part extraction function: SlotType[ n_Integer, X ] \
\>", "Text",
 CellChangeTimes->{{3.656111779338204*^9, 3.6561119042644367`*^9}}],

Cell["\<\
These are like  Most[ ]  and  Rest[ ]  but will only attempt to do anything \
on  SlotData[ ],  thus leaving unevaluated any argument
that has an undefined  SlotType[ ],\
\>", "Text",
 CellChangeTimes->{{3.656115116466774*^9, 3.656115122402627*^9}, {
  3.656115398255512*^9, 3.656115505564419*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DropFirst", "[", "x_SlotData", "]"}], "/;", 
   RowBox[{"!", 
    RowBox[{
     RowBox[{"Head", "[", 
      RowBox[{"First", "[", "x", "]"}], "]"}], "===", "SlotType"}]}]}], ":=", 
  
  RowBox[{"Rest", "[", "x", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DropLast", "[", "x_SlotData", "]"}], "/;", 
   RowBox[{"!", 
    RowBox[{
     RowBox[{"Head", "[", 
      RowBox[{"Last", "[", "x", "]"}], "]"}], "===", "SlotType"}]}]}], ":=", 
  RowBox[{"Most", "[", "x", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DropFirstAndLast", "[", "x_SlotData", "]"}], "/;", 
   RowBox[{"!", 
    RowBox[{
     RowBox[{"Head", "[", 
      RowBox[{"First", "[", "x", "]"}], "]"}], "===", "SlotType"}]}]}], ":=", 
  
  RowBox[{"DropLast", "[", 
   RowBox[{"Rest", "[", "x", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DropFirstAndLast", "[", "x_SlotData", "]"}], "/;", 
   RowBox[{"!", 
    RowBox[{
     RowBox[{"Head", "[", 
      RowBox[{"Last", "[", "x", "]"}], "]"}], "===", "SlotType"}]}]}], ":=", 
  RowBox[{"DropFirst", "[", 
   RowBox[{"Most", "[", "x", "]"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656114682887271*^9, 3.656114867094715*^9}, {
  3.656115896773528*^9, 3.656115991907577*^9}, {3.6561160844817677`*^9, 
  3.656116170544257*^9}}],

Cell["This was my first attempt (not initialized),", "Text",
 CellChangeTimes->{{3.656115558059277*^9, 3.656115586666873*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SlotType", "[", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X1_", ",", "X2_"}], "\[RightAngleBracket]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"ValueQ", "[", 
     RowBox[{"SlotType", "[", "X1", "]"}], "]"}], "&&", 
    RowBox[{"ValueQ", "[", 
     RowBox[{"SlotType", "[", "X2", "]"}], "]"}]}]}], ":=", 
  RowBox[{"SlotData", "[", 
   RowBox[{
    RowBox[{"Most", "[", 
     RowBox[{"SlotType", "[", "X1", "]"}], "]"}], ",", 
    RowBox[{"Rest", "[", 
     RowBox[{"SlotType", "[", "X2", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.655593916576412*^9, 3.655593943824009*^9}, 
   3.6561119551122837`*^9, {3.6561120044233093`*^9, 3.65611201767105*^9}, {
   3.6561125199209127`*^9, 3.656112546656179*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SlotType", "[", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X1_", ",", "X2__", ",", "X3_"}], "\[RightAngleBracket]"}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"ValueQ", "[", 
     RowBox[{"SlotType", "[", "X1", "]"}], "]"}], "&&", 
    RowBox[{"ValueQ", "[", 
     RowBox[{"SlotType", "[", "X3", "]"}], "]"}], "&&", 
    RowBox[{"Apply", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ValueQ", "[", 
        RowBox[{"SlotType", "[", "#", "]"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"First", "[", 
        RowBox[{"{", "X2", "}"}], "]"}], "}"}]}], "]"}], "&&", 
    RowBox[{"Apply", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ValueQ", "[", 
        RowBox[{"SlotType", "[", "#", "]"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"Last", "[", 
        RowBox[{"{", "X2", "}"}], "]"}], "}"}]}], "]"}]}]}], ":=", 
  RowBox[{"SlotData", "[", 
   RowBox[{
    RowBox[{"Most", "[", 
     RowBox[{"SlotType", "[", "X1", "]"}], "]"}], ",", 
    RowBox[{"Most", "[", 
     RowBox[{"Rest", "[", 
      RowBox[{"SlotType", "[", "X2", "]"}], "]"}], "]"}], ",", 
    RowBox[{"Rest", "[", 
     RowBox[{"SlotType", "[", "X3", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6555916791268463`*^9, 3.655591687868389*^9}, {
   3.655591733275893*^9, 3.655591843834594*^9}, {3.655592080039977*^9, 
   3.655592113015327*^9}, {3.655592350100375*^9, 3.6555923637641163`*^9}, {
   3.6555925777304373`*^9, 3.655592599777256*^9}, {3.6555931546822453`*^9, 
   3.655593181234332*^9}, {3.6555932232412567`*^9, 3.655593274536499*^9}, {
   3.655593393031288*^9, 3.655593526069459*^9}, {3.65559358136353*^9, 
   3.655593585364704*^9}, {3.655593769042522*^9, 3.6555938207376413`*^9}, {
   3.655593881857027*^9, 3.6555939040647163`*^9}, {3.656112130518148*^9, 
   3.6561121469332542`*^9}, 3.656112603420148*^9, {3.656113445215417*^9, 
   3.6561134512634077`*^9}, {3.65611386399192*^9, 3.6561139033035297`*^9}, {
   3.656114063844635*^9, 3.656114086451911*^9}}],

Cell["This should be faster and is more general,", "Text",
 CellChangeTimes->{{3.6561156166823177`*^9, 3.656115629914043*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotType", "[", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X1_", ",", "X2_"}], "\[RightAngleBracket]"}], "]"}], ":=", 
  RowBox[{"SlotData", "[", 
   RowBox[{
    RowBox[{"DropLast", "[", 
     RowBox[{"SlotType", "[", "X1", "]"}], "]"}], ",", 
    RowBox[{"DropFirst", "[", 
     RowBox[{"SlotType", "[", "X2", "]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655593916576412*^9, 3.655593943824009*^9}, 
   3.6561119551122837`*^9, {3.6561120044233093`*^9, 3.65611201767105*^9}, {
   3.6561125199209127`*^9, 3.656112546656179*^9}, {3.656115647609955*^9, 
   3.656115668105383*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotType", "[", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X1_", ",", "X2_", ",", "X3_"}], "\[RightAngleBracket]"}], "]"}], 
  ":=", 
  RowBox[{"SlotData", "[", 
   RowBox[{
    RowBox[{"DropLast", "[", 
     RowBox[{"SlotType", "[", "X1", "]"}], "]"}], ",", 
    RowBox[{"DropFirstAndLast", "[", 
     RowBox[{"SlotType", "[", "X2", "]"}], "]"}], ",", 
    RowBox[{"DropFirst", "[", 
     RowBox[{"SlotType", "[", "X3", "]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655593916576412*^9, 3.655593943824009*^9}, 
   3.6561119551122837`*^9, {3.6561120044233093`*^9, 3.65611201767105*^9}, {
   3.6561125199209127`*^9, 3.656112546656179*^9}, {3.656115647609955*^9, 
   3.656115724456114*^9}, 3.674362202917655*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotType", "[", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X1_", ",", "X2__", ",", "X3_", ",", "X4_"}], 
    "\[RightAngleBracket]"}], "]"}], ":=", 
  RowBox[{"SlotData", "[", 
   RowBox[{
    RowBox[{"DropLast", "[", 
     RowBox[{"SlotType", "[", "X1", "]"}], "]"}], ",", 
    RowBox[{"DropFirstAndLast", "[", 
     RowBox[{"SlotType", "[", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"X2", ",", "X3"}], "\[RightAngleBracket]"}], "]"}], "]"}], ",", 
    RowBox[{"DropFirst", "[", 
     RowBox[{"SlotType", "[", "X4", "]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655593916576412*^9, 3.655593943824009*^9}, 
   3.6561119551122837`*^9, {3.6561120044233093`*^9, 3.65611201767105*^9}, {
   3.6561125199209127`*^9, 3.656112546656179*^9}, {3.656115647609955*^9, 
   3.656115724456114*^9}, {3.6743622561490726`*^9, 3.674362262773094*^9}, {
   3.674362307012328*^9, 3.674362307076083*^9}, {3.674362359219802*^9, 
   3.674362372739587*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SlotType", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6561139536532707`*^9, 3.656113970597897*^9}}],

Cell[BoxData[
 RowBox[{"SlotData", "[", 
  RowBox[{
   RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
    "[", "\<\"M\"\>", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.6561139710469646`*^9, 3.656116379429049*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SlotType", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"X", ",", "W"}], "\[RightAngleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6561139536532707`*^9, 3.656113979941951*^9}, 
   3.656114199026582*^9}],

Cell[BoxData[
 RowBox[{"SlotData", "[", 
  RowBox[{
   RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"DropFirst", "[", 
    RowBox[{"SlotType", "[", "W", "]"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.6561139808717527`*^9, 3.656114103836576*^9, 
  3.656114199786645*^9, 3.6561163829167433`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SlotType", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"W", ",", "X"}], "\[RightAngleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6561139536532707`*^9, 3.656113979941951*^9}, {
  3.656114199026582*^9, 3.656114212657764*^9}}],

Cell[BoxData[
 RowBox[{"SlotData", "[", 
  RowBox[{
   RowBox[{"DropLast", "[", 
    RowBox[{"SlotType", "[", "W", "]"}], "]"}], ",", 
   RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
    "[", "\<\"M\"\>", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.656114213026009*^9, 3.656116389075305*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SlotType", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
   "W"}], "]"}]], "Input",
 CellChangeTimes->{{3.6561139536532707`*^9, 3.656113970597897*^9}, {
  3.6561142697929573`*^9, 3.656114272320838*^9}}],

Cell[BoxData[
 RowBox[{"SlotData", "[", 
  RowBox[{
   RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
    "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"SlotType", "[", "W", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.656114273778564*^9, 3.656116394308115*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SlotType", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
   "X"}], "]"}]], "Input",
 CellChangeTimes->{{3.6561139536532707`*^9, 3.656113970597897*^9}, {
  3.6561142697929573`*^9, 3.656114289136383*^9}}],

Cell[BoxData[
 RowBox[{"SlotData", "[", 
  RowBox[{
   RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
    "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
    "[", "\<\"M\"\>", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.656114289616922*^9, 3.656116992599334*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotType", "[", "X_Plus", "]"}], ":=", 
  RowBox[{"SlotType", "[", 
   RowBox[{"First", "[", "X", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6555940112046137`*^9, 3.655594058414657*^9}}],

Cell["\<\
05/06/2016   Need SlotType for series.  Since we are using First for Plus,do \
likewise for SeriesData, \
\>", "Text",
 CellChangeTimes->{{3.674108293495228*^9, 3.674108367174265*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotType", "[", 
   RowBox[{"X_SeriesData", "/;", 
    RowBox[{"!", 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "===", 
      RowBox[{"{", "}"}]}]}]}], "]"}], ":=", 
  RowBox[{"SlotType", "[", 
   RowBox[{"X", "[", 
    RowBox[{"[", 
     RowBox[{"3", ",", "1"}], "]"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6741084067928553`*^9, 3.674108412757698*^9}, {
  3.674108579204327*^9, 3.674108619211748*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotType", "[", 
   RowBox[{
    RowBox[{"a_", "?", "deg0Q"}], "  ", "X_"}], "]"}], ":=", 
  RowBox[{"SlotType", "[", "X", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6555940112046137`*^9, 3.655594058414657*^9}, {
  3.6555940982063026`*^9, 3.65559411726192*^9}, {3.6555941702371197`*^9, 
  3.655594193596784*^9}, {3.6555948439565783`*^9, 3.655594940419044*^9}, {
  3.655595089169257*^9, 3.655595090225236*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotType", "[", 
   RowBox[{"X_", "?", "deg0Q"}], "]"}], ":=", 
  RowBox[{"SlotData", "[", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655594217068426*^9, 3.655594236124312*^9}, {
  3.655594989794632*^9, 3.655594989947732*^9}, {3.6561143649271927`*^9, 
  3.6561143704149647`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SlotType", "[", 
  RowBox[{
   RowBox[{"3", " ", "X"}], "+", "Y"}], "]"}]], "Input",
 CellChangeTimes->{{3.6555937138271713`*^9, 3.655593713979742*^9}, {
  3.655595013730742*^9, 3.6555950319220753`*^9}, {3.655595121616886*^9, 
  3.655595122080782*^9}}],

Cell[BoxData[
 RowBox[{"SlotData", "[", 
  RowBox[{
   RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
    "[", "\<\"M\"\>", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.655593719221224*^9, {3.6555950142794857`*^9, 3.655595032662306*^9}, {
   3.655595071887417*^9, 3.655595123271763*^9}, 3.656114401942319*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotType", "[", 
   RowBox[{
    RowBox[{"mv", "[", "n__", "]"}], "[", "X_", "]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"mv", "[", "n", "]"}], "[", 
   RowBox[{"SlotType", "[", "X", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655872549423583*^9, 3.655872615192152*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NotSlotTypeQ", "[", "x_", "]"}], ":=", 
  RowBox[{"!", 
   RowBox[{
    RowBox[{"Head", "[", "x", "]"}], "===", "SlotType"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656117485309004*^9, 3.6561175196795893`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mv", "[", "n__", "]"}], "[", 
   RowBox[{"SlotData", "[", 
    RowBox[{"x__", "?", "NotSlotTypeQ"}], "]"}], "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"SlotData", ",", 
    RowBox[{
     RowBox[{"mv", "[", "n", "]"}], "[", 
     RowBox[{"{", "x", "}"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656122391392581*^9, 3.65612241710433*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotType", "[", 
   RowBox[{"rev", "[", "X_", "]"}], "]"}], ":=", 
  RowBox[{"rev", "[", 
   RowBox[{"SlotType", "[", "X", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655872549423583*^9, 3.655872615192152*^9}, {
  3.6560992053863077`*^9, 3.656099205770163*^9}, {3.656099490006675*^9, 
  3.656099490358542*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rev", "[", "s_SlotData", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"rev", ",", 
    RowBox[{"Reverse", "[", "s", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656117822980332*^9, 3.6561179224511213`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rev", "[", 
   RowBox[{"SlotType", "[", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
     "W"}], "]"}], "]"}], "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.6561179358590612`*^9, 3.656117967938497*^9}, {
  3.656118000434181*^9, 3.65611800275389*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"SlotData", "[", 
    RowBox[{
     RowBox[{"rev", "[", 
      RowBox[{"SlotType", "[", "W", "]"}], "]"}], ",", 
     RowBox[{"rev", "[", 
      RowBox[{"Cotangent", "[", "\"\<M\>\"", "]"}], "]"}], ",", 
     RowBox[{"rev", "[", 
      RowBox[{"Tangent", "[", "\"\<M\>\"", "]"}], "]"}]}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{3.656117968487361*^9, 3.656118003267001*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rev", "[", "x_Tangent", "]"}], ":=", 
  "x"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rev", "[", "x_Cotangent", "]"}], ":=", "x"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656118007256772*^9, 3.656118040673506*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"SlotType", "[", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
    "W"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{3.656118058817855*^9}],

Cell[BoxData[
 RowBox[{"SlotData", "[", 
  RowBox[{
   RowBox[{"rev", "[", 
    RowBox[{"SlotType", "[", "W", "]"}], "]"}], ",", 
   RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(T\\), \
\\(\\(\[VeryThinSpace]\\)\\(*\\)\\)]\\)\[NegativeThinSpace]\"\>", 
    "[", "\<\"M\"\>", "]"}], ",", 
   RowBox[{"\<\"T\"\>", "[", "\<\"M\"\>", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.656118051766397*^9, 3.6561180593499603`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotType", "[", 
   RowBox[{"\[Del]", 
    RowBox[{"X_", "?", "FieldLikeQ"}]}], "]"}], ":=", 
  RowBox[{"Append", "[", 
   RowBox[{
    RowBox[{"SlotType", "[", "X", "]"}], ",", 
    RowBox[{"Cotangent", "[", 
     RowBox[{"Manifold", "[", "]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655592834574211*^9, 3.655592923789062*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotType", "[", 
   RowBox[{"grad", "[", 
    RowBox[{"X_", "?", "FieldLikeQ"}], "]"}], "]"}], ":=", 
  RowBox[{"Append", "[", 
   RowBox[{
    RowBox[{"SlotType", "[", "X", "]"}], ",", 
    RowBox[{"Tangent", "[", 
     RowBox[{"Manifold", "[", "]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotType", "[", 
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"X_", "?", "FieldLikeQ"}], "]"}], "]"}], ":=", 
  RowBox[{"SlotType", "[", "X", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655592834574211*^9, 3.655592923789062*^9}, {
  3.655592980124426*^9, 3.6555930140119133`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotType", "[", 
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{
     RowBox[{"X_", "?", "FieldLikeQ"}], ",", "_"}], "]"}], "]"}], ":=", 
  RowBox[{"SlotType", "[", "X", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655675207897184*^9, 3.655675210601433*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotType", "[", 
   RowBox[{"pD", "[", 
    RowBox[{
     RowBox[{"X_", "?", "FieldLikeQ"}], ",", "__"}], "]"}], "]"}], ":=", 
  RowBox[{"SlotType", "[", "X", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655592834574211*^9, 3.655592923789062*^9}, {
  3.655592980124426*^9, 3.65559304214869*^9}}],

Cell["\<\
Derivative[ ][ ]  can be useful as an unevaluated prime notation for  \
\[GothicCapitalD], \
\>", "Text",
 CellChangeTimes->{{3.656100532324629*^9, 3.6561005423025227`*^9}, 
   3.656122044851753*^9, 3.656122123811017*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotType", "[", 
   RowBox[{
    RowBox[{"Derivative", "[", "__", "]"}], "[", 
    RowBox[{"X_", "?", "FieldLikeQ"}], "]"}], "]"}], ":=", 
  RowBox[{"SlotType", "[", "X", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656100669031822*^9, 3.6561006900235558`*^9}}],

Cell["09/06/2016:  SlotType for the general contraction bracket, ", "Text",
 CellChangeTimes->{{3.6744477662303534`*^9, 3.674447800358027*^9}, {
  3.674448804779821*^9, 3.6744488116996603`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotType", "[", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "X_", "\[RightAngleBracket]"}], "ab__"], 
   "]"}], ":=", 
  RowBox[{"Delete", "[", 
   RowBox[{
    RowBox[{"SlotType", "[", "X", "]"}], ",", 
    RowBox[{"Map", "[", 
     RowBox[{"List", ",", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", "ab", "}"}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.67444782237381*^9, 3.674447868341361*^9}, {
  3.674447915972927*^9, 3.67444791878893*^9}, {3.6744480273317432`*^9, 
  3.6744480297319517`*^9}, {3.6744483136650267`*^9, 3.674448345136849*^9}, {
  3.674448379936397*^9, 3.6744483943364162`*^9}, {3.6744484672795887`*^9, 
  3.6744484703836517`*^9}}],

Cell["\<\
23/08/2016   SlotType[ 0 ]  is ambiguous, and needs to be to check SlotType \
of eqns like  0 == X,\
\>", "Text",
 CellChangeTimes->{{3.680907075713068*^9, 3.680907159864111*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotType", "[", "0", "]"}], ":=", 
  RowBox[{"SlotType", "[", "$ZeroTensor", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656100669031822*^9, 3.6561006900235558`*^9}, 
   3.6809071920957603`*^9, {3.6809072469918823`*^9, 3.680907251310809*^9}, {
   3.680907332781601*^9, 3.680907377485105*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["FieldQ[x],  DerivedFieldQ[x],  FieldLikeQ[x]", "Subsection",
 CellChangeTimes->{{3.467119314622471*^9, 3.467119352821146*^9}, {
  3.467370985602835*^9, 3.46737099050696*^9}, {3.478969712456913*^9, 
  3.47896975380715*^9}, {3.479402682149652*^9, 3.479402686548678*^9}, {
  3.6157640291911497`*^9, 3.6157640665185823`*^9}, {3.649825296312427*^9, 
  3.649825315002001*^9}, {3.6498253834957438`*^9, 3.649825411191324*^9}}],

Cell["Default values,", "Text",
 CellChangeTimes->{{3.615095574222474*^9, 3.615095591150738*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FieldQ", "[", "x_", "]"}], ":=", 
  "False"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConstantQ", "[", "x_", "]"}], ":=", "False"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6150955468886433`*^9, 3.615095557778023*^9}, {
  3.615095595628028*^9, 3.615095602963439*^9}}],

Cell["\<\
To test a sequence of expressions.  True if all are fields, False otherwise,\
\>", "Text",
 CellChangeTimes->{{3.615095574222474*^9, 3.615095591150738*^9}, {
  3.615097679526286*^9, 3.615097683494339*^9}, {3.615097979863081*^9, 
  3.61509803323951*^9}, {3.615098127751728*^9, 3.615098142343603*^9}, {
  3.615148658599455*^9, 3.615148708727614*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldQ", "[", "x__", "]"}], ":=", " ", 
  RowBox[{"Apply", "[", 
   RowBox[{"And", ",", 
    RowBox[{"Map", "[", 
     RowBox[{"FieldQ", ",", 
      RowBox[{"{", "x", "}"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615148715084539*^9, 3.615148772771649*^9}, {
   3.615148873691205*^9, 3.6151489179644537`*^9}, 3.615149020285475*^9, 
   3.61514906583715*^9}],

Cell["\<\
For other things that must behave like fields but are not actually declared \
as fields:
The default value,\
\>", "Text",
 CellChangeTimes->{{3.615095574222474*^9, 3.615095591150738*^9}, {
  3.615097679526286*^9, 3.615097683494339*^9}, {3.615097979863081*^9, 
  3.61509803323951*^9}, {3.615098127751728*^9, 3.615098142343603*^9}, {
  3.649806165065534*^9, 3.649806165494913*^9}, {3.649806430227003*^9, 
  3.649806443443799*^9}, {3.649814392568993*^9, 3.64981439429662*^9}, {
  3.6498147072701*^9, 3.64981478499704*^9}, {3.649824163579007*^9, 
  3.649824202279273*^9}, {3.649824316021722*^9, 3.649824363477973*^9}, {
  3.649824433172707*^9, 3.649824501667555*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DerivedFieldQ", "[", "_", "]"}], ":=", "False"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6150955468886433`*^9, 3.615095557778023*^9}, {
   3.615095595628028*^9, 3.615095602963439*^9}, {3.649824209129752*^9, 
   3.6498242159285507`*^9}, 3.649824774929105*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DerivedFieldQ", "[", 
   RowBox[{"\[Del]", "_"}], "]"}], ":=", "True"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DerivedFieldQ", "[", 
   RowBox[{
    RowBox[{"Derivative", "[", "__", "]"}], "[", "_", "]"}], "]"}], ":=", 
  "True"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DerivedFieldQ", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Derivative", "[", "__", "]"}], "[", "_", "]"}], "[", "_", "]"}],
    "]"}], ":=", "True"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DerivedFieldQ", "[", "_\[GothicCapitalD]", "]"}], ":=", 
  "True"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DerivedFieldQ", "[", "_pD", "]"}], ":=", "True"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6150967402229557`*^9, 3.615096784360593*^9}, 
   3.615098055100524*^9, {3.649824227033865*^9, 3.649824254583544*^9}, {
   3.649824510107929*^9, 3.649824526980735*^9}, {3.64982465366745*^9, 
   3.6498246631558447`*^9}, {3.6498247246211*^9, 3.649824823810562*^9}}],

Cell["\<\
To test a sequence of expressions.  True if all are fields, False otherwise,\
\>", "Text",
 CellChangeTimes->{{3.615095574222474*^9, 3.615095591150738*^9}, {
  3.615097679526286*^9, 3.615097683494339*^9}, {3.615097979863081*^9, 
  3.61509803323951*^9}, {3.615098127751728*^9, 3.615098142343603*^9}, {
  3.615148658599455*^9, 3.615148708727614*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DerivedFieldQ", "[", "x__", "]"}], ":=", " ", 
  RowBox[{"Apply", "[", 
   RowBox[{"And", ",", 
    RowBox[{"Map", "[", 
     RowBox[{"DerivedFieldQ", ",", 
      RowBox[{"{", "x", "}"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615148715084539*^9, 3.615148772771649*^9}, {
   3.615148873691205*^9, 3.6151489179644537`*^9}, 3.615149020285475*^9, 
   3.61514906583715*^9, 3.649824950633588*^9, 3.649825025282401*^9}],

Cell["\<\
To test if something is field-like,  ie.,  either a field or derived field, \
\>", "Text",
 CellChangeTimes->{{3.615095574222474*^9, 3.615095591150738*^9}, {
  3.615097679526286*^9, 3.615097683494339*^9}, {3.615097979863081*^9, 
  3.61509803323951*^9}, {3.615098127751728*^9, 3.615098142343603*^9}, {
  3.615148658599455*^9, 3.615148708727614*^9}, {3.649825166938485*^9, 
  3.649825237129561*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldLikeQ", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"FieldQ", "[", "x", "]"}], "||", 
   RowBox[{"DerivedFieldQ", "[", "x", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649825076640554*^9, 3.649825119404813*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldLikeQ", "[", "x__", "]"}], ":=", " ", 
  RowBox[{"Apply", "[", 
   RowBox[{"And", ",", 
    RowBox[{"Map", "[", 
     RowBox[{"FieldLikeQ", ",", 
      RowBox[{"{", "x", "}"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615148715084539*^9, 3.615148772771649*^9}, {
   3.615148873691205*^9, 3.6151489179644537`*^9}, 3.615149020285475*^9, 
   3.61514906583715*^9, 3.649824950633588*^9, 3.649825025282401*^9, {
   3.649825135869561*^9, 3.649825149101735*^9}, {3.6555926452327843`*^9, 
   3.655592648400671*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["The tensor product  \[CircleTimes] ,  TensorPower[ ]", "Subsection",
 CellChangeTimes->{{3.467119314622471*^9, 3.467119372544761*^9}, {
   3.467186809307252*^9, 3.467186816729617*^9}, {3.527638549982872*^9, 
   3.5276386077271233`*^9}, 3.527638670800178*^9, {3.6540469582488337`*^9, 
   3.654046963672477*^9}}],

Cell[CellGroupData[{

Cell["\<\
Precedence to prevent printing as   -(a\[CircleTimes]b).   Nothing \
initialized.\
\>", "Subsubsection",
 CellChangeTimes->{{3.6518975814236794`*^9, 3.651897624511722*^9}, {
   3.65199134044727*^9, 3.651991347789667*^9}, 3.655106698112969*^9}],

Cell["Still too many problems to be usable.  ", "Text",
 CellChangeTimes->{{3.651991184751786*^9, 3.6519912015514393`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Precedence", "[", "CircleTimes", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Precedence", "[", "CircleDot", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Precedence", "[", "Times", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Precedence", "[", "Minus", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Precedence", "[", "Power", "]"}]}], "Input",
 CellChangeTimes->{{3.651896095800928*^9, 3.65189612669271*^9}, {
  3.651897348813272*^9, 3.651897383365171*^9}}],

Cell[BoxData["420.`"], "Output",
 CellChangeTimes->{
  3.651896127196617*^9, {3.651897361289403*^9, 3.65189738389916*^9}}],

Cell[BoxData["520.`"], "Output",
 CellChangeTimes->{
  3.651896127196617*^9, {3.651897361289403*^9, 3.651897383903221*^9}}],

Cell[BoxData["400.`"], "Output",
 CellChangeTimes->{
  3.651896127196617*^9, {3.651897361289403*^9, 3.6518973839068317`*^9}}],

Cell[BoxData["480.`"], "Output",
 CellChangeTimes->{
  3.651896127196617*^9, {3.651897361289403*^9, 3.65189738391043*^9}}],

Cell[BoxData["590.`"], "Output",
 CellChangeTimes->{
  3.651896127196617*^9, {3.651897361289403*^9, 3.651897383913981*^9}}]
}, Open  ]],

Cell["Want to get rid of the ( ),", "Text",
 CellChangeTimes->{{3.65199121649543*^9, 3.65199122835131*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{"a", "\[CircleTimes]", "b"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.6518962259507236`*^9, 3.651896234402055*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{"a", "\[CircleTimes]", "b"}], ")"}]}]], "Output",
 CellChangeTimes->{3.651896235110796*^9, 3.6519914043738003`*^9}]
}, Open  ]],

Cell["This works to get rid of  the ( ),", "Text",
 CellChangeTimes->{{3.6519912399191103`*^9, 3.6519912557909184`*^9}}],

Cell[BoxData[
 RowBox[{"CircleTimes", "/:", 
  RowBox[{"MakeBoxes", "[", 
   RowBox[{
    RowBox[{"CircleTimes", "[", "x__", "]"}], ",", "StandardForm"}], "]"}], ":=", 
  RowBox[{"TagBox", "[", 
   RowBox[{
    RowBox[{"RowBox", "[", 
     RowBox[{"Riffle", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MakeBoxes", "[", 
           RowBox[{"#", ",", "StandardForm"}], "]"}], "&"}], ",", 
         RowBox[{"{", "x", "}"}]}], "]"}], ",", "\"\<\[CircleTimes]\>\""}], 
      "]"}], "]"}], ",", "CircleTimes", ",", 
    RowBox[{"SyntaxForm", "\[Rule]", "\"\<\[CircleDot]\>\""}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.651897467450008*^9, 3.651897496019011*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{"a", "\[CircleTimes]", "b"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
   "a", "\[CircleTimes]", "b", "\[CircleTimes]", "c", "\[CircleTimes]", "d"}],
    ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "\[CircleTimes]", "b"}], "-", 
  RowBox[{"b", "\[CircleTimes]", "a"}]}]}], "Input",
 CellChangeTimes->{{3.6518962259507236`*^9, 3.651896234402055*^9}, {
  3.651897523861869*^9, 3.651897534945551*^9}, {3.6519903515664587`*^9, 
  3.651990361725501*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  TagBox[
   RowBox[{"a", "\[CircleTimes]", "b"}],
   CircleTimes,
   SyntaxForm->"\[CircleDot]"]}]], "Output",
 CellChangeTimes->{{3.6518975143257647`*^9, 3.651897536273374*^9}, 
   3.651989965186606*^9, {3.651990345485682*^9, 3.65199036257968*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  TagBox[
   RowBox[{
   "a", "\[CircleTimes]", "b", "\[CircleTimes]", "c", "\[CircleTimes]", "d"}],
   
   CircleTimes,
   SyntaxForm->"\[CircleDot]"]}]], "Output",
 CellChangeTimes->{{3.6518975143257647`*^9, 3.651897536273374*^9}, 
   3.651989965186606*^9, {3.651990345485682*^9, 3.6519903625847063`*^9}}],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{"a", "\[CircleTimes]", "b"}],
   CircleTimes,
   SyntaxForm->"\[CircleDot]"], "-", 
  TagBox[
   RowBox[{"b", "\[CircleTimes]", "a"}],
   CircleTimes,
   SyntaxForm->"\[CircleDot]"]}]], "Output",
 CellChangeTimes->{{3.6518975143257647`*^9, 3.651897536273374*^9}, 
   3.651989965186606*^9, {3.651990345485682*^9, 3.651990362588975*^9}}]
}, Open  ]],

Cell["But cut-and paste gets broken,", "Text",
 CellChangeTimes->{{3.6519912768626337`*^9, 3.651991295886392*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"X", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v2", ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"v1", ",", 
       SubscriptBox[
        RowBox[{
        "\[LeftAngleBracket]", "\[CurlyEpsilon]\[CurlyEpsilon]4", 
         "\[RightAngleBracket]"}], 
        RowBox[{"{", 
         RowBox[{"4", ",", "5"}], "}"}]]}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}]}], "\[RightAngleBracket]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   TagBox[
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "2"}], "]"}], "[", 
      TagBox[
       RowBox[{"X", "\[CircleTimes]", "v1"}],
       CircleTimes,
       SyntaxForm->"^"], "]"}], "\[CircleTimes]", "v2"}],
    CircleTimes,
    SyntaxForm->"^"]}], "+", 
  TagBox[
   RowBox[{
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "2"}], "]"}], "[", 
     TagBox[
      RowBox[{"X", "\[CircleTimes]", "v2"}],
      CircleTimes,
      SyntaxForm->"^"], "]"}], "\[CircleTimes]", "v1"}],
   CircleTimes,
   SyntaxForm->"^"], "+", 
  TagBox[
   RowBox[{"X", "\[CircleTimes]", "v1", "\[CircleTimes]", "v2"}],
   CircleTimes,
   SyntaxForm->"^"], "-", 
  TagBox[
   RowBox[{"X", "\[CircleTimes]", "v2", "\[CircleTimes]", "v1"}],
   CircleTimes,
   SyntaxForm->"^"], "+", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
   TagBox[
    RowBox[{"X", "\[CircleTimes]", "v1", "\[CircleTimes]", "v2"}],
    CircleTimes,
    SyntaxForm->"^"], "]"}], "-", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
   TagBox[
    RowBox[{"X", "\[CircleTimes]", "v2", "\[CircleTimes]", "v1"}],
    CircleTimes,
    SyntaxForm->"^"], "]"}]}]], "Output",
 CellChangeTimes->{3.651990661335093*^9}]
}, Open  ]],

Cell["\<\
Cut and paste from the above and the  + signs get droped after evaluating and \
the expression gets miss-interpreted as  Times,\
\>", "Text",
 CellChangeTimes->{{3.6519906843105392`*^9, 3.6519907255743113`*^9}, {
  3.65199107280167*^9, 3.651991122208599*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{"X", "\[CircleTimes]", "v1", "\[CircleTimes]", "v2"}],
   CircleTimes,
   SyntaxForm->"^"], 
  RowBox[{"-", 
   RowBox[{
    TagBox[
     RowBox[{"X", "\[CircleTimes]", "v2", "\[CircleTimes]", "v1"}],
     CircleTimes,
     SyntaxForm->"^"], 
    RowBox[{"+", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
      TagBox[
       RowBox[{"X", "\[CircleTimes]", "v1", "\[CircleTimes]", "v2"}],
       CircleTimes,
       SyntaxForm->"^"], "]"}]}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{"X", "\[CircleTimes]", "v1", "\[CircleTimes]", "v2"}], ")"}]}], 
  " ", 
  RowBox[{"X", "\[CircleTimes]", "v2", "\[CircleTimes]", "v1"}], " ", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
   RowBox[{"X", "\[CircleTimes]", "v1", "\[CircleTimes]", "v2"}], 
   "]"}]}]], "Output",
 CellChangeTimes->{3.651990672693831*^9, 3.6519910599326*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.651991063331724*^9, 3.6519910680348463`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"Times", "[", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"CircleTimes", "[", 
      RowBox[{"X", ",", "v1", ",", "v2"}], "]"}], ",", 
     RowBox[{"CircleTimes", "[", 
      RowBox[{"X", ",", "v2", ",", "v1"}], "]"}], ",", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
      RowBox[{"CircleTimes", "[", 
       RowBox[{"X", ",", "v1", ",", "v2"}], "]"}], "]"}]}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{3.65199106866045*^9}]
}, Open  ]],

Cell["\<\
If typed in by hand, the above is OK.  So the problem is with cut-and-paste,\
\>", "Text",
 CellChangeTimes->{{3.651990810308971*^9, 3.65199084165269*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"X", "\[CircleTimes]", "v1", "\[CircleTimes]", "v2"}], "-", 
  RowBox[{"X", "\[CircleTimes]", "v2", "\[CircleTimes]", "v1"}], "+", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
   RowBox[{"X", "\[CircleTimes]", "v1", "\[CircleTimes]", "v2"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6519907375405807`*^9, 3.651990791623385*^9}}],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{"X", "\[CircleTimes]", "v1", "\[CircleTimes]", "v2"}],
   CircleTimes,
   SyntaxForm->"^"], "-", 
  TagBox[
   RowBox[{"X", "\[CircleTimes]", "v2", "\[CircleTimes]", "v1"}],
   CircleTimes,
   SyntaxForm->"^"], "+", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
   TagBox[
    RowBox[{"X", "\[CircleTimes]", "v1", "\[CircleTimes]", "v2"}],
    CircleTimes,
    SyntaxForm->"^"], "]"}]}]], "Output",
 CellChangeTimes->{3.6519907937167063`*^9}]
}, Open  ]],

Cell["\<\
Note also that the output spacing is wrong. Eg. the   +mv[1,3,4,2]    are too \
close together.  Without the MakeBoxes, the spacing is better,\
\>", "Text",
 CellChangeTimes->{{3.651990867284224*^9, 3.6519908875080338`*^9}, {
  3.651990919891343*^9, 3.65199104214575*^9}}],

Cell[BoxData[
 RowBox[{"CircleTimes", "/:", 
  RowBox[{"MakeBoxes", "[", 
   RowBox[{
    RowBox[{"CircleTimes", "[", "x__", "]"}], ",", "StandardForm"}], "]"}], 
  "=."}]], "Input",
 CellChangeTimes->{{3.651897467450008*^9, 3.651897496019011*^9}, {
  3.651984937925703*^9, 3.65198493829348*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"X", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v2", ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"v1", ",", 
       SubscriptBox[
        RowBox[{
        "\[LeftAngleBracket]", "\[CurlyEpsilon]\[CurlyEpsilon]4", 
         "\[RightAngleBracket]"}], 
        RowBox[{"{", 
         RowBox[{"4", ",", "5"}], "}"}]]}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}]}], "\[RightAngleBracket]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "2"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "v1"}], "]"}], "\[CircleTimes]", "v2"}], 
    ")"}]}], "+", 
  RowBox[{
   RowBox[{
    RowBox[{"mv", "[", 
     RowBox[{"1", ",", "3", ",", "2"}], "]"}], "[", 
    RowBox[{"X", "\[CircleTimes]", "v2"}], "]"}], "\[CircleTimes]", "v1"}], 
  "+", 
  RowBox[{"X", "\[CircleTimes]", "v1", "\[CircleTimes]", "v2"}], "-", 
  RowBox[{"X", "\[CircleTimes]", "v2", "\[CircleTimes]", "v1"}], "+", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
   RowBox[{"X", "\[CircleTimes]", "v1", "\[CircleTimes]", "v2"}], "]"}], "-", 
  
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
   RowBox[{"X", "\[CircleTimes]", "v2", "\[CircleTimes]", "v1"}], 
   "]"}]}]], "Output",
 CellChangeTimes->{3.651990912206362*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Rules for \[CircleTimes]", "Subsubsection",
 CellChangeTimes->{{3.6518975814236794`*^9, 3.651897624511722*^9}, {
  3.65199134044727*^9, 3.651991347789667*^9}, {3.655106698112969*^9, 
  3.655106747407688*^9}}],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
------------------------------------------------------------------------\
\>", "Text",
 CellChangeTimes->{{3.651897681405636*^9, 3.6518976919016647`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"CircleTimes", "[", "v_", "]"}], ":=", "v"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6498303290001574`*^9, 3.649830354344595*^9}, {
   3.649831438208281*^9, 3.6498314427785263`*^9}, 3.649832017730362*^9, {
   3.649832051811516*^9, 3.64983205259476*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "1", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "}"}], "\[CircleTimes]", "X_"}], ":=", "X"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"X_", "\[CircleTimes]", 
     RowBox[{"{", "}"}]}], ":=", "X"}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615334516326242*^9, 3.61533458691508*^9}, {
  3.6153353179744263`*^9, 3.61533532331746*^9}, {3.6167272461169662`*^9, 
  3.61672724703183*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "2", "]"}]], "Output"],

Cell[BoxData[
 RowBox[{"rule", "[", "3", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"CircleTimes", "[", 
     RowBox[{"a___", ",", " ", 
      RowBox[{"CircleTimes", "[", 
       RowBox[{"b___", ",", " ", "c___"}], "]"}], ",", " ", "d___"}], "]"}], 
    "   ", ":=", "   ", 
    RowBox[{"CircleTimes", "[", 
     RowBox[{"a", ",", " ", "b", ",", " ", "c", ",", " ", "d"}], "]"}]}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614388729410749*^9, 3.614388729412279*^9}, {
   3.6148957781792097`*^9, 3.6148957815761843`*^9}, 3.616727250758527*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "4", "]"}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "Define \[CircleTimes]  for scalar arguments  (to simplify later defn of  \
\[Del],  and also for Clifford alg.)",
 "\nThis will also be useful for Cliffordizing via   ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"sym", "[", 
     RowBox[{
      SubscriptBox["\[Gamma]", "i"], "\[CircleTimes]", 
      SubscriptBox["\[Gamma]", "j"]}], "]"}], "\[Rule]", 
    SubscriptBox["g", 
     RowBox[{" ", 
      RowBox[{"i", " ", "j", " "}]}]]}], TraditionalForm]]],
 "    in which case we shall want  \[CircleTimes]  to collapse for scalar \
args."
}], "Text",
 CellChangeTimes->{{3.478627988671803*^9, 3.47862804189048*^9}, {
  3.478628072347725*^9, 3.478628202506586*^9}, {3.478628246203595*^9, 
  3.47862824708268*^9}, {3.478628370401241*^9, 3.478628372576413*^9}, {
  3.5276395975585613`*^9, 3.527639607453905*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"CircleTimes", "[", 
     RowBox[{"v1___", ",", 
      RowBox[{"a_", "?", "deg0Q"}], ",", "v2___"}], "]"}], ":=", 
    RowBox[{"a", " ", 
     RowBox[{"CircleTimes", "[", 
      RowBox[{"v1", ",", "v2"}], "]"}]}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.527639626373084*^9, 3.527639626373905*^9}, {
   3.614122934599729*^9, 3.614122940858881*^9}, {3.614473653072904*^9, 
   3.614473659730544*^9}, 3.6167272534485292`*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "5", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"u___", "\[CircleTimes]", "v_Plus", "\[CircleTimes]", "w___"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"CircleTimes", "[", 
        RowBox[{"u", ",", "#", ",", "w"}], "]"}], "&"}], ",", "v"}], 
     "]"}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614121361580503*^9, 3.6141213631933947`*^9}, {
   3.614122437114822*^9, 3.614122486648905*^9}, {3.614122665019432*^9, 
   3.6141226745049667`*^9}, {3.614895707081772*^9, 3.6148957150473003`*^9}, 
   3.6167272615035563`*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "6", "]"}]], "Output"]
}, Open  ]],

Cell["Take out scalar factors (including minus signs),", "Text",
 CellChangeTimes->{{3.5276394664494457`*^9, 3.5276394778101587`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"CircleTimes", "[", 
     RowBox[{"v1___", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a_", "?", "deg0Q"}], ")"}], " ", "v2_"}], ",", "v3___"}], 
     "]"}], ":=", 
    RowBox[{"a", " ", 
     RowBox[{"CircleTimes", "[", 
      RowBox[{"v1", ",", "v2", ",", "v3"}], "]"}]}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5276394856300898`*^9, 3.527639485631238*^9}, {
   3.6141228436786623`*^9, 3.6141228652603893`*^9}, {3.614895765822521*^9, 
   3.614895768215827*^9}, 3.616727263647522*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "7", "]"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"TrueQ", "[", "ArgumentChecking", "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Unprotect", "[", "Times", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Times", "[", 
      RowBox[{
       RowBox[{"x1_", "/;", 
        RowBox[{
         RowBox[{"deg", "[", "x1", "]"}], ">", "0"}]}], ",", 
       RowBox[{"x2_", "/;", 
        RowBox[{
         RowBox[{"deg", "[", "x2", "]"}], ">", "0"}]}]}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<Ordinary multiplication is not defined between tensors. Use \
\[CircleTimes].\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"HoldForm", "[", 
         RowBox[{"Times", "[", 
          RowBox[{"x1", ",", "x2"}], "]"}], "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Abort", "[", "]"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Protect", "[", "Times", "]"}], ";"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.614935951409343*^9, 3.614936215179142*^9}, {
  3.614941046398405*^9, 3.614941051742949*^9}, {3.61498101538922*^9, 
  3.6149810202703876`*^9}, {3.614981075166266*^9, 3.614981088941773*^9}, {
  3.615251047175428*^9, 3.615251053734714*^9}, {3.6152638378189697`*^9, 
  3.6152639171964197`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TensorPower", "[", 
   RowBox[{"_", ",", "0"}], "]"}], ":=", " ", "1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorPower", "[", 
   RowBox[{"0", ",", "0"}], "]"}], ":=", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<TensorPower[0,0] is indeterminate.\>\"", "]"}],
     ";", 
    RowBox[{"Abort", "[", "]"}]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorPower", "[", 
   RowBox[{"X_", ",", "1"}], "]"}], ":=", " ", "X"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorPower", "[", 
   RowBox[{"X_", ",", "n_Integer"}], "]"}], ":=", " ", 
  RowBox[{"Apply", "[", 
   RowBox[{"CircleTimes", ",", 
    RowBox[{"Table", "[", 
     RowBox[{"X", ",", 
      RowBox[{"{", "n", "}"}]}], "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614392625632571*^9, 3.614392686316403*^9}, {
   3.6143928889734573`*^9, 3.614392912207666*^9}, {3.615251101506983*^9, 
   3.615251188772333*^9}, {3.615251223908205*^9, 3.6152512286487007`*^9}, {
   3.615975190896058*^9, 3.615975193152443*^9}, {3.616221305484776*^9, 
   3.6162213055530243`*^9}, {3.654041441872572*^9, 3.6540414598247766`*^9}, {
   3.6540468888790283`*^9, 3.6540469063159018`*^9}, 3.655580705004463*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"TensorPower", "[", 
    RowBox[{"X_", ",", "n_"}], "]"}], "]"}], ":=", 
  RowBox[{"n", " ", 
   RowBox[{"deg", "[", "X", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.654046317729862*^9, 3.654046378436945*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Outer product for  \[CircleTimes]   and   //TensorForm   print output", \
"Subsection"],

Cell["\<\
Added 2016/10/11.  See file  OuterProduct.nb  for details about how  \
MatrixForm  prints things.\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CircleTimes", "[", 
   RowBox[{"x_List", ",", "y__List"}], "]"}], ":=", 
  RowBox[{"Outer", "[", 
   RowBox[{"CircleTimes", ",", "x", ",", "y"}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"NotListQ", "[", "x_", "]"}], ":=", 
  RowBox[{"!", 
   RowBox[{
    RowBox[{"Head", "[", "x", "]"}], "===", "List"}]}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"CircleTimes", "[", 
   RowBox[{"z1___", ",", 
    RowBox[{"x_", "?", "NotListQ"}], ",", "y__List", ",", "z2___"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CircleTimes", "[", 
      RowBox[{"z1", ",", "x", ",", "#", ",", "z2"}], "]"}], "&"}], ",", "y"}],
    "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"CircleTimes", "[", 
   RowBox[{"z1___", ",", "y__List", ",", 
    RowBox[{"x_", "?", "NotListQ"}], ",", "z2___"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CircleTimes", "[", 
      RowBox[{"z1", ",", "#", ",", "x", ",", "z2"}], "]"}], "&"}], ",", "y"}],
    "]"}]}]], "Input",
 InitializationCell->True],

Cell["\<\
To get nice printout of odd outer products, use a different display function.
TensorForm  will print so that the innermost  (  )  is always a matrix.
MatrixForm prints so that the innermost  (  )  is a column for odd outer \
products and a matrix for even outer products,\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TensorForm", "[", "X_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "s"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"ArrayDepth", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OddQ", "[", "n", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"s", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3.5", ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"n", "-", "1"}], ")"}], "/", "2"}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "2"}], "}"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"MatrixForm", "[", 
         RowBox[{
          RowBox[{"{", "X", "}"}], ",", 
          RowBox[{"TableSpacing", "\[Rule]", "s"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"s", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"3.5", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", "/", "2"}], "}"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"MatrixForm", "[", 
         RowBox[{"X", ",", 
          RowBox[{"TableSpacing", "\[Rule]", "s"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell["This could be better and more general,", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeTensor", "[", 
   RowBox[{"components_", ",", "tensorbasis_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{
        RowBox[{"Dimensions", "[", "components", "]"}], "===", 
        RowBox[{"Dimensions", "[", "tensorbasis", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<MakeTensor: Miss-matched array shapes for components and tensor \
basis.\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<Components = \>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"TensorForm", "[", "components", "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<Tensor basis = \>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"TensorForm", "[", "tensorbasis", "]"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Abort", "[", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"components", " ", "tensorbasis"}], ",", "Infinity"}], 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], "\n", "]"}]}]], "Input",
 InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["Tensor slot rearrangement :    rev[ ]   CyclicSum [ ]", "Subsection",
 CellChangeTimes->{
  3.478620837814964*^9, {3.478620899757682*^9, 3.478621098243444*^9}, 
   3.478806712706863*^9, {3.614422443992894*^9, 3.614422457569222*^9}, {
   3.614422514977572*^9, 3.614422516926838*^9}, {3.6152522712126217`*^9, 
   3.61525228272407*^9}, {3.6152544346094913`*^9, 3.615254435489299*^9}}],

Cell[CellGroupData[{

Cell["Take care using Reverse[ ]", "Subsubsection",
 CellChangeTimes->{{3.6149185157698*^9, 3.614918654122201*^9}, {
   3.614918906683086*^9, 3.614918944042968*^9}, {3.614926563829781*^9, 
   3.61492657571723*^9}, 3.615251791979197*^9, {3.649813332790987*^9, 
   3.649813371222681*^9}, {3.649813923506239*^9, 3.6498139298738728`*^9}, {
   3.650745192868326*^9, 3.6507451992840652`*^9}, {3.650745369713722*^9, 
   3.650745371218066*^9}, {3.65074660409618*^9, 3.6507466371033297`*^9}, 
   3.655106845518545*^9}],

Cell["\<\
Reverse[ ]  gets applied to the top level of expressions with any head. It is \
not defined for atomic expressions,\
\>", "Text",
 CellChangeTimes->{{3.6149185157698*^9, 3.614918654122201*^9}, 
   3.6149189559313793`*^9, {3.614922494227291*^9, 3.614922497307302*^9}, {
   3.650745205060224*^9, 3.650745293699503*^9}, {3.650745337346385*^9, 
   3.650745350163204*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", "f", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Reverse", "[", 
  RowBox[{"f", "[", 
   RowBox[{"a", ",", "b"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.650745301845022*^9, 3.650745320836481*^9}}],

Cell[BoxData[
 RowBox[{"f", "[", 
  RowBox[{"b", ",", "a"}], "]"}]], "Output",
 CellChangeTimes->{{3.650745310822589*^9, 3.6507453223568783`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"X", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Reverse", "[", "X", "]"}]}], "Input",
 CellChangeTimes->{{3.614918625335672*^9, 3.614918641134252*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Reverse", "::", "normal"}], "MessageName"], ":", 
  " ", "\<\"Nonatomic expression expected at position \[NoBreak]\\!\\(1\\)\
\[NoBreak] in \[NoBreak]\\!\\(Reverse[X]\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/normal\\\", \
ButtonNote -> \\\"Reverse::normal\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.614918642079811*^9, 3.615260341601701*^9, 
  3.6152642575755033`*^9, 3.61527203312307*^9, 3.615272206691503*^9}],

Cell[BoxData[
 RowBox[{"Reverse", "[", "X", "]"}]], "Output",
 CellChangeTimes->{3.614918642082994*^9, 3.615260341605055*^9, 
  3.6152642575843887`*^9, 3.615272033125543*^9, 3.615272206694569*^9}]
}, Open  ]],

Cell["\<\
This does not give an error because here  Reverse  is getting applied to the \
arguments of  Times,\
\>", "Text",
 CellChangeTimes->{{3.6149185157698*^9, 3.614918654122201*^9}, {
  3.614918788746924*^9, 3.614918848475115*^9}, {3.6507467044785748`*^9, 
  3.650746743982402*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reverse", "[", 
  RowBox[{"-", "X"}], "]"}]], "Input",
 CellChangeTimes->{{3.6149187505956373`*^9, 3.614918755518238*^9}}],

Cell[BoxData[
 RowBox[{"-", "X"}]], "Output",
 CellChangeTimes->{3.61491875614214*^9, 3.615260341690621*^9, 
  3.615264257770331*^9, 3.615272033136392*^9, 3.615272206855947*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Reverse", "[", 
  RowBox[{
  "a", "\[CircleTimes]", "b", "\[CircleTimes]", "c", "\[CircleTimes]", "d"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Reverse", "[", 
  RowBox[{
   RowBox[{"-", "a"}], "\[CircleTimes]", "b", "\[CircleTimes]", "c", 
   "\[CircleTimes]", "d"}], "]"}]}], "Input",
 CellChangeTimes->{{3.614918857678452*^9, 3.614918871631734*^9}, {
  3.614918962375175*^9, 3.6149189773163652`*^9}}],

Cell[BoxData[
 RowBox[{"d", "\[CircleTimes]", "c", "\[CircleTimes]", "b", "\[CircleTimes]", 
  "a"}]], "Output",
 CellChangeTimes->{3.614918872941329*^9, 3.614918979790204*^9, 
  3.615260341852067*^9, 3.615264257787078*^9, 3.615272033249736*^9, 
  3.61527220695057*^9}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
   "a", "\[CircleTimes]", "b", "\[CircleTimes]", "c", "\[CircleTimes]", "d"}],
    ")"}]}]], "Output",
 CellChangeTimes->{3.614918872941329*^9, 3.614918979790204*^9, 
  3.615260341852067*^9, 3.615264257787078*^9, 3.615272033249736*^9, 
  3.615272206955001*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
  "a", "\[CircleTimes]", "b", "\[CircleTimes]", "c", "\[CircleTimes]", "d"}], 
  "//", "FullForm"}]], "Input",
 CellChangeTimes->{{3.6149226441679564`*^9, 3.614922647623888*^9}, 
   3.614922690841935*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   RowBox[{"CircleTimes", "[", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}],
   ShowSpecialCharacters->False,
   ShowStringCharacters->True,
   NumberMarks->True],
  FullForm]], "Output",
 CellChangeTimes->{3.614922648705011*^9, 3.6149226920010157`*^9, 
  3.6152603419407997`*^9, 3.615264257891567*^9, 3.615272033363421*^9, 
  3.615272207052463*^9}]
}, Open  ]],

Cell["\<\
For example, not being careful with Reverse[ ]  gave a a bug that took ages \
to find:    I was somehow getting   Reverse[ Subscript[ \[LeftAngleBracket]X\
\[RightAngleBracket], a, b] ]   which evaluates to the nonsensical expression \
  Subscript[ b, a, \[LeftAngleBracket]X\[RightAngleBracket]]. \
\>", "Text",
 CellChangeTimes->{{3.614469770646714*^9, 3.614469818967228*^9}, {
   3.6144698536709013`*^9, 3.614469855798312*^9}, {3.614910076076189*^9, 
   3.6149102448450203`*^9}, 3.614910285581277*^9, {3.6149103714539633`*^9, 
   3.614910386238011*^9}, {3.6149224426751757`*^9, 3.6149224574113817`*^9}, {
   3.614922508115329*^9, 3.614922509827587*^9}, {3.6149228519074993`*^9, 
   3.614922892884261*^9}, {3.6507451530446367`*^9, 3.650745168421143*^9}, 
   3.6551068359026833`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["rev[ ] ", "Subsubsection",
 CellChangeTimes->{{3.465382641638598*^9, 3.465382664870949*^9}, {
   3.466847176173019*^9, 3.46684721355625*^9}, {3.466847298083375*^9, 
   3.466847315774946*^9}, {3.527627706964282*^9, 3.527627709939876*^9}, 
   3.6519833575930758`*^9}],

Cell["\<\
18/11/2016.   It might be possible to clean up the rev[ ] code using the new \
fn  MinusOnePower[ ]  (see Wedge section).\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"rev", "[", 
   RowBox[{"X_", "?", "AntisymQ"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"MinusOnePower", "[", 
    RowBox[{
     RowBox[{"deg", "[", "X", "]"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"deg", "[", "X", "]"}], "-", "1"}], ")"}], "/", "2"}]}], 
    "]"}], "X"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AssumeAntisymmetric", "[", "X", "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"deg[\"\>", "\[InvisibleSpace]", "X", 
   "\[InvisibleSpace]", "\<\"] does not evaluate to an integer. See  ? \
NewField  for declaring the degree of a tensor field.\"\>"}],
  SequenceForm[
  "deg[", $CellContext`X, 
   "] does not evaluate to an integer. See  ? NewField  for declaring the \
degree of a tensor field."],
  Editable->False]], "Print"],

Cell[BoxData["$Aborted"], "Output"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AntisymQ", "[", "X", "]"}], "=", "True"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AntisymQ", "[", "Y", "]"}], "=", "True"}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", "X", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"X", " ", 
  SuperscriptBox[
   StyleBox["\<\"(-1)\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontWeight->Bold,
    FontColor->RGBColor[0, 0, 1]], 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"deg", "[", "X", "]"}], "2"]}], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"deg", "[", "X", "]"}], "2"], "2"]}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"X", "\[CircleTimes]", "Y"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Y", "\[CircleTimes]", "X"}], " ", 
  SuperscriptBox[
   StyleBox["\<\"(-1)\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontWeight->Bold,
    FontColor->RGBColor[0, 0, 1]], 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"deg", "[", "X", "]"}], "2"]}], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"deg", "[", "X", "]"}], "2"], "2"], "-", 
    FractionBox[
     RowBox[{"deg", "[", "Y", "]"}], "2"], "+", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"deg", "[", "Y", "]"}], "2"], "2"]}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rev", "[", 
   RowBox[{"X", "\[CircleTimes]", "Y"}], "]"}], "/.", 
  RowBox[{
   RowBox[{"deg", "[", "Y", "]"}], "\[Rule]", 
   RowBox[{"deg", "[", "X", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rev", "[", 
    RowBox[{"X", "\[CircleTimes]", "Y"}], "]"}], "/.", 
   RowBox[{
    RowBox[{"deg", "[", "Y", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"deg", "[", "X", "]"}], "+", "1"}]}]}], "//", 
  "ExpandAll"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rev", "[", 
    RowBox[{"X", "\[CircleTimes]", "Y"}], "]"}], "/.", 
   RowBox[{
    RowBox[{"deg", "[", "Y", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"deg", "[", "X", "]"}], "+", "2"}]}]}], "//", 
  "ExpandAll"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rev", "[", 
    RowBox[{"X", "\[CircleTimes]", "Y"}], "]"}], "/.", 
   RowBox[{
    RowBox[{"deg", "[", "Y", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"deg", "[", "X", "]"}], "+", "3"}]}]}], "//", 
  "ExpandAll"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rev", "[", 
    RowBox[{"X", "\[CircleTimes]", "Y"}], "]"}], "/.", 
   RowBox[{
    RowBox[{"deg", "[", "Y", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"deg", "[", "X", "]"}], "+", "4"}]}]}], "//", 
  "ExpandAll"}]}], "Input"],

Cell[BoxData[
 RowBox[{"Y", "\[CircleTimes]", "X"}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Y", "\[CircleTimes]", "X"}], " ", 
  SuperscriptBox[
   StyleBox["\<\"(-1)\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontWeight->Bold,
    FontColor->RGBColor[0, 0, 1]], 
   RowBox[{"deg", "[", "X", "]"}]]}]], "Output"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{"Y", "\[CircleTimes]", "X"}], ")"}]}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{"Y", "\[CircleTimes]", "X"}], ")"}]}], " ", 
  SuperscriptBox[
   StyleBox["\<\"(-1)\"\>",
    StripOnInput->False,
    LineColor->RGBColor[0, 0, 1],
    FrontFaceColor->RGBColor[0, 0, 1],
    BackFaceColor->RGBColor[0, 0, 1],
    GraphicsColor->RGBColor[0, 0, 1],
    FontWeight->Bold,
    FontColor->RGBColor[0, 0, 1]], 
   RowBox[{"deg", "[", "X", "]"}]]}]], "Output"],

Cell[BoxData[
 RowBox[{"Y", "\[CircleTimes]", "X"}]], "Output"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AntisymQ", "[", "X", "]"}], "=."}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AntisymQ", "[", "Y", "]"}], "=."}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rev", "[", 
   RowBox[{"X_", "?", "AntisymQ"}], "]"}], "=."}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AntisymQ", "[", "X", "]"}]], "Input"],

Cell[BoxData["False"], "Output"]
}, Open  ]],

Cell[TextData[{
 "\nDo not assume that using  UnsetRule  on  rev[ ]  rules is safe.  Other \
rules depend on  rev[ ]  evaluating to something when possible,  which could \
be  a  List,  \[CircleTimes],  \[LeftAngleBracket] , , \[RightAngleBracket],  \
or  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "   ", "\[RightAngleBracket]"}], "ab"], 
   TraditionalForm]]],
 " .\nIf   rev[ ]  remains unevaluated because rules have been unset, then \
whenever  Apply, Join, Append, etc.  have been used on a rev[ ]  expression \
in the definition of other rules,  they \nwill try to act on the unevaluated  \
rev[ ]  rather than its evaluation. The result can be a mess !"
}], "Text"],

Cell["\<\
This is one of the few places we shall use  Reverse[ ],  other than for \
reversing a  Range[ ]  of integers,\
\>", "Text",
 CellChangeTimes->{{3.614920016349769*^9, 3.614920081342441*^9}, {
  3.615166299402405*^9, 3.615166306954422*^9}, {3.61516885911972*^9, 
  3.615168862591694*^9}, {3.649812382501287*^9, 3.649812382804226*^9}, {
  3.649812443826836*^9, 3.649812456546742*^9}, {3.6498126770263977`*^9, 
  3.6498126776178703`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"rev", "[", "x_List", "]"}], ":=", " ", 
    RowBox[{"Map", "[", 
     RowBox[{"rev", ",", 
      RowBox[{"Reverse", "[", "x", "]"}]}], "]"}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615167607541254*^9, 3.61516761976294*^9}, 
   3.616727305954741*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "8", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
09/09/2015    For a sequence of  0  or  2 or more arguments, rev returns a \
Sequence. This is convenient for writing code but was added late.  Any old \
code that 
                             includes an expression    Apply[ Sequence, rev[ \
{ Y } ] ]    as an argument can now be replaced by    rev[ Y ]   and this \
will be OK for  Y___ .\
\>", "Text",
 CellChangeTimes->{{3.650744873737483*^9, 3.650744934520664*^9}, {
  3.6507450019912357`*^9, 3.650745020823154*^9}, {3.650745554673623*^9, 
  3.650745688861162*^9}, {3.650745736588727*^9, 3.6507457888597918`*^9}, {
  3.650746816784338*^9, 3.650746826637856*^9}, {3.650746861646187*^9, 
  3.65074687113249*^9}}],

Cell["\<\
AddRule bug:   Should be able to write    AddRule[  rev[ ] :=  Sequence[ ] ]  \
                          but Addrule gets confused and then  rev[ ]  returns \
 Null.
                                This works though,            AddRule[  rev[ \
] :=   Apply[ Sequence, { } ]  ]\
\>", "Text",
 CellChangeTimes->{{3.650843645389947*^9, 3.6508437171162243`*^9}, {
  3.650843747356008*^9, 3.65084375756434*^9}, {3.6508437956752167`*^9, 
  3.6508438194628572`*^9}, {3.650843853114419*^9, 3.6508439645534153`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rev", "[", "]"}], ":=", 
  RowBox[{"Sequence", "[", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"X1_", ",", "X2__"}], "]"}], ":=", 
    RowBox[{"Apply", "[", 
     RowBox[{"Sequence", ",", 
      RowBox[{"Map", "[", 
       RowBox[{"rev", ",", 
        RowBox[{"Reverse", "[", 
         RowBox[{"{", 
          RowBox[{"X1", ",", "X2"}], "}"}], "]"}]}], "]"}]}], "]"}]}]}], 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6507440481528883`*^9, 3.650744056582762*^9}, {
  3.650744302404698*^9, 3.650744311987303*^9}, {3.65074447293256*^9, 
  3.650744481969803*^9}, {3.65074471339229*^9, 3.650744742366273*^9}, {
  3.650744960336667*^9, 3.650744996253736*^9}, {3.6508435453313427`*^9, 
  3.650843560756599*^9}, {3.650843865743198*^9, 3.650843865967052*^9}, {
  3.650843972124614*^9, 3.650843981437166*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "9", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"rev", "[", "expr_Plus", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"rev", ",", "expr"}], "]"}]}]}], "]"}], "\n", 
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"rev", "[", "expr_Times", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{"rev", ",", "expr"}], "]"}]}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5276279816416283`*^9, 3.5276279816427917`*^9}, {
   3.611433101741054*^9, 3.6114331505344467`*^9}, {3.611433317470071*^9, 
   3.611433324390239*^9}, {3.6114334502687674`*^9, 3.611433454481127*^9}, {
   3.6148958588616667`*^9, 3.614895879464394*^9}, 3.61491758564771*^9, {
   3.61509255115379*^9, 3.615092568975278*^9}, 3.6152517484521*^9, {
   3.616727295257153*^9, 3.61672729640687*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "10", "]"}]], "Output"],

Cell[BoxData[
 RowBox[{"rule", "[", "11", "]"}]], "Output"]
}, Open  ]],

Cell["18/11/2016:  Replaced by simpler code,", "Text"],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"rev", "[", "x_CircleTimes", "]"}], ":=", 
    RowBox[{"Apply", "[", 
     RowBox[{"CircleTimes", ",", 
      RowBox[{"rev", "[", 
       RowBox[{"Apply", "[", 
        RowBox[{"List", ",", "x"}], "]"}], "]"}]}], "]"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.6149204637008743`*^9, 3.614920521381235*^9}, {
   3.6149205630133944`*^9, 3.614920573478065*^9}, {3.615166864740108*^9, 
   3.6151668660185347`*^9}, {3.615166945139844*^9, 3.615166946867156*^9}, {
   3.615168067542283*^9, 3.615168078309804*^9}, {3.6151681482944508`*^9, 
   3.6151681489337273`*^9}, {3.6151681867267227`*^9, 3.615168196950809*^9}, {
   3.615168230791728*^9, 3.615168269383922*^9}, 3.615168331431305*^9, 
   3.616727308685089*^9, {3.649813488793029*^9, 3.6498134893841343`*^9}, {
   3.64981373313588*^9, 3.649813749716778*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"rev", "[", "x_CircleTimes", "]"}], ":=", 
    RowBox[{"CircleTimes", "[", 
     RowBox[{"Apply", "[", 
      RowBox[{"rev", ",", "x"}], "]"}], "]"}]}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"rule", "[", "12", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"rev", "[", "X_", "]"}], "]"}], ":=", "X"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.616727303379702*^9, {3.6498093309493103`*^9, 3.649809365742608*^9}, {
   3.6498101430614862`*^9, 3.6498101468924007`*^9}, {3.649810646109438*^9, 
   3.649810660844467*^9}, {3.649811858748781*^9, 3.649811860206856*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "13", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"f_", "/;", 
      RowBox[{"NumericQ", "[", "f", "]"}]}], "]"}], ":=", "f"}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6499834613867073`*^9, 3.64998346764244*^9}, {
  3.649983575026478*^9, 3.6499835825180073`*^9}, {3.6499836316734467`*^9, 
  3.649983633384759*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "14", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"f_", "/;", 
      RowBox[{"ConstantQ", "[", "f", "]"}]}], "]"}], ":=", "f"}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6499834613867073`*^9, 3.64998346764244*^9}, {
  3.649983575026478*^9, 3.649983600137762*^9}, {3.649983637719729*^9, 
  3.649983639609078*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "15", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
Re. The following formula for the AntisymQ[f] case...
This is how the sign of  rev[X]  depends on  deg[X]  if  X  is antisymmetric,\
\
\>", "Text",
 CellChangeTimes->{{3.61317167467161*^9, 3.613171839374461*^9}, {
  3.613171911440881*^9, 3.613172017407218*^9}, {3.613172082768917*^9, 
  3.613172085103612*^9}, {3.6131722157606487`*^9, 3.613172243920146*^9}, {
  3.613172373282558*^9, 3.613172502144786*^9}, {3.6498259266568193`*^9, 
  3.649825961887783*^9}, {3.649984230878343*^9, 3.649984235598448*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"mvSignature", "[", 
    RowBox[{"Apply", "[", 
     RowBox[{"Sequence", ",", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Range", "[", "0", "]"}], "]"}]}], "]"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"mvSignature", "[", 
    RowBox[{"Apply", "[", 
     RowBox[{"Sequence", ",", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Range", "[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"mvSignature", "[", 
    RowBox[{"Apply", "[", 
     RowBox[{"Sequence", ",", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Range", "[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"mvSignature", "[", 
    RowBox[{"Apply", "[", 
     RowBox[{"Sequence", ",", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Range", "[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"mvSignature", "[", 
    RowBox[{"Apply", "[", 
     RowBox[{"Sequence", ",", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Range", "[", "4", "]"}], "]"}]}], "]"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"mvSignature", "[", 
    RowBox[{"Apply", "[", 
     RowBox[{"Sequence", ",", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Range", "[", "5", "]"}], "]"}]}], "]"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"mvSignature", "[", 
    RowBox[{"Apply", "[", 
     RowBox[{"Sequence", ",", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Range", "[", "6", "]"}], "]"}]}], "]"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"mvSignature", "[", 
    RowBox[{"Apply", "[", 
     RowBox[{"Sequence", ",", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Range", "[", "7", "]"}], "]"}]}], "]"}], "]"}]}], 
  "}"}]], "Input",
 CellChangeTimes->{{3.613126446559561*^9, 3.6131265337500067`*^9}, {
  3.613126932631868*^9, 3.6131269409241247`*^9}, {3.613172512878274*^9, 
  3.61317251832507*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.613126481830348*^9, 3.6131265349091387`*^9}, 
   3.613126942430787*^9, 3.613172519426652*^9, 3.615271235326083*^9, 
   3.6152760738079357`*^9, 3.6498263078017197`*^9}]
}, Open  ]],

Cell["18/11/2016:  This would have been simpler,", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"revSig", "[", "r_", "]"}], ":=", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], 
   RowBox[{"r", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r", "-", "1"}], ")"}], "/", "2"}]}]]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"revSig", ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", 
     "7"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"revSignAntisym", "[", "r_Integer", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"OddQ", "[", 
     RowBox[{"Floor", "[", 
      RowBox[{"r", "/", "2"}], "]"}], "]"}], ",", 
    RowBox[{"-", "1"}], ",", "1"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6506163650694447`*^9, 3.650616432417238*^9}, {
  3.6506165131363363`*^9, 3.650616528624084*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"revSignAntisym", ",", 
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "7"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.650616453422998*^9, 3.650616490350668*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", "1", ",", "1", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.650616491642007*^9, 3.650616532670721*^9}}]
}, Open  ]],

Cell["\<\
f  is trivially even under the action of  rev[ ]  if  f  is  deg0or1Q.
revEvenQ[f] = True  if  f  it is known that for some non-trivial reason   f   \
will be even under action of  rev,   in which case we wont have to actually \
calculate rev.  
revOddQ[f]  = True  if  f  it is known that  f   will be odd under action of  \
rev,   in which case we wont have to actually calculate rev.  \
\>", "Text",
 CellChangeTimes->{{3.6499879606684017`*^9, 3.649988214137205*^9}, {
  3.649998931673704*^9, 3.649999005320663*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"f_", "?", "deg0or1Q"}], "]"}], ":=", "f"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649999057401919*^9, 3.649999063044276*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "16", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
....it will be convenient to exclude   deg0or1Q   from the   revEvenQ   test. \
  That is,  revEvenQ  tests only for non-trivial explicit symmetry under rev. \

Then if  a  \[LeftAngleBracket]  \[RightAngleBracket]  of deg 0 or 1 is  \
revOddQ  it must be zero.
The default False value is defined for both single arg and multiple arg \
because the single arg rules will get checked before spending time on any \
other double arg rules,\
\>", "Text",
 CellChangeTimes->{{3.649999106663715*^9, 3.6499992739248133`*^9}, {
  3.650068610461198*^9, 3.6500686213063993`*^9}, {3.650068673626135*^9, 
  3.650068717721339*^9}, {3.650069360209597*^9, 3.6500695072475863`*^9}, {
  3.6502609332072363`*^9, 3.650260933989697*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"revEvenQ", "[", "_", "]"}], ":=", "False"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"revOddQ", "[", "_", "]"}], ":=", 
  "False"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"revEvenQ", "[", "__", "]"}], ":=", 
  "False"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"revOddQ", "[", "__", "]"}], ":=", "False"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"revEvenQ", "[", 
     RowBox[{"x_", "/;", 
      RowBox[{
       RowBox[{"SymQ", "[", "x", "]"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AntisymQ", "[", "x", "]"}], "&&", 
         RowBox[{"EvenQ", "[", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"deg", "[", "x", "]"}], "/", "2"}], "]"}], "]"}]}], 
        ")"}]}]}], "]"}], ":=", "True"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"revOddQ", "[", 
     RowBox[{"x_", "/;", 
      RowBox[{
       RowBox[{"AntisymQ", "[", "x", "]"}], "&&", 
       RowBox[{"OddQ", "[", 
        RowBox[{"Floor", "[", 
         RowBox[{
          RowBox[{"deg", "[", "x", "]"}], "/", "2"}], "]"}], "]"}]}]}], "]"}],
     ":=", "True"}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649982099241157*^9, 3.649982148174402*^9}, {
   3.649982257436611*^9, 3.649982268726532*^9}, {3.649982359147616*^9, 
   3.649982429115328*^9}, {3.649982477488596*^9, 3.649982588570086*^9}, {
   3.649982623979021*^9, 3.6499826975468893`*^9}, 3.649982740394355*^9, {
   3.6499830323577843`*^9, 3.649983046789831*^9}, {3.649983130530634*^9, 
   3.6499831349166737`*^9}, {3.649983665824047*^9, 3.649983671276578*^9}, {
   3.649983726890621*^9, 3.649983728730441*^9}, {3.649983773422593*^9, 
   3.6499837751954536`*^9}, 3.649999079231971*^9, {3.650052190825014*^9, 
   3.650052194167639*^9}, {3.650069188900304*^9, 3.65006919334234*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "17", "]"}]], "Output"],

Cell[BoxData[
 RowBox[{"rule", "[", "18", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
.... there will be other cases that   revEvenQ[x]   or  revOddQ[x]    could \
be assigned True.
For example,   \[LeftAngleBracket] rev[ f ], f \[RightAngleBracket]    is  \
revEvenQ  for any  f .  To detect such cases....\
\>", "Text",
 CellChangeTimes->{{3.6499828778086443`*^9, 3.649982884192631*^9}, {
   3.649982935791882*^9, 3.649982981311816*^9}, {3.649987380340209*^9, 
   3.649987450274722*^9}, 3.6499877290875273`*^9, 3.649988220506426*^9, {
   3.650049364049797*^9, 3.650049388296215*^9}, {3.650049443431539*^9, 
   3.6500495194144487`*^9}, 3.650049568581348*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"ParityQ", "[", 
    RowBox[{"X_", ",", "Y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"X", "===", "Y"}], "||", 
    RowBox[{"X", "===", 
     RowBox[{"-", "Y"}]}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"ParityQ", "[", 
    RowBox[{"X_List", ",", "Y_List"}], "]"}], ":=", 
   RowBox[{"MapThread", "[", 
    RowBox[{"ParityQ", ",", 
     RowBox[{"{", 
      RowBox[{"X", ",", "Y"}], "}"}]}], "]"}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650046839467555*^9, 3.650046891310932*^9}, {
   3.650047007924259*^9, 3.650047024030135*^9}, {3.65004707996697*^9, 
   3.650047129325581*^9}, {3.650047171948963*^9, 3.6500471985122423`*^9}, {
   3.650047693814837*^9, 3.6500477044395943`*^9}, {3.65004812657659*^9, 
   3.650048127807626*^9}, {3.650048981650729*^9, 3.650049003090536*^9}, {
   3.650049043372727*^9, 3.6500490453458643`*^9}, {3.650049635103429*^9, 
   3.6500496401528263`*^9}, {3.65026814205777*^9, 3.650268199641718*^9}, 
   3.650268235527052*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "19", "]"}]], "Output"],

Cell[BoxData[
 RowBox[{"rule", "[", "20", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", "$UndefinedParity", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "$UndefinedParity", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"Parity", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"x", "===", "y"}], ",", "1", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"x", "===", 
        RowBox[{"-", "y"}]}], ",", 
       RowBox[{"-", "1"}], ",", "$UndefinedParity"}], "]"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"Parity", "[", 
    RowBox[{"x_List", ",", "y_List"}], "]"}], ":=", " ", 
   RowBox[{"MapThread", "[", 
    RowBox[{"Parity", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650000594839218*^9, 3.650000645492154*^9}, {
   3.650000685044416*^9, 3.6500007225646067`*^9}, {3.6500007797328653`*^9, 
   3.6500008027724*^9}, {3.6500013195834303`*^9, 3.650001371599365*^9}, {
   3.6500473671950502`*^9, 3.650047513466729*^9}, {3.6500475720897818`*^9, 
   3.650047584470104*^9}, {3.650047885941827*^9, 3.650047913642106*^9}, 
   3.6500486652818327`*^9, {3.6500488033051977`*^9, 3.650048803752213*^9}, 
   3.650048897148714*^9, {3.6500499889000673`*^9, 3.650050043157518*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "21", "]"}]], "Output"],

Cell[BoxData[
 RowBox[{"rule", "[", "22", "]"}]], "Output"]
}, Open  ]],

Cell["Testing  --  ParityQ,  Parity", "Text",
 CellChangeTimes->{{3.6500486819865847`*^9, 3.650048683266575*^9}, {
  3.6500487700173903`*^9, 3.6500487818890944`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ParityQ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3"}], ",", "4", ",", "a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3"}], ",", "4", ",", 
     RowBox[{"-", "a"}], ",", "c"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6500486931727533`*^9, 3.6500487249646482`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "True", ",", "True", ",", "False"}], "}"}]], "Output",
 CellChangeTimes->{{3.650048697316843*^9, 3.6500487265512743`*^9}, 
   3.650069094505272*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Parity", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3"}], ",", "4", ",", "a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3"}], ",", "4", ",", 
     RowBox[{"-", "a"}], ",", "c"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{3.650048739524517*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", 
   RowBox[{"-", "1"}], ",", "$UndefinedParity"}], "}"}]], "Output",
 CellChangeTimes->{3.650048740324685*^9, 3.6500500635265703`*^9, 
  3.650069096973115*^9}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
-------------------------------------------------------------\
\>", "Text",
 CellChangeTimes->{{3.650262088710393*^9, 3.650262129194622*^9}}],

Cell["\<\
For single arguments, see above.
We define    revEvenQ[ X__ ]   and   revOddQ[ X__ ]    with  more than 1 \
argument  to be as if applied to  \[LeftAngleBracket] X__ \
\[RightAngleBracket] .
The length check is to prevent a loop. Single argument  ref[ x ]  uses  \
revEvenQ[ x ]  and  revOddQ[ x ]  to test its argument  x,  so single \
argument  revEvenQ[ x ] and revOddQ[ x ] can not use rev[ ].\
\>", "Text",
 CellChangeTimes->{{3.650050603511166*^9, 3.650050605525675*^9}, {
  3.650050768385154*^9, 3.65005080211453*^9}, {3.6500513342033243`*^9, 
  3.650051377850963*^9}, {3.650055120549542*^9, 3.6500551321173687`*^9}, {
  3.650055348178052*^9, 3.650055481695997*^9}, {3.650266174894906*^9, 
  3.650266190894435*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"revEvenQ", "[", 
    RowBox[{"X__", "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "X", "}"}], "]"}], ">", "1"}], "&&", 
      RowBox[{"Apply", "[", 
       RowBox[{"And", ",", 
        RowBox[{"ParityQ", "[", 
         RowBox[{
          RowBox[{"{", "X", "}"}], ",", 
          RowBox[{"rev", "[", 
           RowBox[{"{", "X", "}"}], "]"}]}], "]"}]}], "]"}], "&&", 
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"Times", ",", 
         RowBox[{"Parity", "[", 
          RowBox[{
           RowBox[{"{", "X", "}"}], ",", 
           RowBox[{"rev", "[", 
            RowBox[{"{", "X", "}"}], "]"}]}], "]"}]}], "]"}], "===", 
       "1"}]}]}], "]"}], ":=", "True"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"revOddQ", "[", 
    RowBox[{"X__", "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "X", "}"}], "]"}], ">", "1"}], "&&", 
      RowBox[{"Apply", "[", 
       RowBox[{"And", ",", 
        RowBox[{"ParityQ", "[", 
         RowBox[{
          RowBox[{"{", "X", "}"}], ",", 
          RowBox[{"rev", "[", 
           RowBox[{"{", "X", "}"}], "]"}]}], "]"}]}], "]"}], "&&", 
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"Times", ",", 
         RowBox[{"Parity", "[", 
          RowBox[{
           RowBox[{"{", "X", "}"}], ",", 
           RowBox[{"rev", "[", 
            RowBox[{"{", "X", "}"}], "]"}]}], "]"}]}], "]"}], "===", 
       RowBox[{"-", "1"}]}]}]}], "]"}], ":=", "True"}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650046802256929*^9, 3.650046813536714*^9}, {
  3.650049049439842*^9, 3.650049274518404*^9}, {3.650050199271968*^9, 
  3.65005022222889*^9}, {3.650051382132546*^9, 3.650051387043742*^9}, {
  3.650055150623609*^9, 3.650055202005311*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "23", "]"}]], "Output"],

Cell[BoxData[
 RowBox[{"rule", "[", "24", "]"}]], "Output"]
}, Open  ]],

Cell["Testing  --  revEvenQ,   revOddQ", "Text",
 CellChangeTimes->{{3.6500486819865847`*^9, 3.650048683266575*^9}, {
  3.6500487700173903`*^9, 3.6500487818890944`*^9}, {3.6502602791345882`*^9, 
  3.650260290396575*^9}}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"f1", ",", "f2", ",", "g1", ",", "g2"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"f1", ",", "f2", ",", "g1", ",", "g2"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumeSymmetric", "[", 
   RowBox[{"{", 
    RowBox[{"g1", ",", "g2"}], "}"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumeAntisymmetric", "[", 
   RowBox[{"{", 
    RowBox[{"f1", ",", "f2"}], "}"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6502609996527233`*^9, 3.650261093798455*^9}, {
  3.650261134841651*^9, 3.650261137015066*^9}, {3.653790480658958*^9, 
  3.6537904824024887`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListOfFields", "[", "]"}]], "Input",
 CellChangeTimes->{{3.653790610661264*^9, 3.6537906230779676`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f1", "\[Element]", 
      RowBox[{"Arrays", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"dim", "[", "\<\"M\"\>", "]"}], ",", 
          RowBox[{"dim", "[", "\<\"M\"\>", "]"}]}], "}"}], ",", "Reals", ",", 
        
        RowBox[{"{", "}"}]}], "]"}]}], ",", 
     RowBox[{"{", "2", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f2", "\[Element]", 
      RowBox[{"Arrays", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"dim", "[", "\<\"M\"\>", "]"}], ",", 
          RowBox[{"dim", "[", "\<\"M\"\>", "]"}]}], "}"}], ",", "Reals", ",", 
        
        RowBox[{"{", "}"}]}], "]"}]}], ",", 
     RowBox[{"{", "2", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"g1", "\[Element]", 
      RowBox[{"Arrays", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"dim", "[", "\<\"M\"\>", "]"}], ",", 
          RowBox[{"dim", "[", "\<\"M\"\>", "]"}]}], "}"}], ",", "Reals", ",", 
        
        RowBox[{"{", "}"}]}], "]"}]}], ",", 
     RowBox[{"{", "2", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"g2", "\[Element]", 
      RowBox[{"Arrays", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"dim", "[", "\<\"M\"\>", "]"}], ",", 
          RowBox[{"dim", "[", "\<\"M\"\>", "]"}]}], "}"}], ",", "Reals", ",", 
        
        RowBox[{"{", "}"}]}], "]"}]}], ",", 
     RowBox[{"{", "2", "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.653790623685823*^9, {3.653791126257332*^9, 3.653791130939948*^9}}]
}, Open  ]],

Cell["Examples of   revEvenQ === True,", "Text",
 CellChangeTimes->{{3.650262885103448*^9, 3.650262901339533*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Through", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"revEvenQ", ",", "revOddQ"}], "}"}], "[", 
   RowBox[{"f1", ",", "g1", ",", "g1", ",", "f1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.650260397373719*^9, 3.650260411934349*^9}, {
  3.65026115749266*^9, 3.650261173687652*^9}, {3.650261235956604*^9, 
  3.65026132857969*^9}, {3.650261624383822*^9, 3.650261667615457*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "False"}], "}"}]], "Output",
 CellChangeTimes->{3.650260412528902*^9, 3.65026117623637*^9, 
  3.650261332914054*^9, 3.650261778109741*^9, 3.653791146442216*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Through", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"revEvenQ", ",", "revOddQ"}], "}"}], "[", 
   RowBox[{"f1", ",", "g1", ",", "f1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.650260397373719*^9, 3.650260411934349*^9}, {
   3.65026115749266*^9, 3.650261173687652*^9}, {3.650261235956604*^9, 
   3.65026132857969*^9}, {3.650261624383822*^9, 3.650261667615457*^9}, 
   3.650261797868874*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "False"}], "}"}]], "Output",
 CellChangeTimes->{3.650261798604609*^9, 3.653791148952896*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Through", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"revEvenQ", ",", "revOddQ"}], "}"}], "[", 
   RowBox[{"g1", ",", "g1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.650260397373719*^9, 3.650260411934349*^9}, {
  3.65026115749266*^9, 3.650261173687652*^9}, {3.650261235956604*^9, 
  3.65026132857969*^9}, {3.650261624383822*^9, 3.650261667615457*^9}, {
  3.650261797868874*^9, 3.650261819131771*^9}, {3.6502618554195127`*^9, 
  3.650261857611554*^9}, {3.6502619132745247`*^9, 3.650261913353779*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "False"}], "}"}]], "Output",
 CellChangeTimes->{3.6502628307662373`*^9, 3.6537911507767076`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Through", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"revEvenQ", ",", "revOddQ"}], "}"}], "[", 
   RowBox[{"f1", ",", "f1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.650260397373719*^9, 3.650260411934349*^9}, {
  3.65026115749266*^9, 3.650261173687652*^9}, {3.650261235956604*^9, 
  3.65026132857969*^9}, {3.650261624383822*^9, 3.650261667615457*^9}, {
  3.650261797868874*^9, 3.650261819131771*^9}, {3.6502618554195127`*^9, 
  3.650261857611554*^9}, {3.6502619132745247`*^9, 3.650261924282732*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "False"}], "}"}]], "Output",
 CellChangeTimes->{3.650261925201857*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Through", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"revEvenQ", ",", "revOddQ"}], "}"}], "[", 
   RowBox[{"f1", ",", "f1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.650260397373719*^9, 3.650260411934349*^9}, {
  3.65026115749266*^9, 3.650261173687652*^9}, {3.650261235956604*^9, 
  3.65026132857969*^9}, {3.650261624383822*^9, 3.650261667615457*^9}, {
  3.650261797868874*^9, 3.650261819131771*^9}, {3.6502618554195127`*^9, 
  3.650261857611554*^9}, {3.6502619132745247`*^9, 3.650261924282732*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "False"}], "}"}]], "Output",
 CellChangeTimes->{3.650261925201857*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Through", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"revEvenQ", ",", "revOddQ"}], "}"}], "[", 
   RowBox[{
   "g1", ",", " ", "f1", ",", "g2", ",", "f2", ",", "g2", ",", "f1", ",", 
    "g1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.650260397373719*^9, 3.650260411934349*^9}, {
   3.65026115749266*^9, 3.650261173687652*^9}, {3.650261235956604*^9, 
   3.65026132857969*^9}, {3.650261624383822*^9, 3.650261667615457*^9}, {
   3.650261797868874*^9, 3.650261819131771*^9}, {3.6502618554195127`*^9, 
   3.650261857611554*^9}, {3.6502619132745247`*^9, 3.650261924282732*^9}, {
   3.65026195628787*^9, 3.650262002937949*^9}, {3.650263014108444*^9, 
   3.6502630519639587`*^9}, 3.650263163211434*^9, {3.650263334168297*^9, 
   3.650263338499509*^9}, {3.650263381402937*^9, 3.650263385880945*^9}, {
   3.650263602277965*^9, 3.6502636289809017`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "True"}], "}"}]], "Output",
 CellChangeTimes->{
  3.650262004249692*^9, {3.6502630262357616`*^9, 3.650263053625669*^9}, 
   3.6502631648596478`*^9, {3.650263335028287*^9, 3.650263339989625*^9}, 
   3.65026338721548*^9, {3.650263613239751*^9, 3.6502636296268053`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Through", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"revEvenQ", ",", "revOddQ"}], "}"}], "[", "f1", "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.650260397373719*^9, 3.650260411934349*^9}, {
  3.65026115749266*^9, 3.650261173687652*^9}, {3.650261235956604*^9, 
  3.65026132857969*^9}, {3.650261624383822*^9, 3.650261667615457*^9}, {
  3.650261797868874*^9, 3.650261819131771*^9}, {3.6502618554195127`*^9, 
  3.650261857611554*^9}, {3.6502619132745247`*^9, 3.650261924282732*^9}, {
  3.65026195628787*^9, 3.650262002937949*^9}, {3.650262244904023*^9, 
  3.650262252357719*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "True"}], "}"}]], "Output",
 CellChangeTimes->{3.650262254151042*^9}]
}, Open  ]],

Cell["Examples of   revOddQ === True,", "Text",
 CellChangeTimes->{{3.650262885103448*^9, 3.650262913531752*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Through", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"revEvenQ", ",", "revOddQ"}], "}"}], "[", 
   RowBox[{"g1", ",", "f1", ",", "g1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.650260397373719*^9, 3.650260411934349*^9}, {
  3.65026115749266*^9, 3.650261173687652*^9}, {3.650261235956604*^9, 
  3.65026132857969*^9}, {3.650261624383822*^9, 3.650261667615457*^9}, {
  3.650261797868874*^9, 3.650261844235239*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "True"}], "}"}]], "Output",
 CellChangeTimes->{{3.650261819948206*^9, 3.650261845608411*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Through", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"revEvenQ", ",", "revOddQ"}], "}"}], "[", 
   RowBox[{
   "g1", ",", "f1", ",", "g2", ",", "f2", ",", "g2", ",", "f1", ",", "g1"}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.650260397373719*^9, 3.650260411934349*^9}, {
  3.65026115749266*^9, 3.650261173687652*^9}, {3.650261235956604*^9, 
  3.65026132857969*^9}, {3.650261624383822*^9, 3.650261667615457*^9}, {
  3.650261797868874*^9, 3.650261819131771*^9}, {3.6502618554195127`*^9, 
  3.650261857611554*^9}, {3.6502619132745247`*^9, 3.650261924282732*^9}, {
  3.65026195628787*^9, 3.650262002937949*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "True"}], "}"}]], "Output",
 CellChangeTimes->{3.650262004249692*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Through", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"revEvenQ", ",", "revOddQ"}], "}"}], "[", "f1", "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.650260397373719*^9, 3.650260411934349*^9}, {
  3.65026115749266*^9, 3.650261173687652*^9}, {3.650261235956604*^9, 
  3.65026132857969*^9}, {3.650261624383822*^9, 3.650261667615457*^9}, {
  3.650261797868874*^9, 3.650261819131771*^9}, {3.6502618554195127`*^9, 
  3.650261857611554*^9}, {3.6502619132745247`*^9, 3.650261924282732*^9}, {
  3.65026195628787*^9, 3.650262002937949*^9}, {3.650262244904023*^9, 
  3.650262252357719*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "True"}], "}"}]], "Output",
 CellChangeTimes->{3.650262254151042*^9}]
}, Open  ]],

Cell["Examples of   revEvenQ === False  &&  revOddQ === False,", "Text",
 CellChangeTimes->{{3.650262885103448*^9, 3.6502629552744923`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Through", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"revEvenQ", ",", "revOddQ"}], "}"}], "[", 
   RowBox[{"g1", ",", "f1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.650260397373719*^9, 3.650260411934349*^9}, {
  3.65026115749266*^9, 3.650261173687652*^9}, {3.650261235956604*^9, 
  3.65026132857969*^9}, {3.650261624383822*^9, 3.650261667615457*^9}, {
  3.650261797868874*^9, 3.650261819131771*^9}, {3.6502618554195127`*^9, 
  3.650261857611554*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "False"}], "}"}]], "Output",
 CellChangeTimes->{3.65026185892379*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Through", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"revEvenQ", ",", "revOddQ"}], "}"}], "[", 
   RowBox[{"f1", ",", "f2", ",", "f1", ",", "f2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.650260397373719*^9, 3.650260411934349*^9}, {
  3.65026115749266*^9, 3.650261173687652*^9}, {3.650261235956604*^9, 
  3.65026132857969*^9}, {3.650261624383822*^9, 3.650261667615457*^9}, {
  3.650261797868874*^9, 3.650261819131771*^9}, {3.6502618554195127`*^9, 
  3.650261857611554*^9}, {3.6502619132745247`*^9, 3.650261924282732*^9}, {
  3.65026195628787*^9, 3.6502619627140923`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "False"}], "}"}]], "Output",
 CellChangeTimes->{3.6502619655481653`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Through", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"revEvenQ", ",", "revOddQ"}], "}"}], "[", 
   RowBox[{"f1", ",", "g1", ",", "f2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.650260397373719*^9, 3.650260411934349*^9}, {
  3.65026115749266*^9, 3.650261173687652*^9}, {3.650261235956604*^9, 
  3.65026132857969*^9}, {3.650261624383822*^9, 3.650261667615457*^9}, {
  3.650261797868874*^9, 3.650261819131771*^9}, {3.6502618554195127`*^9, 
  3.650261857611554*^9}, {3.6502619132745247`*^9, 3.650261924282732*^9}, {
  3.65026195628787*^9, 3.650262002937949*^9}, {3.650262244904023*^9, 
  3.650262277285626*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"False", ",", "False"}], "}"}]], "Output",
 CellChangeTimes->{{3.650262267120058*^9, 3.650262277887347*^9}}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
-------------------------------------------------------------\
\>", "Text",
 CellChangeTimes->{{3.650262088710393*^9, 3.650262129194622*^9}}],

Cell["We then have  (not initialized ---  a better version later),", "Text",
 CellChangeTimes->{{3.6500515113060703`*^9, 3.650051514120865*^9}, {
  3.650264436422503*^9, 3.650264447653943*^9}, {3.6502724870486383`*^9, 
  3.6502725182646093`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"X__", "/;", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"{", "X", "}"}], "]"}], ">", "1"}], "&&", 
     RowBox[{"Same0or1Q", "[", 
      RowBox[{"degBracket", "[", "X", "]"}], "]"}], "&&", 
     RowBox[{"revOddQ", "[", "X", "]"}]}]}], "\[RightAngleBracket]"}], ":=", 
  "0"}]], "Input",
 CellChangeTimes->{{3.650050646994172*^9, 3.65005071445452*^9}, {
  3.650051440670052*^9, 3.650051457852375*^9}, {3.6500553235694447`*^9, 
  3.650055338214418*^9}, {3.650264451083426*^9, 3.6502644539944077`*^9}}],

Cell["\<\
degBracket[ a__]   returns the degree of the bracket   \[LeftAngleBracket] \
a__ \[RightAngleBracket]   with arguments  a__ ,\
\>", "Text",
 CellChangeTimes->{{3.650003058853785*^9, 3.6500031200692577`*^9}, {
  3.650070116648201*^9, 3.6500701337189407`*^9}, {3.650258359064166*^9, 
  3.650258359736121*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"degBracket", "[", "a__", "]"}], ":=", 
  RowBox[{
   RowBox[{"deg", "[", "a", "]"}], "-", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"{", "a", "}"}], "]"}], "-", "1"}], ")"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649844800216008*^9, 3.649844826053954*^9}, {
  3.649844878709824*^9, 3.649844895031105*^9}, {3.649895940859248*^9, 
  3.649895947532795*^9}, {3.6498969377018423`*^9, 3.6498969385977917`*^9}, {
  3.650002723586972*^9, 3.6500027263197327`*^9}, {3.6502732208978786`*^9, 
  3.6502732239691896`*^9}}],

Cell["\<\

Re. the above rule for  \[LeftAngleBracket] \[RightAngleBracket] \[Rule] 0.   \
 If  a bracket is deg 0 or 1 then its possible args are

                      For  deg0Q:         { 1, 1 } ,   { 1, 2__, 1 } .
                      For deg1Q:          {1, 2__ }    or   { 2__, 1 }   or   \
 { 1, 3, 1 },    { 1, 2___, 3, 2___, 1 }    

If the bracket is deg 0 or 1 and also revOddQ,  then it needs an odd number \
of  AntisymQ, hence an odd number of  2or3 that are AntisymQ.
The vanishing deg 0or1 bracket cases are:
Length 2:  none
Length 3:  \[LeftAngleBracket] X_?deg1Q,  Y_/;deg2or3Q[Y] && AntisymQ[Y],  X_ \
\[RightAngleBracket]    but that is just a special case of contraction of the \
same vector X twice on any  AntisymQ[Y].
Length 4:  none.  None for any even length, because the revOdd comes from a \
revOddQ at the center of the argument list.
Length 2n+1 :   \[LeftAngleBracket]1, 2__, 2or3, 2__, 1\[RightAngleBracket]   \
  <-----  The only rule.  \
\>", "Text",
 CellChangeTimes->{{3.650258376505822*^9, 3.650258710885178*^9}, {
   3.6502587928350143`*^9, 3.650258947921399*^9}, {3.650259033447257*^9, 
   3.650259080846476*^9}, {3.650259117454249*^9, 3.650259190700384*^9}, {
   3.650262385362492*^9, 3.650262397500535*^9}, {3.650262449296383*^9, 
   3.6502624526893*^9}, {3.6502625081767693`*^9, 3.6502625741767673`*^9}, {
   3.6502626951177197`*^9, 3.650262768093402*^9}, {3.6502637907507477`*^9, 
   3.650263885485708*^9}, {3.650264059175282*^9, 3.650264276179182*^9}, {
   3.650264324504834*^9, 3.65026439773678*^9}, {3.6502645660364857`*^9, 
   3.6502646470276337`*^9}, {3.650264725874284*^9, 3.6502647394741983`*^9}, {
   3.650264799729185*^9, 3.650264810306469*^9}, {3.650264908801694*^9, 
   3.650264909791615*^9}, {3.650266090863408*^9, 3.650266092527896*^9}, {
   3.6502687449708767`*^9, 3.6502687495635567`*^9}, {3.650272535719823*^9, 
   3.6502725647276993`*^9}, 3.6502732493772306`*^9}],

Cell["For brackets with  5, 7, 9, 11, ... args, ", "Text",
 CellChangeTimes->{{3.650265143516273*^9, 3.650265211435128*^9}, {
  3.650266075183762*^9, 3.650266083567978*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"X_", "?", "deg1Q"}], ",", 
      RowBox[{"Y1__", "?", "deg2Q"}], ",", 
      RowBox[{"Z_", "/;", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"deg2Q", "[", "Z", "]"}], "&&", 
          RowBox[{"AntisymQ", "[", "Z", "]"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"deg3Q", "[", "Z", "]"}], "&&", 
          RowBox[{"revOddQ", "[", "Z", "]"}]}], ")"}]}]}], ",", "Y2__", ",", 
      "X_"}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"{", "Y1", "}"}], "]"}], "===", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "Y2", "}"}], "]"}]}], "&&", 
     RowBox[{"Apply", "[", 
      RowBox[{"And", ",", 
       RowBox[{"ParityQ", "[", 
        RowBox[{
         RowBox[{"{", "Y1", "}"}], ",", 
         RowBox[{"rev", "[", 
          RowBox[{"{", "Y2", "}"}], "]"}]}], "]"}]}], "]"}]}]}], ":=", "0"}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650263903259405*^9, 3.650263992454253*^9}, 
   3.650264054702795*^9, {3.650264657577433*^9, 3.650264690006194*^9}, {
   3.650264823234932*^9, 3.650264869142906*^9}, {3.650264928341469*^9, 
   3.650264994136326*^9}, {3.6502650361124077`*^9, 3.650265087811019*^9}, {
   3.6502653546057568`*^9, 3.650265414558621*^9}, {3.650265480664217*^9, 
   3.6502654837732553`*^9}, {3.650265990341063*^9, 3.6502660277008457`*^9}, {
   3.650266722412408*^9, 3.65026679172255*^9}, {3.6502668931290483`*^9, 
   3.6502668966809473`*^9}, {3.650267181993198*^9, 3.6502672087738028`*^9}, {
   3.650267258709155*^9, 3.65026731716115*^9}, 3.650267707135778*^9, {
   3.650267870748414*^9, 3.650267984332355*^9}, {3.650268262632612*^9, 
   3.650268295608857*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "25", "]"}]], "Output"]
}, Open  ]],

Cell["Testing  --   \[LeftAngleBracket] , , \[RightAngleBracket]  \
simplification to zero", "Text",
 CellChangeTimes->{{3.6500541666107283`*^9, 3.650054170595172*^9}, {
  3.650054200994534*^9, 3.650054241490238*^9}}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{
   "w", ",", "z", ",", "F2", ",", "G2", ",", "H2", ",", "F3", ",", "G3", ",", 
    "H3"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"w", ",", "z"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"F2", ",", "G2", ",", "H2"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{
   RowBox[{"{", "3", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"F3", ",", "G3", ",", "H3"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumeAntisymmetric", "[", 
   RowBox[{"{", 
    RowBox[{"F2", ",", "F3"}], "}"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumeSymmetric", "[", 
   RowBox[{"{", 
    RowBox[{"G2", ",", "G3"}], "}"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6500522578657017`*^9, 3.650052258543476*^9}, {
  3.650052675873364*^9, 3.6500527667292137`*^9}, {3.65005345099533*^9, 
  3.6500535261454477`*^9}, {3.653791166827478*^9, 3.6537911774680357`*^9}}],

Cell["These should be zero,", "Text",
 CellChangeTimes->{{3.650054303137354*^9, 3.6500543096496363`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "F2", ",", "z"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "F2", ",", "F2", ",", "F2", ",", "z"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "F2", ",", "F3", ",", "F2", ",", "z"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "G2", ",", "F3", ",", "G2", ",", "z"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"rev", "[", "H2", "]"}], ",", "F3", ",", "H2", ",", "z"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"rev", "[", "H2", "]"}], ",", "F2", ",", "H2", ",", "z"}], 
  "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.650052929389757*^9, 3.650052967112214*^9}, {
  3.6500535437014313`*^9, 3.650053566686759*^9}, {3.6500542552530117`*^9, 
  3.650054297111526*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.650052936543285*^9, 3.65005296778883*^9}, 
   3.650053439696589*^9, 3.6500535679630213`*^9, 3.6500543141908493`*^9, 
   3.650055548231749*^9, 3.6500695483547583`*^9, 3.650267470255561*^9, 
   3.650267509342227*^9, 3.650268007498836*^9, 3.6502684412980556`*^9, 
   3.650272398619712*^9, 3.6537911968171377`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.650052936543285*^9, 3.65005296778883*^9}, 
   3.650053439696589*^9, 3.6500535679630213`*^9, 3.6500543141908493`*^9, 
   3.650055548231749*^9, 3.6500695483547583`*^9, 3.650267470255561*^9, 
   3.650267509342227*^9, 3.650268007498836*^9, 3.6502684412980556`*^9, 
   3.650272398619712*^9, 3.653791196822757*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.650052936543285*^9, 3.65005296778883*^9}, 
   3.650053439696589*^9, 3.6500535679630213`*^9, 3.6500543141908493`*^9, 
   3.650055548231749*^9, 3.6500695483547583`*^9, 3.650267470255561*^9, 
   3.650267509342227*^9, 3.650268007498836*^9, 3.6502684412980556`*^9, 
   3.650272398619712*^9, 3.653791196827443*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.650052936543285*^9, 3.65005296778883*^9}, 
   3.650053439696589*^9, 3.6500535679630213`*^9, 3.6500543141908493`*^9, 
   3.650055548231749*^9, 3.6500695483547583`*^9, 3.650267470255561*^9, 
   3.650267509342227*^9, 3.650268007498836*^9, 3.6502684412980556`*^9, 
   3.650272398619712*^9, 3.653791196831451*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.650052936543285*^9, 3.65005296778883*^9}, 
   3.650053439696589*^9, 3.6500535679630213`*^9, 3.6500543141908493`*^9, 
   3.650055548231749*^9, 3.6500695483547583`*^9, 3.650267470255561*^9, 
   3.650267509342227*^9, 3.650268007498836*^9, 3.6502684412980556`*^9, 
   3.650272398619712*^9, 3.6537911968361473`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.650052936543285*^9, 3.65005296778883*^9}, 
   3.650053439696589*^9, 3.6500535679630213`*^9, 3.6500543141908493`*^9, 
   3.650055548231749*^9, 3.6500695483547583`*^9, 3.650267470255561*^9, 
   3.650267509342227*^9, 3.650268007498836*^9, 3.6502684412980556`*^9, 
   3.650272398619712*^9, 3.653791196840848*^9}]
}, Open  ]],

Cell["These should not be zero,", "Text",
 CellChangeTimes->{{3.650054303137354*^9, 3.6500543096496363`*^9}, {
  3.6500555563985987`*^9, 3.650055557054861*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "G2", ",", "z"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "F2", ",", "G2", ",", "F2", ",", "z"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "F2", ",", "H3", ",", "F2", ",", "z"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "G2", ",", "G3", ",", "G2", ",", "z"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"rev", "[", "H2", "]"}], ",", "G3", ",", "H2", ",", "z"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"rev", "[", "H2", "]"}], ",", "H2", ",", "H2", ",", "z"}], 
  "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.650052929389757*^9, 3.650052967112214*^9}, {
  3.6500535437014313`*^9, 3.650053566686759*^9}, {3.6500542552530117`*^9, 
  3.650054297111526*^9}, {3.6500555669289827`*^9, 3.650055624752619*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "G2", ",", "z"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.65005562643963*^9, 3.650069550561014*^9, 
  3.650267583660934*^9, 3.650268443905634*^9, 3.650272400156887*^9, 
  3.653791202369315*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "F2", ",", "G2", ",", "F2", ",", "z"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.65005562643963*^9, 3.650069550561014*^9, 
  3.650267583660934*^9, 3.650268443905634*^9, 3.650272400156887*^9, 
  3.653791202374958*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "F2", ",", "H3", ",", "F2", ",", "z"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.65005562643963*^9, 3.650069550561014*^9, 
  3.650267583660934*^9, 3.650268443905634*^9, 3.650272400156887*^9, 
  3.6537912023793097`*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "G2", ",", "G3", ",", "G2", ",", "z"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.65005562643963*^9, 3.650069550561014*^9, 
  3.650267583660934*^9, 3.650268443905634*^9, 3.650272400156887*^9, 
  3.6537912023837337`*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"rev", "[", "H2", "]"}], ",", "G3", ",", "H2", ",", "z"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.65005562643963*^9, 3.650069550561014*^9, 
  3.650267583660934*^9, 3.650268443905634*^9, 3.650272400156887*^9, 
  3.6537912023879766`*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"rev", "[", "H2", "]"}], ",", "H2", ",", "H2", ",", "z"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.65005562643963*^9, 3.650069550561014*^9, 
  3.650267583660934*^9, 3.650268443905634*^9, 3.650272400156887*^9, 
  3.653791202392329*^9}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
----------\
\>", "Text",
 CellChangeTimes->{{3.650272415001049*^9, 3.650272421337182*^9}}],

Cell["\<\
For the case  deg2Q[X] ,  we have that    revOddQ[X]    and   revEvenQ[X]   \
coincide with  (the faster)   AntisymQ[X]   and   SymQ[X]   respectively  
(but they do not coincide for general degree ---- see the single arg defns of \
 revOddQ  and  revEvenQ  above),\
\>", "Text",
 CellChangeTimes->{{3.650266342492214*^9, 3.650266612776217*^9}, {
  3.650266665895493*^9, 3.650266668311659*^9}}],

Cell["07/09/2015  initialized,", "Text",
 CellChangeTimes->{{3.650580920426866*^9, 3.650580930279647*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg2revParityQ", "[", "X_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"AntisymQ", "[", "X", "]"}], "||", 
     RowBox[{"SymQ", "[", "X", "]"}]}], ")"}], "&&", " ", 
   RowBox[{"deg2Q", "[", "X", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6502705732002697`*^9, 3.650270623876171*^9}, 
   3.650270705538393*^9, {3.650270855616025*^9, 3.650270937473152*^9}, {
   3.650581245080353*^9, 3.650581249542301*^9}}],

Cell["\<\
Put vectors at the end of any 2-chain that has definite rev parity rather \
than at the begining,\
\>", "Text",
 CellChangeTimes->{{3.6502710175483093`*^9, 3.650271048187646*^9}, {
  3.650272233372692*^9, 3.650272250699267*^9}, {3.650272321882347*^9, 
  3.650272323530521*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"z_", "?", "deg1Q"}], ",", 
     RowBox[{"F__", "?", "deg2revParityQ"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"rev", "[", "F", "]"}], ",", "z"}], "\[RightAngleBracket]"}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6502710587178926`*^9, 3.650271166045677*^9}, {
  3.650581263592846*^9, 3.6505812680545893`*^9}, {3.650745887893157*^9, 
  3.650745892620556*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "26", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
For chains with rev-parity that have free slots that are symmetric or \
antisymmetric, put vectors at the end rather than at the begining.
This rule handles the case when the free slots are all from the one factor, \
including the case that there is just the tensor X, with either  AntisymQ[X] \
|| SymQ[X],\
\>", "Text",
 CellChangeTimes->{{3.6502710175483093`*^9, 3.650271048187646*^9}, {
  3.650272233372692*^9, 3.650272250699267*^9}, {3.650272321882347*^9, 
  3.650272323530521*^9}, {3.6505844348909073`*^9, 3.650584595992366*^9}, {
  3.6505848727249107`*^9, 3.650584880228497*^9}, {3.6505849695075197`*^9, 
  3.650585042419314*^9}, {3.6505853133274527`*^9, 3.650585328398781*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"z_", "?", "deg1Q"}], ",", 
     RowBox[{"F___", "?", "deg2revParityQ"}], ",", 
     RowBox[{"X_", "/;", 
      RowBox[{
       RowBox[{
        RowBox[{"deg", "[", "X", "]"}], ">", "2"}], "&&", 
       RowBox[{"SymQ", "[", "X", "]"}]}]}]}], "\[RightAngleBracket]"}], ":=", 
   
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"rev", "[", 
      RowBox[{"F", ",", "X"}], "]"}], ",", "z"}], "\[RightAngleBracket]"}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6502710587178926`*^9, 3.650271166045677*^9}, {
   3.650581263592846*^9, 3.6505812680545893`*^9}, {3.650584618268499*^9, 
   3.6505846783794518`*^9}, {3.6505848094814463`*^9, 
   3.6505848297976933`*^9}, {3.650585047479699*^9, 3.650585050536036*^9}, {
   3.6505854503594103`*^9, 3.650585459586931*^9}, 3.650615752125207*^9, {
   3.650746135766066*^9, 3.650746141146694*^9}, {3.652334762228489*^9, 
   3.652334777502294*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "27", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
27/09/2015  removed 1 incorrect rule and fixed the above rule  (the X  has to \
be last).\
\>", "Text",
 CellChangeTimes->{{3.6505812881145163`*^9, 3.650581325457808*^9}, {
  3.652335089493581*^9, 3.652335147830078*^9}, {3.6523351918920717`*^9, 
  3.6523352428032923`*^9}}],

Cell["\<\
The factor  revSignAntisym[ ]  depends on how many slots of  X  are free, so \
we need 2 rules corresponding to 1 or 2 slots of X contracted, \
\>", "Text",
 CellChangeTimes->{{3.650617297745625*^9, 3.6506174386397953`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"z_", "?", "deg1Q"}], ",", 
     RowBox[{"F1___", "?", "deg2revParityQ"}], ",", 
     RowBox[{"X_", "/;", 
      RowBox[{
       RowBox[{
        RowBox[{"deg", "[", "X", "]"}], ">", "2"}], "&&", 
       RowBox[{"AntisymQ", "[", "X", "]"}]}]}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{
    RowBox[{"revSignAntisym", "[", 
     RowBox[{
      RowBox[{"deg", "[", "X", "]"}], "-", "1"}], "]"}], 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"rev", "[", 
       RowBox[{"F1", ",", "X"}], "]"}], ",", "z"}], 
     "\[RightAngleBracket]"}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6502710587178926`*^9, 3.650271166045677*^9}, {
  3.650581263592846*^9, 3.6505812680545893`*^9}, {3.650584618268499*^9, 
  3.6505846783794518`*^9}, {3.6505848094814463`*^9, 3.6505848297976933`*^9}, {
  3.650585047479699*^9, 3.650585050536036*^9}, {3.6505854503594103`*^9, 
  3.650585459586931*^9}, {3.650615756045559*^9, 3.6506157595255213`*^9}, {
  3.650616587466153*^9, 3.650616599713323*^9}, {3.650617562531498*^9, 
  3.650617584770459*^9}, {3.65074617865355*^9, 3.650746184252913*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "28", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
If a 2-chain with parity is terminated by a vector at both ends, then order \
the bracket,\
\>", "Text",
 CellChangeTimes->{{3.650581816539373*^9, 3.6505818639972258`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"z1_", "?", "deg1Q"}], ",", 
      RowBox[{"F__", "?", "deg2revParityQ"}], ",", 
      RowBox[{"z2_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{"!", 
     RowBox[{"OrderedAkaQ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"z1", ",", "F", ",", "z2"}], "}"}], ",", 
       RowBox[{"Reverse", "[", 
        RowBox[{"{", 
         RowBox[{"z1", ",", "F", ",", "z2"}], "}"}], "]"}]}], "]"}]}]}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z2", ",", 
     RowBox[{"rev", "[", "F", "]"}], ",", "z1"}], "\[RightAngleBracket]"}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6505818950600443`*^9, 3.650581914776606*^9}, {
  3.6505819567696047`*^9, 3.650582022590459*^9}, {3.6505820634532967`*^9, 
  3.6505820678879633`*^9}, {3.650583968551214*^9, 3.650583971621039*^9}, {
  3.650746209258746*^9, 3.650746213338188*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "29", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
If a bracket, terminated by vectors at both ends, has free slots that are \
symmetric or antisymmetric, then order the bracket.
This rule handles the case when the free slots are all from the one factor, \
including the case that there is just the tensor X, with either  AntisymQ[X] \
|| SymQ[X],\
\>", "Text",
 CellChangeTimes->{{3.650581816539373*^9, 3.6505818639972258`*^9}, {
  3.6505874353652267`*^9, 3.650587518854253*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"z1_", "?", "deg1Q"}], ",", 
      RowBox[{"F1___", "?", "deg2revParityQ"}], ",", 
      RowBox[{"X_", "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"deg", "[", "X", "]"}], ">", "2"}], "&&", 
        RowBox[{"SymQ", "[", "X", "]"}]}]}], ",", 
      RowBox[{"F2___", "?", "deg2revParityQ"}], ",", 
      RowBox[{"z2_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{"!", 
     RowBox[{"OrderedAkaQ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"z1", ",", "F1", ",", "X", ",", "F2", ",", "z2"}], "}"}], ",", 
       RowBox[{"Reverse", "[", 
        RowBox[{"{", 
         RowBox[{"z1", ",", "F1", ",", "X", ",", "F2", ",", "z2"}], "}"}], 
        "]"}]}], "]"}]}]}], ":=", "\[IndentingNewLine]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z2", ",", 
     RowBox[{"rev", "[", 
      RowBox[{"F1", ",", "X", ",", "F2"}], "]"}], ",", "z1"}], 
    "\[RightAngleBracket]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6502710587178926`*^9, 3.650271166045677*^9}, {
   3.650581263592846*^9, 3.6505812680545893`*^9}, {3.650584618268499*^9, 
   3.6505846783794518`*^9}, {3.6505848094814463`*^9, 
   3.6505848297976933`*^9}, {3.650585047479699*^9, 3.650585050536036*^9}, {
   3.6505854503594103`*^9, 3.650585459586931*^9}, {3.650585525858429*^9, 
   3.6505857387890987`*^9}, {3.6505858337329493`*^9, 3.650585846898864*^9}, {
   3.650585938837146*^9, 3.650585953376088*^9}, {3.650585989597023*^9, 
   3.6505859966068783`*^9}, {3.650586169468774*^9, 3.65058618206513*^9}, {
   3.650586212699901*^9, 3.6505862283511353`*^9}, 3.65061570960264*^9, {
   3.65074623692829*^9, 3.6507462435818987`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "30", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"z1_", "?", "deg1Q"}], ",", 
      RowBox[{"F1___", "?", "deg2revParityQ"}], ",", 
      RowBox[{"X_", "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"deg", "[", "X", "]"}], ">", "2"}], "&&", 
        RowBox[{"AntisymQ", "[", "X", "]"}]}]}], ",", 
      RowBox[{"F2___", "?", "deg2revParityQ"}], ",", 
      RowBox[{"z2_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{"!", 
     RowBox[{"OrderedAkaQ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"z1", ",", "F1", ",", "X", ",", "F2", ",", "z2"}], "}"}], ",", 
       RowBox[{"Reverse", "[", 
        RowBox[{"{", 
         RowBox[{"z1", ",", "F1", ",", "X", ",", "F2", ",", "z2"}], "}"}], 
        "]"}]}], "]"}]}]}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"revSignAntisym", "[", 
     RowBox[{
      RowBox[{"deg", "[", "X", "]"}], "-", "2"}], "]"}], 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"z2", ",", 
      RowBox[{"rev", "[", 
       RowBox[{"F1", ",", "X", ",", "F2"}], "]"}], ",", "z1"}], 
     "\[RightAngleBracket]"}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6502710587178926`*^9, 3.650271166045677*^9}, {
  3.650581263592846*^9, 3.6505812680545893`*^9}, {3.650584618268499*^9, 
  3.6505846783794518`*^9}, {3.6505848094814463`*^9, 3.6505848297976933`*^9}, {
  3.650585047479699*^9, 3.650585050536036*^9}, {3.6505854503594103`*^9, 
  3.650585459586931*^9}, {3.650585525858429*^9, 3.6505857387890987`*^9}, {
  3.6505858337329493`*^9, 3.650585846898864*^9}, {3.650585938837146*^9, 
  3.650585953376088*^9}, {3.650585989597023*^9, 3.6505859966068783`*^9}, {
  3.650586169468774*^9, 3.65058618206513*^9}, {3.650586212699901*^9, 
  3.6505862283511353`*^9}, {3.650615716209523*^9, 3.6506157213730717`*^9}, {
  3.650616653955905*^9, 3.6506166556543417`*^9}, {3.650746252877935*^9, 
  3.650746259118039*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "31", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
Order closed 2-chains.  The bracket is  deg0Q  so no sign is necessary:   \
\[LeftAngleBracket] \[RightAngleBracket] =  rev[rev[ \[LeftAngleBracket] \
\[RightAngleBracket] ]] =  rev[ \[LeftAngleBracket]rev[  \
]\[RightAngleBracket] ] =  \[LeftAngleBracket]rev[  ]\[RightAngleBracket] \
\>", "Text",
 CellChangeTimes->{{3.6519962098179893`*^9, 3.651996297816771*^9}, {
  3.651996615636236*^9, 3.651996639940536*^9}, {3.651996739922563*^9, 
  3.651996768834125*^9}, {3.651996857344894*^9, 3.65199687070522*^9}, {
  3.651997003375052*^9, 3.651997081789473*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
        RowBox[{"F1_", "?", "deg2revParityQ"}], ",", 
        RowBox[{"F2__", "?", "deg2revParityQ"}]}], "\[RightAngleBracket]"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]], "/;", 
    RowBox[{"!", 
     RowBox[{"OrderedAkaQ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"F1", ",", "F2"}], "}"}], ",", 
       RowBox[{"Reverse", "[", 
        RowBox[{"{", 
         RowBox[{"F1", ",", "F2"}], "}"}], "]"}]}], "]"}]}]}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"rev", "[", 
       RowBox[{"F1", ",", "F2"}], "]"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6502710587178926`*^9, 3.650271166045677*^9}, {
   3.650581263592846*^9, 3.6505812680545893`*^9}, {3.650584618268499*^9, 
   3.6505846783794518`*^9}, {3.6505848094814463`*^9, 
   3.6505848297976933`*^9}, {3.650585047479699*^9, 3.650585050536036*^9}, {
   3.6505854503594103`*^9, 3.650585459586931*^9}, {3.650585525858429*^9, 
   3.6505857387890987`*^9}, {3.6505858337329493`*^9, 3.650585846898864*^9}, {
   3.650585938837146*^9, 3.650585953376088*^9}, {3.650585989597023*^9, 
   3.6505859966068783`*^9}, {3.650586169468774*^9, 3.65058618206513*^9}, {
   3.650586212699901*^9, 3.6505862283511353`*^9}, {3.650615716209523*^9, 
   3.6506157213730717`*^9}, {3.650616653955905*^9, 3.6506166556543417`*^9}, {
   3.650746252877935*^9, 3.650746259118039*^9}, {3.6519963246345673`*^9, 
   3.6519963447775097`*^9}, {3.651996654693738*^9, 3.651996688565378*^9}, 
   3.651996733173779*^9, {3.651996878753784*^9, 3.6519969639856253`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "32", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
Testing  --  move vector to the end of  any  2-chain with rev-parity\
\>", "Text",
 CellChangeTimes->{{3.650269020615079*^9, 3.650269040295083*^9}, {
  3.650271418823175*^9, 3.650271433558549*^9}, {3.650272173596541*^9, 
  3.650272218283959*^9}, {3.6507459366334953`*^9, 3.65074594330525*^9}}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"z", ",", "F1", ",", "F2", ",", " ", "G1", ",", "G2"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "z", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"F1", ",", "F2", ",", " ", "G1", ",", "G2"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumeAntisymmetric", "[", 
   RowBox[{"{", 
    RowBox[{"F1", ",", "F2"}], "}"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumeSymmetric", "[", 
   RowBox[{"{", 
    RowBox[{"G1", ",", "G2"}], "}"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6500522578657017`*^9, 3.650052258543476*^9}, {
  3.650052675873364*^9, 3.6500527667292137`*^9}, {3.65005345099533*^9, 
  3.6500535261454477`*^9}, {3.6502692091311817`*^9, 3.650269234711059*^9}, {
  3.650271452730679*^9, 3.6502714672434273`*^9}, {3.650271563848331*^9, 
  3.650271577542987*^9}, {3.6502720551618834`*^9, 3.650272126191928*^9}, {
  3.653791218010248*^9, 3.653791233834385*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"RulesUsed", "[", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1"}], "\[RightAngleBracket]"}], "]"}], "//", 
  "Column"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RulesUsed", "[", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "G1"}], "\[RightAngleBracket]"}], "]"}], "//",
   "Column"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RulesUsed", "[", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "G1"}], "\[RightAngleBracket]"}], "]"}], "//", 
  "Column"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RulesUsed", "[", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "G1", ",", "F2"}], "\[RightAngleBracket]"}], 
   "]"}], "//", "Column"}]}], "Input",
 CellChangeTimes->{{3.650272036699272*^9, 3.650272045487609*^9}, {
  3.65027210825996*^9, 3.650272144885317*^9}, {3.6507460463434687`*^9, 
  3.650746081030117*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"26", ",", "18", ",", "34", ",", "111"}], "}"}]},
    {
     RowBox[{"-", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"F1", ",", "z"}], "\[RightAngleBracket]"}]}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{
  3.6502720467047043`*^9, {3.650272101055978*^9, 3.650272148536469*^9}, 
   3.650745962715248*^9, {3.650746055714848*^9, 3.650746081731371*^9}, 
   3.653791247190721*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{
      "26", ",", "9", ",", "17", ",", "33", ",", "18", ",", "34", ",", 
       "111"}], "}"}]},
    {
     RowBox[{"-", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"G1", ",", "F1", ",", "z"}], "\[RightAngleBracket]"}]}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{
  3.6502720467047043`*^9, {3.650272101055978*^9, 3.650272148536469*^9}, 
   3.650745962715248*^9, {3.650746055714848*^9, 3.650746081731371*^9}, 
   3.653791247196576*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"26", ",", "17", ",", "33"}], "}"}]},
    {
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"G1", ",", "z"}], "\[RightAngleBracket]"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{
  3.6502720467047043`*^9, {3.650272101055978*^9, 3.650272148536469*^9}, 
   3.650745962715248*^9, {3.650746055714848*^9, 3.650746081731371*^9}, 
   3.653791247201206*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{
      "26", ",", "9", ",", "18", ",", "34", ",", "17", ",", "33", ",", "18", 
       ",", "34", ",", "111", ",", "111"}], "}"}]},
    {
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"F2", ",", "G1", ",", "F1", ",", "z"}], "\[RightAngleBracket]"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{
  3.6502720467047043`*^9, {3.650272101055978*^9, 3.650272148536469*^9}, 
   3.650745962715248*^9, {3.650746055714848*^9, 3.650746081731371*^9}, 
   3.653791247205772*^9}]
}, Open  ]],

Cell["\<\
These are correct and do not loop, however we don\[CloseCurlyQuote]t want \
them!  
rev[ ]  checks if its argument is  revEvenQ  or  revOddQ  and does no work if \
possible (see below).  But that is only good if the check is fast, which it \
is if, for example,  X  is something that 
has been decalared  SymQ  or  AntisymQ,  because then   revEvenQ  and  \
revOddQ  can be calculated quickly.  This is not the case for  calculating   \
revEvenQ  and  revOddQ  for a  \[LeftAngleBracket]  \[RightAngleBracket]
( as is evident using   StartDebug[ ] ).   It is much quicker to just apply \
rev to the contents of the bracket. So these are not initialized,\
\>", "Text",
 CellChangeTimes->{{3.65005152888833*^9, 3.6500516200392714`*^9}, 
   3.650051898243284*^9, {3.650070154711631*^9, 3.650070188166483*^9}, {
   3.650070222214188*^9, 3.65007022411854*^9}, {3.650271365480027*^9, 
   3.650271390760726*^9}, {3.650273475882872*^9, 3.650273629928955*^9}, {
   3.650273662552628*^9, 3.650273830550056*^9}, {3.650273880696033*^9, 
   3.650273914485519*^9}, {3.650274018788208*^9, 3.650274024435952*^9}, {
   3.653791305496221*^9, 3.65379131824771*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"revEvenQ", "[", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X__", "/;", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"{", "X", "}"}], "]"}], ">", "1"}]}], "\[RightAngleBracket]"}],
    "]"}], ":=", 
  RowBox[{"revEvenQ", "[", "X", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"revOddQ", "[", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X__", "/;", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"{", "X", "}"}], "]"}], ">", "1"}]}], "\[RightAngleBracket]"}],
    "]"}], ":=", 
  RowBox[{"revOddQ", "[", "X", "]"}]}]}], "Input",
 CellChangeTimes->{{3.650051746903507*^9, 3.650051854611063*^9}, {
  3.650272694715913*^9, 3.650272711034443*^9}, {3.65027346513629*^9, 
  3.650273469199576*^9}}],

Cell["Testing  --  rev[  \[LeftAngleBracket] , , , \[RightAngleBracket]  ]", \
"Text",
 CellChangeTimes->{{3.650269020615079*^9, 3.650269040295083*^9}}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"z", ",", "F", ",", "F3"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "z", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", "F", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{
   RowBox[{"{", "3", "}"}], ",", 
   RowBox[{"{", "F3", "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6500522578657017`*^9, 3.650052258543476*^9}, {
  3.650052675873364*^9, 3.6500527667292137`*^9}, {3.65005345099533*^9, 
  3.6500535261454477`*^9}, {3.6502692091311817`*^9, 3.650269234711059*^9}, {
  3.650272842262535*^9, 3.650272853557949*^9}, {3.653791376376685*^9, 
  3.653791396600873*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"StartDebug", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"F", ",", "z"}], "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "F"}], "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.650270394086413*^9, 3.650270397365893*^9}, {
  3.650271520727705*^9, 3.650271548502495*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"F", ",", "z"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{
  3.650270398442765*^9, {3.650271530986595*^9, 3.650271549864874*^9}, 
   3.6502727405790462`*^9, {3.65379141250248*^9, 3.653791415068078*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "F"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{
  3.650270398442765*^9, {3.650271530986595*^9, 3.650271549864874*^9}, 
   3.6502727405790462`*^9, {3.65379141250248*^9, 3.653791415073894*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"StopDebug", "[", "]"}]], "Input",
 CellChangeTimes->{{3.650271475915531*^9, 3.650271482806794*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"rev", "[", "F", "]"}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"rev", "[", "F", "]"}], ",", "z"}], 
  "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.650271254218693*^9, 3.650271256922554*^9}, {
  3.6502714907175198`*^9, 3.650271498702751*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]8\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", "x_List", "]"}], ":=", 
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", "x", "]"}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]8\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      Pattern[$CellContext`x, 
       Blank[List]]] := Map[$CellContext`rev, 
      Reverse[$CellContext`x]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791457534874*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"rev", "[", "F", "]"}]}], "}"}], "]"}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Map[$CellContext`rev, 
     Reverse[{$CellContext`z, 
       $CellContext`rev[$CellContext`F]}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791457601514*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]13\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"rev", "[", "X_", "]"}], "]"}], ":=", "X"}]}],
  SequenceForm["rule[\[VeryThinSpace]13\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      $CellContext`rev[
       Pattern[$CellContext`X, 
        Blank[]]]] := $CellContext`X]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791457607185*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["F",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`F]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.6537914577460423`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]16\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"f_", "?", "deg0or1Q"}], "]"}], ":=", "f"}]}],
  SequenceForm["rule[\[VeryThinSpace]16\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      PatternTest[
       Pattern[$CellContext`f, 
        Blank[]], $CellContext`deg0or1Q]] := $CellContext`f]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791457751089*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["z",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`z]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.6537914578973637`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]20\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"ParityQ", "[", 
     RowBox[{"X_List", ",", "Y_List"}], "]"}], ":=", 
    RowBox[{"MapThread", "[", 
     RowBox[{"ParityQ", ",", 
      RowBox[{"{", 
       RowBox[{"X", ",", "Y"}], "}"}]}], "]"}]}]}],
  SequenceForm["rule[\[VeryThinSpace]20\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`ParityQ[
      Pattern[$CellContext`X, 
       Blank[List]], 
      Pattern[$CellContext`Y, 
       Blank[List]]] := 
    MapThread[$CellContext`ParityQ, {$CellContext`X, $CellContext`Y}]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.6537914579033127`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"MapThread", "[", 
     RowBox[{"ParityQ", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"z", ",", 
          RowBox[{"rev", "[", "F", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"F", ",", "z"}], "}"}]}], "}"}]}], "]"}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    MapThread[$CellContext`ParityQ, {{$CellContext`z, 
       $CellContext`rev[$CellContext`F]}, {$CellContext`F, $CellContext`z}}]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791458048711*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]19\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"ParityQ", "[", 
     RowBox[{"X_", ",", "Y_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"X", "===", "Y"}], "||", 
     RowBox[{"X", "===", 
      RowBox[{"-", "Y"}]}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]19\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`ParityQ[
      Pattern[$CellContext`X, 
       Blank[]], 
      Pattern[$CellContext`Y, 
       Blank[]]] := 
    Or[$CellContext`X === $CellContext`Y, $CellContext`X === \
-$CellContext`Y]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791458053851*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{
     RowBox[{"z", "===", "F"}], "||", 
     RowBox[{"z", "===", 
      RowBox[{"-", "F"}]}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Or[$CellContext`z === $CellContext`F, $CellContext`z === \
-$CellContext`F]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791458199234*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]19\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"ParityQ", "[", 
     RowBox[{"X_", ",", "Y_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"X", "===", "Y"}], "||", 
     RowBox[{"X", "===", 
      RowBox[{"-", "Y"}]}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]19\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`ParityQ[
      Pattern[$CellContext`X, 
       Blank[]], 
      Pattern[$CellContext`Y, 
       Blank[]]] := 
    Or[$CellContext`X === $CellContext`Y, $CellContext`X === \
-$CellContext`Y]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.6537914582042227`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{
     RowBox[{
      RowBox[{"rev", "[", "F", "]"}], "===", "z"}], "||", 
     RowBox[{
      RowBox[{"rev", "[", "F", "]"}], "===", 
      RowBox[{"-", "z"}]}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Or[$CellContext`rev[$CellContext`F] === $CellContext`z, \
$CellContext`rev[$CellContext`F] === -$CellContext`z]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791458349195*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]147\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"revOrderedQ", "[", "f_", "]"}], ":=", 
    RowBox[{"OrderedQ", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListOfrevs", "[", "f", "]"}], ",", 
       RowBox[{"ListOfrevs", "[", 
        RowBox[{"rev", "[", "f", "]"}], "]"}]}], "}"}], "]"}]}]}],
  SequenceForm["rule[\[VeryThinSpace]147\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`revOrderedQ[
      Pattern[$CellContext`f, 
       Blank[]]] := OrderedQ[{
       $CellContext`ListOfrevs[$CellContext`f], 
       $CellContext`ListOfrevs[
        $CellContext`rev[$CellContext`f]]}]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791458354868*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"OrderedQ", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListOfrevs", "[", 
        RowBox[{"{", 
         RowBox[{"z", ",", 
          RowBox[{"rev", "[", "F", "]"}]}], "}"}], "]"}], ",", 
       RowBox[{"ListOfrevs", "[", 
        RowBox[{"rev", "[", 
         RowBox[{"{", 
          RowBox[{"z", ",", 
           RowBox[{"rev", "[", "F", "]"}]}], "}"}], "]"}], "]"}]}], "}"}], 
     "]"}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    OrderedQ[{
      $CellContext`ListOfrevs[{$CellContext`z, 
        $CellContext`rev[$CellContext`F]}], 
      $CellContext`ListOfrevs[
       $CellContext`rev[{$CellContext`z, 
         $CellContext`rev[$CellContext`F]}]]}]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791458501032*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]146\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"ListOfrevs", "[", "f_", "]"}], ":=", 
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"Reap", "[", 
       RowBox[{
        RowBox[{"f", "/.", "\[VeryThinSpace]", 
         RowBox[{
          RowBox[{"rev", "[", "x_", "]"}], "\[RuleDelayed]", 
          RowBox[{"Sow", "[", 
           RowBox[{"rev", "[", "x", "]"}], "]"}]}]}], ";"}], "]"}], 
      "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}]}]}],
  SequenceForm["rule[\[VeryThinSpace]146\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`ListOfrevs[
      Pattern[$CellContext`f, 
       Blank[]]] := Sort[
      Part[
       Reap[ReplaceAll[$CellContext`f, $CellContext`rev[
            Pattern[$CellContext`x, 
             Blank[]]] :> Sow[
            $CellContext`rev[$CellContext`x]]]; Null], 2]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791458587432*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"Reap", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z", ",", 
           RowBox[{"rev", "[", "F", "]"}]}], "}"}], "/.", "\[VeryThinSpace]", 
         
         RowBox[{
          RowBox[{"rev", "[", "x_", "]"}], "\[RuleDelayed]", 
          RowBox[{"Sow", "[", 
           RowBox[{"rev", "[", "x", "]"}], "]"}]}]}], ";"}], "]"}], 
      "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Sort[
     Part[
      Reap[ReplaceAll[{$CellContext`z, 
          $CellContext`rev[$CellContext`F]}, $CellContext`rev[
           Pattern[$CellContext`x, 
            Blank[]]] :> Sow[
           $CellContext`rev[$CellContext`x]]]; Null], 2]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791458675199*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]8\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", "x_List", "]"}], ":=", 
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", "x", "]"}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]8\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      Pattern[$CellContext`x, 
       Blank[List]]] := Map[$CellContext`rev, 
      Reverse[$CellContext`x]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.6537914586805058`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"rev", "[", "F", "]"}]}], "}"}], "]"}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Map[$CellContext`rev, 
     Reverse[{$CellContext`z, 
       $CellContext`rev[$CellContext`F]}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791458820594*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]13\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"rev", "[", "X_", "]"}], "]"}], ":=", "X"}]}],
  SequenceForm["rule[\[VeryThinSpace]13\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      $CellContext`rev[
       Pattern[$CellContext`X, 
        Blank[]]]] := $CellContext`X]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791458825741*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["F",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`F]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.65379145897178*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]16\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"f_", "?", "deg0or1Q"}], "]"}], ":=", "f"}]}],
  SequenceForm["rule[\[VeryThinSpace]16\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      PatternTest[
       Pattern[$CellContext`f, 
        Blank[]], $CellContext`deg0or1Q]] := $CellContext`f]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.6537914589771757`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["z",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`z]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791459122797*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]146\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"ListOfrevs", "[", "f_", "]"}], ":=", 
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"Reap", "[", 
       RowBox[{
        RowBox[{"f", "/.", "\[VeryThinSpace]", 
         RowBox[{
          RowBox[{"rev", "[", "x_", "]"}], "\[RuleDelayed]", 
          RowBox[{"Sow", "[", 
           RowBox[{"rev", "[", "x", "]"}], "]"}]}]}], ";"}], "]"}], 
      "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}]}]}],
  SequenceForm["rule[\[VeryThinSpace]146\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`ListOfrevs[
      Pattern[$CellContext`f, 
       Blank[]]] := Sort[
      Part[
       Reap[ReplaceAll[$CellContext`f, $CellContext`rev[
            Pattern[$CellContext`x, 
             Blank[]]] :> Sow[
            $CellContext`rev[$CellContext`x]]]; Null], 2]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791459128563*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"Reap", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"F", ",", "z"}], "}"}], "/.", "\[VeryThinSpace]", 
         RowBox[{
          RowBox[{"rev", "[", "x_", "]"}], "\[RuleDelayed]", 
          RowBox[{"Sow", "[", 
           RowBox[{"rev", "[", "x", "]"}], "]"}]}]}], ";"}], "]"}], 
      "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Sort[
     Part[
      Reap[ReplaceAll[{$CellContext`F, $CellContext`z}, $CellContext`rev[
           Pattern[$CellContext`x, 
            Blank[]]] :> Sow[
           $CellContext`rev[$CellContext`x]]]; Null], 2]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.65379145931944*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]148\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X__", "/;", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "X", "}"}], "]"}], ">", "1"}], "&&", 
       RowBox[{"DependsQ", "[", 
        RowBox[{
         RowBox[{"{", "X", "}"}], ",", "rev"}], "]"}], "&&", 
       RowBox[{"Same0or1Q", "[", 
        RowBox[{"degBracket", "[", "X", "]"}], "]"}], "&&", 
       RowBox[{"!", 
        RowBox[{"revEvenQ", "[", "X", "]"}]}], "&&", 
       RowBox[{"!", 
        RowBox[{"revOrderedQ", "[", 
         RowBox[{"{", "X", "}"}], "]"}]}]}]}], "\[RightAngleBracket]"}], ":=", 
    RowBox[{"AngleBracket", "@@", 
     RowBox[{"rev", "[", 
      RowBox[{"{", "X", "}"}], "]"}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]148\[VeryThinSpace]]:", "  ", 
   Defer[AngleBracket[
      Condition[
       Pattern[$CellContext`X, 
        BlankSequence[]], 
       And[Length[{$CellContext`X}] > 1, 
        $CellContext`DependsQ[{$CellContext`X}, $CellContext`rev], 
        $CellContext`Same0or1Q[
         $CellContext`degBracket[$CellContext`X]], 
        Not[
         $CellContext`revEvenQ[$CellContext`X]], 
        Not[
         $CellContext`revOrderedQ[{$CellContext`X}]]]]] := Apply[AngleBracket, 
      $CellContext`rev[{$CellContext`X}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.6537914593252974`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"AngleBracket", "@@", 
     RowBox[{"rev", "[", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"rev", "[", "F", "]"}]}], "}"}], "]"}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Apply[AngleBracket, 
     $CellContext`rev[{$CellContext`z, 
       $CellContext`rev[$CellContext`F]}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791459528595*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]8\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", "x_List", "]"}], ":=", 
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", "x", "]"}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]8\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      Pattern[$CellContext`x, 
       Blank[List]]] := Map[$CellContext`rev, 
      Reverse[$CellContext`x]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.6537914595338793`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"rev", "[", "F", "]"}]}], "}"}], "]"}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Map[$CellContext`rev, 
     Reverse[{$CellContext`z, 
       $CellContext`rev[$CellContext`F]}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.6537914597478228`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]13\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"rev", "[", "X_", "]"}], "]"}], ":=", "X"}]}],
  SequenceForm["rule[\[VeryThinSpace]13\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      $CellContext`rev[
       Pattern[$CellContext`X, 
        Blank[]]]] := $CellContext`X]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791459753446*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["F",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`F]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.6537914597591057`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]16\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"f_", "?", "deg0or1Q"}], "]"}], ":=", "f"}]}],
  SequenceForm["rule[\[VeryThinSpace]16\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      PatternTest[
       Pattern[$CellContext`f, 
        Blank[]], $CellContext`deg0or1Q]] := $CellContext`f]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791459763979*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["z",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`z]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791459877001*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"F", ",", "z"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{
  3.650271260141103*^9, {3.6502714862681093`*^9, 3.650271499363348*^9}, 
   3.6502719291869717`*^9, 3.650272750564642*^9, 3.6502732633427362`*^9, 
   3.6537914598824463`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]8\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", "x_List", "]"}], ":=", 
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", "x", "]"}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]8\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      Pattern[$CellContext`x, 
       Blank[List]]] := Map[$CellContext`rev, 
      Reverse[$CellContext`x]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791459888789*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rev", "[", "F", "]"}], ",", "z"}], "}"}], "]"}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Map[$CellContext`rev, 
     Reverse[{
       $CellContext`rev[$CellContext`F], $CellContext`z}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.6537914601140842`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]16\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"f_", "?", "deg0or1Q"}], "]"}], ":=", "f"}]}],
  SequenceForm["rule[\[VeryThinSpace]16\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      PatternTest[
       Pattern[$CellContext`f, 
        Blank[]], $CellContext`deg0or1Q]] := $CellContext`f]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791460119488*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["z",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`z]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791460336094*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]13\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"rev", "[", "X_", "]"}], "]"}], ":=", "X"}]}],
  SequenceForm["rule[\[VeryThinSpace]13\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      $CellContext`rev[
       Pattern[$CellContext`X, 
        Blank[]]]] := $CellContext`X]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.6537914603417873`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["F",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`F]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791460346871*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]20\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"ParityQ", "[", 
     RowBox[{"X_List", ",", "Y_List"}], "]"}], ":=", 
    RowBox[{"MapThread", "[", 
     RowBox[{"ParityQ", ",", 
      RowBox[{"{", 
       RowBox[{"X", ",", "Y"}], "}"}]}], "]"}]}]}],
  SequenceForm["rule[\[VeryThinSpace]20\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`ParityQ[
      Pattern[$CellContext`X, 
       Blank[List]], 
      Pattern[$CellContext`Y, 
       Blank[List]]] := 
    MapThread[$CellContext`ParityQ, {$CellContext`X, $CellContext`Y}]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791460351925*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"MapThread", "[", 
     RowBox[{"ParityQ", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"rev", "[", "F", "]"}], ",", "z"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", "F"}], "}"}]}], "}"}]}], "]"}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    MapThread[$CellContext`ParityQ, {{
       $CellContext`rev[$CellContext`F], $CellContext`z}, {$CellContext`z, \
$CellContext`F}}]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791460481777*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]19\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"ParityQ", "[", 
     RowBox[{"X_", ",", "Y_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"X", "===", "Y"}], "||", 
     RowBox[{"X", "===", 
      RowBox[{"-", "Y"}]}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]19\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`ParityQ[
      Pattern[$CellContext`X, 
       Blank[]], 
      Pattern[$CellContext`Y, 
       Blank[]]] := 
    Or[$CellContext`X === $CellContext`Y, $CellContext`X === \
-$CellContext`Y]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791460487052*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{
     RowBox[{
      RowBox[{"rev", "[", "F", "]"}], "===", "z"}], "||", 
     RowBox[{
      RowBox[{"rev", "[", "F", "]"}], "===", 
      RowBox[{"-", "z"}]}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Or[$CellContext`rev[$CellContext`F] === $CellContext`z, \
$CellContext`rev[$CellContext`F] === -$CellContext`z]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791460632324*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]19\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"ParityQ", "[", 
     RowBox[{"X_", ",", "Y_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"X", "===", "Y"}], "||", 
     RowBox[{"X", "===", 
      RowBox[{"-", "Y"}]}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]19\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`ParityQ[
      Pattern[$CellContext`X, 
       Blank[]], 
      Pattern[$CellContext`Y, 
       Blank[]]] := 
    Or[$CellContext`X === $CellContext`Y, $CellContext`X === \
-$CellContext`Y]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791460637681*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{
     RowBox[{"z", "===", "F"}], "||", 
     RowBox[{"z", "===", 
      RowBox[{"-", "F"}]}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Or[$CellContext`z === $CellContext`F, $CellContext`z === \
-$CellContext`F]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791460783938*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]147\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"revOrderedQ", "[", "f_", "]"}], ":=", 
    RowBox[{"OrderedQ", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListOfrevs", "[", "f", "]"}], ",", 
       RowBox[{"ListOfrevs", "[", 
        RowBox[{"rev", "[", "f", "]"}], "]"}]}], "}"}], "]"}]}]}],
  SequenceForm["rule[\[VeryThinSpace]147\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`revOrderedQ[
      Pattern[$CellContext`f, 
       Blank[]]] := OrderedQ[{
       $CellContext`ListOfrevs[$CellContext`f], 
       $CellContext`ListOfrevs[
        $CellContext`rev[$CellContext`f]]}]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791460789608*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"OrderedQ", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListOfrevs", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"rev", "[", "F", "]"}], ",", "z"}], "}"}], "]"}], ",", 
       RowBox[{"ListOfrevs", "[", 
        RowBox[{"rev", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rev", "[", "F", "]"}], ",", "z"}], "}"}], "]"}], "]"}]}], 
      "}"}], "]"}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    OrderedQ[{
      $CellContext`ListOfrevs[{
        $CellContext`rev[$CellContext`F], $CellContext`z}], 
      $CellContext`ListOfrevs[
       $CellContext`rev[{
         $CellContext`rev[$CellContext`F], $CellContext`z}]]}]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.65379146093396*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]146\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"ListOfrevs", "[", "f_", "]"}], ":=", 
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"Reap", "[", 
       RowBox[{
        RowBox[{"f", "/.", "\[VeryThinSpace]", 
         RowBox[{
          RowBox[{"rev", "[", "x_", "]"}], "\[RuleDelayed]", 
          RowBox[{"Sow", "[", 
           RowBox[{"rev", "[", "x", "]"}], "]"}]}]}], ";"}], "]"}], 
      "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}]}]}],
  SequenceForm["rule[\[VeryThinSpace]146\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`ListOfrevs[
      Pattern[$CellContext`f, 
       Blank[]]] := Sort[
      Part[
       Reap[ReplaceAll[$CellContext`f, $CellContext`rev[
            Pattern[$CellContext`x, 
             Blank[]]] :> Sow[
            $CellContext`rev[$CellContext`x]]]; Null], 2]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791460940288*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"Reap", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"rev", "[", "F", "]"}], ",", "z"}], "}"}], "/.", 
         "\[VeryThinSpace]", 
         RowBox[{
          RowBox[{"rev", "[", "x_", "]"}], "\[RuleDelayed]", 
          RowBox[{"Sow", "[", 
           RowBox[{"rev", "[", "x", "]"}], "]"}]}]}], ";"}], "]"}], 
      "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Sort[
     Part[
      Reap[ReplaceAll[{
          $CellContext`rev[$CellContext`F], $CellContext`z}, $CellContext`rev[
          
           Pattern[$CellContext`x, 
            Blank[]]] :> Sow[
           $CellContext`rev[$CellContext`x]]]; Null], 2]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791461085339*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]8\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", "x_List", "]"}], ":=", 
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", "x", "]"}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]8\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      Pattern[$CellContext`x, 
       Blank[List]]] := Map[$CellContext`rev, 
      Reverse[$CellContext`x]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.65379146109099*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rev", "[", "F", "]"}], ",", "z"}], "}"}], "]"}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Map[$CellContext`rev, 
     Reverse[{
       $CellContext`rev[$CellContext`F], $CellContext`z}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.6537914612357063`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]16\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"f_", "?", "deg0or1Q"}], "]"}], ":=", "f"}]}],
  SequenceForm["rule[\[VeryThinSpace]16\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      PatternTest[
       Pattern[$CellContext`f, 
        Blank[]], $CellContext`deg0or1Q]] := $CellContext`f]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.6537914612412148`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["z",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`z]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791461386644*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]13\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"rev", "[", "X_", "]"}], "]"}], ":=", "X"}]}],
  SequenceForm["rule[\[VeryThinSpace]13\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      $CellContext`rev[
       Pattern[$CellContext`X, 
        Blank[]]]] := $CellContext`X]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.6537914613922777`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["F",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`F]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.6537914616193457`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]146\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"ListOfrevs", "[", "f_", "]"}], ":=", 
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"Reap", "[", 
       RowBox[{
        RowBox[{"f", "/.", "\[VeryThinSpace]", 
         RowBox[{
          RowBox[{"rev", "[", "x_", "]"}], "\[RuleDelayed]", 
          RowBox[{"Sow", "[", 
           RowBox[{"rev", "[", "x", "]"}], "]"}]}]}], ";"}], "]"}], 
      "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}]}]}],
  SequenceForm["rule[\[VeryThinSpace]146\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`ListOfrevs[
      Pattern[$CellContext`f, 
       Blank[]]] := Sort[
      Part[
       Reap[ReplaceAll[$CellContext`f, $CellContext`rev[
            Pattern[$CellContext`x, 
             Blank[]]] :> Sow[
            $CellContext`rev[$CellContext`x]]]; Null], 2]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.6537914616243677`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"Reap", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z", ",", "F"}], "}"}], "/.", "\[VeryThinSpace]", 
         RowBox[{
          RowBox[{"rev", "[", "x_", "]"}], "\[RuleDelayed]", 
          RowBox[{"Sow", "[", 
           RowBox[{"rev", "[", "x", "]"}], "]"}]}]}], ";"}], "]"}], 
      "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Sort[
     Part[
      Reap[ReplaceAll[{$CellContext`z, $CellContext`F}, $CellContext`rev[
           Pattern[$CellContext`x, 
            Blank[]]] :> Sow[
           $CellContext`rev[$CellContext`x]]]; Null], 2]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.6537914618439903`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]148\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X__", "/;", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "X", "}"}], "]"}], ">", "1"}], "&&", 
       RowBox[{"DependsQ", "[", 
        RowBox[{
         RowBox[{"{", "X", "}"}], ",", "rev"}], "]"}], "&&", 
       RowBox[{"Same0or1Q", "[", 
        RowBox[{"degBracket", "[", "X", "]"}], "]"}], "&&", 
       RowBox[{"!", 
        RowBox[{"revEvenQ", "[", "X", "]"}]}], "&&", 
       RowBox[{"!", 
        RowBox[{"revOrderedQ", "[", 
         RowBox[{"{", "X", "}"}], "]"}]}]}]}], "\[RightAngleBracket]"}], ":=", 
    RowBox[{"AngleBracket", "@@", 
     RowBox[{"rev", "[", 
      RowBox[{"{", "X", "}"}], "]"}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]148\[VeryThinSpace]]:", "  ", 
   Defer[AngleBracket[
      Condition[
       Pattern[$CellContext`X, 
        BlankSequence[]], 
       And[Length[{$CellContext`X}] > 1, 
        $CellContext`DependsQ[{$CellContext`X}, $CellContext`rev], 
        $CellContext`Same0or1Q[
         $CellContext`degBracket[$CellContext`X]], 
        Not[
         $CellContext`revEvenQ[$CellContext`X]], 
        Not[
         $CellContext`revOrderedQ[{$CellContext`X}]]]]] := Apply[AngleBracket, 
      $CellContext`rev[{$CellContext`X}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791461850813*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"AngleBracket", "@@", 
     RowBox[{"rev", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rev", "[", "F", "]"}], ",", "z"}], "}"}], "]"}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Apply[AngleBracket, 
     $CellContext`rev[{
       $CellContext`rev[$CellContext`F], $CellContext`z}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.6537914618562727`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]8\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", "x_List", "]"}], ":=", 
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", "x", "]"}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]8\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      Pattern[$CellContext`x, 
       Blank[List]]] := Map[$CellContext`rev, 
      Reverse[$CellContext`x]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791461860633*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rev", "[", "F", "]"}], ",", "z"}], "}"}], "]"}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Map[$CellContext`rev, 
     Reverse[{
       $CellContext`rev[$CellContext`F], $CellContext`z}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.6537914619905643`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]16\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"f_", "?", "deg0or1Q"}], "]"}], ":=", "f"}]}],
  SequenceForm["rule[\[VeryThinSpace]16\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      PatternTest[
       Pattern[$CellContext`f, 
        Blank[]], $CellContext`deg0or1Q]] := $CellContext`f]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791461995784*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["z",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`z]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.653791462141684*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]13\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"rev", "[", "X_", "]"}], "]"}], ":=", "X"}]}],
  SequenceForm["rule[\[VeryThinSpace]13\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      $CellContext`rev[
       Pattern[$CellContext`X, 
        Blank[]]]] := $CellContext`X]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.65379146214699*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["F",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`F]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6502727477864027`*^9, 3.650273260906901*^9, 
  3.65379146229275*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "F"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{
  3.650271260141103*^9, {3.6502714862681093`*^9, 3.650271499363348*^9}, 
   3.6502719291869717`*^9, 3.650272750564642*^9, 3.6502732633427362`*^9, 
   3.653791462297324*^9}]
}, Open  ]],

Cell["No change because the bracket is deg 1,", "Text",
 CellChangeTimes->{{3.6502719621114683`*^9, 3.6502719745436363`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"z", ",", "F"}], "\[RightAngleBracket]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"F", ",", "z"}], "\[RightAngleBracket]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.650269077237143*^9, 3.650269108040287*^9}, {
  3.650269169895455*^9, 3.650269197783095*^9}, {3.6502692393663797`*^9, 
  3.6502692413035307`*^9}, {3.650271910525139*^9, 3.650271918019033*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]16\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"f_", "?", "deg0or1Q"}], "]"}], ":=", "f"}]}],
  SequenceForm["rule[\[VeryThinSpace]16\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      PatternTest[
       Pattern[$CellContext`f, 
        Blank[]], $CellContext`deg0or1Q]] := $CellContext`f]],
  Editable->False]], "Print",
 CellChangeTimes->{3.650272783900258*^9, 3.6502732927853107`*^9, 
  3.653791491868911*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"z", ",", "F"}], "\[RightAngleBracket]"}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    AngleBracket[$CellContext`z, $CellContext`F]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.650272783900258*^9, 3.6502732927853107`*^9, 
  3.653791491994136*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "F"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{
  3.65026911816849*^9, {3.6502691712720327`*^9, 3.650269175361498*^9}, 
   3.6502692427226686`*^9, {3.650271919052845*^9, 3.6502719261155376`*^9}, 
   3.6502727842822247`*^9, 3.650273292899642*^9, 3.6537914919987383`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]16\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"f_", "?", "deg0or1Q"}], "]"}], ":=", "f"}]}],
  SequenceForm["rule[\[VeryThinSpace]16\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      PatternTest[
       Pattern[$CellContext`f, 
        Blank[]], $CellContext`deg0or1Q]] := $CellContext`f]],
  Editable->False]], "Print",
 CellChangeTimes->{3.650272783900258*^9, 3.6502732927853107`*^9, 
  3.653791492003645*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"F", ",", "z"}], "\[RightAngleBracket]"}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    AngleBracket[$CellContext`F, $CellContext`z]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.650272783900258*^9, 3.6502732927853107`*^9, 
  3.6537914921452227`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"F", ",", "z"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{
  3.65026911816849*^9, {3.6502691712720327`*^9, 3.650269175361498*^9}, 
   3.6502692427226686`*^9, {3.650271919052845*^9, 3.6502719261155376`*^9}, 
   3.6502727842822247`*^9, 3.650273292899642*^9, 3.6537914921496572`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"StartDebug", "[", "]"}]], "Input",
 CellChangeTimes->{{3.650270326188039*^9, 3.650270330550959*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"z", ",", "F3"}], "\[RightAngleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{3.65027286979727*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]144\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"a_AngleBracket", "/;", 
      RowBox[{
       RowBox[{"Length", "[", "a", "]"}], ">", "1"}]}], "]"}], ":=", 
    RowBox[{"AngleBracket", "@@", 
     RowBox[{"rev", "[", 
      RowBox[{"List", "@@", "a"}], "]"}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]144\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      Condition[
       Pattern[$CellContext`a, 
        Blank[AngleBracket]], Length[$CellContext`a] > 1]] := 
    Apply[AngleBracket, 
      $CellContext`rev[
       Apply[List, $CellContext`a]]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.650270336618434*^9, 3.650272871079289*^9, 
  3.650273322892275*^9, 3.653791507896576*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"AngleBracket", "@@", 
     RowBox[{"rev", "[", 
      RowBox[{"List", "@@", 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"z", ",", "F3"}], "\[RightAngleBracket]"}]}], "]"}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Apply[AngleBracket, 
     $CellContext`rev[
      Apply[List, 
       AngleBracket[$CellContext`z, $CellContext`F3]]]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.650270336618434*^9, 3.650272871079289*^9, 
  3.650273322892275*^9, 3.653791508016862*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]8\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", "x_List", "]"}], ":=", 
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", "x", "]"}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]8\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      Pattern[$CellContext`x, 
       Blank[List]]] := Map[$CellContext`rev, 
      Reverse[$CellContext`x]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.650270336618434*^9, 3.650272871079289*^9, 
  3.650273322892275*^9, 3.653791508022091*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", 
      RowBox[{"{", 
       RowBox[{"z", ",", "F3"}], "}"}], "]"}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Map[$CellContext`rev, 
     Reverse[{$CellContext`z, $CellContext`F3}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.650270336618434*^9, 3.650272871079289*^9, 
  3.650273322892275*^9, 3.6537915081677732`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]16\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"f_", "?", "deg0or1Q"}], "]"}], ":=", "f"}]}],
  SequenceForm["rule[\[VeryThinSpace]16\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      PatternTest[
       Pattern[$CellContext`f, 
        Blank[]], $CellContext`deg0or1Q]] := $CellContext`f]],
  Editable->False]], "Print",
 CellChangeTimes->{3.650270336618434*^9, 3.650272871079289*^9, 
  3.650273322892275*^9, 3.6537915081721983`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["z",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`z]],
  Editable->False]], "Print",
 CellChangeTimes->{3.650270336618434*^9, 3.650272871079289*^9, 
  3.650273322892275*^9, 3.65379150831914*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"rev", "[", "F3", "]"}], ",", "z"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.6502703369726152`*^9, 3.6502728738271923`*^9, 
  3.650273323355638*^9, 3.653791508323839*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"rev", "[", "F3", "]"}], ",", "z"}], 
  "\[RightAngleBracket]"}]], "Input"],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"rev", "[", "F3", "]"}], ",", "z"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.650273130390238*^9, 3.653791540035365*^9}]
}, Open  ]],

Cell["Testing  --   revEvenQ, revOddQ   on   \[LeftAngleBracket] , , \
\[RightAngleBracket]", "Text",
 CellChangeTimes->{{3.650051989650198*^9, 3.650052028353804*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Definition", "[", "revEvenQ", "]"}]], "Input",
 CellChangeTimes->{{3.6500536554245653`*^9, 3.6500536631446333`*^9}}],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {GridBox[{
       {
        RowBox[{
         RowBox[{"revEvenQ", "[", 
          RowBox[{"x_", "/;", 
           RowBox[{
            RowBox[{"SymQ", "[", "x", "]"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"AntisymQ", "[", "x", "]"}], "&&", 
              RowBox[{"EvenQ", "[", 
               RowBox[{"Floor", "[", 
                FractionBox[
                 RowBox[{"deg", "[", "x", "]"}], "2"], "]"}], "]"}]}], 
             ")"}]}]}], "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "16", "]"}], ";", 
           RowBox[{"Snoopr", "[", "True", "]"}]}], ")"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"revEvenQ", "[", 
          RowBox[{"\[LeftAngleBracket]", 
           RowBox[{"X__", "/;", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"{", "X", "}"}], "]"}], ">", "1"}]}], 
           "\[RightAngleBracket]"}], "]"}], ":=", 
         RowBox[{"revEvenQ", "[", "X", "]"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"revEvenQ", "[", "_", "]"}], ":=", "False"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"revEvenQ", "[", 
          RowBox[{"X__", "/;", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"{", "X", "}"}], "]"}], ">", "1"}], "&&", 
            RowBox[{"And", "@@", 
             RowBox[{"ParityQ", "[", 
              RowBox[{
               RowBox[{"{", "X", "}"}], ",", 
               RowBox[{"rev", "[", 
                RowBox[{"{", "X", "}"}], "]"}]}], "]"}]}], "&&", 
            RowBox[{
             RowBox[{"Times", "@@", 
              RowBox[{"Parity", "[", 
               RowBox[{
                RowBox[{"{", "X", "}"}], ",", 
                RowBox[{"rev", "[", 
                 RowBox[{"{", "X", "}"}], "]"}]}], "]"}]}], "===", "1"}]}]}], 
          "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "22", "]"}], ";", 
           RowBox[{"Snoopr", "[", "True", "]"}]}], ")"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"revEvenQ", "[", "__", "]"}], ":=", "False"}]}
      },
      BaselinePosition->{Baseline, {1, 1}},
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{"Columns" -> {{
           Scaled[0.999]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  Definition[$CellContext`revEvenQ],
  Editable->False]], "Output",
 CellChangeTimes->{3.650053664539919*^9, 3.650053779272758*^9, 
  3.650053834846162*^9, 3.6500555225940733`*^9, 3.650068761219112*^9, 
  3.650068857353279*^9, 3.6500691050612497`*^9, 3.6500692031095753`*^9, 
  3.65006929710749*^9, 3.650268980056772*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Definition", "[", "revOddQ", "]"}]], "Input",
 CellChangeTimes->{{3.650054066455345*^9, 3.650054067019026*^9}}],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {GridBox[{
       {
        RowBox[{
         RowBox[{"revOddQ", "[", 
          RowBox[{"x_", "/;", 
           RowBox[{
            RowBox[{"AntisymQ", "[", "x", "]"}], "&&", 
            RowBox[{"OddQ", "[", 
             RowBox[{"Floor", "[", 
              FractionBox[
               RowBox[{"deg", "[", "x", "]"}], "2"], "]"}], "]"}]}]}], "]"}], 
         ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "17", "]"}], ";", 
           RowBox[{"Snoopr", "[", "True", "]"}]}], ")"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"revOddQ", "[", 
          RowBox[{"\[LeftAngleBracket]", 
           RowBox[{"X__", "/;", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"{", "X", "}"}], "]"}], ">", "1"}]}], 
           "\[RightAngleBracket]"}], "]"}], ":=", 
         RowBox[{"revOddQ", "[", "X", "]"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"revOddQ", "[", "_", "]"}], ":=", "False"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"revOddQ", "[", 
          RowBox[{"X__", "/;", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"{", "X", "}"}], "]"}], ">", "1"}], "&&", 
            RowBox[{"And", "@@", 
             RowBox[{"ParityQ", "[", 
              RowBox[{
               RowBox[{"{", "X", "}"}], ",", 
               RowBox[{"rev", "[", 
                RowBox[{"{", "X", "}"}], "]"}]}], "]"}]}], "&&", 
            RowBox[{
             RowBox[{"Times", "@@", 
              RowBox[{"Parity", "[", 
               RowBox[{
                RowBox[{"{", "X", "}"}], ",", 
                RowBox[{"rev", "[", 
                 RowBox[{"{", "X", "}"}], "]"}]}], "]"}]}], "===", 
             RowBox[{"-", "1"}]}]}]}], "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "23", "]"}], ";", 
           RowBox[{"Snoopr", "[", "True", "]"}]}], ")"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"revOddQ", "[", "__", "]"}], ":=", "False"}]}
      },
      BaselinePosition->{Baseline, {1, 1}},
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{"Columns" -> {{
           Scaled[0.999]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  Definition[$CellContext`revOddQ],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.650054068443204*^9, {3.650054118591814*^9, 3.6500541317749*^9}, 
   3.650055527170158*^9, 3.6500691090170097`*^9, 3.650069214604821*^9, 
   3.650069307509893*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"f", ",", "g"}], "]"}]], "Input",
 CellChangeTimes->{{3.650054046432786*^9, 3.650054052057866*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"revEvenQ", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"rev", "[", "f", "]"}], ",", "f"}], "\[RightAngleBracket]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"revEvenQ", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"f", ",", 
    RowBox[{"rev", "[", "f", "]"}]}], "\[RightAngleBracket]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.650049318698945*^9, 3.650049332859076*^9}, {
  3.650050131451367*^9, 3.6500501435837*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6500493211072273`*^9, 3.650049334309312*^9}, 
   3.650050103759852*^9, 3.650050144096133*^9, 3.650050252421129*^9, 
   3.650054408740419*^9, 3.650055533814561*^9, 3.650068961033267*^9, 
   3.6500695384764423`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6500493211072273`*^9, 3.650049334309312*^9}, 
   3.650050103759852*^9, 3.650050144096133*^9, 3.650050252421129*^9, 
   3.650054408740419*^9, 3.650055533814561*^9, 3.650068961033267*^9, 
   3.650069538480419*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"revEvenQ", "[", 
  RowBox[{"g", ",", "f"}], "]"}]], "Input",
 CellChangeTimes->{{3.650052152706697*^9, 3.650052155841344*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.650052157039716*^9, 3.650052166884597*^9}, {
   3.650052212340345*^9, 3.650052228344988*^9}, 3.6500544249468*^9, 
   3.650055538129534*^9, 3.650068962295286*^9, 3.6500695400567493`*^9}]
}, Open  ]],

Cell["\<\

Since argument  f  is evaluated before application of rev,  f  is presumably \
in its simplest possible form.  So if   f   is   revEvenQ  or  revOddQ, the \
desired answer is trivial,\
\>", "Text",
 CellChangeTimes->{{3.6499877719667463`*^9, 3.649987920029004*^9}, {
   3.649988231272996*^9, 3.649988241032853*^9}, {3.6500696429899273`*^9, 
   3.65006964746973*^9}, 3.650274012085231*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"f_", "?", "revEvenQ"}], "]"}], ":=", "f"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"f_", "?", "revOddQ"}], "]"}], ":=", 
    RowBox[{"-", "f"}]}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6498043816183643`*^9, 3.649804393346018*^9}, {
   3.649806489732465*^9, 3.649806526724436*^9}, {3.649806815188157*^9, 
   3.6498068325284758`*^9}, {3.649806890991766*^9, 3.64980689340765*^9}, {
   3.649807017053664*^9, 3.649807030429277*^9}, 3.649807083628337*^9, 
   3.649813866528719*^9, {3.649837056098827*^9, 3.649837060255464*^9}, {
   3.6499833378049088`*^9, 3.649983341708701*^9}, {3.649984259072506*^9, 
   3.649984259758236*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "33", "]"}]], "Output"],

Cell[BoxData[
 RowBox[{"rule", "[", "34", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"rev", "[", "X_SeriesData", "]"}], ":=", 
   RowBox[{"MapAt", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{"rev", ",", "#"}], "]"}], "&"}], ",", "X", ",", "3"}], "]"}]}],
   "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5426061517950363`*^9, 3.542606151796256*^9}, {
   3.614895901158222*^9, 3.6148959034629717`*^9}, 3.616728160665531*^9, {
   3.6498138880130157`*^9, 3.649813888258932*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "35", "]"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing:", "Subsubsection",
 CellChangeTimes->{{3.477548386475421*^9, 3.477548565420809*^9}, 
   3.47757627386733*^9, {3.477577260676643*^9, 3.477577287709584*^9}, {
   3.477577359071555*^9, 3.477577397367381*^9}, {3.477577433776634*^9, 
   3.477577438302905*^9}, {3.477577915452042*^9, 3.477577932199367*^9}, {
   3.478618523218866*^9, 3.478618600064865*^9}, {3.478618655462275*^9, 
   3.478618701947495*^9}, {3.478618763071931*^9, 3.47861878946664*^9}, {
   3.478619857121208*^9, 3.478619930568765*^9}}],

Cell[BoxData[
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.61492058617906*^9, 3.614920596253229*^9}, 
   3.614921974357445*^9, 3.614922272695059*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"rev", "[", 
  RowBox[{"{", 
   RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"rev", "[", 
  RowBox[{"{", "a", "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"rev", "[", 
  RowBox[{"{", "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6149203218457203`*^9, 3.6149203334592123`*^9}, {
  3.6149204191417017`*^9, 3.614920431555825*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"rev", "[", "d", "]"}], ",", 
   RowBox[{"rev", "[", "c", "]"}], ",", 
   RowBox[{"rev", "[", "b", "]"}], ",", 
   RowBox[{"rev", "[", "a", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.614920334097167*^9, {3.614920425598432*^9, 3.6149204325227633`*^9}, 
   3.6149205991316767`*^9, 3.615260342504547*^9, 3.615264258627891*^9, 
   3.6152720342455807`*^9, 3.615272207744473*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"rev", "[", "a", "]"}], "}"}]], "Output",
 CellChangeTimes->{
  3.614920334097167*^9, {3.614920425598432*^9, 3.6149204325227633`*^9}, 
   3.6149205991316767`*^9, 3.615260342504547*^9, 3.615264258627891*^9, 
   3.6152720342455807`*^9, 3.615272207747364*^9}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.614920334097167*^9, {3.614920425598432*^9, 3.6149204325227633`*^9}, 
   3.6149205991316767`*^9, 3.615260342504547*^9, 3.615264258627891*^9, 
   3.6152720342455807`*^9, 3.615272207749569*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"rev", "[", 
  RowBox[{
  "a", "\[CircleTimes]", "b", "\[CircleTimes]", "c", "\[CircleTimes]", "d"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"rev", "[", 
  RowBox[{
   RowBox[{"-", "a"}], "\[CircleTimes]", "b", "\[CircleTimes]", "c", 
   "\[CircleTimes]", "d"}], "]"}]}], "Input",
 CellChangeTimes->{{3.614920581458831*^9, 3.6149206405018253`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rev", "[", "d", "]"}], "\[CircleTimes]", 
  RowBox[{"rev", "[", "c", "]"}], "\[CircleTimes]", 
  RowBox[{"rev", "[", "b", "]"}], "\[CircleTimes]", 
  RowBox[{"rev", "[", "a", "]"}]}]], "Output",
 CellChangeTimes->{{3.61492062734595*^9, 3.614920641378642*^9}, 
   3.6149206904897213`*^9, 3.615260342608222*^9, 3.61526425887145*^9, 
   3.6152720343576937`*^9, 3.615272207868681*^9}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"rev", "[", "d", "]"}], "\[CircleTimes]", 
    RowBox[{"rev", "[", "c", "]"}], "\[CircleTimes]", 
    RowBox[{"rev", "[", "b", "]"}], "\[CircleTimes]", 
    RowBox[{"rev", "[", "a", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.61492062734595*^9, 3.614920641378642*^9}, 
   3.6149206904897213`*^9, 3.615260342608222*^9, 3.61526425887145*^9, 
   3.6152720343576937`*^9, 3.61527220787322*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"deg", "[", 
  RowBox[{"rev", "[", 
   RowBox[{"a1", "\[CircleTimes]", "b", "\[CircleTimes]", "c"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.478518018597093*^9, 3.478518028193394*^9}, {
   3.478518061015849*^9, 3.478518068785461*^9}, 3.479721987394504*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", "a1", "]"}], "+", 
  RowBox[{"deg", "[", "b", "]"}], "+", 
  RowBox[{"deg", "[", "c", "]"}]}]], "Output",
 CellChangeTimes->{
  3.478518028824211*^9, {3.478518062051417*^9, 3.478518070960081*^9}, 
   3.478518486733335*^9, 3.478641454543831*^9, 3.478677229578047*^9, 
   3.478697557907379*^9, 3.478714942768139*^9, 3.478769065946065*^9, 
   3.478786922130382*^9, 3.478806939703678*^9, 3.478860370820519*^9, 
   3.478931074018971*^9, 3.478973087376959*^9, 3.479020087170594*^9, 
   3.479024519738838*^9, 3.479046777722337*^9, 3.479046987973047*^9, 
   3.479054579861009*^9, 3.47910366817201*^9, 3.479112698895402*^9, 
   3.479148906066184*^9, 3.479189602561598*^9, 3.479201558633372*^9, 
   3.479225792849702*^9, 3.479299428770158*^9, 3.479324876907785*^9, 
   3.47932691592273*^9, 3.479358947727983*^9, 3.479454095733376*^9, 
   3.479919160368909*^9, 3.480312932598865*^9, 3.480317275469985*^9, 
   3.480328333657802*^9, 3.480328587940391*^9, 3.480333475153856*^9, 
   3.480333970899746*^9, 3.480334701926994*^9, 3.48066131120988*^9, 
   3.480661695798922*^9, 3.480662409239278*^9, 3.5180811311697903`*^9, 
   3.6137168376362667`*^9, 3.613718510378804*^9, 3.6137186932835503`*^9, 
   3.61526034270462*^9, 3.615264258987597*^9, 3.615272034370392*^9, 
   3.615272208002829*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"a", "\[CircleTimes]", "b", "\[CircleTimes]", "c"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rev", "[", "c", "]"}], "\[CircleTimes]", 
  RowBox[{"rev", "[", "b", "]"}], "\[CircleTimes]", 
  RowBox[{"rev", "[", "a", "]"}]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQB2LzhsnM+1+9dHzFdiMKRD+8dzH1N5Be5LT1Ls/rl461
8w+eEgPSuva33OWB9LbP9lstgfSOfa65TkD6pnKFsQ+QbumP9UoD0k6mThc6
gPSVix+C5wLpP6bP3bYAaf95Pwq2AenuZeb+B4H0iS31mSDaRbJG7iiQ7nfv
ErsLpOVy4+ofAukLh5x1PwPp5CthPOxvXjoe8b/2iAdIP74rt0MCSD/JmrvG
BkT/XCjpCaQrcpokvID0uUfVeyKB9A3mH4YdQJojksc9++1Lx9fXp/Vov3vp
qCxXuFoXSL/23CpoDKQFNjQZguhJ9ulTTIH0z28xl0B0xv4DumZAWuXBs+VX
gbT5wZ/XQfTbeZqG14D0l540XlOzV44FC7fpzHvzyvHfibN/QTSX/yqR+UD6
ZNqta/3vXzm2SCccmAikDU38e6YCaYEmhkUgGgDdo9pD
  "]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Cyclic[ ]", "Subsubsection"],

Cell["\<\

Previously called CyclicSum[ ].   Changed in Ver 0.6.0 with introduction of \
new  CyclicSum[ ]  function.\
\>", "Text"],

Cell["\<\

See   mvCyclic[ ]   for generalization to subsets of slots.  
See also   CyclicSum [ X ,  { i, j, ... } ]   defined later for substitutions \
into arbitrary expressions X  ( similar to  AlternatingSum  and  SymmetricSum \
).\
\>", "Text"],

Cell[BoxData[
 RowBox[{"Clear", "[", "Cyclic", "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cyclic", "[", "X_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"Apply", "[", 
         RowBox[{"SameQ", ",", 
          RowBox[{"SlotType", "[", "X", "]"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<CyclicSum: The given argument has mixed slot types, \>\"", ",", 
          
          RowBox[{"SlotType", "[", "X", "]"}], ",", "\"\<.\>\""}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"deg", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mv", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"j", ",", "n"}], "]"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", 
             RowBox[{"j", "-", "1"}]}], "]"}]}], "]"}], "]"}], "[", "X", 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"deg", "[", "X", "]"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Tensor slot rearrangement :    mv[ ] ,  mvSignature[ ],  mvInverse[ ]         \
                   \
\>", "Subsection",
 CellChangeTimes->{{3.6117004172917347`*^9, 3.611700487110237*^9}, {
   3.611794160708014*^9, 3.6117941632039413`*^9}, {3.611801723060134*^9, 
   3.611801724660182*^9}, {3.611803255881888*^9, 3.611803257769734*^9}, 
   3.611808086541277*^9, {3.612203398599391*^9, 3.6122034089317417`*^9}, {
   3.6147368827938766`*^9, 3.6147369178980637`*^9}, {3.614812643311215*^9, 
   3.6148126845745497`*^9}, {3.614812846450317*^9, 3.614812856399665*^9}, 
   3.614827869186965*^9, {3.6148309305785093`*^9, 3.614830953890073*^9}, {
   3.6152522877974377`*^9, 3.615252289676409*^9}, {3.615254438802102*^9, 
   3.615254439313552*^9}}],

Cell[TextData[{
 "The arguments of  mv  specify the arrangement of the slots of  X.  We deal \
with expressions of the form \n\n                                             \
                         mv[ ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["j", "1"], ",", " ", 
    SubscriptBox["j", "2"], ",", " ", "...", " ", ",", " ", 
    SubscriptBox["j", "n"]}], TraditionalForm]]],
 " ] [ X ]            where  n = deg[ X ]   and   ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["j", "k"], "\[Element]"}], TraditionalForm]]],
 "  { 1, 2, 3, ..., n } ,  with  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["j", 
    RowBox[{"k", " "}]], TraditionalForm]]],
 " distinct.\n                                 \nwhich says that slots   { 1, \
2, 3, ..., n }    have been permuted to  { ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["j", "1"], ",", " ", 
    SubscriptBox["j", "2"], ",", " ", "...", " ", ",", " ", 
    SubscriptBox["j", "n"]}], TraditionalForm]]],
 " } .  In particular,\n\n                                                    \
                                   mv[ 1, 2, 3, ..., n  ] [ X ]  =  X         \
 where  n = deg[ X ] .      \n                                                \
                                                                              \
                                               \nTranslation to tensor index \
notation can be done using  mvInverse[ ].                                     \
                      "
}], "Text",
 CellChangeTimes->{{3.611621111385861*^9, 3.611621163211791*^9}, {
   3.611621348510483*^9, 3.6116214994210787`*^9}, {3.611621579069466*^9, 
   3.61162163182172*^9}, {3.611621689278077*^9, 3.611621759070204*^9}, {
   3.6116220623516407`*^9, 3.611622119807776*^9}, {3.611622578449768*^9, 
   3.611622583617832*^9}, {3.611622623473901*^9, 3.6116227698906116`*^9}, 
   3.6116237877667313`*^9, {3.6116238423112297`*^9, 3.611623846935069*^9}, {
   3.61162391403933*^9, 3.611624039751965*^9}, {3.611624124808857*^9, 
   3.611624132120658*^9}, 3.61162421674918*^9, {3.6116250782233477`*^9, 
   3.611625112284037*^9}, {3.61162518343629*^9, 3.6116252984763927`*^9}, {
   3.6116281339749193`*^9, 3.611628326439302*^9}, 3.611628368103758*^9, {
   3.6116407365952177`*^9, 3.6116409918536043`*^9}, {3.611641054001313*^9, 
   3.611641185614512*^9}, {3.6116412269454737`*^9, 3.611641228777965*^9}, {
   3.611699253315288*^9, 3.611699272589781*^9}, {3.6116993067853813`*^9, 
   3.611699322573469*^9}, {3.611699353201222*^9, 3.611699656494681*^9}, {
   3.611699703884709*^9, 3.611699746947895*^9}, {3.611699808195922*^9, 
   3.6116999009756804`*^9}, {3.611699938911889*^9, 3.6116999797163477`*^9}, {
   3.6117000235243692`*^9, 3.6117001139362087`*^9}, {3.611700147578026*^9, 
   3.611700391927116*^9}, {3.611701162265295*^9, 3.611701175333487*^9}, 
   3.611720128347739*^9, {3.6118087527419653`*^9, 3.61180878873359*^9}, 
   3.6118088485864477`*^9, {3.611827678204671*^9, 3.61182778024606*^9}, {
   3.6118278186580887`*^9, 3.61182786947819*^9}, {3.612040397073482*^9, 
   3.612040498595254*^9}, {3.6120405625672197`*^9, 3.612040581425087*^9}, {
   3.612040636049416*^9, 3.6120407811214037`*^9}, {3.6120408699059772`*^9, 
   3.6120410282427263`*^9}, {3.612041060525745*^9, 3.612041065255727*^9}, {
   3.612041105929063*^9, 3.612041157923077*^9}, {3.6120529499603033`*^9, 
   3.612053330003244*^9}, {3.61205336667585*^9, 3.612053384469531*^9}, {
   3.612053434229807*^9, 3.61205346438971*^9}, {3.612053500358107*^9, 
   3.612053520966517*^9}, {3.612060070891522*^9, 3.6120601378227*^9}, {
   3.61206017787232*^9, 3.612060339119104*^9}, {3.613091363610154*^9, 
   3.6130913744822683`*^9}, {3.61309225796666*^9, 3.6130923408217783`*^9}, {
   3.6131150808432837`*^9, 3.613115234673695*^9}, 3.61372311883606*^9, 
   3.614835773724978*^9, 3.615251982348516*^9, {3.655149853017805*^9, 
   3.655149857415399*^9}}],

Cell[CellGroupData[{

Cell["mv[]  and  mvInverse[ ]  ", "Subsubsection",
 CellChangeTimes->{{3.614832541659161*^9, 3.6148325431788273`*^9}, {
   3.614834579762329*^9, 3.614834604754891*^9}, 3.614835669957259*^9}],

Cell["\<\

The new defn of  mv  uses  Part[ ]  rather than the permutation functions, \
which are a mess re. version changes between Math 8.0 and 10.0.\
\>", "Text",
 CellChangeTimes->{{3.6147756867433157`*^9, 3.614775700940906*^9}, {
  3.6148129102558117`*^9, 3.614812982287877*^9}, {3.614835639941456*^9, 
  3.614835662117692*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"mv", "[", "n_List", "]"}], ":=", 
   RowBox[{"mv", "[", 
    RowBox[{"Apply", "[", 
     RowBox[{"Sequence", ",", "n"}], "]"}], "]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612088204247141*^9, 3.612088239833246*^9}, {
  3.614989879447513*^9, 3.6149899020342216`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "36", "]"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"PadList", "[", 
   RowBox[{"n_List", ",", "len_Integer"}], "]"}], ":=", " ", 
  RowBox[{"Join", "[", 
   RowBox[{"n", ",", 
    RowBox[{"Range", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "n", "]"}], "+", "1"}], ",", "len"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614772040757311*^9, 3.614772064742908*^9}, {
  3.6147721131911917`*^9, 3.614772210571732*^9}, {3.614772247898644*^9, 
  3.614772253130505*^9}, {3.614772283725216*^9, 3.614772361579278*^9}, {
  3.6147724259659433`*^9, 3.614772426302965*^9}, {3.61477245646278*^9, 
  3.614772458827176*^9}, {3.6147724985429583`*^9, 3.61477251539002*^9}, {
  3.614772634143322*^9, 3.6147726356472197`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"mv", "[", "n1___Integer", "]"}], "[", 
    RowBox[{"mv", "[", "n2___Integer", "]"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "len", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"len", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"{", "n1", "}"}], "]"}], ",", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "n2", "}"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Apply", "[", 
       RowBox[{"mv", ",", 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"PadList", "[", 
           RowBox[{
            RowBox[{"{", "n2", "}"}], ",", "len"}], "]"}], ",", 
          RowBox[{"PadList", "[", 
           RowBox[{
            RowBox[{"{", "n1", "}"}], ",", "len"}], "]"}]}], "]"}]}], 
       "]"}]}]}], "]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6147725602396097`*^9, 3.614772630686303*^9}, {
  3.614772669520033*^9, 3.614772768885558*^9}, {3.614773707194002*^9, 
  3.614773713961752*^9}, {3.6147739999138947`*^9, 3.614774004235365*^9}, {
  3.61498988254797*^9, 3.6149898994799843`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "37", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"mvInverse", "[", "n_List", "]"}], ":=", 
   RowBox[{"mvInverse", "[", 
    RowBox[{"Apply", "[", 
     RowBox[{"Sequence", ",", "n"}], "]"}], "]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614833881203306*^9, 3.614833891829186*^9}, {
  3.6149898898245773`*^9, 3.6149898976821747`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "38", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
The initial value   arg = {n}   is just to set arg to be a list with the \
right length,\
\>", "Text",
 CellChangeTimes->{{3.614835444052847*^9, 3.614835520308898*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"mvInverse", "[", "n__Integer", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"arg", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"arg", "=", 
       RowBox[{"{", "n", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"arg", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"{", "n", "}"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "=", "j"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "arg", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mv", "[", "arg", "]"}]}]}], "]"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"rule", "[", "39", "]"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Error messages for  mv[]  and  mvInverse[ ]  ", "Subsubsection",
 CellChangeTimes->{{3.614832541659161*^9, 3.6148325431788273`*^9}, {
  3.614834579762329*^9, 3.614834604754891*^9}}],

Cell["\<\

Error checking adds about  30%  to the time for  mv[ ]  and  mvInverse[ ] .\
\>", "Text",
 CellChangeTimes->{{3.614834640546962*^9, 3.6148347026754827`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArgumentCheck", "[", 
  RowBox[{"AddRule", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", "n__Integer", "]"}], "[", "X_", "]"}], "/;", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"X", "===", "0"}]}], "&&", 
      RowBox[{"!", 
       RowBox[{"PermutationListQ", "[", 
        RowBox[{"{", "n", "}"}], "]"}]}]}]}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<If the argument of mv[ ] evaluates to a sequence or list of \
integers, then it is required to be a permutation of 1,2,...,n (some n).\>\"",
        "]"}], ";", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<The list of arguments is \>\"", " ", ",", 
        RowBox[{"{", "n", "}"}], " ", ",", "\"\<.\>\""}], "]"}], ";", 
      RowBox[{"Hold", "[", 
       RowBox[{"mv", "[", "n", "]"}], "]"}]}], ")"}]}], "\[IndentingNewLine]",
    "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614774087143825*^9, 3.614774333115823*^9}, {
   3.614774371564782*^9, 3.6147744030553007`*^9}, 3.6147745776304817`*^9, {
   3.614774647068*^9, 3.614774648435279*^9}, {3.6147752796651907`*^9, 
   3.6147753455399857`*^9}, {3.614775376866653*^9, 3.614775422034791*^9}, {
   3.614834035789707*^9, 3.614834043597805*^9}, 3.614834164799788*^9, {
   3.614834216782902*^9, 3.614834222606196*^9}, {3.6149815119232483`*^9, 
   3.614981534132154*^9}, {3.6161166105225677`*^9, 3.616116618439597*^9}, {
   3.6516017313884974`*^9, 3.651601731996312*^9}, {3.6516019959919767`*^9, 
   3.651602000346155*^9}, {3.651602041687891*^9, 3.6516020467761393`*^9}, {
   3.651602139318878*^9, 3.65160214442247*^9}, {3.651602632465064*^9, 
   3.651602671695602*^9}, 3.680905090684745*^9, 3.6809058108334513`*^9, {
   3.6809064650817833`*^9, 3.680906583927495*^9}, {3.68090665744974*^9, 
   3.6809066914942093`*^9}, {3.6809067284504433`*^9, 3.680906739717945*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "40", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ArgumentCheck", "[", 
   RowBox[{"AddRule", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"mv", "[", "n__", "]"}], "[", "X_", "]"}], "/;", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"X", "===", "0"}]}], "&&", 
       RowBox[{"Apply", "[", 
        RowBox[{"Or", ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Greater", "[", 
             RowBox[{"#", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"{", "n", "}"}], "]"}]}], "]"}], "&"}], ",", 
           RowBox[{"{", "n", "}"}]}], "]"}]}], "]"}]}]}], ":=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<The argument sequence of mv[ ] can not contain any integer \
greater than the length of the sequence.\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<The list of arguments is \>\"", " ", ",", 
         RowBox[{"{", "n", "}"}], " ", ",", "\"\<.\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Hold", "[", 
        RowBox[{"mv", "[", "n", "]"}], "]"}]}], ")"}]}], 
    "\[IndentingNewLine]", "]"}], "]"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614774797558343*^9, 3.6147748635770073`*^9}, {
   3.614774901736189*^9, 3.614774916413034*^9}, {3.614774947948172*^9, 
   3.614775046333479*^9}, {3.614775194318839*^9, 3.6147752643850813`*^9}, {
   3.614775446319619*^9, 3.614775457743887*^9}, 3.6148341661743*^9, {
   3.614834225348205*^9, 3.6148342351507597`*^9}, {3.614981525879408*^9, 
   3.614981536275587*^9}, {3.616115813492392*^9, 3.61611582833936*^9}, {
   3.616116399590568*^9, 3.616116436535581*^9}, 3.6516017349238997`*^9, {
   3.6516018272110662`*^9, 3.651601869625898*^9}, {3.6516019191935387`*^9, 
   3.651601931577395*^9}, {3.651602249184597*^9, 3.651602261173246*^9}, {
   3.6516026810877743`*^9, 3.651602688032093*^9}, 3.6809050931290483`*^9, 
   3.6809058174095097`*^9, {3.680906050766715*^9, 3.680906072510193*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "41", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArgumentCheck", "[", 
  RowBox[{"AddRule", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", "n__Integer", "]"}], "[", "X_", "]"}], "/;", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"X", "===", "0"}]}], "&&", 
      RowBox[{
       RowBox[{"deg", "[", "X", "]"}], "<", 
       RowBox[{"Length", "[", 
        RowBox[{"{", "n", "}"}], "]"}]}]}]}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"mv", "[", "n", "]"}], ",", " ", 
        "\"\< operates on tensors that have degree \[GreaterEqual] \>\"", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"{", "n", "}"}], "]"}], ",", "\"\<.\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<The tensor argument \>\"", ",", "X", ",", "\"\< has degree \>\"", 
        ",", 
        RowBox[{"deg", "[", "X", "]"}], ",", "\"\<.\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Hold", "[", 
       RowBox[{
        RowBox[{"mv", "[", "n", "]"}], "[", "X", "]"}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612128153353718*^9, 3.612128320719593*^9}, {
   3.6121283978671703`*^9, 3.612128437457061*^9}, {3.6121285691996317`*^9, 
   3.612128594788527*^9}, {3.61215332762577*^9, 3.612153358088613*^9}, {
   3.612153510105156*^9, 3.61215351234487*^9}, {3.612153544133795*^9, 
   3.6121535462151947`*^9}, {3.6123907822033167`*^9, 3.612390828204213*^9}, {
   3.612390864574768*^9, 3.6123908684263563`*^9}, {3.612391005067498*^9, 
   3.612391006410419*^9}, {3.6123917380635643`*^9, 3.6123917541261873`*^9}, {
   3.612808465935123*^9, 3.6128084713462667`*^9}, 3.614981607141033*^9, 
   3.614981925862578*^9, {3.614982461944335*^9, 3.614982494679453*^9}, {
   3.614982550705442*^9, 3.614982554441197*^9}, {3.616116644487853*^9, 
   3.616116646855294*^9}, {3.616116760085227*^9, 3.616116801142981*^9}, {
   3.616222363601755*^9, 3.6162223725135736`*^9}, {3.651602694895164*^9, 
   3.651602747118483*^9}, {3.65160278558206*^9, 3.6516028111176243`*^9}, {
   3.655103296732665*^9, 3.655103323691639*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "42", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ArgumentCheck", "[", 
   RowBox[{"AddRule", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"mvInverse", "[", "n__Integer", "]"}], "[", "X_", "]"}], "/;", 
      
      RowBox[{
       RowBox[{"!", 
        RowBox[{"X", "===", "0"}]}], "&&", 
       RowBox[{"!", 
        RowBox[{"PermutationListQ", "[", 
         RowBox[{"{", "n", "}"}], "]"}]}]}]}], ":=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<If the argument of mv[ ] evaluates to a sequence or list of \
integers, then it is required to be a permutation of 1,2,...,n (some n).\>\"",
         "]"}], ";", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<The argument list is \>\"", " ", ",", 
         RowBox[{"{", "n", "}"}], " ", ",", "\"\<.\>\""}], "]"}], ";", 
       RowBox[{"Hold", "[", 
        RowBox[{"mvInverse", "[", "n", "]"}], "]"}]}], ")"}]}], 
    "\[IndentingNewLine]", "]"}], "]"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614834014989256*^9, 3.614834024029717*^9}, 
   3.61483408426814*^9, 3.6148341576948023`*^9, {3.6148342277389193`*^9, 
   3.614834239681717*^9}, {3.614981527098391*^9, 3.614981537907207*^9}, {
   3.616116629670508*^9, 3.6161166333838453`*^9}, 3.616116673311043*^9, 
   3.651601738812017*^9, {3.651602850515587*^9, 3.65160287265238*^9}, {
   3.651602995687284*^9, 3.651603023100219*^9}, {3.680905118122532*^9, 
   3.680905120490528*^9}, 3.680905851985139*^9, {3.68090660085919*^9, 
   3.680906611623444*^9}, {3.680906641768222*^9, 3.680906645142687*^9}, {
   3.680906701318233*^9, 3.6809067422133636`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "43", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ArgumentCheck", "[", 
   RowBox[{"AddRule", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"mvInverse", "[", "n__", "]"}], "[", "X_", "]"}], "/;", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"X", "===", "0"}]}], "&&", 
       RowBox[{"Apply", "[", 
        RowBox[{"Or", ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Greater", "[", 
             RowBox[{"#", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"{", "n", "}"}], "]"}]}], "]"}], "&"}], ",", 
           RowBox[{"{", "n", "}"}]}], "]"}]}], "]"}]}]}], ":=", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<The argument of mvInverse[ ] can not contain any integer greater \
than the argument length.\>\"", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Hold", "[", 
        RowBox[{"mvInverse", "[", "n", "]"}], "]"}]}], ")"}]}], 
    "\[IndentingNewLine]", "]"}], "]"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614774797558343*^9, 3.6147748635770073`*^9}, {
   3.614774901736189*^9, 3.614774916413034*^9}, {3.614774947948172*^9, 
   3.614775046333479*^9}, {3.614775194318839*^9, 3.6147752643850813`*^9}, {
   3.614775446319619*^9, 3.614775457743887*^9}, {3.614834060975462*^9, 
   3.614834080621429*^9}, 3.6148341687669697`*^9, {3.614834229509407*^9, 
   3.6148342436628733`*^9}, {3.614981528203834*^9, 3.614981539379747*^9}, {
   3.616115715331973*^9, 3.616115717877077*^9}, 3.616115798157423*^9, {
   3.616116635432372*^9, 3.616116668527279*^9}, 3.6161167457990217`*^9, {
   3.651602852572246*^9, 3.651602868892632*^9}, {3.651603000217293*^9, 
   3.651603019376645*^9}, {3.68090514762605*^9, 3.680905149385952*^9}, 
   3.680905898976573*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "44", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArgumentCheck", "[", 
  RowBox[{"AddRule", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"mvInverse", "[", "n__Integer", "]"}], "[", "X_", "]"}], "/;", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"X", "===", "0"}]}], "&&", 
      RowBox[{
       RowBox[{"deg", "[", "X", "]"}], "<", 
       RowBox[{"Length", "[", 
        RowBox[{"{", "n", "}"}], "]"}]}]}]}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"mv", "[", "n", "]"}], ",", " ", 
        "\"\< operates on tensors that have degree \[GreaterEqual] \>\"", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"{", "n", "}"}], "]"}], ",", "\"\<.\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<The tensor argument has degree \>\"", ",", 
        RowBox[{"deg", "[", "X", "]"}], ",", "\"\<.\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Hold", "[", 
       RowBox[{
        RowBox[{"mvInverse", "[", "n", "]"}], "[", "X", "]"}], "]"}]}], 
     ")"}]}], "\[IndentingNewLine]", "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612128153353718*^9, 3.612128320719593*^9}, {
   3.6121283978671703`*^9, 3.612128437457061*^9}, {3.6121285691996317`*^9, 
   3.612128594788527*^9}, {3.61215332762577*^9, 3.612153358088613*^9}, {
   3.612153510105156*^9, 3.61215351234487*^9}, {3.612153544133795*^9, 
   3.6121535462151947`*^9}, {3.6123907822033167`*^9, 3.612390828204213*^9}, {
   3.612390864574768*^9, 3.6123908684263563`*^9}, {3.612391005067498*^9, 
   3.612391006410419*^9}, {3.6123917380635643`*^9, 3.6123917541261873`*^9}, {
   3.612808465935123*^9, 3.6128084713462667`*^9}, 3.614981607141033*^9, 
   3.614981925862578*^9, {3.614982461944335*^9, 3.614982494679453*^9}, {
   3.614982550705442*^9, 3.614982554441197*^9}, {3.616116644487853*^9, 
   3.616116646855294*^9}, {3.616116760085227*^9, 3.616116801142981*^9}, {
   3.61611692414189*^9, 3.616116931576056*^9}, 3.6162223864323*^9, {
   3.651602854764831*^9, 3.651602939307794*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "45", "]"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing", "Subsubsection",
 CellChangeTimes->{{3.614832541659161*^9, 3.6148325431788273`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mv", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "3", ",", "4"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.6147753625066633`*^9, 3.614775368013473*^9}}],

Cell[BoxData[
 RowBox[{"mv", "[", 
  RowBox[{"2", ",", "3", ",", "4"}], "]"}]], "Output",
 CellChangeTimes->{{3.6147753659467297`*^9, 3.6147754270132647`*^9}, 
   3.615260343766254*^9, 3.615264262090293*^9, 3.615272035146585*^9, 
   3.6152722524161377`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mv", "[", 
  RowBox[{"{", 
   RowBox[{"a", ",", "4", ",", "b"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.614774354598875*^9, 3.614774358467958*^9}, {
  3.614774464904337*^9, 3.614774481594664*^9}, {3.614774541144594*^9, 
  3.61477456639012*^9}, {3.614774596537986*^9, 3.614774596636795*^9}, {
  3.6147747078472643`*^9, 3.614774707933312*^9}, {3.61477505730545*^9, 
  3.6147750646650753`*^9}, {3.614775477677183*^9, 3.614775477777061*^9}}],

Cell[BoxData[
 RowBox[{"mv", "[", 
  RowBox[{"a", ",", "4", ",", "b"}], "]"}]], "Output",
 CellChangeTimes->{{3.614775057976183*^9, 3.6147750653237143`*^9}, 
   3.614775357271669*^9, {3.614775475608803*^9, 3.614775478754025*^9}, 
   3.615260343892344*^9, 3.615264262115561*^9, 3.615272035230474*^9, 
   3.615272252522235*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"3", ",", "1", ",", "4", ",", "5", ",", "2", ",", "6", ",", "7"}], 
   "]"}], "[", 
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1", ",", "3", ",", "4"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1", ",", "3", ",", "4"}], "]"}], "[", 
  RowBox[{"mv", "[", 
   RowBox[{"3", ",", "1", ",", "4", ",", "5", ",", "2", ",", "6", ",", "7"}], 
   "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.612051523320784*^9, 3.612051549812834*^9}, {
  3.612051916791534*^9, 3.612051930295108*^9}, {3.612052159688251*^9, 
  3.612052166021749*^9}, {3.6120618260172367`*^9, 3.6120618263693027`*^9}, {
  3.6122041705801497`*^9, 3.6122041721301622`*^9}, {3.614728061303245*^9, 
  3.61472807425381*^9}}],

Cell[BoxData[
 RowBox[{"mv", "[", 
  RowBox[{"3", ",", "2", ",", "4", ",", "5", ",", "1", ",", "6", ",", "7"}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.612051551152457*^9, 3.6120517451485157`*^9, 3.612052168126646*^9, 
   3.612060721408453*^9, 3.612061734342761*^9, {3.6120618148045187`*^9, 
   3.612061829435305*^9}, 3.612061884199641*^9, 3.612062168778564*^9, 
   3.612122385957159*^9, 3.61215242637122*^9, {3.6122041617758293`*^9, 
   3.612204173294325*^9}, 3.612204464487236*^9, 3.6122260701831703`*^9, 
   3.612242225299245*^9, 3.6122446057005787`*^9, 3.612245305426291*^9, 
   3.612245408791202*^9, 3.612245880707837*^9, 3.612246361427814*^9, 
   3.6122468184611607`*^9, 3.612254142120079*^9, 3.612256789755137*^9, 
   3.612330932828904*^9, {3.612340269972266*^9, 3.61234027542677*^9}, 
   3.612346130361093*^9, 3.6126702988571157`*^9, 3.612683980317672*^9, 
   3.6126869565612593`*^9, 3.6131163598545237`*^9, 3.6147278483062687`*^9, 
   3.614728076325807*^9, 3.6147350873310328`*^9, 3.614735824444068*^9, 
   3.614773065935542*^9, 3.614773111005288*^9, 3.614773206973056*^9, 
   3.614773274009012*^9, {3.614773332484432*^9, 3.614773368123032*^9}, 
   3.614773401790929*^9, 3.6147734378966427`*^9, {3.6147737041977587`*^9, 
   3.614773717384651*^9}, 3.614773835274469*^9, 3.614775530891082*^9, 
   3.615260343953483*^9, 3.615264262233533*^9, 3.6152720353330812`*^9, 
   3.615272252623254*^9}],

Cell[BoxData[
 RowBox[{"mv", "[", 
  RowBox[{"1", ",", "3", ",", "4", ",", "5", ",", "2", ",", "6", ",", "7"}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.612051551152457*^9, 3.6120517451485157`*^9, 3.612052168126646*^9, 
   3.612060721408453*^9, 3.612061734342761*^9, {3.6120618148045187`*^9, 
   3.612061829435305*^9}, 3.612061884199641*^9, 3.612062168778564*^9, 
   3.612122385957159*^9, 3.61215242637122*^9, {3.6122041617758293`*^9, 
   3.612204173294325*^9}, 3.612204464487236*^9, 3.6122260701831703`*^9, 
   3.612242225299245*^9, 3.6122446057005787`*^9, 3.612245305426291*^9, 
   3.612245408791202*^9, 3.612245880707837*^9, 3.612246361427814*^9, 
   3.6122468184611607`*^9, 3.612254142120079*^9, 3.612256789755137*^9, 
   3.612330932828904*^9, {3.612340269972266*^9, 3.61234027542677*^9}, 
   3.612346130361093*^9, 3.6126702988571157`*^9, 3.612683980317672*^9, 
   3.6126869565612593`*^9, 3.6131163598545237`*^9, 3.6147278483062687`*^9, 
   3.614728076325807*^9, 3.6147350873310328`*^9, 3.614735824444068*^9, 
   3.614773065935542*^9, 3.614773111005288*^9, 3.614773206973056*^9, 
   3.614773274009012*^9, {3.614773332484432*^9, 3.614773368123032*^9}, 
   3.614773401790929*^9, 3.6147734378966427`*^9, {3.6147737041977587`*^9, 
   3.614773717384651*^9}, 3.614773835274469*^9, 3.614775530891082*^9, 
   3.615260343953483*^9, 3.615264262233533*^9, 3.6152720353330812`*^9, 
   3.615272252629724*^9}]
}, Open  ]],

Cell["With error checking,", "Text",
 CellChangeTimes->{{3.6147757832079678`*^9, 3.6147757886486893`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{
       "3", ",", "1", ",", "4", ",", "5", ",", "2", ",", "6", ",", "7"}], 
       "]"}], "[", 
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1", ",", "3", ",", "4"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1", ",", "3", ",", "4"}], "]"}], "[", 
      RowBox[{"mv", "[", 
       RowBox[{
       "3", ",", "1", ",", "4", ",", "5", ",", "2", ",", "6", ",", "7"}], 
       "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "10000"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6147728195509777`*^9, 3.6147728552234488`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.0240640000000000853219717100728303194`6.030927012476359", ",", "Null"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.614774450604904*^9, {3.6147755353898153`*^9, 3.614775540233838*^9}, 
   3.6152603449907923`*^9, 3.615264263775961*^9, 3.615272036381301*^9, 
   3.615272253668921*^9}]
}, Open  ]],

Cell["Without error checking is faster,", "Text",
 CellChangeTimes->{{3.6147757832079678`*^9, 3.614775858280739*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{
       "3", ",", "1", ",", "4", ",", "5", ",", "2", ",", "6", ",", "7"}], 
       "]"}], "[", 
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1", ",", "3", ",", "4"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1", ",", "3", ",", "4"}], "]"}], "[", 
      RowBox[{"mv", "[", 
       RowBox[{
       "3", ",", "1", ",", "4", ",", "5", ",", "2", ",", "6", ",", "7"}], 
       "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "10000"}], "}"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.02806400000000008887468538887333124876`6.0326200648860295", ",", 
   "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.6147750781272087`*^9, 3.614775084388234*^9}, 
   3.614775758274506*^9, 3.615260346131559*^9, 3.61526426549221*^9, 
   3.615272037547852*^9, 3.615272254848147*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1", ",", "3"}], "]"}], "[", 
  RowBox[{"mv", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", "]"}], "[", 
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1", ",", "3"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6121227787562103`*^9, 3.612122797666699*^9}}],

Cell[BoxData[
 RowBox[{"mv", "[", 
  RowBox[{"2", ",", "1", ",", "3"}], "]"}]], "Output",
 CellChangeTimes->{{3.612122783244516*^9, 3.612122799866317*^9}, 
   3.612152426377475*^9, 3.612204479191696*^9, 3.6122260702321672`*^9, 
   3.612242225308896*^9, 3.612244605768879*^9, 3.612245318500358*^9, 
   3.6122454087983637`*^9, 3.612245880760145*^9, 3.612246361433086*^9, 
   3.6122468184670277`*^9, 3.612254142127708*^9, 3.612256789807988*^9, 
   3.612330932867298*^9, {3.612340269979106*^9, 3.6123402754343243`*^9}, 
   3.612346130366119*^9, 3.612670298862833*^9, 3.612683980376903*^9, 
   3.612686956569545*^9, 3.613116361602806*^9, 3.614727889461239*^9, 
   3.614773880305142*^9, 3.614775933904509*^9, 3.615260346222781*^9, 
   3.6152642657179327`*^9, 3.615272037679653*^9, 3.615272254986991*^9}],

Cell[BoxData[
 RowBox[{"mv", "[", 
  RowBox[{"2", ",", "1", ",", "3"}], "]"}]], "Output",
 CellChangeTimes->{{3.612122783244516*^9, 3.612122799866317*^9}, 
   3.612152426377475*^9, 3.612204479191696*^9, 3.6122260702321672`*^9, 
   3.612242225308896*^9, 3.612244605768879*^9, 3.612245318500358*^9, 
   3.6122454087983637`*^9, 3.612245880760145*^9, 3.612246361433086*^9, 
   3.6122468184670277`*^9, 3.612254142127708*^9, 3.612256789807988*^9, 
   3.612330932867298*^9, {3.612340269979106*^9, 3.6123402754343243`*^9}, 
   3.612346130366119*^9, 3.612670298862833*^9, 3.612683980376903*^9, 
   3.612686956569545*^9, 3.613116361602806*^9, 3.614727889461239*^9, 
   3.614773880305142*^9, 3.614775933904509*^9, 3.615260346222781*^9, 
   3.6152642657179327`*^9, 3.615272037679653*^9, 3.615272254994025*^9}]
}, Open  ]],

Cell["Tests for mvInverse[ ], ", "Text",
 CellChangeTimes->{{3.6147757832079678`*^9, 3.614775858280739*^9}, {
  3.614834372513954*^9, 3.614834385506074*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"list", "=", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", "list", "]"}], "[", 
  RowBox[{"mvInverse", "[", "list", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.614832193291786*^9, 3.61483219798067*^9}, {
  3.614833856165443*^9, 3.614833868499064*^9}, {3.6148339077051773`*^9, 
  3.6148339457037888`*^9}}],

Cell[BoxData[
 RowBox[{"mv", "[", 
  RowBox[{"1", ",", "2", ",", "3"}], "]"}]], "Output",
 CellChangeTimes->{3.6148321987030067`*^9, 3.614833783825576*^9, 
  3.614833814753993*^9, 3.614833943788517*^9, 3.6152603463130407`*^9, 
  3.615264265931162*^9, 3.615272037811851*^9, 3.615272255003973*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"list", "=", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "5", ",", "4", ",", "2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", "list", "]"}], "[", 
  RowBox[{"mvInverse", "[", "list", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.614833952549728*^9, 3.61483395397456*^9}}],

Cell[BoxData[
 RowBox[{"mv", "[", 
  RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "]"}]], "Output",
 CellChangeTimes->{3.6148339553785133`*^9, 3.6148343083432493`*^9, 
  3.615260346423234*^9, 3.615264265948448*^9, 3.6152720379270782`*^9, 
  3.6152722551333933`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mvInverse", "[", 
  RowBox[{"3", ",", "4", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.614833976787876*^9, 3.614833979636016*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Set", "::", "partw"}], "MessageName"], ":", 
  " ", "\<\"Part \[NoBreak]\\!\\(4\\)\[NoBreak] of \[NoBreak]\\!\\({3, 4, \
1}\\)\[NoBreak] does not exist. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Set::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6152720380229397`*^9, 3.615272255274819*^9}],

Cell[BoxData[
 RowBox[{"mv", "[", 
  RowBox[{"3", ",", "3", ",", "1"}], "]"}]], "Output",
 CellChangeTimes->{
  3.6148339809951363`*^9, {3.614834095280225*^9, 3.614834115852008*^9}, 
   3.614834180338356*^9, 3.614834252213869*^9, 3.615260346572584*^9, 
   3.6152642660745277`*^9, 3.615272038026425*^9, 3.615272255282317*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mvInverse", "[", 
  RowBox[{"3", ",", "b"}], "]"}]], "Input",
 CellChangeTimes->{3.614834316853725*^9}],

Cell[BoxData[
 RowBox[{"mvInverse", "[", 
  RowBox[{"3", ",", "b"}], "]"}]], "Output",
 CellChangeTimes->{3.6148343184707947`*^9, 3.615260346790786*^9, 
  3.6152642663077106`*^9, 3.6152720380370502`*^9, 3.6152722559971533`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["mvSignature[ ]", "Subsubsection",
 CellChangeTimes->{{3.612691799416052*^9, 3.612691809127748*^9}, {
  3.613118696095948*^9, 3.613118721838936*^9}, {3.6148325895952597`*^9, 
  3.614832599659409*^9}}],

Cell["\<\
Warning :   PermutationCycles[ ]   is defined differently in Versions 8 and \
10  (inverse permutation).
But that does not matter here,\
\>", "Text",
 CellChangeTimes->{{3.6116284697864027`*^9, 3.611628557879972*^9}, {
   3.611641212496069*^9, 3.6116412481106577`*^9}, {3.61164131428724*^9, 
   3.6116415084813538`*^9}, {3.611700499032084*^9, 3.611700499906479*^9}, {
   3.612041401562169*^9, 3.6120414054919987`*^9}, 3.612046491080649*^9, {
   3.6120512931001587`*^9, 3.612051295498661*^9}, {3.6120594073731813`*^9, 
   3.612059428413116*^9}, {3.612060415264543*^9, 3.612060415487587*^9}, {
   3.612121998856104*^9, 3.612122000535617*^9}, {3.612203418409175*^9, 
   3.612203434179721*^9}, {3.612203780699435*^9, 3.612203785236432*^9}, {
   3.615270318410289*^9, 3.6152703819862432`*^9}, {3.615270539811647*^9, 
   3.6152705763549223`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mvSignature", "[", 
   RowBox[{"n___Integer", "/;", 
    RowBox[{"PermutationListQ", "[", 
     RowBox[{"{", "n", "}"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"Times", ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"Length", ",", 
         RowBox[{"First", "[", 
          RowBox[{"PermutationCycles", "[", 
           RowBox[{"{", "n", "}"}], "]"}], "]"}]}], "]"}], "-", "1"}], 
      ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.613118166491119*^9, 3.613118169081833*^9}, {
  3.613118206697695*^9, 3.61311830692456*^9}, {3.613118586014422*^9, 
  3.61311865200004*^9}, {3.615270428077292*^9, 3.6152704451969547`*^9}},
 CellID->1792294297],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"mvSignature", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"mvSignature", "[", 
  RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"mvSignature", "[", 
  RowBox[{"2", ",", "1", ",", "3", ",", "4"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"mvSignature", "[", 
  RowBox[{"2", ",", "3", ",", "1", ",", "4"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"mvSignature", "[", 
  RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6131187413635693`*^9, 3.613118774588481*^9}, {
  3.61527048386668*^9, 3.615270520829413*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.613118775985486*^9, 3.614773946096958*^9, 
  3.615260346880336*^9, 3.6152642664291687`*^9, 3.615270457676405*^9, 
  3.615270490154364*^9, 3.615270522193883*^9, 3.615272038152424*^9, 
  3.615272256171932*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.613118775985486*^9, 3.614773946096958*^9, 
  3.615260346880336*^9, 3.6152642664291687`*^9, 3.615270457676405*^9, 
  3.615270490154364*^9, 3.615270522193883*^9, 3.615272038152424*^9, 
  3.615272256178689*^9}],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{3.613118775985486*^9, 3.614773946096958*^9, 
  3.615260346880336*^9, 3.6152642664291687`*^9, 3.615270457676405*^9, 
  3.615270490154364*^9, 3.615270522193883*^9, 3.615272038152424*^9, 
  3.615272256183584*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.613118775985486*^9, 3.614773946096958*^9, 
  3.615260346880336*^9, 3.6152642664291687`*^9, 3.615270457676405*^9, 
  3.615270490154364*^9, 3.615270522193883*^9, 3.615272038152424*^9, 
  3.615272256187265*^9}],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{3.613118775985486*^9, 3.614773946096958*^9, 
  3.615260346880336*^9, 3.6152642664291687`*^9, 3.615270457676405*^9, 
  3.615270490154364*^9, 3.615270522193883*^9, 3.615272038152424*^9, 
  3.6152722561909733`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mvSignature", "[", "n_List", "]"}], ":=", 
  RowBox[{"mvSignature", "[", 
   RowBox[{"Apply", "[", 
    RowBox[{"Sequence", ",", "n"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mvSignature", "[", "n_mv", "]"}], ":=", 
  RowBox[{"mvSignature", "[", 
   RowBox[{"Apply", "[", 
    RowBox[{"Sequence", ",", "n"}], "]"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.61326196733156*^9, 3.6132620402423067`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"mvSignature", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "1"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"mvSignature", "[", 
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.613262057658236*^9, 3.613262096857232*^9}}],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{{3.6132620848501997`*^9, 3.613262098130423*^9}, 
   3.615260346970632*^9, 3.6152642666866417`*^9, 3.615270625236372*^9, 
   3.615272038364953*^9, 3.615272256332205*^9}],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{{3.6132620848501997`*^9, 3.613262098130423*^9}, 
   3.615260346970632*^9, 3.6152642666866417`*^9, 3.615270625236372*^9, 
   3.615272038364953*^9, 3.615272256339113*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["mvCyclic[ ]", "Subsubsection",
 CellChangeTimes->{{3.6148326353073893`*^9, 3.6148326416592503`*^9}}],

Cell["\<\
This makes a  mv  operator  (the one with the shortest possible slot \
sequence) that corresponds to cycling those slots identified in the sequence  \
m,  in the specified order,\
\>", "Text",
 CellChangeTimes->{{3.614817384599962*^9, 3.61481746728936*^9}, {
  3.6152706623711233`*^9, 3.615270721187676*^9}, {3.6152707564837*^9, 
  3.615270808083542*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mvCyclic", "[", 
   RowBox[{"m__", "?", "IntegerQ"}], "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"mv", ",", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"Max", "[", "m", "]"}], "]"}], ",", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "m", "}"}], ",", 
          RowBox[{"RotateLeft", "[", 
           RowBox[{"{", "m", "}"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614814610524431*^9, 3.6148146120265913`*^9}, {
  3.614814657420063*^9, 3.6148146643168087`*^9}, {3.614814864412445*^9, 
  3.614814991572744*^9}, {3.6148150576988993`*^9, 3.6148150710751038`*^9}, {
  3.614815272034137*^9, 3.6148152753625526`*^9}, {3.61481531275697*^9, 
  3.6148153471565332`*^9}, {3.614815380404146*^9, 3.614815399219635*^9}, {
  3.61481551360677*^9, 3.614815533925908*^9}, {3.614817051055567*^9, 
  3.61481709494096*^9}, {3.6148175268649883`*^9, 3.614817538818611*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"mvCyclic", "[", 
  RowBox[{"1", ",", "2", ",", "3"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"mvCyclic", "[", 
  RowBox[{"2", ",", "4", ",", "6"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6148153631187553`*^9, 3.61481536821072*^9}, {
  3.614817302158086*^9, 3.614817303646093*^9}, {3.61481747559864*^9, 
  3.614817478253536*^9}, {3.614817671205102*^9, 3.614817672479298*^9}}],

Cell[BoxData[
 RowBox[{"mv", "[", 
  RowBox[{"2", ",", "3", ",", "1"}], "]"}]], "Output",
 CellChangeTimes->{3.614815372799*^9, 3.614815403132319*^9, 
  3.614817101550596*^9, 3.6148173053367233`*^9, 3.614817479704425*^9, 
  3.614817542884739*^9, 3.614817673811257*^9, 3.6152603470845737`*^9, 
  3.615264266813892*^9, 3.615272038477338*^9, 3.6152722564877863`*^9}],

Cell[BoxData[
 RowBox[{"mv", "[", 
  RowBox[{"1", ",", "4", ",", "3", ",", "6", ",", "5", ",", "2"}], 
  "]"}]], "Output",
 CellChangeTimes->{3.614815372799*^9, 3.614815403132319*^9, 
  3.614817101550596*^9, 3.6148173053367233`*^9, 3.614817479704425*^9, 
  3.614817542884739*^9, 3.614817673811257*^9, 3.6152603470845737`*^9, 
  3.615264266813892*^9, 3.615272038477338*^9, 3.615272256494616*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Basic properties of mv[ ]", "Subsubsection",
 CellChangeTimes->{{3.611886448000499*^9, 3.611886515727385*^9}, {
   3.6119013546891823`*^9, 3.6119014378233757`*^9}, {3.61190256088657*^9, 
   3.611902564500119*^9}, {3.6119029310474997`*^9, 3.611902937685643*^9}, 
   3.611903033863901*^9, {3.615252054460393*^9, 3.6152520560755444`*^9}, {
   3.6152648390555487`*^9, 3.6152648489431334`*^9}}],

Cell["mv[ 1, 2, 3, ... ]   is the identity, ", "Text",
 CellChangeTimes->{{3.6116381865350513`*^9, 3.611638242480274*^9}, {
  3.611638310273542*^9, 3.611638313906225*^9}, {3.611640174682646*^9, 
  3.611640175453682*^9}, {3.611647949950491*^9, 3.611647951854311*^9}, {
  3.6118742122868357`*^9, 3.611874228782949*^9}, {3.6120523316317377`*^9, 
  3.612052351534709*^9}, {3.6120614491257267`*^9, 3.612061480756567*^9}, {
  3.612091101488134*^9, 3.6120911171318493`*^9}, {3.612091342143552*^9, 
  3.612091370609037*^9}, {3.614813272657255*^9, 3.6148132732809687`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mv", "[", "n__Integer", "]"}], "/;", 
   RowBox[{
    RowBox[{"{", "n", "}"}], "===", 
    RowBox[{"Range", "[", 
     RowBox[{"Length", "[", 
      RowBox[{"{", "n", "}"}], "]"}], "]"}]}]}], " ", ":=", 
  RowBox[{"mv", "[", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.611828152396906*^9, 3.611828156636578*^9}, {
  3.6120523746744432`*^9, 3.612052450410349*^9}, {3.612061083509354*^9, 
  3.6120611630412273`*^9}, {3.612061274751203*^9, 3.612061287742935*^9}, {
  3.612091224458946*^9, 3.612091244619937*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"mv", "[", "]"}], "[", "X_", "]"}], ":=", "X"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.61209139584912*^9, 3.6120914060343723`*^9}, {
  3.614989842066737*^9, 3.614989844049314*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "46", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], "[", "X", 
  "]"}]], "Input",
 CellChangeTimes->{{3.612061326760565*^9, 3.6120613328267183`*^9}}],

Cell[BoxData["X"], "Output",
 CellChangeTimes->{{3.612061330260378*^9, 3.612061333396207*^9}, 
   3.612091425357163*^9, 3.612122118888029*^9, 3.6121524278284807`*^9, 
   3.612226082942115*^9, 3.612242225383067*^9, 3.612244606020886*^9, 
   3.612245408866667*^9, 3.612245885343149*^9, 3.61224636599319*^9, 
   3.612246818528653*^9, 3.612254148513399*^9, 3.612256791253359*^9, 
   3.612330937057922*^9, 3.612340278318907*^9, 3.612346131983699*^9, 
   3.61267030288971*^9, 3.6126839834793463`*^9, 3.6126869585139217`*^9, 
   3.6148181148173647`*^9, 3.615260347277253*^9, 3.615264267064559*^9, 
   3.615272038698023*^9, 3.615272257104663*^9}]
}, Open  ]],

Cell["mv  does not change tensor degree,", "Text",
 CellChangeTimes->{{3.6116381865350513`*^9, 3.611638242480274*^9}, {
  3.611638310273542*^9, 3.611638313906225*^9}, {3.611640174682646*^9, 
  3.611640175453682*^9}, {3.611647949950491*^9, 3.611647951854311*^9}, {
  3.6118742122868357`*^9, 3.611874228782949*^9}, {3.6120523316317377`*^9, 
  3.612052351534709*^9}, {3.6120614491257267`*^9, 3.612061480756567*^9}, {
  3.612091101488134*^9, 3.6120911171318493`*^9}, {3.612091342143552*^9, 
  3.612091370609037*^9}, {3.612227369983377*^9, 3.6122273827987833`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{
    RowBox[{"mv", "[", "__", "]"}], "[", "X_", "]"}], "]"}], ":=", 
  RowBox[{"deg", "[", "X", "]"}]}]], "Input",
 InitializationCell->True],

Cell["\<\
This reln is made use of when simplifying the operator version of sym,\
\>", "Text",
 CellChangeTimes->{{3.6116381865350513`*^9, 3.611638242480274*^9}, {
   3.611638310273542*^9, 3.611638313906225*^9}, {3.611640174682646*^9, 
   3.611640175453682*^9}, {3.611647949950491*^9, 3.611647951854311*^9}, {
   3.6118742122868357`*^9, 3.611874228782949*^9}, {3.6120523316317377`*^9, 
   3.612052351534709*^9}, {3.6120614491257267`*^9, 3.612061480756567*^9}, {
   3.612091101488134*^9, 3.6120911171318493`*^9}, {3.612091342143552*^9, 
   3.612091370609037*^9}, {3.612390147778583*^9, 3.6123901534522457`*^9}, {
   3.61239029960312*^9, 3.6123903353088903`*^9}, {3.612390500019889*^9, 
   3.612390530093705*^9}, {3.612391962057397*^9, 3.612392000530802*^9}, {
   3.612392073226256*^9, 3.6123920816031733`*^9}, {3.612397190314393*^9, 
   3.612397223234406*^9}, 3.612397273720668*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"mv", "[", "n___", "]"}], "[", "]"}], " ", ":=", " ", 
   RowBox[{"mv", "[", "n", "]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6123933478202467`*^9, 3.612393347821809*^9}, 
   3.6123973479423933`*^9, {3.614989823586171*^9, 3.6149898310895967`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "47", "]"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["rev[ ] as mv[ ]", "Subsubsection",
 CellChangeTimes->{{3.611886448000499*^9, 3.611886515727385*^9}, {
  3.6119013546891823`*^9, 3.6119014378233757`*^9}, {3.61190256088657*^9, 
  3.611902564500119*^9}, {3.6143825665450068`*^9, 3.6143825809437513`*^9}, {
  3.615252107051849*^9, 3.6152521224437723`*^9}}],

Cell["\<\
Combine  mv  and  rev  into a  mv   by converting rev to a  mv  and using the \
 mv  operator multiplication,\
\>", "Text",
 CellChangeTimes->{{3.614382080447694*^9, 3.614382104047307*^9}, {
  3.614382610288826*^9, 3.614382665472849*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"rev", "[", 
    RowBox[{
     RowBox[{"mv", "[", "n__", "]"}], "[", 
     RowBox[{"X_", "/;", 
      RowBox[{"IntegerQ", "[", 
       RowBox[{"deg", "[", "X", "]"}], "]"}]}], "]"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Range", "[", 
        RowBox[{"deg", "[", "X", "]"}], "]"}], "]"}], "]"}], "[", 
     RowBox[{"mv", "[", "n", "]"}], "]"}], "[", "X", "]"}]}], "]"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.614381001444976*^9, 3.614381076292186*^9}, {
   3.614381463622967*^9, 3.6143815084289207`*^9}, 3.61438154295506*^9, {
   3.6143815751156178`*^9, 3.614381620211581*^9}, {3.6143816618751287`*^9, 
   3.6143816671053257`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "48", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"mv", "[", "n__", "]"}], "[", 
    RowBox[{"rev", "[", 
     RowBox[{"X_", "/;", 
      RowBox[{"IntegerQ", "[", 
       RowBox[{"deg", "[", "X", "]"}], "]"}]}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"mv", "[", "n", "]"}], "[", 
     RowBox[{"mv", "[", 
      RowBox[{"Reverse", "[", 
       RowBox[{"Range", "[", 
        RowBox[{"deg", "[", "X", "]"}], "]"}], "]"}], "]"}], "]"}], "[", "X", 
    "]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.61438180258962*^9, 3.614381853900922*^9}, {
  3.6143819154652443`*^9, 3.614381966096801*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "49", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearField", "[", "X", "]"}], "\[IndentingNewLine]", 
 RowBox[{"rev", "[", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{
   RowBox[{"{", "5", "}"}], ",", "X"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"rev", "[", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6143815483089647`*^9, 3.614381560916565*^9}, {
  3.614381700370206*^9, 3.614381732023254*^9}, {3.615264784265052*^9, 
  3.615264784358705*^9}, {3.653791612168247*^9, 3.653791617737357*^9}}],

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "]"}]], "Output",
 CellChangeTimes->{3.614381561667609*^9, 3.614381690233343*^9, 
  3.614381733760662*^9, 3.6148181159537477`*^9, 3.614982737916915*^9, 
  3.61526034890661*^9, 3.615264268476647*^9, 3.615264715030182*^9, 
  3.615264784961282*^9, 3.615272039179178*^9, 3.6152722584412947`*^9, 
  3.653791630770566*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"5", ",", "4", ",", "3", ",", "1", ",", "2"}], "]"}], "[", "X", 
  "]"}]], "Output",
 CellChangeTimes->{3.614381561667609*^9, 3.614381690233343*^9, 
  3.614381733760662*^9, 3.6148181159537477`*^9, 3.614982737916915*^9, 
  3.61526034890661*^9, 3.615264268476647*^9, 3.615264715030182*^9, 
  3.615264784961282*^9, 3.615272039179178*^9, 3.6152722584412947`*^9, 
  3.653791630775581*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearField", "[", "X", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "[", 
  RowBox[{"rev", "[", "X", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{
   RowBox[{"{", "5", "}"}], ",", "X"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "[", 
  RowBox[{"rev", "[", "X", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6143815483089647`*^9, 3.614381560916565*^9}, {
  3.614381700370206*^9, 3.614381732023254*^9}, {3.614381994958865*^9, 
  3.6143820157541447`*^9}, {3.615264780744471*^9, 3.61526478115907*^9}, {
  3.6537916405527353`*^9, 3.653791641928426*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "[", 
  RowBox[{"rev", "[", "X", "]"}], "]"}]], "Output",
 CellChangeTimes->{3.614382017873495*^9, 3.614818116201694*^9, 
  3.614982749800275*^9, 3.615260349589471*^9, 3.615264269139267*^9, 
  3.615264756120101*^9, 3.61526478713538*^9, 3.615272039192443*^9, 
  3.6152722584649687`*^9, 3.6537916432468557`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"4", ",", "5", ",", "3", ",", "2", ",", "1"}], "]"}], "[", "X", 
  "]"}]], "Output",
 CellChangeTimes->{3.614382017873495*^9, 3.614818116201694*^9, 
  3.614982749800275*^9, 3.615260349589471*^9, 3.615264269139267*^9, 
  3.615264756120101*^9, 3.61526478713538*^9, 3.615272039192443*^9, 
  3.6152722584649687`*^9, 3.653791643252396*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["The action of  mv[ ]  on vectors", "Subsubsection",
 CellChangeTimes->{{3.611886448000499*^9, 3.611886515727385*^9}, {
  3.6119013546891823`*^9, 3.6119014378233757`*^9}, {3.61190256088657*^9, 
  3.611902564500119*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"mv", "[", "n__", "]"}], "[", "X_Plus", "]"}], ":=", " ", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{"mv", "[", "n", "]"}], ",", "X"}], "]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.611875353622713*^9, 3.6118753996116877`*^9}, {
   3.611875522796371*^9, 3.6118755232603416`*^9}, 3.611875556412725*^9, {
   3.6148971828912907`*^9, 3.614897189338612*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "50", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"mv", "[", "n__", "]"}], "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a_", "/;", 
       RowBox[{
        RowBox[{"deg", "[", "a", "]"}], "===", "0"}]}], ")"}], "X_"}], "]"}], 
   ":=", 
   RowBox[{"a", " ", 
    RowBox[{
     RowBox[{"mv", "[", "n", "]"}], "[", "X", "]"}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.611875675448633*^9, 3.611875705642619*^9}, {
  3.6118761483987293`*^9, 3.611876165489627*^9}, {3.614897193795293*^9, 
  3.614897209771845*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "51", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"mv", "[", "__", "]"}], "[", "0", "]"}], ":=", "0"}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612808386635295*^9, 3.612808407339415*^9}, {
  3.614897199923617*^9, 3.614897206136763*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "52", "]"}]], "Output"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "a", "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "b", "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "c", "]"}], "=", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.611876064437413*^9, 3.611876093310732*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"W", " ", "=", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"n1", ",", "n2", ",", "n3"}], "]"}], "[", 
   RowBox[{
    RowBox[{"a", " ", "X"}], "+", 
    RowBox[{"b", " ", "Y"}], " ", "+", " ", 
    RowBox[{"c", " ", "Z"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.611875442592325*^9, 3.6118754927464333`*^9}, {
   3.611875589693128*^9, 3.611875589787969*^9}, 3.61187608420536*^9, {
   3.611877199107354*^9, 3.611877200146226*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", " ", 
   RowBox[{
    RowBox[{"mv", "[", 
     RowBox[{"n1", ",", "n2", ",", "n3"}], "]"}], "[", "X", "]"}]}], "+", 
  RowBox[{"b", " ", 
   RowBox[{
    RowBox[{"mv", "[", 
     RowBox[{"n1", ",", "n2", ",", "n3"}], "]"}], "[", "Y", "]"}]}], "+", 
  RowBox[{"c", " ", 
   RowBox[{
    RowBox[{"mv", "[", 
     RowBox[{"n1", ",", "n2", ",", "n3"}], "]"}], "[", "Z", 
    "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.611875494227593*^9, {3.611875576339631*^9, 3.6118755918511543`*^9}, 
   3.611876097685577*^9, 3.6118761766662397`*^9, 3.611877201832863*^9, 
   3.611922463037541*^9, 3.6119231838520107`*^9, 3.6119234445909758`*^9, 
   3.6119235814469843`*^9, 3.61194475638367*^9, 3.611945308177969*^9, 
   3.6119520222079067`*^9, 3.611952380047061*^9, 3.611952915698187*^9, 
   3.611953509748612*^9, 3.611983117088399*^9, 3.612002288039157*^9, 
   3.612004249919194*^9, 3.612061648906602*^9, 3.6121222396933107`*^9, 
   3.612122399216879*^9, 3.612152427957759*^9, 3.612226086791416*^9, 
   3.6122422254518747`*^9, 3.612244606050702*^9, 3.6122454089345617`*^9, 
   3.612245954764819*^9, 3.6122463717259073`*^9, 3.612246818600945*^9, 
   3.612254154699209*^9, 3.612256791407235*^9, 3.612330941014513*^9, 
   3.612340278403064*^9, 3.6123461321408253`*^9, 3.6126703029928207`*^9, 
   3.6126839835852137`*^9, 3.612686958650999*^9, 3.614818116492732*^9, 
   3.615260351354011*^9, 3.615264271154739*^9, 3.6152648975419903`*^9, 
   3.61527203964097*^9, 3.615272258994021*^9}]
}, Open  ]],

Cell["And we need to be able to operate on vectors such as W,", "Text",
 CellChangeTimes->{{3.6116381865350513`*^9, 3.611638242480274*^9}, {
   3.611638310273542*^9, 3.611638313906225*^9}, {3.61163839797014*^9, 
   3.611638427536927*^9}, {3.611639888361322*^9, 3.611639955210099*^9}, {
   3.611640034521619*^9, 3.611640070552799*^9}, {3.611643214089416*^9, 
   3.611643223880831*^9}, {3.6116471248110437`*^9, 3.611647337420285*^9}, {
   3.611647373723956*^9, 3.611647378923085*^9}, 3.611647772863079*^9, {
   3.611647972319211*^9, 3.61164797787097*^9}, {3.6116480190082808`*^9, 
   3.6116480220946093`*^9}, {3.6118093384651814`*^9, 3.61180942825609*^9}, 
   3.6118281696405363`*^9, {3.61187478921754*^9, 3.6118748631053333`*^9}, {
   3.611874893842432*^9, 3.6118750212979507`*^9}, {3.611875224563596*^9, 
   3.6118752489949512`*^9}, {3.611875873684626*^9, 3.611876038932887*^9}, {
   3.611876196069373*^9, 3.611876232197356*^9}, {3.6118771637842712`*^9, 
   3.611877222632003*^9}, 3.611878904174807*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"n4", ",", "n5"}], "]"}], "[", "W", "]"}]], "Input",
 CellChangeTimes->{{3.611877226496325*^9, 3.6118772402854147`*^9}, {
  3.6122462699509087`*^9, 3.6122462940310173`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", " ", 
   RowBox[{
    RowBox[{"mv", "[", 
     RowBox[{"n4", ",", "n5"}], "]"}], "[", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"n1", ",", "n2", ",", "n3"}], "]"}], "[", "X", "]"}], "]"}]}], 
  "+", 
  RowBox[{"b", " ", 
   RowBox[{
    RowBox[{"mv", "[", 
     RowBox[{"n4", ",", "n5"}], "]"}], "[", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"n1", ",", "n2", ",", "n3"}], "]"}], "[", "Y", "]"}], "]"}]}], 
  "+", 
  RowBox[{"c", " ", 
   RowBox[{
    RowBox[{"mv", "[", 
     RowBox[{"n4", ",", "n5"}], "]"}], "[", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"n1", ",", "n2", ",", "n3"}], "]"}], "[", "Z", "]"}], 
    "]"}]}]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQAOL1mwPfS7985bgh6SGzEZAO6P4TC6JvCEyuA9Ei09f3
g+h13/ue2YDoG63atkDa7fyxIgcgvW9X03wQ/ayp7BGIzhHbqeMIpA/4L1no
D6SfXGf6FwGkt02x/RwJpBcydziWAellrw97geieuT/6JwNpuz8vFoNpo0bf
RUB6dftNl2NAWuKnvto5IL1kxmH/80D6kIrcFhDt7XnsB4je8qJa5wKQluoN
TgHREtsifl4G0n9i3zpdBdE1i8t/AulPPGfZ/gHprgMtjxhevXJ8E/lQez6Q
1rD5cnMpkF71/4rvciAtxzb5xfZ3QPGdrDf6379y/LKc+dBEIG1s8k5gEpA+
kvmzZyqQ/lycugJEAwAUH8I1
  "]]
}, Open  ]],

Cell["Therefore, we need,", "Text",
 CellChangeTimes->{{3.6116381865350513`*^9, 3.611638242480274*^9}, {
   3.611638310273542*^9, 3.611638313906225*^9}, {3.61163839797014*^9, 
   3.611638427536927*^9}, {3.611639888361322*^9, 3.611639955210099*^9}, {
   3.611640034521619*^9, 3.611640070552799*^9}, {3.611643214089416*^9, 
   3.611643223880831*^9}, {3.6116471248110437`*^9, 3.611647337420285*^9}, {
   3.611647373723956*^9, 3.611647378923085*^9}, 3.611647772863079*^9, {
   3.611647972319211*^9, 3.61164797787097*^9}, {3.6116480190082808`*^9, 
   3.6116480220946093`*^9}, {3.6118093384651814`*^9, 3.61180942825609*^9}, 
   3.6118281696405363`*^9, {3.61187478921754*^9, 3.6118748631053333`*^9}, {
   3.611874893842432*^9, 3.6118750212979507`*^9}, {3.611875224563596*^9, 
   3.6118752489949512`*^9}, {3.611875873684626*^9, 3.611876038932887*^9}, {
   3.611876196069373*^9, 3.611876232197356*^9}, {3.6118771637842712`*^9, 
   3.611877222632003*^9}, {3.6118772578331757`*^9, 3.611877274568162*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"mv", "[", "n1__", "]"}], "[", 
    RowBox[{
     RowBox[{"mv", "[", "n2__", "]"}], "[", "X_", "]"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"mv", "[", "n1", "]"}], "[", 
     RowBox[{"mv", "[", "n2", "]"}], "]"}], "[", "X", "]"}]}], "]"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.6120513749604807`*^9, 3.612051489384218*^9}, {
  3.612060811854146*^9, 3.612060838480633*^9}, {3.6120609001600447`*^9, 
  3.612060952653811*^9}, {3.6148972323962307`*^9, 3.614897238395871*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "53", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1", ",", "3", ",", "4"}], "]"}], "[", 
  RowBox[{
   RowBox[{"a", " ", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"3", ",", "1", ",", "4", ",", "2"}], "]"}], "[", "X", "]"}]}], 
   "+", " ", 
   RowBox[{"b", " ", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "]"}], "[", "X", "]"}]}]}],
   "]"}]], "Input",
 CellChangeTimes->{
  3.612061380940051*^9, {3.612062625879507*^9, 3.612062649899062*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", " ", 
   RowBox[{
    RowBox[{"mv", "[", 
     RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", "X", "]"}]}], 
  "+", 
  RowBox[{"b", " ", 
   RowBox[{
    RowBox[{"mv", "[", 
     RowBox[{"2", ",", "1", ",", "4", ",", "3"}], "]"}], "[", "X", 
    "]"}]}]}]], "Output",
 CellChangeTimes->{3.612061382724504*^9, 3.612062650491908*^9, 
  3.612122239836097*^9, 3.612122399290309*^9, 3.612152428143715*^9, 
  3.6121619553551292`*^9, 3.612226086874873*^9, 3.612242225514377*^9, 
  3.612244606123557*^9, 3.612245408998268*^9, 3.612245963991931*^9, 
  3.612246372029064*^9, 3.612246818625826*^9, 3.612254154781143*^9, 
  3.612256791431885*^9, 3.612330941235791*^9, 3.612340278443763*^9, 
  3.6123461321941442`*^9, 3.612670303052511*^9, 3.6126839836837797`*^9, 
  3.612686958692436*^9, 3.61481811674076*^9, 3.6152603535709333`*^9, 
  3.615264273521737*^9, 3.6152649074821157`*^9, 3.6152720400079813`*^9, 
  3.615272259919622*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
The application of a linear operator  op  to X \[Element] V :   op[ X ]       \
                                             --- skipped / commented\
\>", "Subsubsection",
 CellChangeTimes->{{3.611886448000499*^9, 3.611886515727385*^9}, {
  3.6119013546891823`*^9, 3.611901370528536*^9}, {3.611901458160838*^9, 
  3.611901520256131*^9}, {3.611901631297035*^9, 3.611901647315323*^9}, {
  3.611901879523034*^9, 3.6119018943854856`*^9}, {3.615267990650158*^9, 
  3.615268000697825*^9}, {3.6152724520742292`*^9, 3.6152724641540823`*^9}}],

Cell["\<\
If argument cheking is done, then this messes up because a  mv  operator has \
no well defined deg[ ]. 
Since this requires changes to Protected  Plus and Times,  let\
\[CloseCurlyQuote]s skip it.  \
\>", "Text",
 CellChangeTimes->{{3.6152680117373037`*^9, 3.615268120474186*^9}, 
   3.65489170480027*^9}],

Cell["The result of applying a linear operator such as", "Text",
 CellChangeTimes->{{3.611888467178268*^9, 3.611888637912455*^9}, {
  3.6118887064104843`*^9, 3.6118887116414757`*^9}, {3.611888961803166*^9, 
  3.6118889673544493`*^9}, {3.611892332475195*^9, 3.611892340489616*^9}, {
  3.611892392155492*^9, 3.611892430954629*^9}, {3.611893772992916*^9, 
  3.6118937843676853`*^9}, {3.611901547266073*^9, 3.611901551679832*^9}, {
  3.611901919091096*^9, 3.611901926753742*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"ClearField", "[", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e"}], "}"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"NewField", "[", 
    RowBox[{
     RowBox[{"{", "0", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e"}], "}"}]}], "]"}]}],
   "*)"}]], "Input",
 CellChangeTimes->{{3.615267083044512*^9, 3.615267109939742*^9}, {
  3.615267368878538*^9, 3.615267373534388*^9}, {3.653792596298359*^9, 
  3.6537925985866528`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"op1", "=."}], ";", 
    RowBox[{"op2", "=."}], ";", 
    RowBox[{"op3", "=."}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"op", " ", "=", " ", 
    RowBox[{
     RowBox[{"a", " ", "op1"}], " ", "+", " ", 
     RowBox[{"b", " ", "op2"}], " ", "+", " ", 
     RowBox[{"c", " ", "op3"}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{
  3.611901555184538*^9, {3.6119019000390472`*^9, 3.61190190048447*^9}, {
   3.6119019853833*^9, 3.611902009400936*^9}, {3.612331067731851*^9, 
   3.6123310823589287`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", " ", "op1"}], "+", 
  RowBox[{"b", " ", "op2"}], "+", 
  RowBox[{"c", " ", "op3"}]}]], "Output",
 CellChangeTimes->{
  3.611901555648542*^9, 3.611901902161656*^9, 3.6119020128027773`*^9, 
   3.611902050578766*^9, 3.611922634489409*^9, 3.611923184000348*^9, 
   3.611923444873125*^9, 3.611923581602036*^9, 3.611944756662599*^9, 
   3.611945308456036*^9, 3.6119520224044867`*^9, 3.611952380313788*^9, 
   3.611952915803406*^9, 3.611953509882729*^9, 3.6119831172865257`*^9, 
   3.6120022881696053`*^9, 3.612004250054929*^9, 3.612062778241611*^9, 
   3.612122414180401*^9, 3.612152428149465*^9, 3.612227415418593*^9, 
   3.612242225689506*^9, 3.612244606350657*^9, 3.612245409177156*^9, 
   3.6122464175976877`*^9, 3.6122468187503643`*^9, 3.612254165827415*^9, 
   3.612256791606484*^9, 3.612330946740533*^9, {3.612331060331911*^9, 
   3.61233108619203*^9}, 3.612340278533184*^9, 3.612346132284824*^9, 
   3.6126703031788273`*^9, 3.6126839837464323`*^9, 3.61268695878401*^9, 
   3.614818117179386*^9, 3.614836648185896*^9, 3.615260363478138*^9, 
   3.615264277606328*^9, 3.615266596817604*^9, 3.615266711311138*^9, {
   3.615267305913761*^9, 3.615267327465849*^9}, 3.6152720502993402`*^9, 
   3.615272310181158*^9}]
}, Open  ]],

Cell["\<\
to a tensor expression X  (or anything else)  is denoted   op[ X ]  =  (a op1 \
+ b op2 + c op3 )[ X ] .   To expand this we need something like the \
following, \
\>", "Text",
 CellChangeTimes->{{3.611888467178268*^9, 3.611888637912455*^9}, {
  3.6118887064104843`*^9, 3.6118887116414757`*^9}, {3.611888961803166*^9, 
  3.6118889673544493`*^9}, {3.611892332475195*^9, 3.611892340489616*^9}, {
  3.611892392155492*^9, 3.611892430954629*^9}, {3.611893772992916*^9, 
  3.6118937843676853`*^9}, {3.6119015623224163`*^9, 3.611901609616527*^9}, {
  3.611901932771124*^9, 3.611901933169573*^9}, {3.611902306580812*^9, 
  3.611902328419709*^9}, {3.611902380565092*^9, 3.611902411925022*^9}, {
  3.612339737733467*^9, 3.612339742579999*^9}}],

Cell["\<\
        ( op1_ + op2_ )[ X_ ]  :=  op1[ X ]  +  op2[ X ] 

however, when later tested with    sym[ ][ X ] ,  deg[ X ] = 7   the \
application of the operator   sym[7][ ]   (with 7 !  terms)  took about 10 \
sec. 
After changing to the following code, applying the same operator was instant,\
\
\>", "Text",
 CellChangeTimes->{{3.6118925267122927`*^9, 3.611892545232527*^9}, {
   3.611892597776331*^9, 3.6118925986250267`*^9}, {3.611892960482477*^9, 
   3.611893005106872*^9}, {3.611893065636907*^9, 3.611893141497932*^9}, {
   3.6118932816609173`*^9, 3.611893293466798*^9}, {3.6118933606349897`*^9, 
   3.611893391515777*^9}, {3.6118934316620913`*^9, 3.611893454637746*^9}, {
   3.611902023537909*^9, 3.611902032115888*^9}, 3.612331107309966*^9, {
   3.612339746821744*^9, 3.6123400546460953`*^9}, {3.6123400980725327`*^9, 
   3.6123401673177567`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SquareBracket", "[", 
    RowBox[{"f_", ",", "x_"}], "]"}], ":=", " ", 
   RowBox[{"f", "[", "x", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.612330221397726*^9, 3.6123305310932293`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Unprotect", "[", "Plus", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"AddRule", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "ops_Plus", ")"}], "[", "X_", "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"SquareBracket", "[", 
         RowBox[{"#", ",", "X"}], "]"}], "&"}], ",", "ops"}], "]"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Protect", "[", "Plus", "]"}], ";"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.612330616550185*^9, 3.6123306706297693`*^9}, {
  3.6123307972993507`*^9, 3.612330821733644*^9}, {3.614897333732307*^9, 
  3.6148973362205467`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "26", "]"}]], "Output",
 CellChangeTimes->{3.614993988535483*^9, 3.615086870455689*^9, 
  3.615089758449026*^9, 3.615095512512035*^9, 3.615098420496705*^9, 
  3.615169047494969*^9, 3.615171796775981*^9, 3.615260363602388*^9, 
  3.615264277770508*^9, 3.615266597027898*^9, 3.615266711499209*^9, 
  3.615272050374638*^9, 3.615272310313414*^9}]
}, Open  ]],

Cell["\<\
........this should probably be done with Through. See section  \
\[OpenCurlyDoubleQuote]The action of  mv[ ]  on lists\[CloseCurlyDoubleQuote].\
\>", "Text",
 CellChangeTimes->{{3.613093480106533*^9, 3.613093524250429*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Unprotect", "[", "Times", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"AddRule", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a_", " ", "/;", 
          RowBox[{
           RowBox[{"deg", "[", "a", "]"}], "===", "0"}]}], ")"}], "v_"}], 
       ")"}], "[", "X_", "]"}], ":=", " ", 
     RowBox[{"a", " ", 
      RowBox[{"v", "[", "X", "]"}]}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Protect", "[", "Times", "]"}], ";"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.611893568173255*^9, 3.611893590748258*^9}, {
  3.6118936265733423`*^9, 3.61189364956721*^9}, {3.614897311228883*^9, 
  3.614897313773266*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "27", "]"}]], "Output",
 CellChangeTimes->{3.614993988664031*^9, 3.615086870506352*^9, 
  3.615089758465967*^9, 3.6150955125398283`*^9, 3.615098420629031*^9, 
  3.61516904763686*^9, 3.615171796948948*^9, 3.6152603639870567`*^9, 
  3.615264278546246*^9, 3.615266597373269*^9, 3.615266711771099*^9, 
  3.615272050443708*^9, 3.6152723104303923`*^9}]
}, Open  ]],

Cell["\<\
Let  X  be a tensor. We can now apply  the linear operator  op  to  X,\
\>", "Text",
 CellChangeTimes->{{3.615266883845446*^9, 3.615266921877684*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"ClearField", "[", "X", "]"}], ";", 
   RowBox[{
    RowBox[{"NewField", "[", 
     RowBox[{
      RowBox[{"{", "3", "}"}], ",", "X"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"op", "[", "X", "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6152671408509483`*^9, 3.6152671930842037`*^9}, {
  3.6537926084902487`*^9, 3.653792609850461*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", " ", 
   RowBox[{"op1", "[", "X", "]"}]}], "+", 
  RowBox[{"b", " ", 
   RowBox[{"op2", "[", "X", "]"}]}], "+", 
  RowBox[{"c", " ", 
   RowBox[{"op3", "[", "X", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.615267172190916*^9, 3.615267193738611*^9}, 
   3.615267329654023*^9, 3.6152720506110163`*^9, 3.615272310551468*^9}]
}, Open  ]],

Cell["Similary,", "Text",
 CellChangeTimes->{{3.611888467178268*^9, 3.611888637912455*^9}, {
  3.6118887064104843`*^9, 3.6118887116414757`*^9}, {3.611888961803166*^9, 
  3.6118889673544493`*^9}, {3.61189238426899*^9, 3.611892389386456*^9}, {
  3.6118943209631643`*^9, 3.611894360033983*^9}, {3.6118945342598963`*^9, 
  3.6118945989304667`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"a", " ", "Sin"}], " ", "+", " ", 
     RowBox[{"b", " ", "Cos"}]}], ")"}], "[", "\[Theta]", "]"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.611894423942713*^9, 3.6118944603602123`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"b", " ", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "+", 
  RowBox[{"a", " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.611894442786606*^9, 3.6118944616028347`*^9}, 
   3.6119226348323107`*^9, 3.611923184058712*^9, 3.611923444941885*^9, 
   3.611923581701408*^9, 3.611944756846099*^9, 3.6119453086315928`*^9, 
   3.6119520225070343`*^9, 3.6119523803399982`*^9, 3.61195291585563*^9, 
   3.611953509930928*^9, 3.61198311734833*^9, 3.612002288235115*^9, 
   3.612004250382018*^9, 3.6120627928164873`*^9, 3.6121224143759327`*^9, 
   3.612152428332754*^9, 3.6122274156502934`*^9, 3.612242225764325*^9, 
   3.612244606606567*^9, 3.6122454092544193`*^9, 3.612246417795353*^9, 
   3.612246818828086*^9, 3.6122541660293016`*^9, 3.6122567917627077`*^9, 
   3.612331196610965*^9, 3.612340278589348*^9, 3.6123461325003147`*^9, 
   3.6126703033004713`*^9, 3.612683983833263*^9, 3.612686958841412*^9, 
   3.6148181176464033`*^9, 3.6152603653901987`*^9, 3.6152642800373*^9, 
   3.615266597552135*^9, 3.615266712064239*^9, 3.615267047240843*^9, 
   3.615267272377945*^9, 3.6152720506925583`*^9, 3.615272310686755*^9}]
}, Open  ]],

Cell["\<\
To see how this works when  op  is a  linear combinations of   mv  operators,\
\
\>", "Text",
 CellChangeTimes->{{3.611888467178268*^9, 3.611888637912455*^9}, {
  3.6118887064104843`*^9, 3.6118887116414757`*^9}, {3.611888961803166*^9, 
  3.6118889673544493`*^9}, {3.61189238426899*^9, 3.611892389386456*^9}, {
  3.6118943209631643`*^9, 3.611894360033983*^9}, {3.61189463131621*^9, 
  3.6118946342749567`*^9}, {3.611902074180354*^9, 3.6119020786422043`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"op1", " ", "=", 
    RowBox[{
     RowBox[{"a", " ", 
      RowBox[{"mv", "[", 
       RowBox[{"3", ",", "1", ",", "2"}], "]"}]}], "+", 
     RowBox[{"b", " ", 
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "3", ",", "1"}], "]"}]}], "+", 
     RowBox[{"c", " ", 
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1", ",", "3"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   
   RowBox[{"op1", "[", "X", "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.611902111821686*^9, 3.611902121151401*^9}, {
  3.611902165903893*^9, 3.611902167213904*^9}, {3.612062868296535*^9, 
  3.612062902172021*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", " ", 
   RowBox[{"mv", "[", 
    RowBox[{"2", ",", "1", ",", "3"}], "]"}]}], "+", 
  RowBox[{"b", " ", 
   RowBox[{"mv", "[", 
    RowBox[{"2", ",", "3", ",", "1"}], "]"}]}], "+", 
  RowBox[{"a", " ", 
   RowBox[{"mv", "[", 
    RowBox[{"3", ",", "1", ",", "2"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.6119021179709873`*^9, 3.6119021216992693`*^9}, 
   3.611902169363168*^9, 3.611922634842373*^9, 3.6119231840724363`*^9, 
   3.611923444994616*^9, 3.611923581711467*^9, 3.611944757019174*^9, 
   3.6119453087267513`*^9, 3.61195202259599*^9, 3.61195238037959*^9, 
   3.61195291589463*^9, 3.611953509940484*^9, 3.611983117361117*^9, 
   3.612002288296875*^9, 3.61200425064159*^9, 3.612062903850046*^9, 
   3.61212241438653*^9, 3.612152428347909*^9, 3.6122274157159986`*^9, 
   3.612242225821374*^9, 3.612244606746665*^9, 3.6122454093112383`*^9, 
   3.612246417936037*^9, 3.6122468188434*^9, 3.612254166040031*^9, 
   3.612256791830122*^9, 3.61233102213941*^9, 3.61233120296491*^9, 
   3.612340278624906*^9, 3.612346132539935*^9, 3.6126703033566504`*^9, 
   3.6126839838458138`*^9, 3.612686958877388*^9, 3.6148181177823877`*^9, 
   3.615260365751358*^9, 3.6152642805962753`*^9, 3.6152665976082697`*^9, 
   3.615266712429336*^9, 3.615267130739319*^9, 3.615267281326983*^9, 
   3.6152673367110167`*^9, 3.6152720507668047`*^9, 3.615272310814144*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", " ", 
   RowBox[{
    RowBox[{"mv", "[", 
     RowBox[{"2", ",", "1", ",", "3"}], "]"}], "[", "X", "]"}]}], "+", 
  RowBox[{"b", " ", 
   RowBox[{
    RowBox[{"mv", "[", 
     RowBox[{"2", ",", "3", ",", "1"}], "]"}], "[", "X", "]"}]}], "+", 
  RowBox[{"a", " ", 
   RowBox[{
    RowBox[{"mv", "[", 
     RowBox[{"3", ",", "1", ",", "2"}], "]"}], "[", "X", "]"}]}]}]], "Output",\

 CellChangeTimes->{{3.6119021179709873`*^9, 3.6119021216992693`*^9}, 
   3.611902169363168*^9, 3.611922634842373*^9, 3.6119231840724363`*^9, 
   3.611923444994616*^9, 3.611923581711467*^9, 3.611944757019174*^9, 
   3.6119453087267513`*^9, 3.61195202259599*^9, 3.61195238037959*^9, 
   3.61195291589463*^9, 3.611953509940484*^9, 3.611983117361117*^9, 
   3.612002288296875*^9, 3.61200425064159*^9, 3.612062903850046*^9, 
   3.61212241438653*^9, 3.612152428347909*^9, 3.6122274157159986`*^9, 
   3.612242225821374*^9, 3.612244606746665*^9, 3.6122454093112383`*^9, 
   3.612246417936037*^9, 3.6122468188434*^9, 3.612254166040031*^9, 
   3.612256791830122*^9, 3.61233102213941*^9, 3.61233120296491*^9, 
   3.612340278624906*^9, 3.612346132539935*^9, 3.6126703033566504`*^9, 
   3.6126839838458138`*^9, 3.612686958877388*^9, 3.6148181177823877`*^9, 
   3.615260365751358*^9, 3.6152642805962753`*^9, 3.6152665976082697`*^9, 
   3.615266712429336*^9, 3.615267130739319*^9, 3.615267281326983*^9, 
   3.6152673367110167`*^9, 3.6152720507668047`*^9, 3.6152723108206797`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"op2", "=", 
   RowBox[{
    RowBox[{"d", " ", 
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "2", ",", "3"}], "]"}]}], "+", 
    RowBox[{"d", " ", 
     RowBox[{"mv", "[", 
      RowBox[{"3", ",", "2", ",", "1"}], "]"}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.61189400568182*^9, 3.611894068261582*^9}, {
  3.611902138875983*^9, 3.611902174266176*^9}, {3.612062940948846*^9, 
  3.61206295653505*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", " ", 
   RowBox[{"mv", "[", "]"}]}], "+", 
  RowBox[{"d", " ", 
   RowBox[{"mv", "[", 
    RowBox[{"3", ",", "2", ",", "1"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.611894071006646*^9, {3.611902161218957*^9, 3.61190217507456*^9}, 
   3.6119226349052773`*^9, 3.611923184123317*^9, 3.6119234450054293`*^9, 
   3.611923581761035*^9, 3.611944757235407*^9, 3.611945308784305*^9, 
   3.611952022689612*^9, 3.6119523803907137`*^9, 3.6119529159043922`*^9, 
   3.611953509950184*^9, 3.611983117404043*^9, 3.6120022883153133`*^9, 
   3.612004250741605*^9, 3.612062958509294*^9, 3.612122414452218*^9, 
   3.612152428358692*^9, 3.6122274157841263`*^9, 3.612242225872757*^9, 
   3.612244606760685*^9, 3.612245409324224*^9, 3.612246418015122*^9, 
   3.612246818894932*^9, 3.612254166103622*^9, 3.612256791885427*^9, 
   3.612331026805131*^9, 3.612340278634756*^9, 3.612346132551255*^9, 
   3.612670303411396*^9, 3.612683983884013*^9, 3.612686958888783*^9, 
   3.61481811798178*^9, 3.615260366569729*^9, 3.6152642813443317`*^9, 
   3.615266597860499*^9, 3.61526671306019*^9, 3.615267383402021*^9, 
   3.615272050837586*^9, 3.615272310962454*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"op3", "=", 
   RowBox[{
    RowBox[{"op2", "[", "op1", "]"}], "//", "Expand"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.611894076580082*^9, 3.611894117943954*^9}, {
  3.6118941586476307`*^9, 3.611894160118435*^9}, {3.6119021789381866`*^9, 
  3.6119021879441633`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"b", " ", "d", " ", 
   RowBox[{"mv", "[", 
    RowBox[{"1", ",", "3", ",", "2"}], "]"}]}], "+", 
  RowBox[{"a", " ", "d", " ", 
   RowBox[{"mv", "[", 
    RowBox[{"2", ",", "1", ",", "3"}], "]"}]}], "+", 
  RowBox[{"c", " ", "d", " ", 
   RowBox[{"mv", "[", 
    RowBox[{"2", ",", "1", ",", "3"}], "]"}]}], "+", 
  RowBox[{"b", " ", "d", " ", 
   RowBox[{"mv", "[", 
    RowBox[{"2", ",", "3", ",", "1"}], "]"}]}], "+", 
  RowBox[{"a", " ", "d", " ", 
   RowBox[{"mv", "[", 
    RowBox[{"3", ",", "1", ",", "2"}], "]"}]}], "+", 
  RowBox[{"c", " ", "d", " ", 
   RowBox[{"mv", "[", 
    RowBox[{"3", ",", "1", ",", "2"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.6118940791217947`*^9, 3.6118941191542*^9}, 
   3.6118941612489843`*^9, 3.611902191491899*^9, 3.611922634910597*^9, 
   3.611923184128281*^9, 3.6119234450108843`*^9, 3.6119235817660017`*^9, 
   3.6119447572410383`*^9, 3.611945308790049*^9, 3.611952022772832*^9, 
   3.611952380395638*^9, 3.611952915909594*^9, 3.6119535099786463`*^9, 
   3.611983117410264*^9, 3.6120022883235903`*^9, 3.6120042507481337`*^9, 
   3.6120633606912317`*^9, 3.6121224144633503`*^9, 3.612152428432694*^9, 
   3.612227415790018*^9, 3.612242225879569*^9, 3.6122446067666893`*^9, 
   3.612245409370205*^9, 3.612246418021985*^9, 3.612246818901916*^9, 
   3.612254166111492*^9, 3.6122567919266977`*^9, 3.612331028789712*^9, 
   3.612340278665028*^9, 3.612346132556611*^9, 3.612670303467877*^9, 
   3.612683983889524*^9, 3.612686958920018*^9, 3.614818118074078*^9, 
   3.6152603683808107`*^9, 3.615264281968869*^9, 3.6152663940702143`*^9, 
   3.615266598088513*^9, 3.6152667132952147`*^9, 3.615267387821397*^9, 
   3.615267427351935*^9, 3.615267537988255*^9, 3.6152720526446342`*^9, 
   3.6152723127606277`*^9, 3.6152723607849283`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"op2", "[", 
     RowBox[{"op1", "[", "X", "]"}], "]"}], "-", 
    RowBox[{"op3", "[", "X", "]"}]}], "//", "Expand"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6118939473420486`*^9, 3.611893969335294*^9}, {
  3.611894122682604*^9, 3.611894126600939*^9}, {3.611894165721801*^9, 
  3.611894180822756*^9}, {3.6119022163165417`*^9, 3.611902232298478*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.6118939722599897`*^9, 3.611894127923862*^9, {3.6118941678439007`*^9, 
   3.611894185073826*^9}, 3.611902234688868*^9, 3.611922634916286*^9, 
   3.61192318413309*^9, 3.611923445080187*^9, 3.611923581806602*^9, 
   3.61194475724666*^9, 3.6119453087956343`*^9, 3.611952022859848*^9, 
   3.611952380429699*^9, 3.611952915947961*^9, 3.611953509983635*^9, 
   3.611983117417638*^9, 3.612002288377976*^9, 3.612004250755862*^9, 
   3.6120633707192183`*^9, 3.612122414472211*^9, 3.612152428521736*^9, 
   3.6122274157959423`*^9, 3.612242225885951*^9, 3.612244606840001*^9, 
   3.612245409377243*^9, 3.612246418028264*^9, 3.612246818908207*^9, 
   3.612254166120838*^9, 3.612256791994472*^9, 3.612331031680401*^9, 
   3.61234027867107*^9, 3.6123461326147738`*^9, 3.6126703035868893`*^9, 
   3.6126839838968143`*^9, 3.612686958971653*^9, 3.6148181181749697`*^9, 
   3.615260373213225*^9, 3.615264284926387*^9, 3.615266401498968*^9, 
   3.615266598222084*^9, 3.6152667139233103`*^9, 3.615272057535022*^9, 
   3.615272317685025*^9, 3.615272376029231*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["The action of  mv[ ]  on Lists", "Subsubsection",
 CellChangeTimes->{{3.611886448000499*^9, 3.611886515727385*^9}, {
  3.6119013546891823`*^9, 3.6119014156153812`*^9}, {3.613685946457507*^9, 
  3.6136859469050903`*^9}}],

Cell["\<\
If  X  is a list,  then mv[ ]  works as the corresponding permutation of the \
list,   \
\>", "Text",
 CellChangeTimes->{{3.611888467178268*^9, 3.611888637912455*^9}, {
   3.6118887064104843`*^9, 3.6118887116414757`*^9}, {3.611888961803166*^9, 
   3.6118889673544493`*^9}, {3.61189238426899*^9, 3.611892389386456*^9}, {
   3.6118943209631643`*^9, 3.611894360033983*^9}, {3.61189463131621*^9, 
   3.6118946342749567`*^9}, {3.611894669429875*^9, 3.6118947706279087`*^9}, {
   3.612063404960144*^9, 3.612063420671446*^9}, 3.612063530448943*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"mv", "[", "n__", "]"}], "[", "X_List", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "len", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"len", "=", 
       RowBox[{"Length", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Part", "[", 
       RowBox[{"X", ",", 
        RowBox[{"PadList", "[", 
         RowBox[{
          RowBox[{"{", "n", "}"}], ",", "len"}], "]"}]}], "]"}]}]}], "]"}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6147725602396097`*^9, 3.614772630686303*^9}, {
  3.614772669520033*^9, 3.614772768885558*^9}, {3.614773707194002*^9, 
  3.614773713961752*^9}, {3.6147739999138947`*^9, 3.614774004235365*^9}, {
  3.614836064498707*^9, 3.614836097185645*^9}, {3.614836233249344*^9, 
  3.614836277055894*^9}, {3.614898821505354*^9, 3.614898828033045*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "54", "]"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing", "Subsubsection",
 CellChangeTimes->{{3.615018811482389*^9, 3.6150188128101683`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", "]"}], "[", 
  RowBox[{"{", "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.614997065428916*^9, 3.61499707461589*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.614997076037588*^9, 3.615260373564131*^9, 
  3.615264285654353*^9, 3.615268223328862*^9, 3.615272058040264*^9, 
  3.6152723183241167`*^9, 3.6152724857134247`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "[", 
  RowBox[{"{", "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.614997086312085*^9, 3.6149971008252087`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partw"}], "MessageName"], ":", 
  " ", "\<\"Part \[NoBreak]\\!\\({2, 1}\\)\[NoBreak] of \[NoBreak]\\!\\({}\\)\
\[NoBreak] does not exist. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.614997101896587*^9, 3.615260373908733*^9, 
  3.615264286037114*^9, 3.6152682236604967`*^9, 3.615272058317608*^9, 
  3.615272318692935*^9, 3.6152724924607143`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", "}"}], "\[LeftDoubleBracket]", 
  RowBox[{"{", 
   RowBox[{"2", ",", "1"}], "}"}], "\[RightDoubleBracket]"}]], "Output",
 CellChangeTimes->{{3.614997087858376*^9, 3.614997101900297*^9}, 
   3.6152603739134283`*^9, 3.615264286044735*^9, 3.6152682236656027`*^9, 
   3.615272058320682*^9, 3.6152723186988897`*^9, 3.615272492465396*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"1", ",", "5", ",", "3", ",", "2", ",", "4"}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5"}], "}"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "x5", ",", "x3", ",", "x2", ",", "x4"}], "}"}]], "Output",\

 CellChangeTimes->{3.6148362859172487`*^9, 3.6148370706213837`*^9, 
  3.615260374155343*^9, 3.615264286437888*^9, 3.6152682239844637`*^9, 
  3.61527205859521*^9, 3.615272319231041*^9, 3.6152725027542267`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "2"}], "}"}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.612087821819975*^9, 3.61208782417097*^9}, {
  3.6121224472531023`*^9, 3.612122450804182*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x1", ",", "x3", ",", "x2", ",", "x4", ",", "x5"}], "}"}]], "Output",\

 CellChangeTimes->{
  3.612087824802163*^9, {3.6121224416910973`*^9, 3.612122453610024*^9}, 
   3.612152428743486*^9, 3.612227437080429*^9, 3.612242226007949*^9, 
   3.61224460698042*^9, 3.612245409444676*^9, 3.612246424547483*^9, 
   3.6122468190052633`*^9, 3.61225417809126*^9, 3.6122567920839863`*^9, 
   3.61233121143113*^9, 3.6123402787236423`*^9, 3.612346132798574*^9, 
   3.6126703037393913`*^9, 3.612683983987907*^9, 3.6126869590685253`*^9, 
   3.614818118365781*^9, 3.614836568189877*^9, 3.614837072105494*^9, 
   3.615260374564355*^9, 3.615264287055388*^9, 3.615268224462682*^9, 
   3.6152720591210938`*^9, 3.61527231976256*^9, 3.615272505781433*^9}]
}, Open  ]],

Cell["\<\

To get a list of operators applied to an argument to return a list of values, \
use Through[ ],\
\>", "Text",
 CellChangeTimes->{{3.6122028764870234`*^9, 3.612202926289781*^9}, 
   3.6150188307462873`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ops", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a", " ", 
     RowBox[{"mv", "[", 
      RowBox[{"n1", ",", "n2"}], "]"}]}], ",", " ", 
    RowBox[{"b", " ", 
     RowBox[{"mv", "[", 
      RowBox[{"n3", ",", "n4", ",", "n5"}], "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.612202931515793*^9, 3.612203010680691*^9}, {
  3.612203064766137*^9, 3.612203073056698*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a", " ", 
    RowBox[{"mv", "[", 
     RowBox[{"n1", ",", "n2"}], "]"}]}], ",", 
   RowBox[{"b", " ", 
    RowBox[{"mv", "[", 
     RowBox[{"n3", ",", "n4", ",", "n5"}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.612203011241438*^9, 3.6122030753593283`*^9, 
  3.612227437145504*^9, 3.612242226015065*^9, 3.612244606986887*^9, 
  3.61224540945158*^9, 3.6122464246090803`*^9, 3.6122468190120897`*^9, 
  3.612254178153368*^9, 3.612256792127994*^9, 3.6123312115024023`*^9, 
  3.612340278728468*^9, 3.612346132845928*^9, 3.612670303899279*^9, 
  3.612683983993257*^9, 3.612686959101913*^9, 3.614818118485545*^9, 
  3.614836588265994*^9, 3.615260374680513*^9, 3.615264287371245*^9, 
  3.615266350083412*^9, 3.615268224607799*^9, 3.615272059132712*^9, 
  3.61527231996262*^9, 3.615272512812933*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ops", "[", "X", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Through", "[", 
  RowBox[{"ops", "[", "X", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.612203023836876*^9, 3.612203030182522*^9}, {
  3.612203083113927*^9, 3.6122030968688173`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a", " ", 
     RowBox[{"mv", "[", 
      RowBox[{"n1", ",", "n2"}], "]"}]}], ",", 
    RowBox[{"b", " ", 
     RowBox[{"mv", "[", 
      RowBox[{"n3", ",", "n4", ",", "n5"}], "]"}]}]}], "}"}], "[", "X", 
  "]"}]], "Output",
 CellChangeTimes->{
  3.6122030316506567`*^9, 3.612203106019307*^9, 3.612227437151568*^9, 
   3.612242226021861*^9, 3.612244606992999*^9, 3.6122454094579*^9, 
   3.6122464246145363`*^9, 3.612246819018581*^9, 3.61225417822053*^9, 
   3.612256792169187*^9, 3.612331211519063*^9, 3.612340278733*^9, 
   3.612346132889947*^9, 3.612670303949092*^9, 3.612683984000866*^9, 
   3.612686959134712*^9, 3.6148181185870943`*^9, 3.614836594829137*^9, 
   3.6152603746949244`*^9, 3.615264287832094*^9, 3.61526634759396*^9, {
   3.6152682246239567`*^9, 3.61526824814108*^9}, 3.615272059244296*^9, 
   3.615272319976632*^9, 3.6152725146284723`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a", " ", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"n1", ",", "n2"}], "]"}], "[", "X", "]"}]}], ",", 
   RowBox[{"b", " ", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"n3", ",", "n4", ",", "n5"}], "]"}], "[", "X", "]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6122030316506567`*^9, 3.612203106019307*^9, 3.612227437151568*^9, 
   3.612242226021861*^9, 3.612244606992999*^9, 3.6122454094579*^9, 
   3.6122464246145363`*^9, 3.612246819018581*^9, 3.61225417822053*^9, 
   3.612256792169187*^9, 3.612331211519063*^9, 3.612340278733*^9, 
   3.612346132889947*^9, 3.612670303949092*^9, 3.612683984000866*^9, 
   3.612686959134712*^9, 3.6148181185870943`*^9, 3.614836594829137*^9, 
   3.6152603746949244`*^9, 3.615264287832094*^9, 3.61526634759396*^9, {
   3.6152682246239567`*^9, 3.61526824814108*^9}, 3.615272059244296*^9, 
   3.615272319976632*^9, 3.615272514634481*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["The action of  mv[ ]  on Series", "Subsubsection",
 CellChangeTimes->{{3.611886448000499*^9, 3.611886515727385*^9}, {
  3.6119013546891823`*^9, 3.6119014156153812`*^9}, {3.613685939962398*^9, 
  3.613685944185492*^9}}],

Cell["If  X  is a series, then mv acts on each term in X,", "Text",
 CellChangeTimes->{{3.611888467178268*^9, 3.611888637912455*^9}, {
   3.6118887064104843`*^9, 3.6118887116414757`*^9}, {3.611888961803166*^9, 
   3.6118889673544493`*^9}, {3.61189238426899*^9, 3.611892389386456*^9}, {
   3.6118943209631643`*^9, 3.611894360033983*^9}, {3.61189463131621*^9, 
   3.6118946342749567`*^9}, {3.611894669429875*^9, 3.6118947706279087`*^9}, {
   3.612063404960144*^9, 3.612063420671446*^9}, 3.612063530448943*^9, {
   3.613685961738141*^9, 3.613685981017016*^9}, {3.613686402555038*^9, 
   3.613686410058425*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"mv", "[", "n__", "]"}], "[", "X_SeriesData", "]"}], ":=", 
   RowBox[{"MapAt", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"mv", "[", "n", "]"}], "[", "#", "]"}], "&"}], ",", "#"}], 
       "]"}], "&"}], ",", "X", ",", "3"}], "]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.613686300183979*^9, 3.613686360600556*^9}, {
  3.6136864538487577`*^9, 3.613686492872952*^9}, {3.6148988397279654`*^9, 
  3.614898844528182*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "55", "]"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Standard form for   ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"mv", "[", " ", 
      SubscriptBox["n", "1"], "]"}], "[", " ", 
     RowBox[{
      SubscriptBox["Y", "1"], "\[CircleTimes]", " ", 
      RowBox[{
       RowBox[{"mv", "[", 
        SubscriptBox["n", "2"], "]"}], "[", " ", "X", " ", "]"}], " ", 
      "\[CircleTimes]", " ", 
      SubscriptBox["Y", "2"]}], " ", "]"}], " "}], TraditionalForm]]],
 "   is   ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"mv", "[", " ", 
      SubscriptBox["n", "3"], "]"}], "[", " ", 
     RowBox[{
      SubscriptBox["Y", "1"], "\[CircleTimes]", " ", "X", "  ", 
      "\[CircleTimes]", " ", 
      SubscriptBox["Y", "2"]}], " ", "]"}], " "}], TraditionalForm]]],
 "     "
}], "Subsubsection",
 CellChangeTimes->{{3.6152657008978033`*^9, 3.6152658551704893`*^9}, {
   3.6152727278508253`*^9, 3.615272779595168*^9}, 3.653792089823332*^9}],

Cell["", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"mv", "[", "n1__", "]"}], "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Y1___", "/;", 
       RowBox[{"IntegerQ", "[", 
        RowBox[{"deg", "[", "Y1", "]"}], "]"}]}], ")"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", "n2__", "]"}], "[", "X_", "]"}], "\[CircleTimes]", 
     "Y2___"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"mv", "[", "n1", "]"}], "[", 
     RowBox[{"mv", "[", 
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"Sequence", ",", 
         RowBox[{"Range", "[", 
          RowBox[{"deg", "[", "Y1", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"Apply", "[", 
        RowBox[{"Sequence", ",", 
         RowBox[{
          RowBox[{"{", "n2", "}"}], "+", 
          RowBox[{"deg", "[", "Y1", "]"}]}]}], " ", "]"}]}], "]"}], "]"}], 
    " ", "[", 
    RowBox[{"Y1", "\[CircleTimes]", "X", "\[CircleTimes]", "Y2"}], "]"}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612160382443164*^9, 3.6121604070682907`*^9}, {
  3.6121604579174347`*^9, 3.6121604811370497`*^9}, {3.6121607263063498`*^9, 
  3.612160731250511*^9}, {3.612160794292096*^9, 3.612160830468792*^9}, {
  3.612160878596881*^9, 3.612160890705394*^9}, {3.61216114495002*^9, 
  3.6121611664824543`*^9}, {3.612161210103682*^9, 3.6121612185501347`*^9}, {
  3.61216126574651*^9, 3.612161291928719*^9}, {3.61216141305934*^9, 
  3.6121614250119123`*^9}, {3.6128637611754436`*^9, 3.612863820792769*^9}, {
  3.61489725939355*^9, 3.614897262065209*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "56", "]"}]], "Output"]
}, Open  ]],

Cell[TextData[{
 ".... the previous special case rule for when neither  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Y", "1"], TraditionalForm]]],
 "  nor  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Y", "2"], TraditionalForm]]],
 "  is present is still needed because the general case will match   \
\[CircleTimes]",
 Cell[BoxData[
  FormBox[
   RowBox[{"mv", "[", 
    SubscriptBox["n", "2"]}], TraditionalForm]]],
 "__ ][ X ]    rather than ",
 Cell[BoxData[
  FormBox[
   RowBox[{"   ", 
    RowBox[{"mv", "[", 
     SubscriptBox["n", "2"]}]}], TraditionalForm]]],
 "__ ][ X ]    as required."
}], "Text",
 CellChangeTimes->{{3.6116381865350513`*^9, 3.611638242480274*^9}, {
   3.611638310273542*^9, 3.611638313906225*^9}, {3.61163839797014*^9, 
   3.611638427536927*^9}, {3.611639888361322*^9, 3.611639955210099*^9}, {
   3.611640034521619*^9, 3.611640070552799*^9}, {3.611643214089416*^9, 
   3.611643223880831*^9}, {3.6116471248110437`*^9, 3.611647337420285*^9}, {
   3.611647373723956*^9, 3.611647378923085*^9}, 3.611647772863079*^9, {
   3.611647972319211*^9, 3.61164797787097*^9}, {3.6116480190082808`*^9, 
   3.6116480220946093`*^9}, {3.6118093384651814`*^9, 3.61180942825609*^9}, 
   3.6118281696405363`*^9, {3.61187478921754*^9, 3.6118748631053333`*^9}, {
   3.611874893842432*^9, 3.6118750212979507`*^9}, {3.611875224563596*^9, 
   3.6118752489949512`*^9}, {3.611875873684626*^9, 3.611876038932887*^9}, {
   3.611876196069373*^9, 3.611876232197356*^9}, {3.6118771637842712`*^9, 
   3.611877222632003*^9}, {3.6118772578331757`*^9, 3.611877274568162*^9}, {
   3.6121603600307627`*^9, 3.612160366685349*^9}, {3.612160510174983*^9, 
   3.612160570270547*^9}, {3.6121606917115917`*^9, 3.612160704638867*^9}, {
   3.6121615313305807`*^9, 3.612161563189784*^9}, {3.612161697283906*^9, 
   3.6121619073016*^9}}],

Cell["\<\
For example,  if  Y  matches  Y1\[CircleTimes]Y2  within a product  ... \
\[CircleTimes] Y1 \[CircleTimes] Y2 \[CircleTimes] ...  then the value of  Y  \
is  Sequence[ Y1, Y2 ] ,  not  Y1\[CircleTimes]Y2 . 
This is why  deg[ ]  is defined for a Sequence of arguments to be the sum of \
the argument degrees.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6116419461959743`*^9, 3.611642007122487*^9}, {
   3.611642121571679*^9, 3.611642233156457*^9}, {3.6116423486612463`*^9, 
   3.6116423493007803`*^9}, {3.611713565137649*^9, 3.6117137595703497`*^9}, {
   3.611722362793792*^9, 3.611722362937294*^9}, {3.611722569354692*^9, 
   3.611722613002946*^9}, {3.611722753166513*^9, 3.611722764859483*^9}, 
   3.611724949351022*^9, {3.6117294628474617`*^9, 3.6117294733063517`*^9}, {
   3.611907216937298*^9, 3.611907230039212*^9}, {3.611955721805113*^9, 
   3.61195584535773*^9}, {3.61195590435038*^9, 3.611956026190146*^9}, {
   3.611956089057972*^9, 3.611956213775148*^9}, {3.61195627081847*^9, 
   3.611956303087573*^9}, {3.611982106016295*^9, 3.6119823124827642`*^9}, 
   3.612067385732913*^9, {3.612226466239949*^9, 3.612226576618973*^9}, {
   3.6148987056399403`*^9, 3.614898768775936*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"W", ",", "X", ",", "Y"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{
    RowBox[{"{", "1", "}"}], ",", "X"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{
    RowBox[{"{", "2", "}"}], ",", "Y"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{
    RowBox[{"{", "3", "}"}], ",", "W"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "]"}], "[", 
  RowBox[{"Y", "\[CircleTimes]", 
   RowBox[{
    RowBox[{"mv", "[", 
     RowBox[{"3", ",", "2", ",", "1"}], "]"}], "[", "W", "]"}], 
   "\[CircleTimes]", "X"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"3", ",", "1", ",", "2", ",", "4", ",", "6", ",", "5"}], "]"}], 
  "[", 
  RowBox[{"Y", "\[CircleTimes]", 
   RowBox[{
    RowBox[{"mv", "[", 
     RowBox[{"3", ",", "2", ",", "1"}], "]"}], "[", "W", "]"}], 
   "\[CircleTimes]", "X"}], "]"}]}], "Input",
 CellChangeTimes->{{3.615265531586783*^9, 3.615265587928627*^9}, {
  3.615266163307767*^9, 3.6152661793092813`*^9}, {3.6537926160146513`*^9, 
  3.6537926283027153`*^9}}],

Cell[BoxData[
 RowBox[{"Y", "\[CircleTimes]", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"2", ",", "3", ",", "1"}], "]"}], "[", "W", "]"}], 
  "\[CircleTimes]", "X"}]], "Output",
 CellChangeTimes->{3.6152661805623693`*^9, 3.615272069058919*^9, 
  3.615272320905143*^9, 3.615272542824959*^9, 3.6152726375091133`*^9, 
  3.653792966837784*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"5", ",", "1", ",", "2", ",", "4", ",", "6", ",", "3"}], "]"}], 
  "[", 
  RowBox[{"Y", "\[CircleTimes]", "W", "\[CircleTimes]", "X"}], 
  "]"}]], "Output",
 CellChangeTimes->{3.6152661805623693`*^9, 3.615272069058919*^9, 
  3.615272320905143*^9, 3.615272542824959*^9, 3.6152726375091133`*^9, 
  3.6537929668431883`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"4", ",", "5", ",", "3", ",", "2", ",", "1", ",", "6", ",", "7"}], 
   "]"}], "[", 
  RowBox[{"W", "\[CircleTimes]", 
   RowBox[{
    RowBox[{"mv", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "[", "Y", "]"}], "\[CircleTimes]", 
   RowBox[{
    RowBox[{"mv", "[", 
     RowBox[{"3", ",", "2", ",", "1"}], "]"}], "[", "W", "]"}], 
   "\[CircleTimes]", "X", "\[CircleTimes]", "Y"}], "]"}]], "Input",
 CellChangeTimes->{{3.6122268481726723`*^9, 3.612226916011335*^9}, {
  3.6122270496928864`*^9, 3.612227067659968*^9}, {3.615266218102117*^9, 
  3.6152662300138197`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"2", ",", "1"}], "]"}], "[", "Y", "]"}], "\[CircleTimes]", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"3", ",", "2", ",", "1"}], "]"}], "[", "W", "]"}], 
  "\[CircleTimes]", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"3", ",", "2", ",", "1"}], "]"}], "[", "W", "]"}], 
  "\[CircleTimes]", "X", "\[CircleTimes]", "Y"}]], "Output",
 CellChangeTimes->{{3.612226972669154*^9, 3.612227007292963*^9}, 
   3.612227071727476*^9, 3.612227302127369*^9, 3.612242225635901*^9, 
   3.612244606274756*^9, 3.612245409122972*^9, 3.6122456152197857`*^9, 
   3.6122463898356457`*^9, 3.612246818696169*^9, 3.612254154868651*^9, 
   3.6122567915245123`*^9, 3.6123309413752747`*^9, 3.612340278498638*^9, 
   3.612346132247364*^9, 3.612670303124378*^9, 3.612683983736093*^9, 
   3.6126869587447577`*^9, 3.614818117036182*^9, 3.6152603630954523`*^9, 
   3.61526427705326*^9, 3.615266203062867*^9, 3.615266235384222*^9, 
   3.615272070078175*^9, 3.615272322507595*^9, 3.615272547697136*^9, 
   3.6152726401402607`*^9, 3.653792969217087*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"W", ",", "X", ",", "Y"}], "}"}], "]"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Splitting  of  mv[n][ X \[CircleTimes] Y ]   to   ",
 Cell[BoxData[
  FormBox[
   RowBox[{"mv", "[", 
    SubscriptBox["n", "1"], "]"}], TraditionalForm]]],
 "[ X ] \[CircleTimes] ",
 Cell[BoxData[
  FormBox[
   RowBox[{"mv", "[", 
    SubscriptBox["n", "2"], "]"}], TraditionalForm]]],
 "[ Y ]   "
}], "Subsubsection",
 CellChangeTimes->{{3.611886448000499*^9, 3.611886515727385*^9}, {
   3.6119013546891823`*^9, 3.6119014378233757`*^9}, {3.611976460758855*^9, 
   3.6119765233506327`*^9}, {3.615268507067265*^9, 3.615268605739786*^9}, {
   3.615268652827902*^9, 3.615268656879142*^9}, 3.615270862852145*^9}],

Cell[TextData[{
 "The action of  mv  on a tensor product,\n\n                                 \
                        mv[ ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "1"], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "2"], TraditionalForm]]],
 ", ... ][ ",
 Cell[BoxData[
  FormBox["X", TraditionalForm]]],
 " \[CircleTimes] Y ]\n\nwill simplify to one of the forms       \n\n         \
                 X Y form:                   mv[ p1, p2, p3, ... ][ X ]  \
\[CircleTimes]  mv[ q1, q2, q3, ... ][ Y ]   \nor                             \
            \n                          Y X form:                   mv[ q1, \
q2, q3, ... ][ Y ]   \[CircleTimes]  mv[ p1, p2, p3, ... ][ X ]\n\nwhenever \
all the slots of   X  end up either to the left or to the right of all the \
slots of  Y.  Three functions are \nprovided for (automatically) implementing \
the above simplifications :   mvSplitQ,  mvSplit,  tpSplit .  \n"
}], "Text",
 CellChangeTimes->{{3.6116381865350513`*^9, 3.611638242480274*^9}, {
   3.611638310273542*^9, 3.611638313906225*^9}, {3.61163839797014*^9, 
   3.611638427536927*^9}, {3.611639888361322*^9, 3.611639955210099*^9}, {
   3.611640034521619*^9, 3.611640070552799*^9}, {3.611643214089416*^9, 
   3.611643223880831*^9}, {3.6116471248110437`*^9, 3.611647337420285*^9}, {
   3.611647373723956*^9, 3.611647378923085*^9}, 3.611647772863079*^9, {
   3.611647972319211*^9, 3.61164797787097*^9}, {3.6116480190082808`*^9, 
   3.6116480220946093`*^9}, {3.6118093384651814`*^9, 3.61180942825609*^9}, 
   3.6118281696405363`*^9, {3.61187478921754*^9, 3.6118748631053333`*^9}, {
   3.611874893842432*^9, 3.6118750212979507`*^9}, {3.611875224563596*^9, 
   3.6118752489949512`*^9}, {3.611875873684626*^9, 3.611876038932887*^9}, {
   3.611876196069373*^9, 3.611876232197356*^9}, {3.6118771637842712`*^9, 
   3.611877222632003*^9}, {3.611877769818742*^9, 3.6118777786500587`*^9}, {
   3.611878075611964*^9, 3.61187814645957*^9}, {3.6118783471649*^9, 
   3.6118785829260883`*^9}, {3.611878638547184*^9, 3.611878642077338*^9}, {
   3.611879195459589*^9, 3.611879595920678*^9}, {3.611879636017313*^9, 
   3.61187968833698*^9}, {3.61188064173308*^9, 3.611880726869672*^9}, {
   3.611880767014265*^9, 3.611880909830928*^9}, {3.611883861164742*^9, 
   3.611883863382278*^9}, {3.611883900866376*^9, 3.6118840253655977`*^9}, {
   3.611884063909431*^9, 3.61188414938729*^9}, 3.611884182149228*^9, {
   3.6118842957802258`*^9, 3.611884390068674*^9}, {3.611976214046384*^9, 
   3.611976447486558*^9}, {3.611976545719117*^9, 3.6119765490284643`*^9}, {
   3.611978321310688*^9, 3.611978329376396*^9}, {3.6119820149945374`*^9, 
   3.6119820156127367`*^9}, {3.61206370626361*^9, 3.6120637078245296`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "mvSplit"}]], "Input",
 CellChangeTimes->{{3.611906832746397*^9, 3.611906832872903*^9}, 
   3.61194780321922*^9}],

Cell[BoxData[
 StyleBox["\<\"mvSplit[ \
\!\(TraditionalForm\`\(\(mv\)\([\)\*SubscriptBox[\(n\), \(1\)]\)\), \
\!\(TraditionalForm\`\*SubscriptBox[\(n\), \(2\)]\), ... ], { p, q } ]  \
attempts to split the specified  mv[]  operator into a pair of  mv[] \
operators that \\nthat permute seperately the objects  \!\(\*SubscriptBox[\(a\
\), \(i\)]\)  and  \!\(\*SubscriptBox[\(b\), \(j\)]\)  in the list  { \
\!\(\*SubscriptBox[\(a\), \(1\)]\), \!\(\*SubscriptBox[\(a\), \(2\)]\), ..., \
\!\(\*SubscriptBox[\(a\), \(p\)]\), \!\(\*SubscriptBox[\(b\), \(1\)]\), \
\!\(\*SubscriptBox[\(b\), \(2\)]\), ..., \!\(\*SubscriptBox[\(b\), \(q\)]\) } \
.\\n\\nmvSplit[ \!\(TraditionalForm\`\(\(mv\)\([\)\*SubscriptBox[\(n\), \
\(1\)]\)\), \!\(TraditionalForm\`\*SubscriptBox[\(n\), \(2\)]\), ... ], { p, \
q }  ] returns a list of length 3, having the form  {c, P, Q}  where c = 0, \
1, or 2, and where \\n(for c\[VeryThinSpace]\[NotEqual]\[VeryThinSpace]0)  P \
and Q  are mv[] operators. Let s  be the permuted vector\\n \\n               \
                  s =  mv[ \!\(TraditionalForm\`\*SubscriptBox[\(n\), \
\(1\)]\), \!\(TraditionalForm\`\*SubscriptBox[\(n\), \(2\)]\), ... ][ { \
\!\(\*SubscriptBox[\(a\), \(1\)]\), \!\(\*SubscriptBox[\(a\), \(2\)]\), ..., \
\!\(\*SubscriptBox[\(a\), \(p\)]\) ,  \!\(\*SubscriptBox[\(b\), \(1\)]\), \
\!\(\*SubscriptBox[\(b\), \(2\)]\), ..., \!\(\*SubscriptBox[\(b\), \(q\)]\) } \
] .\\n  \\nThe returned value  c  identifies which of the following cases \
holds : \\n\\n         c = 0 :  The symbols  \!\(\*SubscriptBox[\(a\), \(i\)]\
\)  and  \!\(\*SubscriptBox[\(b\), \(j\)]\)  are mixed up in  s .  The  \
\!\(\*SubscriptBox[\(a\), \(i\)]\) are not all together (and neither are the \
\!\(\*SubscriptBox[\(b\), \(j\)]\)).   \\n\\n         c = 1 :  All the \
symbols  \!\(\*SubscriptBox[\(a\), \(i\)]\)  appear first in  s, in which \
case for some  P = mv[ \!\(\*SubscriptBox[\(p\), \(1\)]\), \
\!\(\*SubscriptBox[\(p\), \(2\)]\), ...], and  Q = mv[ \!\(\*SubscriptBox[\(q\
\), \(1\)]\), \!\(\*SubscriptBox[\(q\), \(2\)]\), ...],  \\n\\n               \
      s = Flatten[{ P[{ \!\(\*SubscriptBox[\(a\), \(1\)]\), \
\!\(\*SubscriptBox[\(a\), \(2\)]\), ..., \!\(\*SubscriptBox[\(a\), \(p\)]\) \
}], Q[{ \!\(\*SubscriptBox[\(b\), \(1\)]\), \!\(\*SubscriptBox[\(b\), \
\(2\)]\), ..., \!\(\*SubscriptBox[\(b\), \(q\)]\) }] }]. \\n\\n         c = 2 \
:  All the symbols  \!\(\*SubscriptBox[\(b\), \(j\)]\)  appear first in  s, \
in which case for some  P = mv[ \!\(\*SubscriptBox[\(p\), \(1\)]\), \
\!\(\*SubscriptBox[\(p\), \(2\)]\), ...], and  Q = mv[ \!\(\*SubscriptBox[\(q\
\), \(1\)]\), \!\(\*SubscriptBox[\(q\), \(2\)]\), ...],  \\n\\n               \
      s = Flatten[{ Q[{ \!\(\*SubscriptBox[\(b\), \(1\)]\), \
\!\(\*SubscriptBox[\(b\), \(2\)]\), ..., \!\(\*SubscriptBox[\(b\), \(q\)]\) \
}], P[{ \!\(\*SubscriptBox[\(a\), \(1\)]\), \!\(\*SubscriptBox[\(a\), \
\(2\)]\), ..., \!\(\*SubscriptBox[\(a\), \(p\)]\) }] }]. \\n\\nFor the case c \
= 0, the value returned by  mvSplit  is the list  { 0, { Null, Null} \
}.\\n\\nThe first argument of  mvSplit[ ]  can also be provided as the list  \
\!\(TraditionalForm\`{\\\\ \*SubscriptBox[\(n\), \(1\)]\), \
\!\(TraditionalForm\`\*SubscriptBox[\(n\), \(2\)]\), ...}  instead of the \
operator  \!\(TraditionalForm\`\(\(mv\)\([\)\*SubscriptBox[\(n\), \(1\)]\)\), \
\!\(TraditionalForm\`\*SubscriptBox[\(n\), \(2\)]\), ... ].\"\>", 
  "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.61527261883216*^9},
 CellTags->"Info3615308618-6396053"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "mvSplitQ"}]], "Input",
 CellChangeTimes->{3.611949861515781*^9}],

Cell[BoxData[
 StyleBox["\<\"mvSplitQ[ \!\(TraditionalForm\`\(\(mv\)\([\)\*SubscriptBox[\(n\
\), \(1\)]\)\), \!\(TraditionalForm\`\*SubscriptBox[\(n\), \(2\)]\), ..., \
\!\(\*SubscriptBox[\(n\), \(r\)]\)], { p, q } ]  returns True if the \
specified mv[] splits, and False otherwise.\\n\\nIt is assumed that  \
\!\(TraditionalForm\`\(\(mv\)\([\)\(\\\\ \)\*SubscriptBox[\(n\), \(1\)]\)\), \
\!\(TraditionalForm\`\*SubscriptBox[\(n\), \(2\)]\), ... ]  is a valid mv[ ], \
 that is,  { \!\(\*SubscriptBox[\(n\), \(1\)]\), \!\(\*SubscriptBox[\(n\), \(\
\(2\)\(,\)\(\\\\ \)\)]\)..., \!\(\*SubscriptBox[\(n\), \(r\)]\) } is a \
permutation of  { 1, 2, ..., r }.    \\n\\nThe first argument of  mvSplit[ ]  \
can also be provided as the list  \!\(TraditionalForm\`{\\\\ \
\*SubscriptBox[\(n\), \(1\)]\), \!\(TraditionalForm\`\*SubscriptBox[\(n\), \
\(2\)]\), ...}  instead of the operator  \!\(TraditionalForm\`\(\(mv\)\([\)\(\
\\\\ \)\*SubscriptBox[\(n\), \(1\)]\)\), \!\(TraditionalForm\`\*SubscriptBox[\
\(n\), \(2\)]\), ... ].\\n\\nFor further info see:  ? mvSplit\"\>", 
  "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.615272619019228*^9},
 CellTags->"Info3615308618-6396053"]
}, Open  ]],

Cell["The simplification rule we want is,", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6116419461959743`*^9, 3.611642007122487*^9}, {
   3.611642121571679*^9, 3.611642233156457*^9}, {3.6116423486612463`*^9, 
   3.6116423493007803`*^9}, {3.611713565137649*^9, 3.6117137595703497`*^9}, {
   3.611722362793792*^9, 3.611722362937294*^9}, {3.611722569354692*^9, 
   3.611722613002946*^9}, {3.611722753166513*^9, 3.611722764859483*^9}, 
   3.611724949351022*^9, {3.6117294628474617`*^9, 3.6117294733063517`*^9}, {
   3.611907216937298*^9, 3.611907230039212*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"mv", "[", "n__", "]"}], "[", 
     RowBox[{"X__", "\[CircleTimes]", "Y__"}], "]"}], "/;", 
    RowBox[{"mvSplitQ", "[", 
     RowBox[{
      RowBox[{"{", "n", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"deg", "[", "X", "]"}], ",", 
        RowBox[{"deg", "[", "Y", "]"}]}], "}"}]}], "]"}]}], ":=", " ", 
   RowBox[{"tpSplit", "[", 
    RowBox[{
     RowBox[{"{", "n", "}"}], ",", 
     RowBox[{"CircleTimes", "[", "X", "]"}], ",", 
     RowBox[{"CircleTimes", "[", "Y", "]"}]}], "]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.611907234743011*^9, 3.6119073336540194`*^9}, {
   3.611907377432089*^9, 3.611907378903059*^9}, {3.611907488791875*^9, 
   3.6119075174490023`*^9}, 3.61190763823531*^9, {3.6119533167257013`*^9, 
   3.6119533194128857`*^9}, {3.611954404562639*^9, 3.6119544229724083`*^9}, {
   3.6119556439526*^9, 3.6119556544927883`*^9}, {3.6119822655387278`*^9, 
   3.611982268428624*^9}, {3.612067375041016*^9, 3.6120673778910437`*^9}, {
   3.6144911458844748`*^9, 3.614491151564682*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "57", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
.... the  CircleTimes[ ]  wrappers around  X  and Y  on the  rhs  are because \
if  X  (or  Y)  matches multiple factors then the value of  X  is a Sequence \
of these factors, not a tensor product.  
For example,  if  X  matches  X1\[CircleTimes]X2  within the product  ... \
\[CircleTimes] X1 \[CircleTimes] X2 \[CircleTimes] ...  then the value of  X  \
is  Sequence[ X1, X2 ]. \
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.6116419461959743`*^9, 3.611642007122487*^9}, {
   3.611642121571679*^9, 3.611642233156457*^9}, {3.6116423486612463`*^9, 
   3.6116423493007803`*^9}, {3.611713565137649*^9, 3.6117137595703497`*^9}, {
   3.611722362793792*^9, 3.611722362937294*^9}, {3.611722569354692*^9, 
   3.611722613002946*^9}, {3.611722753166513*^9, 3.611722764859483*^9}, 
   3.611724949351022*^9, {3.6117294628474617`*^9, 3.6117294733063517`*^9}, {
   3.611907216937298*^9, 3.611907230039212*^9}, {3.611955721805113*^9, 
   3.61195584535773*^9}, {3.61195590435038*^9, 3.611956026190146*^9}, {
   3.611956089057972*^9, 3.611956213775148*^9}, {3.61195627081847*^9, 
   3.611956303087573*^9}, {3.611982106016295*^9, 3.6119823124827642`*^9}, 
   3.612067385732913*^9, 3.61222661303827*^9, {3.615269045853574*^9, 
   3.615269050621551*^9}}],

Cell["\<\
There are two defns of   mvSplitQ   here.   Making use of   PermutationListQ[ \
]   from  Version \[GreaterEqual] 8 makes the  2nd defn about 2 x faster than \
the 1st hand coded defn.\
\>", "Text",
 CellChangeTimes->{{3.6152690619489*^9, 3.615269191245625*^9}, {
  3.615269230861622*^9, 3.6152693195822906`*^9}, {3.6152694427984943`*^9, 
  3.61526944911871*^9}, {3.6152694874547043`*^9, 3.615269524174865*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"$VersionNumber", " ", "<", " ", "8.0"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mvSplitQ", "[", 
     RowBox[{"n_", ",", 
      RowBox[{"{", 
       RowBox[{"p_Integer", ",", "q_Integer"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ab", ",", "s", ",", "i", ",", "j"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ab", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "p"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "q"}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"s", " ", "=", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{"mv", ",", "n"}], "]"}], "[", "ab", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"LengthWhile", "[", 
           RowBox[{"s", ",", 
            RowBox[{
             RowBox[{"SameQ", "[", 
              RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "]"}], "===", "p"}], 
         ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"LengthWhile", "[", 
           RowBox[{"s", ",", 
            RowBox[{
             RowBox[{"SameQ", "[", 
              RowBox[{"#", ",", "0"}], "]"}], "&"}]}], "]"}], "===", "q"}], 
         ")"}]}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mvSplitQ", "[", 
     RowBox[{"n_", ",", 
      RowBox[{"{", 
       RowBox[{"p_Integer", ",", "q_Integer"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "i", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "n", "]"}], ">", 
          RowBox[{"p", "+", "q"}]}], ",", 
         RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"PermutationListQ", "[", 
           RowBox[{"Apply", "[", 
            RowBox[{"List", ",", "n"}], "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<mvSplitQ: The argument \>\"", ",", 
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", "n"}], "]"}], ",", 
            "\"\< should be a permutation list.\>\""}], "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"i", " ", "=", " ", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{"mv", ",", "n"}], "]"}], "[", 
         RowBox[{"Range", "[", 
          RowBox[{"p", "+", "q"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PermutationListQ", "[", 
         RowBox[{"Take", "[", 
          RowBox[{"i", ",", "p"}], "]"}], "]"}], "||", 
        RowBox[{"PermutationListQ", "[", 
         RowBox[{"Take", "[", 
          RowBox[{"i", ",", 
           RowBox[{"-", "p"}]}], "]"}], "]"}]}]}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mvSplitQ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.614756311764223*^9, 3.6147563117662992`*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.614756313811686*^9, {3.6147568583130836`*^9, 3.61475687084023*^9}, 
   3.614818119399416*^9, 3.61526037590653*^9, 3.615264289038783*^9, 
   3.6152687018283043`*^9, 3.615268743191166*^9, {3.615269396032729*^9, 
   3.615269414480788*^9}, 3.615269816473319*^9, 3.61527207078467*^9, 
   3.615272324280315*^9, {3.615272595327629*^9, 3.615272619252935*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"3", ",", "1", ",", "2"}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.614756878056779*^9, 3.614756896478249*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "1", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6147568977536383`*^9, 3.6148181195049057`*^9, 3.615260376165045*^9, 
   3.6152642892991962`*^9, 3.6152687033434353`*^9, 3.6152687433042383`*^9, {
   3.6152693972857523`*^9, 3.615269415890361*^9}, 3.615269816627849*^9, 
   3.6152720710196667`*^9, 3.615272324600453*^9, {3.615272597020094*^9, 
   3.61527261934933*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"mvSplitQ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"3", ",", "1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], "]"}], ";"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "10000"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.614756509035995*^9, 3.614756545658475*^9}, 
   3.6147565871169243`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.72404500000000004966693722963100299239`5.880365472079476", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.6147565464613113`*^9, 3.6147566196996517`*^9}, {
   3.614756701939887*^9, 3.6147567051043158`*^9}, 3.614818120406023*^9, 
   3.615260514743804*^9, 3.615264309057016*^9, 3.615268691609964*^9, 
   3.615268744617655*^9, {3.615268794092516*^9, 3.615268809044661*^9}, 
   3.615268930702649*^9, {3.6152694284531803`*^9, 3.615269434240305*^9}, 
   3.615269817930262*^9, 3.615272131980237*^9, 3.615272355951036*^9, {
   3.615272599913168*^9, 3.615272620405099*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mvSplitQ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.612065846318705*^9, 3.612065864889935*^9}, {
  3.612065909025165*^9, 3.612065920131734*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.612065925082038*^9, 3.612122526221283*^9, 3.612152429966236*^9, 
   3.612227468207955*^9, 3.612242227878578*^9, 3.612244608499131*^9, 
   3.61224541138559*^9, 3.612246435177659*^9, 3.612246820787221*^9, 
   3.612254190896512*^9, 3.612256793155978*^9, 3.612331218380889*^9, 
   3.612340279556377*^9, 3.612346133789475*^9, 3.61267030511666*^9, 
   3.612683984921473*^9, 3.61268695995617*^9, 3.614755807188672*^9, 
   3.61475625251716*^9, 3.614818120507803*^9, 3.615268744801076*^9, {
   3.6152693992717247`*^9, 3.6152694179638443`*^9}, 3.615269818170559*^9, 
   3.615272620591031*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mvSplitQ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.612065938931032*^9, 3.612065939283058*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.612065942015617*^9, 3.612122526229053*^9, 3.61215242997157*^9, 
   3.612227469204524*^9, 3.612242227884117*^9, 3.612244608506371*^9, 
   3.612245411393173*^9, 3.6122464352722816`*^9, 3.6122468207957087`*^9, 
   3.612254190901404*^9, 3.612256793200242*^9, 3.612331218521858*^9, 
   3.6123402795625887`*^9, 3.612346133830111*^9, 3.612670305155006*^9, 
   3.6126839849294157`*^9, 3.612686959963889*^9, 3.614818120521179*^9, 
   3.615268744982719*^9, {3.615269400363586*^9, 3.61526941885349*^9}, 
   3.6152698183896093`*^9, 3.615272620678709*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mvSplitQ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2", ",", "1", ",", "3", ",", "4", ",", "6", ",", "5", ",", "9", ",", "8",
      ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.612065968676193*^9, 3.6120659874627647`*^9}, {
  3.6120660353840103`*^9, 3.612066054023456*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.612065978293572*^9, 3.6120659882029247`*^9}, {
   3.612066039568242*^9, 3.6120660553085117`*^9}, 3.6121225262367477`*^9, 
   3.61215242997604*^9, 3.612227470207979*^9, 3.612242227890045*^9, 
   3.6122446085149403`*^9, 3.612245411404545*^9, 3.6122464352809143`*^9, 
   3.612246820804709*^9, 3.612254190906291*^9, 3.612256793206091*^9, 
   3.612331218528184*^9, 3.612340279568617*^9, 3.612346133872326*^9, 
   3.612670305236918*^9, 3.6126839849371347`*^9, 3.612686959971616*^9, 
   3.614818120613432*^9, 3.615268745265764*^9, {3.615269401507864*^9, 
   3.615269420152878*^9}, 3.615269818654942*^9, 3.6152726210345383`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mvSplitQ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2", ",", "1", ",", "3", ",", "4", ",", "6", ",", "5", ",", "9", ",", "8",
      ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.612066066168029*^9, 3.612066067831286*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.6120660683842897`*^9, 3.6121225262443047`*^9, 3.612152429980506*^9, 
   3.6122274711147757`*^9, 3.612242227975326*^9, 3.612244608606636*^9, 
   3.612245411560368*^9, 3.612246435376299*^9, 3.612246820897066*^9, 
   3.612254190910934*^9, 3.6122567932111807`*^9, 3.61233121858813*^9, 
   3.612340279574545*^9, 3.612346133933339*^9, 3.612670305270659*^9, 
   3.6126839849448147`*^9, 3.612686959981039*^9, 3.6148181207276287`*^9, 
   3.6152687452757273`*^9, {3.6152694026119537`*^9, 3.615269421355351*^9}, 
   3.615269818792158*^9, 3.615272621312455*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mvSplitQ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "4", ",", "5", ",", "6", ",", "3"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.612066146295826*^9, 3.612066185941786*^9}, {
  3.61206621765534*^9, 3.612066224203094*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.612066208672394*^9, 3.6120662252486887`*^9}, 
   3.6121225263284683`*^9, 3.6121524299849243`*^9, 3.6122274729069633`*^9, 
   3.612242227981193*^9, 3.612244608612014*^9, 3.61224541156651*^9, 
   3.612246435550379*^9, 3.6122468209027557`*^9, 3.612254190990095*^9, 
   3.612256793216936*^9, 3.612331218594998*^9, 3.612340279614211*^9, 
   3.612346133974494*^9, 3.6126703053077707`*^9, 3.6126839849887333`*^9, 
   3.612686959989506*^9, 3.6148181207439623`*^9, 3.615268745374995*^9, {
   3.6152694040276003`*^9, 3.6152694230207243`*^9}, 3.6152698190072308`*^9, 
   3.6152726213237534`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mvSplitQ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "5", ",", "6", ",", "3", ",", "2", ",", "1"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.612066270837288*^9, 3.612066302711437*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6120662806207857`*^9, 3.612066303597118*^9}, 
   3.612122526333551*^9, 3.612152430058703*^9, 3.612227474431303*^9, 
   3.612242227988389*^9, 3.612244608617264*^9, 3.612245411573736*^9, 
   3.612246435643033*^9, 3.6122468209094963`*^9, 3.612254190995055*^9, 
   3.612256793255398*^9, 3.612331218601757*^9, 3.6123402796186*^9, 
   3.61234613406297*^9, 3.612670305367073*^9, 3.6126839849937897`*^9, 
   3.6126869599972057`*^9, 3.6148181211992207`*^9, 3.615268745481944*^9, {
   3.615269405091093*^9, 3.615269423964476*^9}, 3.6152698192813253`*^9, 
   3.6152726215327044`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Clear", "[", "mvSplit", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mvSplit", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"{", 
     RowBox[{"p_Integer", ",", "q_Integer"}], "}"}]}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "P", ",", "Q"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"i", " ", "=", " ", 
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"mv", ",", "n"}], "]"}], "[", 
       RowBox[{"Range", "[", 
        RowBox[{"p", "+", "q"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"PermutationListQ", "[", 
        RowBox[{"Take", "[", 
         RowBox[{"i", ",", "p"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"P", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"mv", ",", 
           RowBox[{"Take", "[", 
            RowBox[{"i", ",", "p"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Q", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"mv", ",", 
           RowBox[{
            RowBox[{"Take", "[", 
             RowBox[{"i", ",", 
              RowBox[{"-", "q"}]}], "]"}], "-", "p"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "P", ",", "Q"}], "}"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"PermutationListQ", "[", 
        RowBox[{"Take", "[", 
         RowBox[{"i", ",", 
          RowBox[{"-", "p"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"P", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"mv", ",", 
           RowBox[{"Take", "[", 
            RowBox[{"i", ",", 
             RowBox[{"-", "p"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Q", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"mv", ",", 
           RowBox[{
            RowBox[{"Take", "[", 
             RowBox[{"i", ",", "q"}], "]"}], "-", "p"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"2", ",", "P", ",", "Q"}], "}"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "Null", ",", "Null"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6119071163260736`*^9, 3.611907150543086*^9}, {
   3.611908666469199*^9, 3.611908744329873*^9}, {3.611908829527306*^9, 
   3.611908975481081*^9}, 3.611909185368889*^9, {3.611909242264927*^9, 
   3.611909291736661*^9}, {3.6119171122529373`*^9, 3.6119171593995647`*^9}, {
   3.611917197834344*^9, 3.6119172566651897`*^9}, {3.611917385212204*^9, 
   3.611917400051951*^9}, {3.611917633142764*^9, 3.611917643632283*^9}, {
   3.611917780437402*^9, 3.611917818693275*^9}, {3.6119178916577873`*^9, 
   3.611917940854783*^9}, 3.611917996057369*^9, {3.611918073241984*^9, 
   3.611918076119603*^9}, {3.611918142841242*^9, 3.61191819268939*^9}, {
   3.611918232818943*^9, 3.6119183301067123`*^9}, {3.61191928710328*^9, 
   3.6119194883260736`*^9}, {3.611919559784988*^9, 3.611919593421205*^9}, {
   3.611919624842991*^9, 3.611919936959654*^9}, {3.611920005014628*^9, 
   3.611920005478643*^9}, {3.6119200491553087`*^9, 3.6119201911764307`*^9}, 
   3.611921698234844*^9, {3.611921742250411*^9, 3.611921748647822*^9}, {
   3.611945423952589*^9, 3.611945442348209*^9}, {3.6119456113758717`*^9, 
   3.61194561631947*^9}, {3.611945835769457*^9, 3.611945835863578*^9}, {
   3.611946045776931*^9, 3.6119460720714912`*^9}, {3.6119463854948893`*^9, 
   3.6119464737945642`*^9}, {3.611947239456719*^9, 3.611947276556476*^9}, {
   3.6119473331226397`*^9, 3.611947341377829*^9}, {3.6119487791438227`*^9, 
   3.6119487867114897`*^9}, {3.6119504991180363`*^9, 3.61195051896671*^9}, {
   3.611956878365753*^9, 3.611956898899795*^9}, {3.611975981850895*^9, 
   3.61197598996747*^9}, {3.612066500903471*^9, 3.612066510488888*^9}, {
   3.6120665446883783`*^9, 3.612066785809805*^9}, {3.612066816866459*^9, 
   3.612066864075728*^9}, {3.612066912144153*^9, 3.612067022434349*^9}, {
   3.612067656831028*^9, 3.6120676685888147`*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "tpSplit", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tpSplit", "[", 
   RowBox[{"n_", ",", "X_", ",", "Y_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"c", ",", "P", ",", "Q"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c", ",", "P", ",", "Q"}], "}"}], "=", 
      RowBox[{"mvSplit", "[", 
       RowBox[{"n", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"deg", "[", "X", "]"}], ",", 
          RowBox[{"deg", "[", "Y", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"c", "===", "1"}], ",", " ", 
       RowBox[{
        RowBox[{"P", "[", "X", "]"}], "\[CircleTimes]", 
        RowBox[{"Q", "[", "Y", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c", "===", "2"}], ",", 
         RowBox[{
          RowBox[{"Q", "[", "Y", "]"}], "\[CircleTimes]", 
          RowBox[{"P", "[", "X", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"mv", ",", "n"}], "]"}], "[", 
          RowBox[{"X", "\[CircleTimes]", "Y"}], "]"}]}], "]"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.611907589840332*^9, 3.61190758999854*^9}, {
  3.611907699696433*^9, 3.6119077426334867`*^9}, {3.6119078109528637`*^9, 
  3.611908160952928*^9}, {3.611908674316812*^9, 3.611908674648273*^9}, {
  3.611948917908115*^9, 3.611948934848577*^9}, {3.6119499679768047`*^9, 
  3.611950116695026*^9}, {3.611950151481832*^9, 3.611950188788925*^9}, {
  3.611951588277235*^9, 3.611951590052206*^9}, {3.611982561873863*^9, 
  3.61198257119816*^9}, {3.611982626880124*^9, 3.611982630862154*^9}, {
  3.612067073152635*^9, 3.612067076110626*^9}, {3.612067132845916*^9, 
  3.612067166907946*^9}}],

Cell["Some simple examples,", "Text",
 CellChangeTimes->{{3.611921131098195*^9, 3.611921293745077*^9}, {
   3.611950897085691*^9, 3.611950912988896*^9}, {3.611957130659176*^9, 
   3.6119571779866858`*^9}, {3.611983651284217*^9, 3.61198365310769*^9}, 
   3.612202721352491*^9, {3.6122543329916277`*^9, 3.612254347646646*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"X", "=."}], ";", 
  RowBox[{"Y", "=."}], ";", 
  RowBox[{"Z", "=."}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "X", "]"}], "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "Y", "]"}], "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "Z", "]"}], "=", "3"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6119214591755247`*^9, 3.611921487704364*^9}, {
  3.61194929889445*^9, 3.61194929953981*^9}, {3.611951093907091*^9, 
  3.6119511387119713`*^9}, {3.611951437641457*^9, 3.61195143769005*^9}, {
  3.612254364358965*^9, 3.6122543736126013`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "1"}], "]"}], 
  "[", 
  RowBox[{"Y", "\[CircleTimes]", "X", "\[CircleTimes]", "Z"}], "]"}]], "Input",\

 CellChangeTimes->{{3.611982977145029*^9, 3.6119829809497423`*^9}, {
  3.6120673350150557`*^9, 3.612067353406693*^9}, {3.612227538503786*^9, 
  3.612227540873868*^9}}],

Cell[BoxData[
 RowBox[{"X", "\[CircleTimes]", "Z", "\[CircleTimes]", "Y"}]], "Output",
 CellChangeTimes->{
  3.612067982130755*^9, 3.612068591734786*^9, {3.6120689279216623`*^9, 
   3.6120689703001823`*^9}, 3.612122527082473*^9, 3.612152431089175*^9, 
   3.612153018038012*^9, 3.612153102057633*^9, 3.612227491761198*^9, 
   3.6122275420824223`*^9, 3.6122422285276003`*^9, 3.6122446092315273`*^9, 
   3.6122454121653347`*^9, 3.612246436845786*^9, 3.612246821499617*^9, 
   3.612254191597702*^9, 3.612254382547864*^9, 3.612256793441498*^9, 
   3.612331218916686*^9, 3.6123402797459583`*^9, 3.612346134421277*^9, 
   3.612670305504197*^9, 3.612683985064267*^9, 3.612686960379785*^9, 
   3.614818121606352*^9, 3.6152687460569677`*^9, 3.615269819690205*^9, 
   3.6152726220333977`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "3", ",", "1"}], "]"}], "[", 
  RowBox[{"Y", "\[CircleTimes]", "X"}], "]"}]], "Input",
 CellChangeTimes->{{3.6120675542576*^9, 3.612067554680696*^9}}],

Cell[BoxData[
 RowBox[{"X", "\[CircleTimes]", "Y"}]], "Output",
 CellChangeTimes->{3.612067563452241*^9, 3.612067684738439*^9, 
  3.6120679846919003`*^9, 3.61212252709146*^9, 3.61215243115941*^9, 
  3.612227551696602*^9, 3.6122422285366907`*^9, 3.612244609340662*^9, 
  3.612245412271779*^9, 3.612246436950108*^9, 3.612246821505247*^9, 
  3.6122541916031713`*^9, 3.612254383902801*^9, 3.612256793480378*^9, 
  3.6123312189228163`*^9, 3.6123402797811193`*^9, 3.612346134467442*^9, 
  3.612670305535585*^9, 3.612683985069109*^9, 3.612686960419797*^9, 
  3.614818121741535*^9, 3.615268746154455*^9, 3.615269819835767*^9, 
  3.615272622133107*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "3", ",", "1", ",", "4", ",", "5", ",", "6"}], "]"}], 
  "[", 
  RowBox[{"Z", "\[CircleTimes]", "Z"}], "]"}]], "Input",
 CellChangeTimes->{{3.6120677170838223`*^9, 3.612067723291016*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"2", ",", "3", ",", "1"}], "]"}], "[", "Z", "]"}], 
  "\[CircleTimes]", "Z"}]], "Output",
 CellChangeTimes->{3.612067725394359*^9, 3.612067986834496*^9, 
  3.612122527108459*^9, 3.6121524312353573`*^9, 3.612242228542861*^9, 
  3.612244609422366*^9, 3.612245412484625*^9, 3.612246437057702*^9, 
  3.612246821510763*^9, 3.61225419167629*^9, 3.612254384911173*^9, 
  3.612256793518293*^9, 3.612331218928812*^9, 3.612340279815189*^9, 
  3.6123461345151787`*^9, 3.61267030556633*^9, 3.612683985073971*^9, 
  3.612686960425803*^9, 3.614818122254159*^9, 3.615268746260643*^9, 
  3.61526981985184*^9, 3.615272622535428*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1", ",", "3", ",", "5", ",", "6", ",", "4"}], "]"}], 
  "[", 
  RowBox[{"Z", "\[CircleTimes]", "Z"}], "]"}]], "Input",
 CellChangeTimes->{{3.6120677379795847`*^9, 3.612067750283071*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"2", ",", "1", ",", "3"}], "]"}], "[", "Z", "]"}], 
  "\[CircleTimes]", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"2", ",", "3", ",", "1"}], "]"}], "[", "Z", "]"}]}]], "Output",
 CellChangeTimes->{3.612067752882423*^9, 3.612067987859737*^9, 
  3.612122527118594*^9, 3.6121524312415743`*^9, 3.6122422285491667`*^9, 
  3.612244609428186*^9, 3.6122454124909487`*^9, 3.612246437185659*^9, 
  3.612246821600761*^9, 3.612254191789399*^9, 3.612254386153846*^9, 
  3.612256793578937*^9, 3.612331219000764*^9, 3.612340279880126*^9, 
  3.612346134557076*^9, 3.61267030561884*^9, 3.612683985078752*^9, 
  3.612686960431234*^9, 3.614818122767571*^9, 3.6152687462757463`*^9, 
  3.615269819987678*^9, 3.615272622636571*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1", ",", "3", ",", "5", ",", "4"}], "]"}], "[", 
  RowBox[{"X", "\[CircleTimes]", "Z"}], "]"}]], "Input",
 CellChangeTimes->{{3.612067779660194*^9, 3.61206778818688*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "\[CircleTimes]", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"1", ",", "3", ",", "2"}], "]"}], "[", "Z", "]"}]}]], "Output",
 CellChangeTimes->{3.612067789359417*^9, 3.6120679951239767`*^9, 
  3.612122527187283*^9, 3.612152431247313*^9, 3.612227634080793*^9, 
  3.612242228636222*^9, 3.6122446094336853`*^9, 3.6122454124971867`*^9, 
  3.612246437194624*^9, 3.612246821810368*^9, 3.612254191847471*^9, 
  3.612254387798654*^9, 3.6122567936359453`*^9, 3.612331219021695*^9, 
  3.6123402799136477`*^9, 3.6123461345620403`*^9, 3.612670305666589*^9, 
  3.61268398511337*^9, 3.6126869604362907`*^9, 3.614818123501593*^9, 
  3.615268746672377*^9, 3.6152698201210003`*^9, 3.615272622858947*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"3", ",", "5", ",", "4", ",", "2", ",", "1"}], "]"}], "[", 
  RowBox[{"X", "\[CircleTimes]", "Z"}], "]"}]], "Input",
 CellChangeTimes->{{3.612067810698495*^9, 3.612067814987665*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"1", ",", "3", ",", "2"}], "]"}], "[", "Z", "]"}], 
  "\[CircleTimes]", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}]}]], "Output",
 CellChangeTimes->{3.6120678155548162`*^9, 3.61206799651054*^9, 
  3.612122527194618*^9, 3.612152431318243*^9, 3.612227637601099*^9, 
  3.612242228642707*^9, 3.612244609439083*^9, 3.6122454125873823`*^9, 
  3.612246437279798*^9, 3.612246821819828*^9, 3.612254191916469*^9, 
  3.612254389034121*^9, 3.612256793674107*^9, 3.61233121903032*^9, 
  3.612340279920059*^9, 3.612346134566951*^9, 3.612670305714758*^9, 
  3.612683985118494*^9, 3.612686960466666*^9, 3.6148181235166063`*^9, 
  3.615268746686987*^9, 3.615269820245578*^9, 3.615272622868423*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"1", ",", "2", ",", "4", ",", "3", ",", "6", ",", "5"}], "]"}], 
  "[", 
  RowBox[{"Z", "\[CircleTimes]", "Y", "\[CircleTimes]", "X"}], "]"}]], "Input",\

 CellChangeTimes->{{3.612068378452347*^9, 3.612068404286352*^9}, {
  3.612227684667025*^9, 3.612227689386113*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "]"}], "[", 
   RowBox[{"Z", "\[CircleTimes]", "Y"}], "]"}], "\[CircleTimes]", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}]}]], "Output",
 CellChangeTimes->{
  3.611984688066024*^9, 3.612002289515155*^9, 3.612004251853723*^9, {
   3.6120683901012707`*^9, 3.612068422741157*^9}, 3.612068574646037*^9, 
   3.612069709561798*^9, 3.612122527211239*^9, 3.6121524313309937`*^9, 
   3.612227649797188*^9, 3.6122276901486197`*^9, 3.612242228650155*^9, 
   3.612244609513459*^9, 3.6122454125938187`*^9, 3.612246437397718*^9, 
   3.612246821829328*^9, 3.6122541920039787`*^9, 3.612254390161147*^9, 
   3.6122567937157288`*^9, 3.612331219038424*^9, 3.612340279958832*^9, 
   3.612346134605894*^9, 3.612670305761772*^9, 3.612683985123912*^9, 
   3.6126869604734583`*^9, 3.6148181239648333`*^9, 3.6152687467899303`*^9, 
   3.615269820380825*^9, 3.615272623286975*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"1", ",", "2", ",", "3", ",", "5", ",", "6", ",", "4"}], "]"}], 
  "[", 
  RowBox[{"Z", "\[CircleTimes]", "Y", "\[CircleTimes]", "X"}], "]"}]], "Input",\

 CellChangeTimes->{{3.612069740499817*^9, 3.612069748722945*^9}}],

Cell[BoxData[
 RowBox[{"Z", "\[CircleTimes]", "X", "\[CircleTimes]", "Y"}]], "Output",
 CellChangeTimes->{3.612069750825675*^9, 3.6121225272773943`*^9, 
  3.612152431336886*^9, 3.6122422287363787`*^9, 3.612244609519433*^9, 
  3.612245412600505*^9, 3.612246437496099*^9, 3.612246821916801*^9, 
  3.6122541921493998`*^9, 3.61225439196172*^9, 3.612256793815922*^9, 
  3.612331219113364*^9, 3.6123402800225153`*^9, 3.6123461346112003`*^9, 
  3.612670305810082*^9, 3.612683985130781*^9, 3.612686960505889*^9, 
  3.614818124646299*^9, 3.615268746805456*^9, 3.615269820517424*^9, 
  3.6152726236646643`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["mv[ ]  argument length settings", "Subsubsection",
 CellChangeTimes->{{3.6117004172917347`*^9, 3.611700487110237*^9}, {
   3.611700901848016*^9, 3.611701130920413*^9}, {3.611701234361413*^9, 
   3.611701302550877*^9}, {3.611701786139716*^9, 3.6117017862152348`*^9}, {
   3.61170200910107*^9, 3.6117020329203777`*^9}, 3.611996273648815*^9, {
   3.6119963087668657`*^9, 3.611996325229361*^9}, {3.612145566621338*^9, 
   3.61214560729216*^9}, 3.612145985391918*^9, {3.612237117025572*^9, 
   3.612237120640545*^9}, {3.61525272012504*^9, 3.615252742637183*^9}}],

Cell["\<\
These functions are defined here :       SetmvArgLengthVariable[ ],    \
SetmvArgLengthFixed[ ]\
\>", "Text",
 CellChangeTimes->{{3.612145664573555*^9, 3.6121458885735483`*^9}, {
  3.612237126771596*^9, 3.6122371310109463`*^9}, {3.612237242518929*^9, 
  3.612237292309105*^9}}],

Cell["\<\
To standardize the length of mv arguments according to tensor degree,\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.611643774046471*^9, 3.611644228205924*^9}, {
   3.6116481761128273`*^9, 3.611648236128635*^9}, {3.611648901843369*^9, 
   3.611649052371339*^9}, 3.611794111476083*^9, {3.6120049030031757`*^9, 
   3.61200492298695*^9}, {3.612005211537902*^9, 3.612005213420268*^9}, {
   3.612005343341991*^9, 3.6120053450205593`*^9}, {3.612092128915626*^9, 
   3.6120921674081287`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetmvArgLengthFixed", "[", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", "ArgLengthOfmvIsFixed"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ArgLengthOfmvIsFixed", "=", "True"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Off", "[", 
      StyleBox[
       RowBox[{"Unset", "::", "norep"}], "MessageName"], "]"}], ";", 
     RowBox[{
      RowBox[{
       RowBox[{"mv", "[", "n__Integer", "]"}], "/;", 
       RowBox[{
        RowBox[{"Last", "[", 
         RowBox[{"{", "n", "}"}], "]"}], "===", 
        RowBox[{"Length", "[", 
         RowBox[{"{", "n", "}"}], "]"}]}]}], "=."}], ";", 
     RowBox[{"On", "[", 
      StyleBox[
       RowBox[{"Unset", "::", "norep"}], "MessageName"], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mv", "[", "n__Integer", "]"}], "[", "X_", "]"}], "/;", 
       RowBox[{
        RowBox[{"deg", "[", "X", "]"}], ">", 
        RowBox[{"Length", "[", 
         RowBox[{"{", "n", "}"}], "]"}]}]}], ":=", 
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"mv", ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", "n", "}"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"{", "n", "}"}], "]"}], "+", "1"}], ",", 
             RowBox[{"deg", "[", "X", "]"}]}], "]"}]}], "]"}]}], "]"}], "[", 
       "X", "]"}]}], ";"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612124045209364*^9, 3.612124083952099*^9}, {
   3.612124119072166*^9, 3.6121242994128523`*^9}, {3.612124330432996*^9, 
   3.612124388042141*^9}, {3.612124618428233*^9, 3.612124655545576*^9}, 
   3.612124739965481*^9, {3.612124798730234*^9, 3.6121248272464733`*^9}, {
   3.612124863338595*^9, 3.6121248719698067`*^9}, {3.612236993851109*^9, 
   3.612237056738112*^9}, {3.612238732108362*^9, 3.612238744555647*^9}, {
   3.612241367332506*^9, 3.612241371516296*^9}, 3.6147350221703873`*^9, {
   3.614735691501989*^9, 3.61473569476338*^9}, 3.614813554821265*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetmvArgLengthVariable", "[", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{"ArgLengthOfmvIsFixed", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ArgLengthOfmvIsFixed", "=", "False"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Off", "[", 
      StyleBox[
       RowBox[{"Unset", "::", "norep"}], "MessageName"], "]"}], ";", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mv", "[", "n__Integer", "]"}], "[", "X_", "]"}], "/;", 
       RowBox[{
        RowBox[{"deg", "[", "X", "]"}], ">", 
        RowBox[{"Length", "[", 
         RowBox[{"{", "n", "}"}], "]"}]}]}], "=."}], ";", 
     RowBox[{"On", "[", 
      StyleBox[
       RowBox[{"Unset", "::", "norep"}], "MessageName"], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"mv", "[", "n__Integer", "]"}], "/;", 
       RowBox[{
        RowBox[{"Last", "[", 
         RowBox[{"{", "n", "}"}], "]"}], "===", 
        RowBox[{"Length", "[", 
         RowBox[{"{", "n", "}"}], "]"}]}]}], ":=", 
      RowBox[{"Apply", "[", 
       RowBox[{"mv", ",", 
        RowBox[{"Most", "[", 
         RowBox[{"{", "n", "}"}], "]"}]}], "]"}]}], ";"}]}], "]"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.612124394951366*^9, 3.6121244787518473`*^9}, {
   3.612124640246684*^9, 3.6121246568678303`*^9}, {3.6122368207288446`*^9, 
   3.612236978699874*^9}, {3.612238753298397*^9, 3.612238764182542*^9}, {
   3.6122413072649803`*^9, 3.612241349333185*^9}, 3.614735044755917*^9, {
   3.6147357002652817`*^9, 3.6147357031768017`*^9}, 3.614813543878957*^9}],

Cell["To get initial state correct,", "Text",
 CellChangeTimes->{{3.612206694606636*^9, 3.61220670718246*^9}, {
  3.612420183584168*^9, 3.612420189180562*^9}, {3.612420219382292*^9, 
  3.612420230599886*^9}, {3.614813866452547*^9, 3.614813874100168*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ArgLengthOfmvIsFixed", "=", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetmvArgLengthFixed", "[", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6121249263720093`*^9, 3.61212492728008*^9}, {
  3.61212495903541*^9, 3.612124960772883*^9}, {3.612125290759458*^9, 
  3.612125319700523*^9}, {3.612241430458221*^9, 3.612241431095922*^9}, {
  3.612255558056883*^9, 3.612255568757169*^9}}],

Cell["This defn is required by the   SetmvArgLength  functions,", "Text",
 CellChangeTimes->{{3.612206694606636*^9, 3.61220670718246*^9}, {
  3.612420183584168*^9, 3.612420189180562*^9}, {3.612420219382292*^9, 
  3.612420230599886*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "]"}], "=", "0"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6124202344317617`*^9, 3.6124202384609137`*^9}}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"K", ",", "W", ",", "X", ",", "Z"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{
    RowBox[{"{", "2", "}"}], ",", "X"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{
    RowBox[{"{", "3", "}"}], ",", "Z"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{
    RowBox[{"{", "5", "}"}], ",", "W"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6121254751048613`*^9, 3.612125483142069*^9}, {
  3.6122464957409983`*^9, 3.612246503264389*^9}, {3.61481363704836*^9, 
  3.6148136836763153`*^9}, {3.653815050184991*^9, 3.653815059208871*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"deg", "[", 
  RowBox[{"{", 
   RowBox[{"K", ",", "W", ",", "X", ",", "Z"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.6121254281497307`*^9, 3.6121254453969173`*^9}, {
  3.6121255357336407`*^9, 3.6121255361492367`*^9}, {3.612126121660577*^9, 
  3.612126163227968*^9}, {3.615270968971415*^9, 3.615270982071162*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"deg", "[", "K", "]"}], ",", "5", ",", "2", ",", "3"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6122556049476147`*^9, 3.6122556099601297`*^9}, 
   3.6122567942863007`*^9, 3.612331225712657*^9, 3.612340281557188*^9, 
   3.61234613512218*^9, 3.6126703061761703`*^9, 3.612683987123268*^9, 
   3.6126869611750727`*^9, 3.614813689462102*^9, 3.615270894543478*^9, {
   3.615270961862727*^9, 3.615270983628908*^9}, 3.61527292701267*^9, 
   3.6538151424030247`*^9}]
}, Open  ]],

Cell["\<\
Here the argument length of  mv[ ]  is increased (if necessary) to be the \
degree of the tensor,  or left as is if there is no arg,\
\>", "Text",
 CellChangeTimes->{{3.6121261833155537`*^9, 3.612126245619299*^9}, {
  3.614813953909141*^9, 3.614814019397838*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetmvArgLengthFixed", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "[", "K", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "[", "Z", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "[", "W", "]"}], "\[IndentingNewLine]", 
 RowBox[{"mv", "[", 
  RowBox[{"2", ",", "1", ",", "3", ",", "4", ",", "5", ",", "6"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.612094267410261*^9, 3.612094268798141*^9}, {
  3.612125452792441*^9, 3.612125465606285*^9}, {3.612125503198989*^9, 
  3.6121255267834187`*^9}, {3.612125583998639*^9, 3.612125585460279*^9}, {
  3.614814029549218*^9, 3.614814039773263*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "[", "K", "]"}]], "Output",
 CellChangeTimes->{
  3.612094270016015*^9, 3.612094420744076*^9, 3.612125404347932*^9, {
   3.612125456541362*^9, 3.6121254661292973`*^9}, 3.612125528289734*^9, 
   3.612125606529731*^9, {3.612126059001622*^9, 3.612126062963159*^9}, 
   3.612152434814815*^9, 3.612242229660973*^9, 3.612244610248857*^9, 
   3.612245414437502*^9, 3.612246470306822*^9, 3.612246823158105*^9, {
   3.6122554886115837`*^9, 3.612255510647449*^9}, 3.6122556123532*^9, 
   3.6122567943246803`*^9, 3.6123312257175713`*^9, 3.6123402815943193`*^9, 
   3.61234613516521*^9, 3.612670306181538*^9, 3.612683987156787*^9, 
   3.6126869611804323`*^9, 3.612756917361786*^9, 3.6148137053971*^9, 
   3.614813771334234*^9, 3.6148138490926523`*^9, 3.614814041367495*^9, 
   3.615270894691905*^9, 3.615272927135374*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}]], "Output",
 CellChangeTimes->{
  3.612094270016015*^9, 3.612094420744076*^9, 3.612125404347932*^9, {
   3.612125456541362*^9, 3.6121254661292973`*^9}, 3.612125528289734*^9, 
   3.612125606529731*^9, {3.612126059001622*^9, 3.612126062963159*^9}, 
   3.612152434814815*^9, 3.612242229660973*^9, 3.612244610248857*^9, 
   3.612245414437502*^9, 3.612246470306822*^9, 3.612246823158105*^9, {
   3.6122554886115837`*^9, 3.612255510647449*^9}, 3.6122556123532*^9, 
   3.6122567943246803`*^9, 3.6123312257175713`*^9, 3.6123402815943193`*^9, 
   3.61234613516521*^9, 3.612670306181538*^9, 3.612683987156787*^9, 
   3.6126869611804323`*^9, 3.612756917361786*^9, 3.6148137053971*^9, 
   3.614813771334234*^9, 3.6148138490926523`*^9, 3.614814041367495*^9, 
   3.615270894691905*^9, 3.61527292713938*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1", ",", "3"}], "]"}], "[", "Z", "]"}]], "Output",
 CellChangeTimes->{
  3.612094270016015*^9, 3.612094420744076*^9, 3.612125404347932*^9, {
   3.612125456541362*^9, 3.6121254661292973`*^9}, 3.612125528289734*^9, 
   3.612125606529731*^9, {3.612126059001622*^9, 3.612126062963159*^9}, 
   3.612152434814815*^9, 3.612242229660973*^9, 3.612244610248857*^9, 
   3.612245414437502*^9, 3.612246470306822*^9, 3.612246823158105*^9, {
   3.6122554886115837`*^9, 3.612255510647449*^9}, 3.6122556123532*^9, 
   3.6122567943246803`*^9, 3.6123312257175713`*^9, 3.6123402815943193`*^9, 
   3.61234613516521*^9, 3.612670306181538*^9, 3.612683987156787*^9, 
   3.6126869611804323`*^9, 3.612756917361786*^9, 3.6148137053971*^9, 
   3.614813771334234*^9, 3.6148138490926523`*^9, 3.614814041367495*^9, 
   3.615270894691905*^9, 3.615272927142598*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1", ",", "3", ",", "4", ",", "5"}], "]"}], "[", "W", 
  "]"}]], "Output",
 CellChangeTimes->{
  3.612094270016015*^9, 3.612094420744076*^9, 3.612125404347932*^9, {
   3.612125456541362*^9, 3.6121254661292973`*^9}, 3.612125528289734*^9, 
   3.612125606529731*^9, {3.612126059001622*^9, 3.612126062963159*^9}, 
   3.612152434814815*^9, 3.612242229660973*^9, 3.612244610248857*^9, 
   3.612245414437502*^9, 3.612246470306822*^9, 3.612246823158105*^9, {
   3.6122554886115837`*^9, 3.612255510647449*^9}, 3.6122556123532*^9, 
   3.6122567943246803`*^9, 3.6123312257175713`*^9, 3.6123402815943193`*^9, 
   3.61234613516521*^9, 3.612670306181538*^9, 3.612683987156787*^9, 
   3.6126869611804323`*^9, 3.612756917361786*^9, 3.6148137053971*^9, 
   3.614813771334234*^9, 3.6148138490926523`*^9, 3.614814041367495*^9, 
   3.615270894691905*^9, 3.615272927145761*^9}],

Cell[BoxData[
 RowBox[{"mv", "[", 
  RowBox[{"2", ",", "1", ",", "3", ",", "4", ",", "5", ",", "6"}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.612094270016015*^9, 3.612094420744076*^9, 3.612125404347932*^9, {
   3.612125456541362*^9, 3.6121254661292973`*^9}, 3.612125528289734*^9, 
   3.612125606529731*^9, {3.612126059001622*^9, 3.612126062963159*^9}, 
   3.612152434814815*^9, 3.612242229660973*^9, 3.612244610248857*^9, 
   3.612245414437502*^9, 3.612246470306822*^9, 3.612246823158105*^9, {
   3.6122554886115837`*^9, 3.612255510647449*^9}, 3.6122556123532*^9, 
   3.6122567943246803`*^9, 3.6123312257175713`*^9, 3.6123402815943193`*^9, 
   3.61234613516521*^9, 3.612670306181538*^9, 3.612683987156787*^9, 
   3.6126869611804323`*^9, 3.612756917361786*^9, 3.6148137053971*^9, 
   3.614813771334234*^9, 3.6148138490926523`*^9, 3.614814041367495*^9, 
   3.615270894691905*^9, 3.615272927148869*^9}]
}, Open  ]],

Cell["\<\
Here the argument length of  mv[ ]  is the shortest possible permutation \
list,  whether it has a tensor argument or not,\
\>", "Text",
 CellChangeTimes->{{3.6121261833155537`*^9, 3.612126290771291*^9}, 
   3.614813975157196*^9, {3.6148140525653753`*^9, 3.61481407374892*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetmvArgLengthVariable", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "[", "K", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "[", "Z", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1", ",", "3"}], "]"}], "[", "Z", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1", ",", "3", ",", "4"}], "]"}], "[", "W", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1", ",", "3", ",", "4", ",", "5"}], "]"}], "[", "W", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1", ",", "4", ",", "3", ",", "5"}], "]"}], "[", "W", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "5", ",", "4", ",", "3", ",", "1"}], "]"}], "[", "W", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"mv", "[", 
  RowBox[{"2", ",", "1", ",", "3", ",", "4", ",", "5", ",", "6"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.612094267410261*^9, 3.612094268798141*^9}, {
  3.612125452792441*^9, 3.612125465606285*^9}, {3.612125503198989*^9, 
  3.6121255267834187`*^9}, {3.612125583998639*^9, 3.612125585460279*^9}, {
  3.612125616401166*^9, 3.612125618672076*^9}, {3.612125659695484*^9, 
  3.612125705398435*^9}, {3.612125738272077*^9, 3.612125762888506*^9}, {
  3.61481408671551*^9, 3.614814089485118*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "[", "K", "]"}]], "Output",
 CellChangeTimes->{
  3.612125621297934*^9, 3.612125676066132*^9, 3.612125709090148*^9, 
   3.612125765122428*^9, {3.612126061479724*^9, 3.61212606429585*^9}, 
   3.6121524348257647`*^9, 3.612242229926365*^9, 3.612244610259233*^9, 
   3.612245414497415*^9, 3.6122464703171577`*^9, 3.612246823171425*^9, 
   3.6122554951915483`*^9, 3.612255614499954*^9, 3.612256794333296*^9, 
   3.6123312257259817`*^9, 3.612340281603951*^9, 3.612346135212603*^9, 
   3.612670306219431*^9, 3.612683987169922*^9, 3.6126869611915007`*^9, 
   3.614814092569427*^9, 3.615270894853924*^9, 3.615272927303377*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "[", "Z", "]"}]], "Output",
 CellChangeTimes->{
  3.612125621297934*^9, 3.612125676066132*^9, 3.612125709090148*^9, 
   3.612125765122428*^9, {3.612126061479724*^9, 3.61212606429585*^9}, 
   3.6121524348257647`*^9, 3.612242229926365*^9, 3.612244610259233*^9, 
   3.612245414497415*^9, 3.6122464703171577`*^9, 3.612246823171425*^9, 
   3.6122554951915483`*^9, 3.612255614499954*^9, 3.612256794333296*^9, 
   3.6123312257259817`*^9, 3.612340281603951*^9, 3.612346135212603*^9, 
   3.612670306219431*^9, 3.612683987169922*^9, 3.6126869611915007`*^9, 
   3.614814092569427*^9, 3.615270894853924*^9, 3.615272927306315*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "[", "Z", "]"}]], "Output",
 CellChangeTimes->{
  3.612125621297934*^9, 3.612125676066132*^9, 3.612125709090148*^9, 
   3.612125765122428*^9, {3.612126061479724*^9, 3.61212606429585*^9}, 
   3.6121524348257647`*^9, 3.612242229926365*^9, 3.612244610259233*^9, 
   3.612245414497415*^9, 3.6122464703171577`*^9, 3.612246823171425*^9, 
   3.6122554951915483`*^9, 3.612255614499954*^9, 3.612256794333296*^9, 
   3.6123312257259817`*^9, 3.612340281603951*^9, 3.612346135212603*^9, 
   3.612670306219431*^9, 3.612683987169922*^9, 3.6126869611915007`*^9, 
   3.614814092569427*^9, 3.615270894853924*^9, 3.6152729273104753`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "[", "W", "]"}]], "Output",
 CellChangeTimes->{
  3.612125621297934*^9, 3.612125676066132*^9, 3.612125709090148*^9, 
   3.612125765122428*^9, {3.612126061479724*^9, 3.61212606429585*^9}, 
   3.6121524348257647`*^9, 3.612242229926365*^9, 3.612244610259233*^9, 
   3.612245414497415*^9, 3.6122464703171577`*^9, 3.612246823171425*^9, 
   3.6122554951915483`*^9, 3.612255614499954*^9, 3.612256794333296*^9, 
   3.6123312257259817`*^9, 3.612340281603951*^9, 3.612346135212603*^9, 
   3.612670306219431*^9, 3.612683987169922*^9, 3.6126869611915007`*^9, 
   3.614814092569427*^9, 3.615270894853924*^9, 3.615272927314006*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1"}], "]"}], "[", "W", "]"}]], "Output",
 CellChangeTimes->{
  3.612125621297934*^9, 3.612125676066132*^9, 3.612125709090148*^9, 
   3.612125765122428*^9, {3.612126061479724*^9, 3.61212606429585*^9}, 
   3.6121524348257647`*^9, 3.612242229926365*^9, 3.612244610259233*^9, 
   3.612245414497415*^9, 3.6122464703171577`*^9, 3.612246823171425*^9, 
   3.6122554951915483`*^9, 3.612255614499954*^9, 3.612256794333296*^9, 
   3.6123312257259817`*^9, 3.612340281603951*^9, 3.612346135212603*^9, 
   3.612670306219431*^9, 3.612683987169922*^9, 3.6126869611915007`*^9, 
   3.614814092569427*^9, 3.615270894853924*^9, 3.615272927317481*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1", ",", "4", ",", "3"}], "]"}], "[", "W", 
  "]"}]], "Output",
 CellChangeTimes->{
  3.612125621297934*^9, 3.612125676066132*^9, 3.612125709090148*^9, 
   3.612125765122428*^9, {3.612126061479724*^9, 3.61212606429585*^9}, 
   3.6121524348257647`*^9, 3.612242229926365*^9, 3.612244610259233*^9, 
   3.612245414497415*^9, 3.6122464703171577`*^9, 3.612246823171425*^9, 
   3.6122554951915483`*^9, 3.612255614499954*^9, 3.612256794333296*^9, 
   3.6123312257259817`*^9, 3.612340281603951*^9, 3.612346135212603*^9, 
   3.612670306219431*^9, 3.612683987169922*^9, 3.6126869611915007`*^9, 
   3.614814092569427*^9, 3.615270894853924*^9, 3.615272927320972*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "5", ",", "4", ",", "3", ",", "1"}], "]"}], "[", "W", 
  "]"}]], "Output",
 CellChangeTimes->{
  3.612125621297934*^9, 3.612125676066132*^9, 3.612125709090148*^9, 
   3.612125765122428*^9, {3.612126061479724*^9, 3.61212606429585*^9}, 
   3.6121524348257647`*^9, 3.612242229926365*^9, 3.612244610259233*^9, 
   3.612245414497415*^9, 3.6122464703171577`*^9, 3.612246823171425*^9, 
   3.6122554951915483`*^9, 3.612255614499954*^9, 3.612256794333296*^9, 
   3.6123312257259817`*^9, 3.612340281603951*^9, 3.612346135212603*^9, 
   3.612670306219431*^9, 3.612683987169922*^9, 3.6126869611915007`*^9, 
   3.614814092569427*^9, 3.615270894853924*^9, 3.615272927324375*^9}],

Cell[BoxData[
 RowBox[{"mv", "[", 
  RowBox[{"2", ",", "1"}], "]"}]], "Output",
 CellChangeTimes->{
  3.612125621297934*^9, 3.612125676066132*^9, 3.612125709090148*^9, 
   3.612125765122428*^9, {3.612126061479724*^9, 3.61212606429585*^9}, 
   3.6121524348257647`*^9, 3.612242229926365*^9, 3.612244610259233*^9, 
   3.612245414497415*^9, 3.6122464703171577`*^9, 3.612246823171425*^9, 
   3.6122554951915483`*^9, 3.612255614499954*^9, 3.612256794333296*^9, 
   3.6123312257259817`*^9, 3.612340281603951*^9, 3.612346135212603*^9, 
   3.612670306219431*^9, 3.612683987169922*^9, 3.6126869611915007`*^9, 
   3.614814092569427*^9, 3.615270894853924*^9, 3.615272927327907*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1", ",", "3", ",", "4", ",", "5", ",", "6"}], "]"}], 
  "[", 
  RowBox[{"mv", "[", 
   RowBox[{"3", ",", "1", ",", "2", ",", "4"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.614814138283512*^9, 3.614814151037489*^9}}],

Cell[BoxData[
 RowBox[{"mv", "[", 
  RowBox[{"1", ",", "3", ",", "2"}], "]"}]], "Output",
 CellChangeTimes->{3.614814152194046*^9, 3.615270895005365*^9, 
  3.6152729274857492`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetmvArgLengthFixed", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1", ",", "3", ",", "4", ",", "5", ",", "6"}], "]"}], 
  "[", 
  RowBox[{"mv", "[", 
   RowBox[{"3", ",", "1", ",", "2", ",", "4"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.614814197049171*^9, 3.614814207540135*^9}}],

Cell[BoxData[
 RowBox[{"mv", "[", 
  RowBox[{"1", ",", "3", ",", "2", ",", "4", ",", "5", ",", "6"}], 
  "]"}]], "Output",
 CellChangeTimes->{3.614814211334278*^9, 3.6152708950175247`*^9, 
  3.6152729276292067`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"K", ",", "W", ",", "X", ",", "Z"}], "}"}], "]"}]], "Input"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Tensor slot rearrangement :    mvToLast[ ]                          \
\>", "Subsection",
 CellChangeTimes->{{3.6117004172917347`*^9, 3.611700487110237*^9}, {
   3.611794160708014*^9, 3.6117941632039413`*^9}, {3.611801723060134*^9, 
   3.611801724660182*^9}, {3.611803255881888*^9, 3.611803257769734*^9}, 
   3.611808086541277*^9, {3.612203398599391*^9, 3.6122034089317417`*^9}, {
   3.6147368827938766`*^9, 3.6147369178980637`*^9}, {3.614812643311215*^9, 
   3.6148126845745497`*^9}, {3.614812846450317*^9, 3.614812856399665*^9}, 
   3.614827869186965*^9, {3.6148309305785093`*^9, 3.614830953890073*^9}, {
   3.6152522877974377`*^9, 3.615252289676409*^9}, {3.615254438802102*^9, 
   3.615254439313552*^9}, {3.65386537521583*^9, 3.653865381567697*^9}}],

Cell["\<\
mvToLast[ n, X ]    is a special case of   mv[ ],   but has useful relations \
defined for when   n  and/or  deg[X]  are symbolic (not known integers).
mvToLast[ ]   is used later to define  \[Del]   on tensor products.\
\>", "Text",
 CellChangeTimes->{{3.6538653938235188`*^9, 3.653865666108292*^9}, {
  3.653865700091887*^9, 3.6538657457874603`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"mvToLast", "[", 
    RowBox[{"_", ",", "X_"}], "]"}], "]"}], ":=", 
  RowBox[{"deg", "[", "X", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.653865784172311*^9, 3.65386587706743*^9}, {
  3.653873609812805*^9, 3.653873612739594*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mvToLast", "[", 
    RowBox[{"_", ",", "0"}], "]"}], ":=", "0"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655673065747283*^9, 3.655673079507189*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"mvToLast", "[", 
     RowBox[{"n_", ",", "X_"}], "]"}], "/;", 
    RowBox[{"n", "===", 
     RowBox[{"deg", "[", "X", "]"}]}]}], ":=", "X"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.653872950760459*^9, 3.653872958728838*^9}, {
  3.6538730505212193`*^9, 3.653873105560512*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "58", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"mvToLast", "[", 
     RowBox[{"n_Integer", ",", "X_"}], "]"}], "/;", 
    RowBox[{"TrueQ", "[", 
     RowBox[{"n", "<", 
      RowBox[{"deg", "[", "X", "]"}]}], "]"}]}], ":=", 
   RowBox[{
    RowBox[{"mv", "[", 
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"deg", "[", "X", "]"}], "]"}], ",", "n"}], "]"}], ",", 
       "n"}], "]"}], "]"}], "[", "X", "]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612553716176992*^9, 3.612553757186768*^9}, {
   3.612865193844915*^9, 3.612865206054541*^9}, {3.651599718375338*^9, 
   3.651599724731124*^9}, 3.653862845068748*^9, {3.653865020072958*^9, 
   3.653865021817904*^9}, {3.653865092792677*^9, 3.6538651059927893`*^9}, {
   3.6538733656081657`*^9, 3.653873366327895*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "59", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"mvToLast", "[", 
       RowBox[{"n_", ",", 
        RowBox[{"X__", "\[CircleTimes]", "Y__"}]}], "]"}], ",", 
      RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{"n", "===", 
     RowBox[{"deg", "[", "X", "]"}]}]}], ":=", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X", ",", "v"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
    "Y"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.653867894038712*^9, 3.653867982612443*^9}, {
  3.653868017476037*^9, 3.6538680938112803`*^9}, {3.65386812568253*^9, 
  3.653868131794705*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "60", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{
        RowBox[{"mvToLast", "[", 
         RowBox[{"n_", ",", "X_"}], "]"}], "/;", 
        RowBox[{"n", "===", 
         RowBox[{
          RowBox[{"deg", "[", "X", "]"}], "-", "1"}]}]}], ",", 
       RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", 
     RowBox[{"u_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X", ",", "u"}], "\[RightAngleBracket]"}], ",", "v"}], 
    "\[RightAngleBracket]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.653867894038712*^9, 3.653867982612443*^9}, {
  3.653868017476037*^9, 3.6538680938112803`*^9}, {3.65386812568253*^9, 
  3.653868131794705*^9}, {3.6538722164673634`*^9, 3.6538722369942007`*^9}, {
  3.65387231636904*^9, 3.653872364848598*^9}, {3.653872417999846*^9, 
  3.653872488689476*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "61", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Definition", "[", "mvToLast", "]"}]], "Input",
 CellChangeTimes->{{3.6538732953478813`*^9, 3.6538733035253067`*^9}}],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {GridBox[{
       {
        RowBox[{
         RowBox[{
          RowBox[{"mvToLast", "[", 
           RowBox[{"n_Integer", ",", "X_"}], "]"}], "/;", 
          RowBox[{"TrueQ", "[", 
           RowBox[{"n", "<", 
            RowBox[{"deg", "[", "X", "]"}]}], "]"}]}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "58", "]"}], ";", 
           RowBox[{"Snoopr", "[", 
            RowBox[{
             RowBox[{"mv", "[", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"Range", "[", 
                   RowBox[{"deg", "[", "X", "]"}], "]"}], ",", "n"}], "]"}], 
                ",", "n"}], "]"}], "]"}], "[", "X", "]"}], "]"}]}], ")"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{
          RowBox[{"mvToLast", "[", 
           RowBox[{"n_", ",", "X_"}], "]"}], "/;", 
          RowBox[{"n", "===", 
           RowBox[{"deg", "[", "X", "]"}]}]}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "322", "]"}], ";", 
           RowBox[{"Snoopr", "[", "X", "]"}]}], ")"}]}]}
      },
      BaselinePosition->{Baseline, {1, 1}},
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{"Columns" -> {{
           Scaled[0.999]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  Definition[$CellContext`mvToLast],
  Editable->False]], "Output",
 CellChangeTimes->{3.6538733041356087`*^9, 3.653873383354624*^9, 
  3.65387341699786*^9, 3.6538771107012577`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Tensor slot rearrangement :    sym[n][X]  and  alt[n][X]                      \
                 --- just a few AddRules done\
\>", "Subsection",
 CellChangeTimes->{{3.6117004172917347`*^9, 3.611700487110237*^9}, {
   3.611700901848016*^9, 3.611701130920413*^9}, {3.611701234361413*^9, 
   3.611701302550877*^9}, {3.611701786139716*^9, 3.6117017862152348`*^9}, {
   3.61170200910107*^9, 3.6117020329203777`*^9}, 3.611996273648815*^9, {
   3.6119963087668657`*^9, 3.611996325229361*^9}, {3.612145566621338*^9, 
   3.61214560729216*^9}, 3.612145985391918*^9, {3.6125024271766453`*^9, 
   3.6125024747607937`*^9}, {3.6139838609620037`*^9, 3.613983882038159*^9}, {
   3.6152529697758627`*^9, 3.615252979551024*^9}, 3.6152540876972218`*^9, {
   3.615254442081972*^9, 3.615254443105836*^9}, {3.615255003667095*^9, 
   3.615255004610417*^9}, 3.649540182706629*^9}],

Cell[TextData[{
 "Here we define the operators  and functions  sym  and  alt .   Eg.,  the  \
mv[ ]  operator    sym[ ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["n", "1"], ",", " ", 
    SubscriptBox["n", "2"], ",", " ", "...", " "}], TraditionalForm]]],
 "]    acts on tensors as    sym[ ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["n", "1"], ",", " ", 
    SubscriptBox["n", "2"], ",", " ", "...", " "}], TraditionalForm]]],
 "][ X ] . "
}], "Text",
 CellChangeTimes->{{3.612145664573555*^9, 3.6121458885735483`*^9}, {
  3.61223714235993*^9, 3.612237145943165*^9}, {3.612502503419251*^9, 
  3.612502546329213*^9}, {3.615253085229924*^9, 3.615253171406457*^9}, {
  3.615253357711211*^9, 3.615253393375288*^9}}],

Cell[CellGroupData[{

Cell["sym[ ]  and  alt[ ]  are linear", "Subsubsection",
 CellChangeTimes->{{3.613268196962401*^9, 3.613268233426104*^9}, {
  3.615253275230503*^9, 3.615253325070671*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sym", "[", "]"}], "[", "1", "]"}]], "Input"],

Cell[BoxData[
 TemplateBox[{
  "$IterationLimit","itlim",
   "\"Iteration limit of \\!\\(\\*RowBox[{\\\"4096\\\"}]\\) exceeded.\"",2,
   1437,3,28423728802571271916,"Local"},
  "MessageTemplate"]], "Message", "MSG"],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{
   RowBox[{"sym", "[", 
    RowBox[{"Range", "[", 
     RowBox[{"deg", "[", "1", "]"}], "]"}], "]"}], "[", "1", "]"}], 
  "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"deg", "[", "1", "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Range", "[", "0", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Sym", "[", "]"}], "[", "1", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sym", "[", "]"}], "[", "1", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Sym", "[", 
   RowBox[{"{", "}"}], "]"}], "[", "X", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sym", "[", "]"}], "[", "X", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"sym", "[", "n___", "]"}], "[", "X_Plus", "]"}], ":=", " ", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{"sym", "[", "n", "]"}], ",", "X"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"sym", "[", "n___", "]"}], "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a_", "?", "deg0Q"}], ")"}], "X_"}], "]"}], ":=", 
   RowBox[{"a", " ", 
    RowBox[{
     RowBox[{"sym", "[", "n", "]"}], "[", "X", "]"}]}]}], "]"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"rule", "[", "62", "]"}]], "Output"],

Cell[BoxData[
 RowBox[{"rule", "[", "63", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"alt", "[", "n___", "]"}], "[", "X_Plus", "]"}], ":=", " ", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{"alt", "[", "n", "]"}], ",", "X"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"alt", "[", "n___", "]"}], "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a_", "?", "deg0Q"}], ")"}], "X_"}], "]"}], ":=", 
   RowBox[{"a", " ", 
    RowBox[{
     RowBox[{"alt", "[", "n", "]"}], "[", "X", "]"}]}]}], "]"}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"rule", "[", "64", "]"}]], "Output"],

Cell[BoxData[
 RowBox[{"rule", "[", "65", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"sym", "[", "]"}], "[", "0", "]"}], ":=", "0"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"alt", "[", "]"}], "[", "0", "]"}], ":=", "0"}], "]"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.61326859299074*^9, 3.613268594219956*^9}, {
  3.6139837893168783`*^9, 3.613983800556134*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "66", "]"}]], "Output"],

Cell[BoxData[
 RowBox[{"rule", "[", "67", "]"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Code for  sym", "Subsubsection",
 CellChangeTimes->{{3.612254626207354*^9, 3.6122546475033092`*^9}, {
   3.612256033557694*^9, 3.612256038197482*^9}, {3.612256141062128*^9, 
   3.6122561497340603`*^9}, {3.6122567278965693`*^9, 
   3.6122567405522413`*^9}, {3.612342271391286*^9, 3.6123423012143583`*^9}, {
   3.612342378958661*^9, 3.612342395806444*^9}, 3.6123890548953238`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"symMessage", "[", "n_", "]"}], ":=", 
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<The argument in sym[\>\"", " ", ",", " ", "n", ",", " ", 
    "\"\<] must be a sequence or list of distinct elements.\>\""}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.61164541061478*^9, 3.6116454649677963`*^9}, {
   3.611702322001289*^9, 3.6117023347208776`*^9}, {3.611702380977538*^9, 
   3.6117024211691837`*^9}, 3.61179411147462*^9, {3.6120036341355247`*^9, 
   3.612003657751189*^9}, {3.612003697926818*^9, 3.612003710551805*^9}, {
   3.6121225881722507`*^9, 3.6121226378504133`*^9}, {3.6121525412288427`*^9, 
   3.612152576825548*^9}, {3.612342317805523*^9, 3.612342321932488*^9}, {
   3.6123424170853043`*^9, 3.6123424175650263`*^9}}],

Cell["\<\
If given a list of  slot positions, convert this to a sequence,\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.611643774046471*^9, 3.611644228205924*^9}, {
   3.6116481761128273`*^9, 3.611648236128635*^9}, {3.611648901843369*^9, 
   3.611649052371339*^9}, 3.611794111476083*^9, {3.6120049030031757`*^9, 
   3.61200492298695*^9}, {3.612005098123748*^9, 3.612005129179603*^9}, 
   3.612089371257184*^9, {3.6121230783147507`*^9, 3.612123184554723*^9}, {
   3.612123429739736*^9, 3.6121234343475246`*^9}, {3.612241127939206*^9, 
   3.612241152034795*^9}, {3.612341962396907*^9, 3.612341974189087*^9}, 
   3.612391375783965*^9, {3.61239141234319*^9, 3.612391441808988*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"sym", "[", "n_List", "]"}], ":=", " ", 
  RowBox[{"sym", "[", 
   RowBox[{"Apply", "[", 
    RowBox[{"Sequence", ",", "n"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True],

Cell["No indices in  sym[ ][X]  implies full symmetrization.", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell["\<\
The  IntegerQ[ ]  is not quite redundant. I suppose someone could define   \
deg[X] > 0  = True   for X to be an arbitrary degree non-scalar field.
The   deg[X]>0   prevents the loop    sym[ ][ X ] := sym[ ][ X ] ,\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"sym", "[", "]"}], "[", 
   RowBox[{"X_", "/;", 
    RowBox[{
     RowBox[{"IntegerQ", "[", 
      RowBox[{"deg", "[", "X", "]"}], "]"}], "&&", 
     RowBox[{
      RowBox[{"deg", "[", "X", "]"}], ">", "0"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"sym", "[", 
    RowBox[{"Range", "[", 
     RowBox[{"deg", "[", "X", "]"}], "]"}], "]"}], "[", "X", "]"}]}]], "Input",\

 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"sym", "[", "]"}], "[", 
   RowBox[{"X_", "?", "deg0Q"}], "]"}], ":=", "X"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"sym", "[", "n___", "]"}], "[", 
   RowBox[{"sym", "[", "]"}], "]"}], ":=", 
  RowBox[{"sym", "[", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612123510447919*^9, 3.612123534867532*^9}, {
   3.612123597171157*^9, 3.6121236187235613`*^9}, 3.612206587119681*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"sym", "[", "]"}], "[", 
   RowBox[{"sym", "[", "n___", "]"}], "]"}], ":=", 
  RowBox[{"sym", "[", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6121236071736603`*^9, 3.612123627027186*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 ".... there are similar identities for    sym[ ",
 Cell[BoxData[
  FormBox["n1__", TraditionalForm]]],
 " ][ sym[ ",
 Cell[BoxData[
  FormBox["n2__", TraditionalForm]]],
 " ] ]   but they make good code checks and simplify anyway."
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.611643774046471*^9, 3.611644228205924*^9}, {
   3.6116481761128273`*^9, 3.611648236128635*^9}, {3.611648901843369*^9, 
   3.611649052371339*^9}, 3.611794111476083*^9, {3.6120049030031757`*^9, 
   3.61200492298695*^9}, {3.612005098123748*^9, 3.612005129179603*^9}, 
   3.612089371257184*^9, {3.6121230783147507`*^9, 3.612123184554723*^9}, {
   3.612123429739736*^9, 3.6121234343475246`*^9}, {3.612123657132228*^9, 
   3.612123747581171*^9}, {3.612153253728426*^9, 3.612153292990429*^9}}],

Cell["\<\
Symmetrization on 1 position is the identity.  This is also used as a \
termination condition in the code for  sym,\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.611643774046471*^9, 3.611644228205924*^9}, {
   3.6116481761128273`*^9, 3.611648236128635*^9}, {3.611648901843369*^9, 
   3.611649052371339*^9}, 3.611794111476083*^9, {3.6120049030031757`*^9, 
   3.61200492298695*^9}, {3.612005098123748*^9, 3.612005129179603*^9}, 
   3.612089371257184*^9, {3.6121230783147507`*^9, 3.612123184554723*^9}, {
   3.612123429739736*^9, 3.6121234343475246`*^9}, {3.612123657132228*^9, 
   3.612123747581171*^9}, {3.6121258861628513`*^9, 3.612125939490291*^9}, {
   3.612125982851152*^9, 3.612125984850347*^9}, {3.612254769328536*^9, 
   3.612254780079812*^9}, {3.612338952433999*^9, 3.6123389816966352`*^9}, {
   3.6123414253396072`*^9, 3.6123414519307404`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"sym", "[", "n_Integer", "]"}], ":=", 
  RowBox[{"mv", "[", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612340989101975*^9, 3.612340991170993*^9}}],

Cell["New reln for values of deg,", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.611643774046471*^9, 3.611644228205924*^9}, {
   3.6116481761128273`*^9, 3.611648236128635*^9}, {3.611648901843369*^9, 
   3.611649052371339*^9}, 3.611794111476083*^9, {3.6120049030031757`*^9, 
   3.61200492298695*^9}, {3.612005098123748*^9, 3.612005129179603*^9}, 
   3.612089371257184*^9, {3.6121230783147507`*^9, 3.612123184554723*^9}, {
   3.612123915293274*^9, 3.6121239245085573`*^9}, {3.612145517932703*^9, 
   3.6121455238197107`*^9}, {3.6122266661871977`*^9, 3.612226670986987*^9}, {
   3.612345718908334*^9, 3.6123457235800953`*^9}, 3.612397150802286*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{
    RowBox[{"sym", "[", "___", "]"}], "[", "X_", "]"}], "]"}], ":=", 
  RowBox[{"deg", "[", "X", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612089413939939*^9, 3.612089448637619*^9}, {
  3.612728446816194*^9, 3.612728448526639*^9}}],

Cell[CellGroupData[{

Cell["\<\
To symmetrize on  n  positions, we symmetrize over  n different \
symmetrizations,  generated by cycling through the  n positions and \
symmetrizing on the last n-1 of them.

If  no tensor argument  X  is given,  sym[n__][ ]   returns the corresponding \
mv operator.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"sym", "[", "n__Integer", "]"}], "[", "X___", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"u", ",", "m", ",", "c", ",", "s", ",", "i", ",", "j"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "X", "}"}], "]"}], ">", "1"}], ",", 
       RowBox[{
       "Print", "[", 
        "\"\<If an argument appears within the 2nd pair of square brackets of \
sym[][], then it should be a single tensor. See: ? sym\>\"", "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"s", " ", "=", " ", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "n", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Union", "[", 
           RowBox[{"{", "n", "}"}], "]"}], "]"}], "===", "s"}]}], ",", 
       RowBox[{
        RowBox[{"symMessage", "[", 
         RowBox[{"{", "n", "}"}], "]"}], ";", " ", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", "0", "]"}], "=", 
      RowBox[{"mv", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", "1", "]"}], "=", 
      RowBox[{"mvCyclic", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"c", "[", "i", "]"}], "=", 
        RowBox[{
         RowBox[{"c", "[", "1", "]"}], "[", 
         RowBox[{"c", "[", 
          RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"s", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m", " ", "=", " ", 
      RowBox[{"Rest", "[", 
       RowBox[{"{", "n", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Expand", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"sym", "[", "m", "]"}], "[", 
           RowBox[{
            RowBox[{"c", "[", "j", "]"}], "[", "X", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", 
            RowBox[{"s", "-", "1"}]}], "}"}]}], "]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"s", "-", "1"}], ")"}], "!"}]}], "]"}], "/", 
      RowBox[{"s", "!"}]}]}]}], "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Open  ]],

Cell["\<\
This makes a  mv  operator corresponding to cycling the slots  m, \
\>", "Text",
 CellChangeTimes->{{3.614817384599962*^9, 3.61481746728936*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mvCyclic", "[", 
   RowBox[{"m__", "?", "IntegerQ"}], "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"mv", ",", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"Max", "[", "m", "]"}], "]"}], ",", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "m", "}"}], ",", 
          RowBox[{"RotateLeft", "[", 
           RowBox[{"{", "m", "}"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614814610524431*^9, 3.6148146120265913`*^9}, {
  3.614814657420063*^9, 3.6148146643168087`*^9}, {3.614814864412445*^9, 
  3.614814991572744*^9}, {3.6148150576988993`*^9, 3.6148150710751038`*^9}, {
  3.614815272034137*^9, 3.6148152753625526`*^9}, {3.61481531275697*^9, 
  3.6148153471565332`*^9}, {3.614815380404146*^9, 3.614815399219635*^9}, {
  3.61481551360677*^9, 3.614815533925908*^9}, {3.614817051055567*^9, 
  3.61481709494096*^9}, {3.6148175268649883`*^9, 3.614817538818611*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"mvCyclic", "[", 
  RowBox[{"1", ",", "2", ",", "3"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"mvCyclic", "[", 
  RowBox[{"2", ",", "4", ",", "6"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6148153631187553`*^9, 3.61481536821072*^9}, {
  3.614817302158086*^9, 3.614817303646093*^9}, {3.61481747559864*^9, 
  3.614817478253536*^9}, {3.614817671205102*^9, 3.614817672479298*^9}}],

Cell[BoxData[
 RowBox[{"mv", "[", 
  RowBox[{"2", ",", "3", ",", "1"}], "]"}]], "Output",
 CellChangeTimes->{3.614815372799*^9, 3.614815403132319*^9, 
  3.614817101550596*^9, 3.6148173053367233`*^9, 3.614817479704425*^9, 
  3.614817542884739*^9, 3.614817673811257*^9, 3.615271167481966*^9, 
  3.615272945130584*^9}],

Cell[BoxData[
 RowBox[{"mv", "[", 
  RowBox[{"1", ",", "4", ",", "3", ",", "6", ",", "5", ",", "2"}], 
  "]"}]], "Output",
 CellChangeTimes->{3.614815372799*^9, 3.614815403132319*^9, 
  3.614817101550596*^9, 3.6148173053367233`*^9, 3.614817479704425*^9, 
  3.614817542884739*^9, 3.614817673811257*^9, 3.615271167481966*^9, 
  3.615272945134821*^9}]
}, Open  ]],

Cell["To check sanity in the case of symbolic slot positions,", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.611643774046471*^9, 3.611644228205924*^9}, {
   3.6116481761128273`*^9, 3.611648236128635*^9}, {3.611648901843369*^9, 
   3.611649052371339*^9}, 3.611794111476083*^9, {3.6120049030031757`*^9, 
   3.61200492298695*^9}, {3.612005211537902*^9, 3.612005213420268*^9}, {
   3.612005343341991*^9, 3.6120053450205593`*^9}, {3.612092128915626*^9, 
   3.6120921674081287`*^9}, {3.612125345521366*^9, 3.6121253710887127`*^9}, {
   3.612126027939372*^9, 3.612126040034663*^9}, {3.612128133705443*^9, 
   3.612128147000634*^9}, {3.6122554282106447`*^9, 3.612255449186727*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"ArgumentChecking", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"sym", "[", "n__", "]"}], "[", "X_", "]"}], "/;", 
     RowBox[{
      RowBox[{"IntegerQ", "[", 
       RowBox[{"deg", "[", "X", "]"}], "]"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"deg", "[", "X", "]"}], "<", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "n", "}"}], "]"}]}], "||", " ", 
        RowBox[{
         RowBox[{"deg", "[", "X", "]"}], "<", 
         RowBox[{"Max", "[", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "n", "}"}], ",", "_Integer"}], "]"}], "]"}]}]}], 
       ")"}]}]}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"sym", "[", "n", "]"}], ",", " ", 
        "\"\< operates on tensors that have degree \[GreaterEqual] \>\"", ",", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "n", "}"}], ",", "_Integer"}], "]"}], "]"}], ",", 
          RowBox[{"Length", "[", 
           RowBox[{"{", "n", "}"}], "]"}]}], "]"}], ",", 
        "\"\<. \nThe given tensor has degree \>\"", ",", 
        RowBox[{"deg", "[", "X", "]"}], ",", "\"\<.\>\""}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612128619952763*^9, 3.6121286984518557`*^9}, {
   3.612129232422579*^9, 3.6121292965360117`*^9}, 3.6121293861983433`*^9, {
   3.612153371180094*^9, 3.6121533786960382`*^9}, {3.612153515641142*^9, 
   3.612153517320292*^9}, 3.612153551727728*^9, {3.612255127369429*^9, 
   3.612255224717876*^9}, {3.61225530611117*^9, 3.612255324690474*^9}, {
   3.612339274400901*^9, 3.6123393024489822`*^9}, {3.612346008284483*^9, 
   3.612346009579411*^9}, 3.612346244318009*^9, {3.612346591039309*^9, 
   3.612346591596517*^9}, 3.612389657038631*^9, {3.614982892271793*^9, 
   3.6149829076955223`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"X", "=."}], ";", 
  RowBox[{
   RowBox[{"deg", "[", "X", "]"}], "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sym", "[", 
   RowBox[{"n1", ",", "2", ",", "n3"}], "]"}], "[", "X", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sym", "[", 
   RowBox[{"n1", ",", "4", ",", "n3"}], "]"}], "[", "X", "]"}]}], "Input",
 CellChangeTimes->{{3.612255256216721*^9, 3.612255259384625*^9}, {
  3.612255341913905*^9, 3.6122553833092527`*^9}, {3.612392964228313*^9, 
  3.612392992740222*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sym", "[", 
   RowBox[{"n1", ",", "2", ",", "n3"}], "]"}], "[", "X", "]"}]], "Output",
 CellChangeTimes->{
  3.6122552628871527`*^9, {3.6122553358134108`*^9, 3.612255354930111*^9}, 
   3.612255384982497*^9, 3.612256799251278*^9, 3.612331290974626*^9, 
   3.612341772989667*^9, 3.612346146275144*^9, 3.612392259523468*^9, {
   3.612392969238977*^9, 3.612392994219016*^9}, 3.612393169210486*^9, 
   3.612420266942968*^9, 3.612670312346846*^9, 3.612683991021316*^9, 
   3.612686964759808*^9, 3.615271167573408*^9, 3.615272945277706*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sym", "[", 
   RowBox[{"n1", ",", "4", ",", "n3"}], "]"}], "[", "X", "]"}]], "Output",
 CellChangeTimes->{
  3.6122552628871527`*^9, {3.6122553358134108`*^9, 3.612255354930111*^9}, 
   3.612255384982497*^9, 3.612256799251278*^9, 3.612331290974626*^9, 
   3.612341772989667*^9, 3.612346146275144*^9, 3.612392259523468*^9, {
   3.612392969238977*^9, 3.612392994219016*^9}, 3.612393169210486*^9, 
   3.612420266942968*^9, 3.612670312346846*^9, 3.612683991021316*^9, 
   3.612686964759808*^9, 3.615271167573408*^9, 3.615272945282008*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "W", "]"}], "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sym", "[", "]"}], "[", "W", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sym", "[", 
   RowBox[{"1", ",", "2", ",", "3"}], "]"}], "[", "]"}]}], "Input",
 CellChangeTimes->{{3.6148177375110283`*^9, 3.614817741573719*^9}, 
   3.614818132384851*^9, {3.614818314697609*^9, 3.614818329172286*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  RowBox[{"(", 
   RowBox[{"W", "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "2"}], "]"}], "[", "W", "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "1", ",", "3"}], "]"}], "[", "W", "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "1"}], "]"}], "[", "W", "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"3", ",", "1", ",", "2"}], "]"}], "[", "W", "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"3", ",", "2", ",", "1"}], "]"}], "[", "W", "]"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.614818151990581*^9, 3.6148183319660254`*^9, 
  3.6152711676596003`*^9, 3.6152729454157352`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"mv", "[", "]"}], "+", 
    RowBox[{"mv", "[", 
     RowBox[{"1", ",", "3", ",", "2"}], "]"}], "+", 
    RowBox[{"mv", "[", 
     RowBox[{"2", ",", "1", ",", "3"}], "]"}], "+", 
    RowBox[{"mv", "[", 
     RowBox[{"2", ",", "3", ",", "1"}], "]"}], "+", 
    RowBox[{"mv", "[", 
     RowBox[{"3", ",", "1", ",", "2"}], "]"}], "+", 
    RowBox[{"mv", "[", 
     RowBox[{"3", ",", "2", ",", "1"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.614818151990581*^9, 3.6148183319660254`*^9, 
  3.6152711676596003`*^9, 3.615272945420236*^9}]
}, Open  ]],

Cell["Timings for the 2 different ways of using sym :", "Text",
 CellChangeTimes->{{3.612389525952106*^9, 3.612389538922131*^9}, {
  3.612396744285228*^9, 3.612396753046694*^9}, {3.612419878625503*^9, 
  3.612419918550921*^9}, {3.6148183773256702`*^9, 3.614818451502898*^9}, {
  3.6148190664333897`*^9, 3.614819067345669*^9}}],

Cell["\<\
For deg 8:   
These were about 7 sec for  Math 8 code using permutations.  
Now in Math 10 :
        11 sec  with  ArgumentChecking = False  
        14 sec  with  ArgumentChecking = False    but  mv error message code \
defined.
        28 sec  with  ArgumentChecking = True.\
\>", "Text",
 CellChangeTimes->{{3.612389525952106*^9, 3.612389538922131*^9}, {
   3.612396744285228*^9, 3.612396753046694*^9}, {3.612419878625503*^9, 
   3.612419918550921*^9}, {3.6148183773256702`*^9, 3.614818451502898*^9}, {
   3.61481907142564*^9, 3.614819085473592*^9}, {3.6148191644504137`*^9, 
   3.614819200450878*^9}, 3.614819466292756*^9, {3.615273245740608*^9, 
   3.615273435341696*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearField", "[", "W", "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"8", ",", "W"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"sym", "[", "]"}], "[", "W", "]"}], ";"}], " ", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"op", "=", 
    RowBox[{
     RowBox[{"sym", "[", 
      RowBox[{"Range", "[", "8", "]"}], "]"}], "[", "]"}]}], ";"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6123895454452868`*^9, 3.612389561728888*^9}, {
  3.6124197649019613`*^9, 3.6124197667171*^9}, {3.6148181643055077`*^9, 
  3.614818182863455*^9}, {3.6148182507397623`*^9, 3.61481825080939*^9}, {
  3.61481909236628*^9, 3.614819114564106*^9}, {3.614819292811412*^9, 
  3.614819293706915*^9}, {3.614819373391334*^9, 3.614819374491281*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "11.09669399999999939154804451391100883484`7.065793523470419", ",", 
   "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.614819245383492*^9, 3.614819309497672*^9, 
  3.614819387716406*^9, 3.614819448999544*^9, 3.615271196299399*^9, 
  3.615272956599965*^9, 3.615273013139718*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "11.70073099999999932663286017486825585365`7.088812908303493", ",", 
   "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.614819245383492*^9, 3.614819309497672*^9, 
  3.614819387716406*^9, 3.614819448999544*^9, 3.615271196299399*^9, 
  3.615272956599965*^9, 3.615273024864283*^9}]
}, Open  ]],

Cell["\<\
Applying the operator  op= sym[Range[8]][ ]  is fast since W has no \
symmetries,\
\>", "Text",
 CellChangeTimes->{{3.612389525952106*^9, 3.612389538922131*^9}, {
  3.612396744285228*^9, 3.612396753046694*^9}, {3.612419878625503*^9, 
  3.612419968791214*^9}, {3.614819316418648*^9, 3.61481936862713*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"op", "[", "W", "]"}], ";"}], "]"}]], "Input",
 CellChangeTimes->{3.612396857331587*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.59203700000000003544897708707139827311`5.792948762559466", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{3.614819459712779*^9, 3.6152712254120283`*^9, 
  3.6152736379502707`*^9}]
}, Open  ]],

Cell["For deg 7:", "Text",
 CellChangeTimes->{{3.612389525952106*^9, 3.612389538922131*^9}, {
  3.612396744285228*^9, 3.612396753046694*^9}, {3.612419878625503*^9, 
  3.612419918550921*^9}, {3.6148183773256702`*^9, 3.614818451502898*^9}, {
  3.61481907142564*^9, 3.614819085473592*^9}, {3.614819158573295*^9, 
  3.614819159202241*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearField", "[", "W", "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"7", ",", "W"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"sym", "[", "]"}], "[", "W", "]"}], ";"}], " ", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"op", "=", 
    RowBox[{
     RowBox[{"sym", "[", 
      RowBox[{"Range", "[", "7", "]"}], "]"}], "[", "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"op", "[", "W", "]"}], ";"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6148191450825443`*^9, 3.614819148637838*^9}, 
   3.614819380346814*^9, {3.614819503380467*^9, 3.614819514539977*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.76811099999999998821920144109753891826`6.268109439326746", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{3.614819322349896*^9, 3.614819399702121*^9, 
  3.614819520275538*^9, 3.6152712287645273`*^9, 3.6152736470470963`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.81211300000000008481038094032555818558`6.278785189261866", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{3.614819322349896*^9, 3.614819399702121*^9, 
  3.614819520275538*^9, 3.6152712287645273`*^9, 3.615273648863037*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.07200499999999999956035168224843800999`4.877962568002762", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{3.614819322349896*^9, 3.614819399702121*^9, 
  3.614819520275538*^9, 3.6152712287645273`*^9, 3.615273648957897*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples of  sym  as  a  mv  operator  (no tensor argument)", \
"Subsubsection",
 CellChangeTimes->{{3.612254626207354*^9, 3.6122546475033092`*^9}, {
  3.612256033557694*^9, 3.612256038197482*^9}, {3.612256141062128*^9, 
  3.6122561497340603`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sym", "[", 
   RowBox[{"1", ",", "2"}], "]"}], "[", "]"}]], "Input",
 CellChangeTimes->{{3.612127562429385*^9, 3.612127567403441*^9}, {
  3.612342094547847*^9, 3.612342094647051*^9}, {3.612346085780266*^9, 
  3.612346085891634*^9}, {3.612346151764336*^9, 3.612346152067102*^9}, {
  3.6123462568058977`*^9, 3.612346284547984*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"mv", "[", "]"}], "+", 
    RowBox[{"mv", "[", 
     RowBox[{"2", ",", "1"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.612342099710381*^9, 3.612345301323386*^9, {3.612346075710491*^9, 
   3.612346086965663*^9}, {3.612346148759371*^9, 3.612346153182226*^9}, {
   3.612346251859692*^9, 3.612346291199222*^9}, 3.612396935944316*^9, 
   3.6124202935614777`*^9, 3.612670314298315*^9, 3.612683993495796*^9, 
   3.6126869667879467`*^9, 3.615271232331966*^9, 3.615273696376835*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sym", "[", 
   RowBox[{"3", ",", "4", ",", "5"}], "]"}], "[", "]"}]], "Input",
 CellChangeTimes->{{3.612127570651464*^9, 3.612127576507536*^9}, {
  3.6123421042770977`*^9, 3.612342107859445*^9}, {3.6123463888370457`*^9, 
  3.6123463889830093`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"mv", "[", "]"}], "+", 
    RowBox[{"mv", "[", 
     RowBox[{"1", ",", "2", ",", "3", ",", "5", ",", "4"}], "]"}], "+", 
    RowBox[{"mv", "[", 
     RowBox[{"1", ",", "2", ",", "4", ",", "3", ",", "5"}], "]"}], "+", 
    RowBox[{"mv", "[", 
     RowBox[{"1", ",", "2", ",", "4", ",", "5", ",", "3"}], "]"}], "+", 
    RowBox[{"mv", "[", 
     RowBox[{"1", ",", "2", ",", "5", ",", "3", ",", "4"}], "]"}], "+", 
    RowBox[{"mv", "[", 
     RowBox[{"1", ",", "2", ",", "5", ",", "4", ",", "3"}], "]"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.612127577047667*^9, 3.612152434921645*^9, 3.612153404623734*^9, 
   3.612228366391827*^9, 3.6122422302712383`*^9, 3.6122446103659077`*^9, 
   3.612245414574198*^9, 3.612246470474505*^9, 3.612246823486618*^9, 
   3.612255619319544*^9, 3.61225680083022*^9, 3.612342081845105*^9, 
   3.6123453040273*^9, {3.6123463858556633`*^9, 3.612346406754277*^9}, 
   3.6123969574962683`*^9, 3.6124202947457457`*^9, 3.612670314390214*^9, 
   3.612683993501267*^9, 3.612686966796254*^9, 3.6152712324719467`*^9, 
   3.615273696541521*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Args can be list or sequence,", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.611643774046471*^9, 3.611644228205924*^9}, {
   3.6116481761128273`*^9, 3.611648236128635*^9}, {3.611648901843369*^9, 
   3.611649052371339*^9}, 3.611794111476083*^9, {3.6120049030031757`*^9, 
   3.61200492298695*^9}, {3.612005098123748*^9, 3.612005129179603*^9}, 
   3.612089371257184*^9, {3.612256296214836*^9, 3.612256313766519*^9}, {
   3.612396968911181*^9, 3.612396970392126*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sym", "[", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2"}], "}"}], "]"}], "[", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sym", "[", 
   RowBox[{"3", ",", "2"}], "]"}], "[", "]"}]}], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.611648770567195*^9, 3.6116487750475903`*^9}, {
   3.611648829208803*^9, 3.6116488334445553`*^9}, {3.61173529090653*^9, 
   3.61173529098984*^9}, 3.611794111475086*^9, 3.6120030961205063`*^9, {
   3.612003311529663*^9, 3.6120033146812696`*^9}, {3.6120033640260878`*^9, 
   3.612003365273254*^9}, {3.612004103821801*^9, 3.6120041074214287`*^9}, {
   3.612004734496896*^9, 3.612004739459343*^9}, {3.612089336131114*^9, 
   3.612089344334743*^9}, {3.6120907613675547`*^9, 3.61209076640519*^9}, {
   3.612254435462201*^9, 3.612254436758026*^9}, {3.612254546854841*^9, 
   3.612254547864684*^9}, 3.612342112289713*^9, 3.612345311471859*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"mv", "[", "]"}], "+", 
    RowBox[{"mv", "[", 
     RowBox[{"1", ",", "3", ",", "2"}], "]"}]}], ")"}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.611648771295546*^9, 3.611648775555015*^9}, 
   3.611648834757773*^9, 3.6116546135327253`*^9, 3.611703068414188*^9, 
   3.6117352937651653`*^9, 3.6117941114753017`*^9, 3.611794296334743*^9, 
   3.611800410122077*^9, 3.611802522122231*^9, 3.611803269379086*^9, 
   3.611803459542871*^9, 3.6118082023345623`*^9, 3.6118378590271683`*^9, 
   3.612003097823515*^9, {3.612003424531763*^9, 3.612003448328887*^9}, {
   3.6120041081404552`*^9, 3.612004126002968*^9}, 3.612004379113247*^9, {
   3.612004731948406*^9, 3.6120047422541447`*^9}, 3.612005589262267*^9, {
   3.6120893008854313`*^9, 3.6120893462570467`*^9}, 3.612089565462304*^9, 
   3.612089601414483*^9, 3.612090740998106*^9, {3.6120907857709303`*^9, 
   3.612090798970907*^9}, 3.6120908478513517`*^9, 3.612122655726965*^9, 
   3.612152431472622*^9, 3.612152664931315*^9, 3.612152720668543*^9, 
   3.612242229212123*^9, 3.612244610050622*^9, 3.612245414266666*^9, 
   3.612246460135212*^9, 3.61224682261147*^9, 3.612254896002451*^9, 
   3.612256800913993*^9, 3.612342081850724*^9, {3.61234530722692*^9, 
   3.612345312126957*^9}, 3.612396972544313*^9, 3.612420295969748*^9, 
   3.612670314429933*^9, 3.6126839935066757`*^9, 3.6126869668045063`*^9, 
   3.615271232617697*^9, 3.615273696555429*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"mv", "[", "]"}], "+", 
    RowBox[{"mv", "[", 
     RowBox[{"1", ",", "3", ",", "2"}], "]"}]}], ")"}]}]], "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.611648771295546*^9, 3.611648775555015*^9}, 
   3.611648834757773*^9, 3.6116546135327253`*^9, 3.611703068414188*^9, 
   3.6117352937651653`*^9, 3.6117941114753017`*^9, 3.611794296334743*^9, 
   3.611800410122077*^9, 3.611802522122231*^9, 3.611803269379086*^9, 
   3.611803459542871*^9, 3.6118082023345623`*^9, 3.6118378590271683`*^9, 
   3.612003097823515*^9, {3.612003424531763*^9, 3.612003448328887*^9}, {
   3.6120041081404552`*^9, 3.612004126002968*^9}, 3.612004379113247*^9, {
   3.612004731948406*^9, 3.6120047422541447`*^9}, 3.612005589262267*^9, {
   3.6120893008854313`*^9, 3.6120893462570467`*^9}, 3.612089565462304*^9, 
   3.612089601414483*^9, 3.612090740998106*^9, {3.6120907857709303`*^9, 
   3.612090798970907*^9}, 3.6120908478513517`*^9, 3.612122655726965*^9, 
   3.612152431472622*^9, 3.612152664931315*^9, 3.612152720668543*^9, 
   3.612242229212123*^9, 3.612244610050622*^9, 3.612245414266666*^9, 
   3.612246460135212*^9, 3.61224682261147*^9, 3.612254896002451*^9, 
   3.612256800913993*^9, 3.612342081850724*^9, {3.61234530722692*^9, 
   3.612345312126957*^9}, 3.612396972544313*^9, 3.612420295969748*^9, 
   3.612670314429933*^9, 3.6126839935066757`*^9, 3.6126869668045063`*^9, 
   3.615271232617697*^9, 3.615273696559613*^9}],

Cell["Symmetrizing again makes no diff,", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.611643774046471*^9, 3.611644228205924*^9}, {
   3.6116481761128273`*^9, 3.611648236128635*^9}, {3.611648901843369*^9, 
   3.611649052371339*^9}, 3.611794111476083*^9, {3.6120049030031757`*^9, 
   3.61200492298695*^9}, {3.612005098123748*^9, 3.612005129179603*^9}, 
   3.612089371257184*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sym", "[", 
   RowBox[{"3", ",", "1"}], "]"}], "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sym", "[", 
    RowBox[{"3", ",", "1"}], "]"}], "[", "]"}], "[", 
  RowBox[{
   RowBox[{"sym", "[", 
    RowBox[{"3", ",", "1"}], "]"}], "[", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.612004975936735*^9, 3.612004996848812*^9}, {
   3.6120050633363953`*^9, 3.612005087569981*^9}, {3.6120893811076603`*^9, 
   3.612089382976585*^9}, {3.612090884089643*^9, 3.612090910068042*^9}, 
   3.612091832187758*^9, {3.612254439847986*^9, 3.612254440919993*^9}, {
   3.612254549352025*^9, 3.612254549924054*^9}, {3.612342115937976*^9, 
   3.612342122702364*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"mv", "[", "]"}], "+", 
    RowBox[{"mv", "[", 
     RowBox[{"3", ",", "2", ",", "1"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.6120049780761337`*^9, 3.6120049975159883`*^9}, {
   3.612005074812594*^9, 3.612005090327528*^9}, 3.612005591518561*^9, 
   3.612089385877532*^9, {3.612089607814386*^9, 3.612089624246605*^9}, {
   3.612090889467848*^9, 3.6120909106668177`*^9}, 3.612091486653468*^9, {
   3.612091828559041*^9, 3.6120918326869087`*^9}, 3.612122659232148*^9, 
   3.612122850490529*^9, 3.6121296555547247`*^9, 3.612152431480337*^9, 
   3.61215273826871*^9, 3.612242229347224*^9, 3.612244610064229*^9, 
   3.612245414275725*^9, 3.612246460143713*^9, 3.612246822978017*^9, 
   3.6122549425850058`*^9, 3.612256800960271*^9, 3.612342081858858*^9, 
   3.6123453166554317`*^9, 3.612345391578185*^9, 3.6123969766000757`*^9, 
   3.6124202976325808`*^9, 3.612670314438219*^9, 3.612683993513729*^9, 
   3.612686966814994*^9, 3.615271232633896*^9, 3.615273696702814*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"mv", "[", "]"}], "+", 
    RowBox[{"mv", "[", 
     RowBox[{"3", ",", "2", ",", "1"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.6120049780761337`*^9, 3.6120049975159883`*^9}, {
   3.612005074812594*^9, 3.612005090327528*^9}, 3.612005591518561*^9, 
   3.612089385877532*^9, {3.612089607814386*^9, 3.612089624246605*^9}, {
   3.612090889467848*^9, 3.6120909106668177`*^9}, 3.612091486653468*^9, {
   3.612091828559041*^9, 3.6120918326869087`*^9}, 3.612122659232148*^9, 
   3.612122850490529*^9, 3.6121296555547247`*^9, 3.612152431480337*^9, 
   3.61215273826871*^9, 3.612242229347224*^9, 3.612244610064229*^9, 
   3.612245414275725*^9, 3.612246460143713*^9, 3.612246822978017*^9, 
   3.6122549425850058`*^9, 3.612256800960271*^9, 3.612342081858858*^9, 
   3.6123453166554317`*^9, 3.612345391578185*^9, 3.6123969766000757`*^9, 
   3.6124202976325808`*^9, 3.612670314438219*^9, 3.612683993513729*^9, 
   3.612686966814994*^9, 3.615271232633896*^9, 3.61527369670859*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sym", "[", 
   RowBox[{"1", ",", "2", ",", "3"}], "]"}], "[", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"sym", "[", 
      RowBox[{"1", ",", "2", ",", "3"}], "]"}], "[", "]"}], "[", 
    RowBox[{
     RowBox[{"sym", "[", 
      RowBox[{"1", ",", "2", ",", "3"}], "]"}], "[", "]"}], "]"}], "-", 
   RowBox[{
    RowBox[{"sym", "[", 
     RowBox[{"1", ",", "2", ",", "3"}], "]"}], "[", "]"}]}], "//", 
  "Expand"}]}], "Input",
 CellChangeTimes->{{3.612127716845902*^9, 3.612127719743729*^9}, {
   3.612255685468316*^9, 3.612255712849897*^9}, {3.61234532249721*^9, 
   3.612345326568087*^9}, 3.612345361896633*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"mv", "[", "]"}], "+", 
    RowBox[{"mv", "[", 
     RowBox[{"1", ",", "3", ",", "2"}], "]"}], "+", 
    RowBox[{"mv", "[", 
     RowBox[{"2", ",", "1", ",", "3"}], "]"}], "+", 
    RowBox[{"mv", "[", 
     RowBox[{"2", ",", "3", ",", "1"}], "]"}], "+", 
    RowBox[{"mv", "[", 
     RowBox[{"3", ",", "1", ",", "2"}], "]"}], "+", 
    RowBox[{"mv", "[", 
     RowBox[{"3", ",", "2", ",", "1"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.612127720296522*^9, 3.612152434933599*^9, 3.6121534095876007`*^9, 
   3.6122283883296843`*^9, 3.6122422303645477`*^9, 3.612244610475934*^9, 
   3.612245414670533*^9, 3.612246470623289*^9, 3.612246823607563*^9, 
   3.612255622841044*^9, {3.6122556972210627`*^9, 3.6122557135886602`*^9}, 
   3.612256801008966*^9, 3.612342081918064*^9, 3.612345327425313*^9, {
   3.612345366358964*^9, 3.612345380377532*^9}, 3.6123969869999027`*^9, 
   3.612420299833351*^9, 3.612670314445374*^9, 3.612683993626705*^9, 
   3.612686966859887*^9, 3.615271232781311*^9, 3.615273696839818*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.612127720296522*^9, 3.612152434933599*^9, 3.6121534095876007`*^9, 
   3.6122283883296843`*^9, 3.6122422303645477`*^9, 3.612244610475934*^9, 
   3.612245414670533*^9, 3.612246470623289*^9, 3.612246823607563*^9, 
   3.612255622841044*^9, {3.6122556972210627`*^9, 3.6122557135886602`*^9}, 
   3.612256801008966*^9, 3.612342081918064*^9, 3.612345327425313*^9, {
   3.612345366358964*^9, 3.612345380377532*^9}, 3.6123969869999027`*^9, 
   3.612420299833351*^9, 3.612670314445374*^9, 3.612683993626705*^9, 
   3.612686966859887*^9, 3.615271232781311*^9, 3.61527369684559*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"sym", "[", 
      RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "]"}], "[", "]"}], "[", 
    RowBox[{
     RowBox[{"sym", "[", 
      RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "]"}], "[", "]"}], "]"}], 
   "-", 
   RowBox[{
    RowBox[{"sym", "[", 
     RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "]"}], "[", "]"}]}], "//", 
  "Expand"}]], "Input",
 CellChangeTimes->{{3.612127694078211*^9, 3.6121276946700373`*^9}, {
  3.6121277274413233`*^9, 3.612127773222372*^9}, {3.612345411307003*^9, 
  3.6123454163461*^9}, {3.6123970147303677`*^9, 3.6123970219128723`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.6121276959748497`*^9, {3.612127732302002*^9, 3.612127775320917*^9}, 
   3.612152435008724*^9, 3.612153414516982*^9, 3.612228398267735*^9, 
   3.61224223085851*^9, 3.61224461096653*^9, 3.612245415117427*^9, 
   3.6122464710941277`*^9, 3.612246824103847*^9, 3.612255626452162*^9, 
   3.612256801478828*^9, 3.612342081929514*^9, 3.612345417955463*^9, {
   3.61239699564814*^9, 3.6123970230734453`*^9}, 3.612420301544483*^9, 
   3.612670314547935*^9, 3.61268399377234*^9, 3.6126869669322453`*^9, 
   3.6152712330700407`*^9, 3.615273696988482*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples of  sym  applied to a tensor", "Subsubsection",
 CellChangeTimes->{{3.612254626207354*^9, 3.6122546475033092`*^9}, {
  3.612256033557694*^9, 3.612256038197482*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearField", "[", "Z", "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"3", ",", "Z"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sym", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "[", "Z", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.612128345744907*^9, 3.6121283462721443`*^9}, {
  3.612397039153607*^9, 3.612397079300932*^9}, {3.615273731493128*^9, 
  3.615273760085833*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  RowBox[{"(", 
   RowBox[{"Z", "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "2"}], "]"}], "[", "Z", "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "1", ",", "3"}], "]"}], "[", "Z", "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "1"}], "]"}], "[", "Z", "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"3", ",", "1", ",", "2"}], "]"}], "[", "Z", "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"3", ",", "2", ",", "1"}], "]"}], "[", "Z", "]"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.612093683061925*^9, 3.612127946633441*^9, 3.612128346953833*^9, 
   3.61215243510245*^9, 3.612153426659812*^9, 3.6122284168217783`*^9, 
   3.612242231173242*^9, 3.61224461133049*^9, 3.612245415524489*^9, 
   3.612246471400062*^9, 3.612246824383793*^9, 3.612256373496266*^9, 
   3.6122564781847*^9, 3.61225681023217*^9, 3.6122568717849913`*^9, 
   3.612262345399852*^9, 3.61226344956168*^9, 3.612345470604246*^9, {
   3.612397056840467*^9, 3.612397079815061*^9}, 3.612420311166669*^9, 
   3.6126703145970583`*^9, 3.6126839937815847`*^9, 3.612686966966571*^9, 
   3.6152712332135897`*^9, 3.615273717945369*^9, 3.615273762424616*^9}]
}, Open  ]],

Cell["\<\
If the args are all integers then the   sym[ ]  operator is evaluated in \
terms of  mv  before being applied to anything,  that\[CloseCurlyQuote]s why \
we get a message about mv[ ], \
\>", "Text",
 CellChangeTimes->{{3.6121288445935307`*^9, 3.61212889684439*^9}, {
  3.612129450525344*^9, 3.6121294908772097`*^9}, {3.61225638743128*^9, 
  3.612256396199387*^9}, {3.612256431655633*^9, 3.612256445607624*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sym", "[", 
   RowBox[{"{", 
    RowBox[{"4", ",", "3", ",", "7"}], "}"}], "]"}], "[", "Z", "]"}]], "Input",\

 CellChangeTimes->{{3.612127957823496*^9, 3.612127963822894*^9}, {
  3.6121283496965723`*^9, 3.6121283512638702`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"1", ",", "2", ",", "7", ",", "4", ",", "5", ",", "6", ",", "3"}],
     "]"}], "\[InvisibleSpace]", "\<\" operates on tensors that have degree \
\[GreaterEqual] \"\>", "\[InvisibleSpace]", "7", 
   "\[InvisibleSpace]", "\<\". \\nThis tensor has degree \"\>", 
   "\[InvisibleSpace]", "3", "\[InvisibleSpace]", "\<\":  \"\>", 
   "\[InvisibleSpace]", "Z"}],
  SequenceForm[
   $CellContext`mv[1, 2, 7, 4, 5, 6, 3], 
   " operates on tensors that have degree \[GreaterEqual] ", 7, 
   ". \nThis tensor has degree ", 3, ":  ", $CellContext`Z],
  Editable->False]], "Print",
 CellChangeTimes->{3.612345478230093*^9, 3.612397082017804*^9, 
  3.612420312719059*^9, 3.6126703146368*^9, 3.612683993790312*^9, 
  3.6126869670023403`*^9, 3.6152712333611383`*^9, 3.615273718092305*^9, 
  3.615273769485701*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.612127964473404*^9, 3.612128352316293*^9, 3.612128450407443*^9, {
   3.612128792347624*^9, 3.612128805510518*^9}, 3.61212932963041*^9, 
   3.612152435117395*^9, 3.612153451802422*^9, 3.612153641507091*^9, 
   3.612228439213069*^9, 3.612242231196023*^9, 3.612244611419509*^9, 
   3.612245415788628*^9, 3.6122464715490513`*^9, 3.6122468244025784`*^9, 
   3.612256405543642*^9, {3.6122564809443502`*^9, 3.612256494336829*^9}, 
   3.612256810346087*^9, 3.61225687185005*^9, 3.612262347713039*^9, 
   3.612263451749948*^9, 3.6123454783041687`*^9, 3.612397082060876*^9, 
   3.612420312758627*^9, 3.612670314637903*^9, 3.612683993792251*^9, 
   3.6126869670035753`*^9, 3.615271233364962*^9, 3.6152737180971203`*^9, 
   3.615273769576973*^9}]
}, Open  ]],

Cell["\<\
sym[ ]  is not evaluated if some positions are not integers,  so this message \
is about sym, not mv,\
\>", "Text",
 CellChangeTimes->{{3.6121288445935307`*^9, 3.61212889684439*^9}, {
  3.612129450525344*^9, 3.612129588797172*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sym", "[", 
   RowBox[{"{", 
    RowBox[{"3", ",", "n1", ",", "n2", ",", "7"}], "}"}], "]"}], "[", "Z", 
  "]"}]], "Input",
 CellChangeTimes->{{3.612129420981414*^9, 3.612129423539679*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sym", "[", 
   RowBox[{"3", ",", "n1", ",", "n2", ",", "7"}], "]"}], "[", "Z", 
  "]"}]], "Output",
 CellChangeTimes->{3.612129424205784*^9, 3.612152435197*^9, 
  3.6121534751130953`*^9, 3.612153657442881*^9, 3.612228457979287*^9, 
  3.612242231391066*^9, 3.612244611434642*^9, 3.612245416071321*^9, 
  3.6122464717035913`*^9, 3.612246824479203*^9, 3.612256495866309*^9, 
  3.612256810356954*^9, 3.612256871897458*^9, 3.612262349664212*^9, 
  3.612263454436974*^9, 3.612345496197021*^9, 3.612397088502946*^9, 
  3.612420314866313*^9, 3.6126703146788588`*^9, 3.61268399380259*^9, 
  3.612686967047966*^9, 3.615271233380096*^9, 3.615273718227668*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "x1", "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "x2", "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "x3", "]"}], "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6120057195465937`*^9, 3.6120057469810753`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sym", "[", 
   RowBox[{"1", ",", "2", ",", "3"}], "]"}], "[", 
  RowBox[{"x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6120057562616997`*^9, 3.612005768886386*^9}, {
  3.6120059747460213`*^9, 3.612005993545602*^9}, {3.612129616374927*^9, 
  3.612129617684886*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3"}], "+", 
    RowBox[{"x1", "\[CircleTimes]", "x3", "\[CircleTimes]", "x2"}], "+", 
    RowBox[{"x2", "\[CircleTimes]", "x1", "\[CircleTimes]", "x3"}], "+", 
    RowBox[{"x2", "\[CircleTimes]", "x3", "\[CircleTimes]", "x1"}], "+", 
    RowBox[{"x3", "\[CircleTimes]", "x1", "\[CircleTimes]", "x2"}], "+", 
    RowBox[{"x3", "\[CircleTimes]", "x2", "\[CircleTimes]", "x1"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.612005772036323*^9, 3.612005950091022*^9, {3.612005988138062*^9, 
   3.6120059948004932`*^9}, 3.612006208337817*^9, 3.6120937969108686`*^9, {
   3.6121296139662523`*^9, 3.612129619886346*^9}, 3.6121524352084293`*^9, 
   3.612153483600031*^9, 3.612153662949567*^9, 3.612225857448791*^9, 
   3.6122284645235443`*^9, 3.6122422314958277`*^9, 3.6122446115177402`*^9, 
   3.612245416224226*^9, 3.6122464717881413`*^9, 3.6122468244947233`*^9, 
   3.612253674364299*^9, 3.612256498936428*^9, 3.6122568104438334`*^9, 
   3.6122568719563723`*^9, 3.612257733706201*^9, 3.612262352816424*^9, 
   3.6123455064640903`*^9, 3.612397096057085*^9, 3.612420319429249*^9, 
   3.612670314730104*^9, 3.6126839939362383`*^9, 3.612686967107828*^9, 
   3.615271233524405*^9, 3.6152737183347893`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sym", "[", 
   RowBox[{"1", ",", "2", ",", "3"}], "]"}], "[", 
  RowBox[{"x1", "\[CircleTimes]", "x1", "\[CircleTimes]", "x3"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.612257780628127*^9, 3.612257783716323*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"x1", "\[CircleTimes]", "x1", "\[CircleTimes]", "x3"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"x1", "\[CircleTimes]", "x3", "\[CircleTimes]", "x1"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"x3", "\[CircleTimes]", "x1", "\[CircleTimes]", "x1"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.612257785373839*^9, 3.612262354274021*^9, 
  3.612345508204178*^9, 3.612397104425074*^9, 3.612420320548191*^9, 
  3.6126703147895823`*^9, 3.612683994061659*^9, 3.612686967147832*^9, 
  3.615271233673459*^9, 3.615273718472329*^9}]
}, Open  ]],

Cell["This gives a degree error, ", "Text",
 CellChangeTimes->{{3.612247394862321*^9, 3.612247421945353*^9}, 
   3.612253885870606*^9, {3.612257803551058*^9, 3.612257806157384*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sym", "[", 
   RowBox[{"1", ",", "2", ",", "3"}], "]"}], "[", 
  RowBox[{"x1", "\[CircleTimes]", "x2"}], "]"}]], "Input",
 CellChangeTimes->{
  3.6122473302126217`*^9, {3.612256509484133*^9, 3.6122565224955177`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"1", ",", "3", ",", "2"}], "]"}], 
   "\[InvisibleSpace]", "\<\" operates on tensors that have degree \
\[GreaterEqual] \"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\". \\nThis tensor has degree \"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\":  \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"x1", "\[CircleTimes]", "x2"}]}],
  SequenceForm[
   $CellContext`mv[1, 3, 2], 
   " operates on tensors that have degree \[GreaterEqual] ", 3, 
   ". \nThis tensor has degree ", 2, ":  ", 
   CircleTimes[$CellContext`x1, $CellContext`x2]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.612253688845355*^9, {3.612256513019257*^9, 3.612256532378067*^9}, 
   3.612256810515073*^9, 3.6122568719648123`*^9, 3.6122577510648117`*^9, {
   3.612257798393106*^9, 3.612257809448925*^9}, 3.6122623561254253`*^9, 
   3.612345510591896*^9, 3.612397113106736*^9, 3.612420326395226*^9, 
   3.612670314829156*^9, 3.612683994070675*^9, 3.612686967183758*^9, 
   3.615271233808103*^9, 3.61527371848564*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.612247330830946*^9, 3.612253688931155*^9, {3.6122565130156403`*^9, 
   3.612256532403008*^9}, 3.612256810516718*^9, 3.612256871967311*^9, 
   3.612257751106382*^9, {3.6122577984355516`*^9, 3.6122578094954023`*^9}, 
   3.612262356140189*^9, 3.612345510661168*^9, 3.6123971131485577`*^9, 
   3.61242032645187*^9, 3.612670314830262*^9, 3.612683994072771*^9, 
   3.612686967185544*^9, 3.6152712338187103`*^9, 3.615273718490816*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Code for  alt", "Subsubsection",
 CellChangeTimes->{{3.612254626207354*^9, 3.6122546475033092`*^9}, {
   3.612256033557694*^9, 3.612256038197482*^9}, {3.612256141062128*^9, 
   3.6122561497340603`*^9}, {3.6122567278965693`*^9, 
   3.6122567405522413`*^9}, {3.612342271391286*^9, 3.6123423012143583`*^9}, {
   3.612342378958661*^9, 3.612342395806444*^9}, 3.6123890548953238`*^9, {
   3.612499868192037*^9, 3.612499870096594*^9}}],

Cell["\<\
The code could be much more general.  alt[ ]  could work for arbitrary head \
G, not just  CircleTimes,  provided it were calculated in terms of alt[ ] of \
the arguments of G.
Instead, we have used  alt[ ][a] = a for deg[a] = 1,  which is specific for  \
\[CircleTimes].   The condition   alt[ ][a] = a   for  G[a] = a  would be \
better and could apply for arbitrary products.

alt[ {i, j, k } ][ X ]   could be defined as an alternating sum over permuted \
substitutions of i,j,k.  Eg.,  i,j,k  symbolic indicies in the expression X.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Wedge", "[", "a", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Times", "[", "a", "]"}], "\[IndentingNewLine]", 
 RowBox[{"CircleTimes", "[", "a", "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", "a", "\[RightAngleBracket]"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Alt", "[", "]"}], "[", "a", "]"}]], "Output"],

Cell[BoxData["a"], "Output"],

Cell[BoxData["a"], "Output"],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", "a", "\[RightAngleBracket]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"alt", "[", "]"}], "[", 
  RowBox[{"G", "[", 
   RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alt", "[", "]"}], "[", 
  RowBox[{"CircleTimes", "[", 
   RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alt", "[", "]"}], "[", "a", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"alt", "[", "]"}], "[", 
  RowBox[{"G", "[", 
   RowBox[{"a", ",", "b", ",", "c"}], "]"}], "]"}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{"alt", "[", "]"}], "[", 
  RowBox[{"a", "\[CircleTimes]", "b", "\[CircleTimes]", "c"}], 
  "]"}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{"alt", "[", "]"}], "[", "a", "]"}]], "Output"]
}, Open  ]],

Cell["If   alt   is generalized ", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"alt", "[", "___", "]"}], "[", 
   RowBox[{"X_", "?", "AntisymQ"}], "]"}], ":=", "X"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"altMessage", "[", "n_", "]"}], ":=", 
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<The argument in alt[\>\"", " ", ",", " ", "n", ",", " ", 
    "\"\<] must be a sequence or list of distinct elements.\>\""}], 
   "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.61164541061478*^9, 3.6116454649677963`*^9}, {
   3.611702322001289*^9, 3.6117023347208776`*^9}, {3.611702380977538*^9, 
   3.6117024211691837`*^9}, 3.61179411147462*^9, {3.6120036341355247`*^9, 
   3.612003657751189*^9}, {3.612003697926818*^9, 3.612003710551805*^9}, {
   3.6121225881722507`*^9, 3.6121226378504133`*^9}, {3.6121525412288427`*^9, 
   3.612152576825548*^9}, {3.612342317805523*^9, 3.612342321932488*^9}, {
   3.6123424170853043`*^9, 3.6123424175650263`*^9}, {3.612499959549019*^9, 
   3.612499969152067*^9}}],

Cell["\<\
If given a list of  slot positions, convert this to a sequence,\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.611643774046471*^9, 3.611644228205924*^9}, {
   3.6116481761128273`*^9, 3.611648236128635*^9}, {3.611648901843369*^9, 
   3.611649052371339*^9}, 3.611794111476083*^9, {3.6120049030031757`*^9, 
   3.61200492298695*^9}, {3.612005098123748*^9, 3.612005129179603*^9}, 
   3.612089371257184*^9, {3.6121230783147507`*^9, 3.612123184554723*^9}, {
   3.612123429739736*^9, 3.6121234343475246`*^9}, {3.612241127939206*^9, 
   3.612241152034795*^9}, {3.612341962396907*^9, 3.612341974189087*^9}, 
   3.612391375783965*^9, {3.61239141234319*^9, 3.612391441808988*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"alt", "[", "n_List", "]"}], ":=", " ", 
  RowBox[{"alt", "[", 
   RowBox[{"Apply", "[", 
    RowBox[{"Sequence", ",", "n"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612500063615161*^9, 3.612500066507069*^9}}],

Cell["No indices in  alt[ ]  implies full  anti-symmetrization,", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.611643774046471*^9, 3.611644228205924*^9}, {
   3.6116481761128273`*^9, 3.611648236128635*^9}, {3.611648901843369*^9, 
   3.611649052371339*^9}, 3.611794111476083*^9, {3.6120049030031757`*^9, 
   3.61200492298695*^9}, {3.612005098123748*^9, 3.612005129179603*^9}, 
   3.612089371257184*^9, {3.6121230783147507`*^9, 3.612123184554723*^9}, {
   3.612123429739736*^9, 3.6121234343475246`*^9}, {3.6125000675098763`*^9, 
   3.612500080018016*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"alt", "[", "]"}], "[", 
   RowBox[{"X_", "/;", 
    RowBox[{
     RowBox[{"IntegerQ", "[", 
      RowBox[{"deg", "[", "X", "]"}], "]"}], "&&", 
     RowBox[{
      RowBox[{"deg", "[", "X", "]"}], ">", "0"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"alt", "[", 
    RowBox[{"Range", "[", 
     RowBox[{"deg", "[", "X", "]"}], "]"}], "]"}], "[", "X", "]"}]}]], "Input",\

 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"alt", "[", "]"}], "[", 
   RowBox[{"X_", "?", "deg0Q"}], "]"}], ":=", "X"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"alt", "[", "n___", "]"}], "[", 
   RowBox[{"alt", "[", "]"}], "]"}], ":=", 
  RowBox[{"alt", "[", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612123510447919*^9, 3.612123534867532*^9}, {
   3.612123597171157*^9, 3.6121236187235613`*^9}, 3.612206587119681*^9, {
   3.6125000978261337`*^9, 3.612500098962184*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"alt", "[", "]"}], "[", 
   RowBox[{"alt", "[", "n___", "]"}], "]"}], ":=", 
  RowBox[{"alt", "[", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6121236071736603`*^9, 3.612123627027186*^9}, {
  3.6125000995197067`*^9, 3.612500100742589*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 ".... there are similar identities for    alt[ ",
 Cell[BoxData[
  FormBox["n1__", TraditionalForm]]],
 " ][ ",
 "alt",
 "[ ",
 Cell[BoxData[
  FormBox["n2__", TraditionalForm]]],
 " ] ]   but they make good code checks and simplify anyway."
}], "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.611643774046471*^9, 3.611644228205924*^9}, {
   3.6116481761128273`*^9, 3.611648236128635*^9}, {3.611648901843369*^9, 
   3.611649052371339*^9}, 3.611794111476083*^9, {3.6120049030031757`*^9, 
   3.61200492298695*^9}, {3.612005098123748*^9, 3.612005129179603*^9}, 
   3.612089371257184*^9, {3.6121230783147507`*^9, 3.612123184554723*^9}, {
   3.612123429739736*^9, 3.6121234343475246`*^9}, {3.612123657132228*^9, 
   3.612123747581171*^9}, {3.612153253728426*^9, 3.612153292990429*^9}, {
   3.612500102680688*^9, 3.6125001039508657`*^9}}],

Cell["\<\
Anti-symmetrization on 1 position is the identity.  This is also used as a \
termination condition in the code for  alt,\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.611643774046471*^9, 3.611644228205924*^9}, {
   3.6116481761128273`*^9, 3.611648236128635*^9}, {3.611648901843369*^9, 
   3.611649052371339*^9}, 3.611794111476083*^9, {3.6120049030031757`*^9, 
   3.61200492298695*^9}, {3.612005098123748*^9, 3.612005129179603*^9}, 
   3.612089371257184*^9, {3.6121230783147507`*^9, 3.612123184554723*^9}, {
   3.612123429739736*^9, 3.6121234343475246`*^9}, {3.612123657132228*^9, 
   3.612123747581171*^9}, {3.6121258861628513`*^9, 3.612125939490291*^9}, {
   3.612125982851152*^9, 3.612125984850347*^9}, {3.612254769328536*^9, 
   3.612254780079812*^9}, {3.612338952433999*^9, 3.6123389816966352`*^9}, {
   3.6123414253396072`*^9, 3.6123414519307404`*^9}, {3.6125001135518293`*^9, 
   3.612500138660836*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"alt", "[", "n_Integer", "]"}], ":=", 
  RowBox[{"mv", "[", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612340989101975*^9, 3.612340991170993*^9}, {
  3.612500157625445*^9, 3.612500167078134*^9}}],

Cell["New reln for values of deg,", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.611643774046471*^9, 3.611644228205924*^9}, {
   3.6116481761128273`*^9, 3.611648236128635*^9}, {3.611648901843369*^9, 
   3.611649052371339*^9}, 3.611794111476083*^9, {3.6120049030031757`*^9, 
   3.61200492298695*^9}, {3.612005098123748*^9, 3.612005129179603*^9}, 
   3.612089371257184*^9, {3.6121230783147507`*^9, 3.612123184554723*^9}, {
   3.612123915293274*^9, 3.6121239245085573`*^9}, {3.612145517932703*^9, 
   3.6121455238197107`*^9}, {3.6122266661871977`*^9, 3.612226670986987*^9}, {
   3.612345718908334*^9, 3.6123457235800953`*^9}, 3.612397150802286*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{
    RowBox[{"alt", "[", "__", "]"}], "[", "X_", "]"}], "]"}], ":=", 
  RowBox[{"deg", "[", "X", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612089413939939*^9, 3.612089448637619*^9}, 
   3.6125001818841333`*^9}],

Cell[CellGroupData[{

Cell["\<\
To anti-symmetrize on  n  positions, we anti-symmetrize over  n different \
anti-symmetrizations,  generated by cycling through the  n positions and \
anti-symmetrizing on the last n-1 of them.
The cyclic perm  c   is even/odd  according to  Length[n],  that\
\[CloseCurlyQuote]s why there are 2 formulas.

If  no tensor argument  X  is given,  alt[n__][ ]   returns the corresponding \
mv operator.\
\>", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.611643774046471*^9, 3.611644228205924*^9}, {
   3.6116481761128273`*^9, 3.611648236128635*^9}, {3.611648901843369*^9, 
   3.611649052371339*^9}, 3.611794111476083*^9, {3.6120049030031757`*^9, 
   3.61200492298695*^9}, {3.612005211537902*^9, 3.612005213420268*^9}, {
   3.612005343341991*^9, 3.6120053450205593`*^9}, {3.612127216614319*^9, 
   3.612127217959132*^9}, {3.61220676659649*^9, 3.6122068621297007`*^9}, {
   3.612206906607637*^9, 3.6122069340853243`*^9}, {3.6123375006041307`*^9, 
   3.612337519930983*^9}, {3.612338013006151*^9, 3.6123382436464443`*^9}, {
   3.612338274847266*^9, 3.612338667231748*^9}, {3.612340641964163*^9, 
   3.612340643223421*^9}, {3.612389368884878*^9, 3.6123894091054697`*^9}, {
   3.612393815282117*^9, 3.612393941962493*^9}, {3.612500187983614*^9, 
   3.612500224015523*^9}, {3.6125014632847853`*^9, 3.612501465857081*^9}, {
   3.6125020142172823`*^9, 3.612502087114152*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"alt", "[", "n__Integer", "]"}], "[", "X___", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "u", ",", "m", ",", "c", ",", "s", ",", "i", ",", "j", ",", "k"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "X", "}"}], "]"}], ">", "1"}], ",", 
       RowBox[{
       "Print", "[", 
        "\"\<If an argument appears within the 2nd square brackets of alt[][] \
then it should be a single tensor. See: ? alt\>\"", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s", " ", "=", " ", 
      RowBox[{"Length", "[", 
       RowBox[{"{", "n", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Union", "[", 
           RowBox[{"{", "n", "}"}], "]"}], "]"}], "===", "s"}]}], ",", 
       RowBox[{
        RowBox[{"altMessage", "[", 
         RowBox[{"{", "n", "}"}], "]"}], ";", " ", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", "0", "]"}], "=", 
      RowBox[{"mv", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "[", "1", "]"}], "=", 
      RowBox[{"mvCyclic", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"c", "[", "i", "]"}], "=", 
        RowBox[{
         RowBox[{"c", "[", "1", "]"}], "[", 
         RowBox[{"c", "[", 
          RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"s", "-", "1"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"m", " ", "=", " ", 
      RowBox[{"Rest", "[", 
       RowBox[{"{", "n", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"EvenQ", "[", "s", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "j"], 
             RowBox[{
              RowBox[{"alt", "[", "m", "]"}], "[", 
              RowBox[{
               RowBox[{"c", "[", "j", "]"}], "[", "X", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "0", ",", 
              RowBox[{"s", "-", "1"}]}], "}"}]}], "]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"s", "-", "1"}], ")"}], "!"}]}], "]"}], "/", 
        RowBox[{"s", "!"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"Sum", "[", "              ", 
           RowBox[{
            RowBox[{
             RowBox[{"alt", "[", "m", "]"}], "[", 
             RowBox[{
              RowBox[{"c", "[", "k", "]"}], "[", "X", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "0", ",", 
              RowBox[{"s", "-", "1"}]}], "}"}]}], "]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"s", "-", "1"}], ")"}], "!"}]}], "]"}], "/", 
        RowBox[{"s", "!"}]}]}], "]"}]}]}], "]"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],

Cell["To check sanity in the case of symbolic slot positions,", "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellChangeTimes->{{3.611643774046471*^9, 3.611644228205924*^9}, {
   3.6116481761128273`*^9, 3.611648236128635*^9}, {3.611648901843369*^9, 
   3.611649052371339*^9}, 3.611794111476083*^9, {3.6120049030031757`*^9, 
   3.61200492298695*^9}, {3.612005211537902*^9, 3.612005213420268*^9}, {
   3.612005343341991*^9, 3.6120053450205593`*^9}, {3.612092128915626*^9, 
   3.6120921674081287`*^9}, {3.612125345521366*^9, 3.6121253710887127`*^9}, {
   3.612126027939372*^9, 3.612126040034663*^9}, {3.612128133705443*^9, 
   3.612128147000634*^9}, {3.6122554282106447`*^9, 3.612255449186727*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"ArgumentChecking", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"alt", "[", "n__", "]"}], "[", "X_", "]"}], "/;", 
     RowBox[{
      RowBox[{"IntegerQ", "[", 
       RowBox[{"deg", "[", "X", "]"}], "]"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"deg", "[", "X", "]"}], "<", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "n", "}"}], "]"}]}], "||", " ", 
        RowBox[{
         RowBox[{"deg", "[", "X", "]"}], "<", 
         RowBox[{"Max", "[", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "n", "}"}], ",", "_Integer"}], "]"}], "]"}]}]}], 
       ")"}]}]}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"alt", "[", "n", "]"}], ",", " ", 
        "\"\< operates on tensors that have degree \[GreaterEqual] \>\"", ",", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "n", "}"}], ",", "_Integer"}], "]"}], "]"}], ",", 
          RowBox[{"Length", "[", 
           RowBox[{"{", "n", "}"}], "]"}]}], "]"}], ",", 
        "\"\<. \nThe given tensor has degree \>\"", ",", 
        RowBox[{"deg", "[", "X", "]"}], ",", "\"\<.\>\""}], "]"}], ";", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612128619952763*^9, 3.6121286984518557`*^9}, {
   3.612129232422579*^9, 3.6121292965360117`*^9}, 3.6121293861983433`*^9, {
   3.612153371180094*^9, 3.6121533786960382`*^9}, {3.612153515641142*^9, 
   3.612153517320292*^9}, 3.612153551727728*^9, {3.612255127369429*^9, 
   3.612255224717876*^9}, {3.61225530611117*^9, 3.612255324690474*^9}, {
   3.612339274400901*^9, 3.6123393024489822`*^9}, {3.612346008284483*^9, 
   3.612346009579411*^9}, 3.612346244318009*^9, {3.612346591039309*^9, 
   3.612346591596517*^9}, 3.612389657038631*^9, {3.612500254496254*^9, 
   3.612500256374789*^9}, {3.614982959310338*^9, 3.6149829751525173`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"X", "=."}], ";", 
  RowBox[{
   RowBox[{"deg", "[", "X", "]"}], "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alt", "[", 
   RowBox[{"n1", ",", "2", ",", "n3"}], "]"}], "[", "X", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alt", "[", 
   RowBox[{"n1", ",", "4", ",", "n3"}], "]"}], "[", "X", "]"}]}], "Input",
 CellChangeTimes->{{3.612255256216721*^9, 3.612255259384625*^9}, {
  3.612255341913905*^9, 3.6122553833092527`*^9}, {3.612392964228313*^9, 
  3.612392992740222*^9}, {3.612500259758357*^9, 3.61250026038251*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"alt", "[", 
    RowBox[{"n1", ",", "2", ",", "n3"}], "]"}], 
   "\[InvisibleSpace]", "\<\" operates on tensors that have degree \
\[GreaterEqual] \"\>", "\[InvisibleSpace]", "3", 
   "\[InvisibleSpace]", "\<\". \\nThe given tensor has degree \"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\".\"\>"}],
  SequenceForm[
   $CellContext`alt[$CellContext`n1, 2, $CellContext`n3], 
   " operates on tensors that have degree \[GreaterEqual] ", 3, 
   ". \nThe given tensor has degree ", 2, "."],
  Editable->False]], "Print",
 CellChangeTimes->{3.612501011136756*^9, 3.612670315160121*^9, 
  3.61268399442346*^9, 3.6126869672880163`*^9, 3.6152712340607777`*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.6122552628871527`*^9, {3.6122553358134108`*^9, 3.612255354930111*^9}, 
   3.612255384982497*^9, 3.612256799251278*^9, 3.612331290974626*^9, 
   3.612341772989667*^9, 3.612346146275144*^9, 3.612392259523468*^9, {
   3.612392969238977*^9, 3.612392994219016*^9}, 3.612393169210486*^9, 
   3.612420266942968*^9, {3.612501007974085*^9, 3.612501011158082*^9}, 
   3.612670315161573*^9, 3.612683994424713*^9, 3.612686967289073*^9, 
   3.615271234071316*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"alt", "[", 
    RowBox[{"n1", ",", "4", ",", "n3"}], "]"}], 
   "\[InvisibleSpace]", "\<\" operates on tensors that have degree \
\[GreaterEqual] \"\>", "\[InvisibleSpace]", "4", 
   "\[InvisibleSpace]", "\<\". \\nThe given tensor has degree \"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\".\"\>"}],
  SequenceForm[
   $CellContext`alt[$CellContext`n1, 4, $CellContext`n3], 
   " operates on tensors that have degree \[GreaterEqual] ", 4, 
   ". \nThe given tensor has degree ", 2, "."],
  Editable->False]], "Print",
 CellChangeTimes->{3.612501011136756*^9, 3.612670315160121*^9, 
  3.61268399442346*^9, 3.6126869672880163`*^9, 3.61527123407544*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.6122552628871527`*^9, {3.6122553358134108`*^9, 3.612255354930111*^9}, 
   3.612255384982497*^9, 3.612256799251278*^9, 3.612331290974626*^9, 
   3.612341772989667*^9, 3.612346146275144*^9, 3.612392259523468*^9, {
   3.612392969238977*^9, 3.612392994219016*^9}, 3.612393169210486*^9, 
   3.612420266942968*^9, {3.612501007974085*^9, 3.612501011158082*^9}, 
   3.612670315161573*^9, 3.612683994424713*^9, 3.612686967289073*^9, 
   3.6152712340787163`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"W", "=."}], ";", " ", 
  RowBox[{
   RowBox[{"deg", "[", "W", "]"}], "=", "3"}], ";"}]], "Input",
 CellChangeTimes->{{3.6123895454452868`*^9, 3.612389561728888*^9}, {
  3.6124197649019613`*^9, 3.6124197667171*^9}, {3.6125010393980083`*^9, 
  3.6125010400603*^9}, {3.612501136471287*^9, 3.612501137116184*^9}, {
  3.6125021400439568`*^9, 3.6125021473924303`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "W", "]"}], "=", "2"}], ";", 
  RowBox[{
   RowBox[{"alt", "[", "]"}], "[", "W", "]"}]}]], "Input",
 CellChangeTimes->{{3.612502219492551*^9, 3.612502220114126*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"W", "-", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "1"}], "]"}], "[", "W", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.612502221259345*^9, 3.612670315221298*^9, 
  3.6126839944359827`*^9, 3.612686967300331*^9, 3.6148196296567593`*^9, 
  3.615271234208721*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "W", "]"}], "=", "3"}], ";", 
  RowBox[{
   RowBox[{"alt", "[", "]"}], "[", "W", "]"}]}]], "Input",
 CellChangeTimes->{{3.612501083958478*^9, 3.612501092387137*^9}, 
   3.612502211369486*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  RowBox[{"(", 
   RowBox[{"W", "-", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "2"}], "]"}], "[", "W", "]"}], "-", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "1", ",", "3"}], "]"}], "[", "W", "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "1"}], "]"}], "[", "W", "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"3", ",", "1", ",", "2"}], "]"}], "[", "W", "]"}], "-", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"3", ",", "2", ",", "1"}], "]"}], "[", "W", "]"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.612501047947369*^9, {3.612501086580508*^9, 3.6125010931899633`*^9}, {
   3.612501129569007*^9, 3.612501140391416*^9}, {3.612502143243458*^9, 
   3.612502150203779*^9}, 3.612502213457378*^9, 3.6126703152874603`*^9, 
   3.6126839945466833`*^9, 3.6126869673057327`*^9, 3.614819631630403*^9, 
   3.6152712343557043`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "W", "]"}], "=", "4"}], ";", 
  RowBox[{
   RowBox[{"alt", "[", "]"}], "[", "W", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "24"], " ", 
  RowBox[{"(", 
   RowBox[{"W", "-", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "2", ",", "4", ",", "3"}], "]"}], "[", "W", "]"}], 
    "-", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "]"}], "[", "W", "]"}], 
    "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", "W", "]"}], 
    "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "2", ",", "3"}], "]"}], "[", "W", "]"}], 
    "-", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "3", ",", "2"}], "]"}], "[", "W", "]"}], 
    "-", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "1", ",", "3", ",", "4"}], "]"}], "[", "W", "]"}], 
    "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "1", ",", "4", ",", "3"}], "]"}], "[", "W", "]"}], 
    "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "1", ",", "4"}], "]"}], "[", "W", "]"}], 
    "-", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "]"}], "[", "W", "]"}], 
    "-", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "1", ",", "3"}], "]"}], "[", "W", "]"}], 
    "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "3", ",", "1"}], "]"}], "[", "W", "]"}], 
    "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"3", ",", "1", ",", "2", ",", "4"}], "]"}], "[", "W", "]"}], 
    "-", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"3", ",", "1", ",", "4", ",", "2"}], "]"}], "[", "W", "]"}], 
    "-", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"3", ",", "2", ",", "1", ",", "4"}], "]"}], "[", "W", "]"}], 
    "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"3", ",", "2", ",", "4", ",", "1"}], "]"}], "[", "W", "]"}], 
    "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"3", ",", "4", ",", "1", ",", "2"}], "]"}], "[", "W", "]"}], 
    "-", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"3", ",", "4", ",", "2", ",", "1"}], "]"}], "[", "W", "]"}], 
    "-", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "]"}], "[", "W", "]"}], 
    "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"4", ",", "1", ",", "3", ",", "2"}], "]"}], "[", "W", "]"}], 
    "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"4", ",", "2", ",", "1", ",", "3"}], "]"}], "[", "W", "]"}], 
    "-", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"4", ",", "2", ",", "3", ",", "1"}], "]"}], "[", "W", "]"}], 
    "-", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"4", ",", "3", ",", "1", ",", "2"}], "]"}], "[", "W", "]"}], 
    "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"4", ",", "3", ",", "2", ",", "1"}], "]"}], "[", "W", "]"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.614819645291646*^9, 3.615271234552112*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"alt", "[", "]"}], "[", 
    RowBox[{
     RowBox[{"alt", "[", "]"}], "[", "W", "]"}], "]"}], "-", 
   RowBox[{
    RowBox[{"alt", "[", "]"}], "[", "W", "]"}]}], "//", "Expand"}]], "Input",
 CellChangeTimes->{{3.612502239670062*^9, 3.612502259027747*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6125022468778067`*^9, 3.6125022604975767`*^9}, 
   3.612670315619772*^9, 3.612683994889042*^9, 3.6126869674876127`*^9, {
   3.614819684190549*^9, 3.614819703451476*^9}, 3.615271235177657*^9}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Sums over index rearrangements:  Permuted[],  AlternatingSum[],  \
SymmetricSum[],  CyclicSum[]\
\>", "Subsection"],

Cell[CellGroupData[{

Cell["Permuted[ ]", "Subsubsection"],

Cell["\<\

The function   Permuted[ X ]     is a correct implementation of   Permute[ \
X_List ,  SymmetricGroup[ Length[X] ]] ,  which should not delete duplicates \
from 
its result, but does so in 11.0.1.0.  See bug report below.

The code for  AlternatingSum  and  SymmetricSum   uses  PermuteSymmetric[ X ] \
  so that when  Permute[ ]  is debugged for SymmetricGroup[]  (it works for \
other groups) nothing will have to change here.\
\>", "Text"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Bug report",
 FontWeight->"Bold"]], "Text"],

Cell["\<\
2016/11/21  Reported...  

This is a bug report for the function  Permute[ ]  in Mathematica 11.0.1.0,  \
Linux x86 (64bit).
 
The bug:  
 
    Permute[ expr, SymmetricGroup[ n ]]   (for some Integer n)   does not \
return the list of 
    permuted forms of  expr  under the elements of  SymmetricGroup[ n ]. 
 
    Instead, the returned list has had all duplicate elements removed from \
it, as if the function
    DeleteDuplicates  had been applied to the correct result.
 
The correct result:
 
     Duplicate elements should not be removed from the result. 
 
     Permute[ expr,  group ]    gives the correct result for all other groups \
that I\[CloseCurlyQuote]ve checked, eg,
   
           CyclicGroup
           AlternatingGroup
           DihedralGroup
           MathieuGroupM11
 
Trivial example:    
 
           Permute[{1,1}, CyclicGroup[2]]   returns the correct result  \
{{1,1},{1,1}}.
           Permute[{1,1}, SymmetricGroup[2]]  returns the incorrect result  \
{{1,1}}  
                                                                      (it \
should return {{1,1},{1,1}}).
\
\>", "Text"]
}, Closed]],

Cell["\<\
Do the Permute on a list with no repeated elts, then substitute for the \
actual argument list,\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Permuted1", "[", "X_List", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"Permute", "[", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{"Length", "[", "X", "]"}], "]"}], ",", 
     RowBox[{"SymmetricGroup", "[", 
      RowBox[{"Length", "[", "X", "]"}], "]"}]}], "]"}], " ", "/.", 
   RowBox[{"MapThread", "[", 
    RowBox[{"Rule", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "X", "]"}], "]"}], ",", "X"}], "}"}]}], 
    "]"}]}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Permuted1", "[", 
  RowBox[{"{", 
   RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Permuted1", "[", 
  RowBox[{"{", 
   RowBox[{"i", ",", "i", ",", "k"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Permuted1", "[", 
  RowBox[{"{", 
   RowBox[{"i", ",", "i", ",", "i"}], "}"}], "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "k", ",", "j"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "i", ",", "k"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "k", ",", "i"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "i", ",", "j"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "j", ",", "i"}], "}"}]}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i", ",", "i", ",", "k"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "k", ",", "i"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "i", ",", "k"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "k", ",", "i"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "i", ",", "i"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "i", ",", "i"}], "}"}]}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i", ",", "i", ",", "i"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "i", ",", "i"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "i", ",", "i"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "i", ",", "i"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "i", ",", "i"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "i", ",", "i"}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell["This defn is faster,", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Permuted", "[", "X_List", "]"}], ":=", 
  RowBox[{
   RowBox[{"Permutations", "[", 
    RowBox[{"Range", "[", 
     RowBox[{"Length", "[", "X", "]"}], "]"}], "]"}], "/.", 
   RowBox[{"MapThread", "[", 
    RowBox[{"Rule", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "X", "]"}], "]"}], ",", "X"}], "}"}]}], 
    "]"}]}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Permuted", "[", 
  RowBox[{"{", 
   RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Permuted", "[", 
  RowBox[{"{", 
   RowBox[{"i", ",", "i", ",", "k"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Permuted", "[", 
  RowBox[{"{", 
   RowBox[{"i", ",", "i", ",", "i"}], "}"}], "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i", ",", "j", ",", "k"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "k", ",", "j"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "i", ",", "k"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "k", ",", "i"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "i", ",", "j"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "j", ",", "i"}], "}"}]}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i", ",", "i", ",", "k"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "k", ",", "i"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "i", ",", "k"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "k", ",", "i"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "i", ",", "i"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k", ",", "i", ",", "i"}], "}"}]}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i", ",", "i", ",", "i"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "i", ",", "i"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "i", ",", "i"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "i", ",", "i"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "i", ",", "i"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "i", ",", "i"}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Permuted1", "[", 
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}], ",", "100000"}], "]"}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Permuted", "[", 
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}], ",", "100000"}], "]"}],
   "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.488`", ",", "Null"}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.964`", ",", "Null"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Examples",
 FontWeight->"Bold"]], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Permute", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"CyclicGroup", "[", "4", "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "2", ",", "1"}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkPermute", "[", "g_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", ",", "n1", ",", "n2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"p", "=", 
      RowBox[{"PermutationMax", "[", "g", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n1", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"Permute", "[", 
        RowBox[{
         RowBox[{"Range", "[", "p", "]"}], ",", "g"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n2", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"Permute", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", "p"}], "]"}], ",", "g"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"g", ",", 
       RowBox[{"GroupOrder", "[", "g", "]"}], ",", " ", "n1", ",", " ", 
       "n2"}], "}"}]}]}], "]"}]}]], "Input"],

Cell["The last 3 numbers should all be the same...", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"check", "[", 
  RowBox[{"AbelianGroup", "[", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"check", "[", 
  RowBox[{"CyclicGroup", "[", "5", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"check", "[", 
  RowBox[{"DihedralGroup", "[", "4", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"check", "[", 
  RowBox[{"DihedralGroup", "[", "4", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"check", "[", 
  RowBox[{"MathieuGroupM11", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"check", "[", 
  RowBox[{"JankoGroupJ2", "[", "]"}], "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"AbelianGroup", "[", 
    RowBox[{"{", 
     RowBox[{"3", ",", "3"}], "}"}], "]"}], ",", "9", ",", "9", ",", "9"}], 
  "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"CyclicGroup", "[", "5", "]"}], ",", "5", ",", "5", ",", "5"}], 
  "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"DihedralGroup", "[", "4", "]"}], ",", "8", ",", "8", ",", "8"}], 
  "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"DihedralGroup", "[", "4", "]"}], ",", "8", ",", "8", ",", "8"}], 
  "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"MathieuGroupM11", "[", "]"}], ",", "7920", ",", "7920", ",", 
   "7920"}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"JankoGroupJ2", "[", "]"}], ",", "604800", ",", "604800", ",", 
   "604800"}], "}"}]], "Output"]
}, Open  ]],

Cell["The  Permute[ ]  bug for the  SymmetricGroup[ ]  ", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"check", "[", 
  RowBox[{"SymmetricGroup", "[", "5", "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"SymmetricGroup", "[", "5", "]"}], ",", "120", ",", "120", ",", 
   "1"}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["AlternatingSum[ ]", "Subsubsection"],

Cell["\<\

AltSum[ X, { i, j, ...} ]   and its postfix form,   AltSum[ i, j, ... ][ X ]  \
  (for use as   X //  Alt[ i, j, ...] )   are defined as an alternating sum \
over substitutions of the permuted  i,j,...
The term in the sum that is equal to X has sign +1.
Typically,  i,j,...  are symbolic indicies in an indexed expression X.
X can be any expression, not just a tensor. \
\>", "Text"],

Cell[BoxData[
 RowBox[{"Clear", "[", "AlternatingSum", "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AlternatingSum", "[", "n__", "]"}], "[", "X_", "]"}], ":=", 
  RowBox[{"AlternatingSum", "[", 
   RowBox[{"X", ",", 
    RowBox[{"{", "n", "}"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"AlternatingSum", "[", 
   RowBox[{"X_", ",", "n_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"perms", ",", "vals", ",", "sigs"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"perms", "=", 
      RowBox[{"Permuted", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vals", "=", 
      RowBox[{"X", "/.", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "#"}], "}"}]}], "]"}], "&"}], ",", "perms"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"sigs", "=", " ", 
      RowBox[{
       RowBox[{"Signature", "[", "n", "]"}], 
       RowBox[{"Map", "[", 
        RowBox[{"Signature", ",", "perms"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sigs", ".", "vals"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Timings",
 FontWeight->"Bold"]], "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Apply", "[", 
  RowBox[{"Plus", ",", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"#1", " ", "#2"}], ")"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a1", ",", "a2", ",", "a3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b1", ",", "b2", ",", "b3"}], "}"}]}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Apply", "[", 
  RowBox[{"Plus", ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a1", ",", "a2", ",", "a3"}], "}"}], "*", 
    RowBox[{"{", 
     RowBox[{"b1", ",", "b2", ",", "b3"}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"a1", ",", "a2", ",", "a3"}], "}"}], ".", 
  RowBox[{"{", 
   RowBox[{"b1", ",", "b2", ",", "b3"}], "}"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a1", " ", "b1"}], "+", 
  RowBox[{"a2", " ", "b2"}], "+", 
  RowBox[{"a3", " ", "b3"}]}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a1", " ", "b1"}], "+", 
  RowBox[{"a2", " ", "b2"}], "+", 
  RowBox[{"a3", " ", "b3"}]}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a1", " ", "b1"}], "+", 
  RowBox[{"a2", " ", "b2"}], "+", 
  RowBox[{"a3", " ", "b3"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Apply", "[", 
     RowBox[{"Plus", ",", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#1", " ", "#2"}], ")"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a1", ",", "a2", ",", "a3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"b1", ",", "b2", ",", "b3"}], "}"}]}], "}"}]}], "]"}]}], 
     "]"}], ",", "100000"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Apply", "[", 
     RowBox[{"Plus", ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a1", ",", "a2", ",", "a3"}], "}"}], "*", 
       RowBox[{"{", 
        RowBox[{"b1", ",", "b2", ",", "b3"}], "}"}]}]}], "]"}], ",", 
    "100000"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a1", ",", "a2", ",", "a3"}], "}"}], ".", 
     RowBox[{"{", 
      RowBox[{"b1", ",", "b2", ",", "b3"}], "}"}]}], ",", "100000"}], "]"}], 
  "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.304`", ",", "Null"}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.176`", ",", "Null"}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.132`", ",", "Null"}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Examples",
 FontWeight->"Bold"]], "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AlternatingSum", "[", 
  RowBox[{
   RowBox[{"q", "[", 
    RowBox[{"i", ",", "j"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "j"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AlternatingSum", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "[", 
  RowBox[{"q", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "//", 
  RowBox[{"AlternatingSum", "[", 
   RowBox[{"i", ",", "j"}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"q", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "-", 
  RowBox[{"q", "[", 
   RowBox[{"j", ",", "i"}], "]"}]}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{"q", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "-", 
  RowBox[{"q", "[", 
   RowBox[{"j", ",", "i"}], "]"}]}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{"q", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "-", 
  RowBox[{"q", "[", 
   RowBox[{"j", ",", "i"}], "]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AlternatingSum", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "[", 
  RowBox[{"M", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AlternatingSum", "[", 
   RowBox[{"j", ",", "i"}], "]"}], "[", 
  RowBox[{"M", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "-", 
  RowBox[{"M", "[", 
   RowBox[{"j", ",", "i"}], "]"}]}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "-", 
  RowBox[{"M", "[", 
   RowBox[{"j", ",", "i"}], "]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlternatingSum", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "[", 
  RowBox[{
   RowBox[{"y", "[", 
    RowBox[{"i", ",", "j"}], "]"}], "+", 
   RowBox[{"h", "[", "k", "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"y", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "-", 
  RowBox[{"y", "[", 
   RowBox[{"i", ",", "k"}], "]"}], "-", 
  RowBox[{"y", "[", 
   RowBox[{"j", ",", "i"}], "]"}], "+", 
  RowBox[{"y", "[", 
   RowBox[{"j", ",", "k"}], "]"}], "+", 
  RowBox[{"y", "[", 
   RowBox[{"k", ",", "i"}], "]"}], "-", 
  RowBox[{"y", "[", 
   RowBox[{"k", ",", "j"}], "]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlternatingSum", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "[", 
  RowBox[{"y", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"y", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "-", 
  RowBox[{"y", "[", 
   RowBox[{"i", ",", "k"}], "]"}], "-", 
  RowBox[{"y", "[", 
   RowBox[{"j", ",", "i"}], "]"}], "+", 
  RowBox[{"y", "[", 
   RowBox[{"j", ",", "k"}], "]"}], "+", 
  RowBox[{"y", "[", 
   RowBox[{"k", ",", "i"}], "]"}], "-", 
  RowBox[{"y", "[", 
   RowBox[{"k", ",", "j"}], "]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlternatingSum", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "[", 
  RowBox[{"y", "[", "i", "]"}], "]"}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"AlternatingSum", "[", 
    RowBox[{"i", ",", "j", ",", "k"}], "]"}], "[", 
   RowBox[{"y", "[", 
    RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "/.", 
  RowBox[{"k", "\[Rule]", "j"}]}]], "Input"],

Cell[BoxData["0"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlternatingSum", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "[", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"i", ",", "j", ",", "k"}], "]"}], "[", "Y", "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"i", ",", "j", ",", "k"}], "]"}], "[", "Y", "]"}], "-", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"i", ",", "k", ",", "j"}], "]"}], "[", "Y", "]"}], "-", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"j", ",", "i", ",", "k"}], "]"}], "[", "Y", "]"}], "+", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"j", ",", "k", ",", "i"}], "]"}], "[", "Y", "]"}], "+", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"k", ",", "i", ",", "j"}], "]"}], "[", "Y", "]"}], "-", 
  RowBox[{
   RowBox[{"mv", "[", 
    RowBox[{"k", ",", "j", ",", "i"}], "]"}], "[", "Y", "]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AlternatingSum", "[", 
   RowBox[{"1", ",", "2", ",", "3"}], "]"}], "[", 
  RowBox[{"Y", "[", 
   RowBox[{"1", ",", "2", ",", "3"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Y", "[", 
   RowBox[{"1", ",", "2", ",", "3"}], "]"}], "-", 
  RowBox[{"Y", "[", 
   RowBox[{"1", ",", "3", ",", "2"}], "]"}], "-", 
  RowBox[{"Y", "[", 
   RowBox[{"2", ",", "1", ",", "3"}], "]"}], "+", 
  RowBox[{"Y", "[", 
   RowBox[{"2", ",", "3", ",", "1"}], "]"}], "+", 
  RowBox[{"Y", "[", 
   RowBox[{"3", ",", "1", ",", "2"}], "]"}], "-", 
  RowBox[{"Y", "[", 
   RowBox[{"3", ",", "2", ",", "1"}], "]"}]}]], "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["SymmetricSum[ ]", "Subsubsection"],

Cell[BoxData[
 RowBox[{"Clear", "[", "SymmetricSum", "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SymmetricSum", "[", "n__", "]"}], "[", "X_", "]"}], ":=", 
  RowBox[{"SymmetricSum", "[", 
   RowBox[{"X", ",", 
    RowBox[{"{", "n", "}"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymmetricSum", "[", 
   RowBox[{"X_", ",", "n_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"perms", ",", "vals"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"perms", "=", 
      RowBox[{"Permuted", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vals", "=", 
      RowBox[{"X", "/.", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "#"}], "}"}]}], "]"}], "&"}], ",", "perms"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Apply", "[", 
      RowBox[{"Plus", ",", "vals"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Examples",
 FontWeight->"Bold"]], "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SymmetricSum", "[", 
  RowBox[{
   RowBox[{"q", "[", 
    RowBox[{"i", ",", "j"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "j"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SymmetricSum", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "[", 
  RowBox[{"q", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "//", 
  RowBox[{"SymmetricSum", "[", 
   RowBox[{"i", ",", "j"}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"q", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "+", 
  RowBox[{"q", "[", 
   RowBox[{"j", ",", "i"}], "]"}]}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{"q", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "+", 
  RowBox[{"q", "[", 
   RowBox[{"j", ",", "i"}], "]"}]}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{"q", "[", 
   RowBox[{"i", ",", "j"}], "]"}], "+", 
  RowBox[{"q", "[", 
   RowBox[{"j", ",", "i"}], "]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SymmetricSum", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "[", 
  RowBox[{"M", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "+", 
  RowBox[{"M", "[", 
   RowBox[{"i", ",", "k", ",", "j"}], "]"}], "+", 
  RowBox[{"M", "[", 
   RowBox[{"j", ",", "i", ",", "k"}], "]"}], "+", 
  RowBox[{"M", "[", 
   RowBox[{"j", ",", "k", ",", "i"}], "]"}], "+", 
  RowBox[{"M", "[", 
   RowBox[{"k", ",", "i", ",", "j"}], "]"}], "+", 
  RowBox[{"M", "[", 
   RowBox[{"k", ",", "j", ",", "i"}], "]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SymmetricSum", "[", 
   RowBox[{"i", ",", "j", ",", "j"}], "]"}], "[", 
  RowBox[{"M", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{"M", "[", 
    RowBox[{"i", ",", "j", ",", "k"}], "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"M", "[", 
    RowBox[{"j", ",", "i", ",", "k"}], "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"M", "[", 
    RowBox[{"j", ",", "j", ",", "k"}], "]"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SymmetricSum", "[", 
    RowBox[{"i", ",", "j", ",", "l"}], "]"}], "[", 
   RowBox[{"M", "[", 
    RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "/.", 
  RowBox[{"l", "\[Rule]", "j"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{"M", "[", 
    RowBox[{"i", ",", "j", ",", "k"}], "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"M", "[", 
    RowBox[{"j", ",", "i", ",", "k"}], "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"M", "[", 
    RowBox[{"j", ",", "j", ",", "k"}], "]"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SymmetricSum", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "[", "M", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SymmetricSum", "[", 
   RowBox[{"i", ",", "j", ",", "j"}], "]"}], "[", "M", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SymmetricSum", "[", 
   RowBox[{"i", ",", "i", ",", "i"}], "]"}], "[", "M", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"6", " ", "M"}]], "Output"],

Cell[BoxData[
 RowBox[{"6", " ", "M"}]], "Output"],

Cell[BoxData[
 RowBox[{"6", " ", "M"}]], "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["CyclicSum[ ]", "Subsubsection"],

Cell["\<\
CyclicSum[ X ]   (single argument)  has already been defined elsewhere for \
tensors.
Here we define it for a sum of cyclic substitutions.\
\>", "Text"],

Cell["\<\
For the  CyclicGroup,   Permute   works properly and does not remove \
duplicates from its result.\
\>", "Text"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "CyclicSum", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CyclicSum", "[", "n__", "]"}], "[", "X_", "]"}], ":=", 
  RowBox[{"CyclicSum", "[", 
   RowBox[{"X", ",", 
    RowBox[{"{", "n", "}"}]}], "]"}]}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"CyclicSum", "[", 
   RowBox[{"X_", ",", "n_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"perms", ",", "vals"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"perms", "=", 
      RowBox[{"Permute", "[", 
       RowBox[{"n", ",", 
        RowBox[{"CyclicGroup", "[", 
         RowBox[{"Length", "[", "n", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vals", "=", 
      RowBox[{"X", "/.", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "#"}], "}"}]}], "]"}], "&"}], ",", "perms"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{"Plus", ",", "vals"}], "]"}], 
      RowBox[{
       RowBox[{"Length", "[", "n", "]"}], "/", 
       RowBox[{"Length", "[", "perms", "]"}]}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Timings",
 FontWeight->"Bold"]], "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Apply", "[", 
  RowBox[{"Plus", ",", 
   RowBox[{"{", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Total", "[", 
  RowBox[{"{", 
   RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"a1", "+", "a2", "+", "a3", "+", "a4"}]], "Output"],

Cell[BoxData[
 RowBox[{"a1", "+", "a2", "+", "a3", "+", "a4"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Apply", "[", 
     RowBox[{"Plus", ",", 
      RowBox[{"{", 
       RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}]}], "]"}], ",", 
    "100000"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"{", 
      RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], "]"}], ",", 
    "100000"}], "]"}], "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.052`", ",", "Null"}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.112`", ",", "Null"}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Examples",
 FontWeight->"Bold"]], "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"CyclicSum", "[", 
  RowBox[{
   RowBox[{"q", "[", 
    RowBox[{"i", ",", "j", ",", "k"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "j", ",", "k"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CyclicSum", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "[", 
  RowBox[{"q", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "//", 
  RowBox[{"CyclicSum", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"q", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "+", 
  RowBox[{"q", "[", 
   RowBox[{"j", ",", "k", ",", "i"}], "]"}], "+", 
  RowBox[{"q", "[", 
   RowBox[{"k", ",", "i", ",", "j"}], "]"}]}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{"q", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "+", 
  RowBox[{"q", "[", 
   RowBox[{"j", ",", "k", ",", "i"}], "]"}], "+", 
  RowBox[{"q", "[", 
   RowBox[{"k", ",", "i", ",", "j"}], "]"}]}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{"q", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "+", 
  RowBox[{"q", "[", 
   RowBox[{"j", ",", "k", ",", "i"}], "]"}], "+", 
  RowBox[{"q", "[", 
   RowBox[{"k", ",", "i", ",", "j"}], "]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CyclicSum", "[", 
   RowBox[{"i", ",", "j", ",", "j"}], "]"}], "[", 
  RowBox[{"M", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "+", 
  RowBox[{"M", "[", 
   RowBox[{"j", ",", "i", ",", "k"}], "]"}], "+", 
  RowBox[{"M", "[", 
   RowBox[{"j", ",", "j", ",", "k"}], "]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CyclicSum", "[", 
    RowBox[{"i", ",", "j", ",", "k"}], "]"}], "[", 
   RowBox[{"M", "[", 
    RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "/.", 
  RowBox[{"k", "\[Rule]", "j"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "[", 
   RowBox[{"i", ",", "j", ",", "j"}], "]"}], "+", 
  RowBox[{"M", "[", 
   RowBox[{"j", ",", "i", ",", "j"}], "]"}], "+", 
  RowBox[{"M", "[", 
   RowBox[{"j", ",", "j", ",", "i"}], "]"}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"CyclicSum", "[", 
   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "[", "M", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CyclicSum", "[", 
   RowBox[{"i", ",", "j", ",", "j"}], "]"}], "[", "M", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CyclicSum", "[", 
   RowBox[{"i", ",", "i", ",", "i"}], "]"}], "[", "M", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"3", " ", "M"}]], "Output"],

Cell[BoxData[
 RowBox[{"3", " ", "M"}]], "Output"],

Cell[BoxData[
 RowBox[{"3", " ", "M"}]], "Output"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Tensors with symmetries  ---  general properties                              \
                  ---  AddRule  is on all transformation rules.  \
\>", "Subsection",
 CellChangeTimes->{{3.6117004172917347`*^9, 3.611700487110237*^9}, {
   3.611700901848016*^9, 3.611701130920413*^9}, {3.611701234361413*^9, 
   3.611701302550877*^9}, {3.611701786139716*^9, 3.6117017862152348`*^9}, {
   3.61170200910107*^9, 3.6117020329203777`*^9}, 3.611996273648815*^9, {
   3.6119963087668657`*^9, 3.611996325229361*^9}, {3.612145566621338*^9, 
   3.61214560729216*^9}, {3.612145987296035*^9, 3.612146026046085*^9}, {
   3.613115509619932*^9, 3.613115518386891*^9}, {3.6131716496652517`*^9, 
   3.613171659023672*^9}, {3.6131735153506117`*^9, 3.613173555621255*^9}, {
   3.613983689328661*^9, 3.6139836928329153`*^9}, {3.614035204729941*^9, 
   3.6140352105224037`*^9}, {3.615253555807332*^9, 3.615253586438092*^9}, {
   3.649540181363348*^9, 3.649540181523201*^9}, {3.655319270699791*^9, 
   3.655319270890669*^9}}],

Cell["\<\
There is a difference between declared symmetry and deduced symmetry.  \
Declaration implicitly specifies the preferred form (and this could 
apply to composite objects such as setting   AntisymQ[ \
\[LeftAngleBracket]F1,z1\[RightAngleBracket] ] = True ),  whereas deduced \
symmetries mean that an automatic simplification choice 
needs to be made,  eg.,  as for brackets that are degree 0 or 1.

The symmetry query functions must be able to distinguish between declared and \
deduced symmetry.\
\>", "Text",
 CellChangeTimes->{{3.6497977871608353`*^9, 3.649798158691733*^9}, {
   3.649798208627357*^9, 3.649798259733921*^9}, {3.649800010794498*^9, 
   3.649800086968906*^9}, {3.6498001523129473`*^9, 3.649800175706918*^9}, 
   3.6498010605267553`*^9}],

Cell["\<\
These general user functions tests for either declared or deduced symmetry.
The general user functions for testing full symmetry (or symmetry on \
specified slots) of a general expression are not yet written,\
\>", "Text",
 CellChangeTimes->{{3.649800312022777*^9, 3.6498003411423492`*^9}, {
  3.649800852894968*^9, 3.6498008636946173`*^9}, {3.6498012279297028`*^9, 
  3.649801232235941*^9}, {3.6498013485841217`*^9, 3.649801396119502*^9}, {
  3.6498014708863153`*^9, 3.649801476278385*^9}, {3.6498254785991297`*^9, 
  3.6498255522616243`*^9}, {3.649825679843861*^9, 3.649825683497127*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymmetricQ", "[", "X_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", " ", 
    RowBox[{
    "Print", "[", "\"\<do zero-check on diff for swapping all slot pairs\>\"",
      "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649801151590611*^9, 3.649801163340128*^9}, {
  3.649801245569865*^9, 3.649801340651532*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AntisymmetricQ", "[", "X_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", " ", 
    RowBox[{
    "Print", "[", "\"\<do zero-check on sum for swapping all slot pairs\>\"", 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6498014098512907`*^9, 3.6498014252277813`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymmetricQ", "[", 
   RowBox[{"X_", ",", "s_List"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", " ", 
    RowBox[{
    "Print", "[", 
     "\"\<do zero-check on diff for swapping all slot pairs listed in s\>\"", 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649801151590611*^9, 3.649801163340128*^9}, {
  3.649801245569865*^9, 3.649801340651532*^9}, {3.6498019710211267`*^9, 
  3.6498020272825003`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AntisymmetricQ", "[", 
   RowBox[{"X_", ",", "s_List"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", " ", 
    RowBox[{
    "Print", "[", 
     "\"\<do zero-check on sum for swapping all slot pairs listed in s\>\"", 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6498014098512907`*^9, 3.6498014252277813`*^9}, {
  3.649801990859729*^9, 3.649801998082881*^9}, {3.649802031151379*^9, 
  3.649802032470561*^9}}],

Cell["\<\
The functions that test for declared symmetry have their values set at the \
time of symmetry declaration.  Symmetry can be declared for  
any field or suitable expression. The default values are,\
\>", "Text",
 CellChangeTimes->{{3.649800312022777*^9, 3.6498003411423492`*^9}, {
  3.649800852894968*^9, 3.6498008636946173`*^9}, {3.6498012279297028`*^9, 
  3.649801232235941*^9}, {3.6498013485841217`*^9, 3.649801396119502*^9}, {
  3.649801490022236*^9, 3.6498014929820623`*^9}, {3.649801546503291*^9, 
  3.649801654148795*^9}, {3.649801717157949*^9, 3.6498017868821907`*^9}, {
  3.649802121246018*^9, 3.649802128045499*^9}, {3.649802409403792*^9, 
  3.649802410300404*^9}, {3.6498255699734087`*^9, 3.6498256618119926`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"SymQ", ",", "AntisymQ"}], "]"}]], "Input",
 CellChangeTimes->{{3.6498398166416492`*^9, 3.6498398262362213`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SymQ", "[", "X_", "]"}], ":=", "False"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AntisymQ", "[", "X_", "]"}], ":=", "False"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.613171362024989*^9, 3.61317142347635*^9}, 
   3.613172593914961*^9, 3.613173035900689*^9, {3.6131755880376368`*^9, 
   3.613175590965411*^9}, {3.614230465974245*^9, 3.614230479668481*^9}, {
   3.649800642727152*^9, 3.649800685076672*^9}, {3.649800718322729*^9, 
   3.64980072200106*^9}}],

Cell["\<\
If   X   is  field-like, then   X\[CircleTimes]X\[CircleTimes] .... \
\[CircleTimes]X   is symmetric and also in its preferred form. So in this \
sense it has declared symmetry,\
\>", "Text",
 CellChangeTimes->{{3.649830802208889*^9, 3.649830948302726*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymQ", "[", 
   RowBox[{
    RowBox[{"CircleTimes", "[", 
     RowBox[{"X_", " ", ",", 
      RowBox[{"X_", " ", ".."}]}], "]"}], "/;", 
    RowBox[{
     RowBox[{"FieldLikeQ", "[", "X", "]"}], "&&", 
     RowBox[{"deg1Q", "[", "X", "]"}]}]}], "]"}], ":=", "True"}]], "Input",
 InitializationCell->True],

Cell["\<\
.... a nice example of how to use repeated args.  Note that  CircleTimes has  \
2 args here,  where   X_ ..   or  Repeated[ X_ ] ,  is the 2nd argument.   
CircleTimes   on one argument has been defined to be the identity.  A test \
for  FieldLikeQ[ X ]   is not necessary because the argument of SymQ is first \

evaluated and thus  \[CircleTimes]  expands,\
\>", "Text",
 CellChangeTimes->{{3.649832448810444*^9, 3.6498325789850082`*^9}, {
  3.649832631752623*^9, 3.649832894212305*^9}, {3.650227334535877*^9, 
  3.650227353287627*^9}, {3.6502274270150957`*^9, 3.65022747938155*^9}, {
  3.6502279456793537`*^9, 3.650228047645876*^9}, {3.650228180219339*^9, 
  3.650228189259726*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearField", "[", 
   RowBox[{"{", 
    RowBox[{"w", ",", "z"}], "}"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"1", ",", 
    RowBox[{"{", 
     RowBox[{"w", ",", "z"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"w", "+", "z"}], ")"}], "\[CircleTimes]", 
  RowBox[{"(", 
   RowBox[{"w", "+", "z"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"SymQ", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"w", "+", "z"}], ")"}], "\[CircleTimes]", 
   RowBox[{"(", 
    RowBox[{"w", "+", "z"}], ")"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SymQ", "[", 
  RowBox[{"w", "\[CircleTimes]", "w"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6502280537104053`*^9, 3.650228112944861*^9}, {
  3.650228150929894*^9, 3.650228151645368*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w", "\[CircleTimes]", "w"}], "+", 
  RowBox[{"w", "\[CircleTimes]", "z"}], "+", 
  RowBox[{"z", "\[CircleTimes]", "w"}], "+", 
  RowBox[{"z", "\[CircleTimes]", "z"}]}]], "Output",
 CellChangeTimes->{{3.6502280909077377`*^9, 3.6502281530911083`*^9}, 
   3.653816120536415*^9, 3.653816371104944*^9}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.6502280909077377`*^9, 3.6502281530911083`*^9}, 
   3.653816120536415*^9, 3.6538163711112432`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6502280909077377`*^9, 3.6502281530911083`*^9}, 
   3.653816120536415*^9, 3.653816371115719*^9}]
}, Open  ]],

Cell["\<\
Derivatives of fields with declared symmetry are treated as having declared \
symmetries:\
\>", "Text",
 CellChangeTimes->{{3.613990162987905*^9, 3.613990170747202*^9}, 
   3.6150182268394737`*^9, {3.622696617813946*^9, 3.6226966183254747`*^9}, {
   3.622696841575492*^9, 3.62269684197436*^9}, {3.622696938706744*^9, 
   3.622696949926867*^9}, 3.649826612919754*^9, {3.649826694118338*^9, 
   3.649826730453683*^9}, {3.649832928787816*^9, 3.6498329592995*^9}}],

Cell["\<\
D[ ] is to be replaced by my pD[ ]  and should never be needed (except \
perhaps to work out new  pD[ ]  definitions for special funtions). 
However,  Derivative[ ][ ]  can be useful as an unevaluated prime notation \
for  \[GothicCapitalD] ,\
\>", "Text",
 CellChangeTimes->{{3.6226966278135*^9, 3.622696700693904*^9}, {
   3.622696756566416*^9, 3.622696807782342*^9}, {3.6226969658947563`*^9, 
   3.622696968934803*^9}, {3.649704293651821*^9, 3.64970446409743*^9}, 
   3.649705685713163*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AntisymQ", "[", 
   RowBox[{
    RowBox[{"Derivative", "[", "__", "]"}], "[", 
    RowBox[{"X_", "?", "AntisymQ"}], "]"}], "]"}], ":=", "True"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.613985961057176*^9, 3.6139860032705317`*^9}, {
   3.614035175509975*^9, 3.614035184147938*^9}, {3.61423057494766*^9, 
   3.61423057560077*^9}, {3.623111415627927*^9, 3.6231114346031313`*^9}, 
   3.64970447666371*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymQ", "[", 
   RowBox[{
    RowBox[{"Derivative", "[", "__", "]"}], "[", 
    RowBox[{"X_", "?", "SymQ"}], "]"}], "]"}], ":=", "True"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.613986026055685*^9, 3.613986030983519*^9}, {
   3.6140351779815283`*^9, 3.6140351852520037`*^9}, {3.614230688891934*^9, 
   3.614230689555746*^9}, {3.623111406908204*^9, 3.623111411244768*^9}, 
   3.649704479193632*^9}],

Cell["The proper-distance derivative  \[GothicCapitalD][  ] ,", "Text",
 CellChangeTimes->{{3.6226966278135*^9, 3.622696748166049*^9}, {
  3.622696820278234*^9, 3.622696835478401*^9}, {3.6226973818967457`*^9, 
  3.622697520921729*^9}, {3.6226976756740723`*^9, 3.62269778679458*^9}, {
  3.649826865428771*^9, 3.649826866148554*^9}, {3.649826917812004*^9, 
  3.6498269394912977`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AntisymQ", "[", 
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"X_", "?", "AntisymQ"}], "]"}], "]"}], ":=", 
  "True"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AntisymQ", "[", 
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{
     RowBox[{"X_", "?", "AntisymQ"}], ",", "_"}], "]"}], "]"}], ":=", 
  "True"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.613985961057176*^9, 3.6139860032705317`*^9}, {
  3.614035175509975*^9, 3.614035184147938*^9}, {3.61423057494766*^9, 
  3.61423057560077*^9}, {3.622696998028468*^9, 3.622697067275536*^9}, {
  3.622697098329221*^9, 3.6226971140311823`*^9}, {3.6498269044714527`*^9, 
  3.6498269134006577`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SymQ", "[", 
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"X_", "?", "SymQ"}], "]"}], "]"}], ":=", 
  "True"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SymQ", "[", 
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{
     RowBox[{"X_", "?", "SymQ"}], ",", "_"}], "]"}], "]"}], ":=", 
  "True"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.613985961057176*^9, 3.6139860032705317`*^9}, {
   3.614035175509975*^9, 3.614035184147938*^9}, {3.61423057494766*^9, 
   3.61423057560077*^9}, {3.622696998028468*^9, 3.622697067275536*^9}, {
   3.622697098329221*^9, 3.6226971140311823`*^9}, {3.6231112490963593`*^9, 
   3.623111257915244*^9}, 3.649826930839634*^9}],

Cell["\<\
The partial derivative  pD[  ] .  Note that  pD[ ]  is the identity on single \
arguments,  \
\>", "Text",
 CellChangeTimes->{{3.6226966278135*^9, 3.622696748166049*^9}, {
  3.622696820278234*^9, 3.622696835478401*^9}, {3.6226973818967457`*^9, 
  3.622697520921729*^9}, {3.6226976756740723`*^9, 3.62269778679458*^9}, {
  3.649826865428771*^9, 3.649826866148554*^9}, {3.649826917812004*^9, 
  3.649826953187468*^9}, {3.649837252969822*^9, 3.64983731066486*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AntisymQ", "[", 
   RowBox[{"pD", "[", 
    RowBox[{
     RowBox[{"X_", "?", "AntisymQ"}], ",", "__"}], "]"}], "]"}], ":=", 
  "True"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.613985961057176*^9, 3.6139860032705317`*^9}, {
  3.614035175509975*^9, 3.614035184147938*^9}, {3.61423057494766*^9, 
  3.61423057560077*^9}, {3.622696998028468*^9, 3.622697067275536*^9}, {
  3.622697098329221*^9, 3.6226971140311823`*^9}, {3.6498269044714527`*^9, 
  3.6498269134006577`*^9}, {3.649826958134364*^9, 3.649826962150017*^9}, {
  3.649837141072953*^9, 3.6498371451332808`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymQ", "[", 
   RowBox[{"pD", "[", 
    RowBox[{
     RowBox[{"X_", "?", "SymQ"}], ",", "__"}], "]"}], "]"}], ":=", 
  "True"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.613985961057176*^9, 3.6139860032705317`*^9}, {
   3.614035175509975*^9, 3.614035184147938*^9}, {3.61423057494766*^9, 
   3.61423057560077*^9}, {3.622696998028468*^9, 3.622697067275536*^9}, {
   3.622697098329221*^9, 3.6226971140311823`*^9}, {3.6231112490963593`*^9, 
   3.623111257915244*^9}, 3.649826930839634*^9, {3.649826967478097*^9, 
   3.649826971190194*^9}, 3.649837149325288*^9, 3.649837179709816*^9}],

Cell[TextData[{
 "The directional derivative,  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Del]", "v"], "X"}], TraditionalForm]]],
 " , "
}], "Text",
 CellChangeTimes->{{3.6226966278135*^9, 3.622696748166049*^9}, {
  3.622696820278234*^9, 3.622696835478401*^9}, {3.6226973818967457`*^9, 
  3.622697520921729*^9}, {3.6226976756740723`*^9, 3.62269778679458*^9}, {
  3.649826865428771*^9, 3.649826866148554*^9}, {3.649826917812004*^9, 
  3.649826953187468*^9}, {3.649827007122848*^9, 3.649827067137871*^9}, {
  3.64982712017708*^9, 3.6498271205292892`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AntisymQ", "[", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[Del]", 
      RowBox[{"(", 
       RowBox[{"X_", "?", "AntisymQ"}], ")"}]}], ",", 
     RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "]"}], ":=", 
  "True"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649827118098925*^9, 3.6498271859072113`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SymQ", "[", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[Del]", 
      RowBox[{"(", 
       RowBox[{"X_", "?", "SymQ"}], ")"}]}], ",", 
     RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "]"}], ":=", 
  "True"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6498272080224447`*^9, 3.649827212402289*^9}}],

Cell["\<\
When partial symmetries are introduced, there should also be rules for the \
gradient  \[Del]X .\
\>", "Text",
 CellChangeTimes->{{3.649827251887257*^9, 3.6498273353266897`*^9}}],

Cell["A general test for symmetry,", "Text",
 CellChangeTimes->{{3.649833011330554*^9, 3.649833023698985*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"HasSymQ", "[", "X_", "]"}], ":=", 
  RowBox[{
   RowBox[{"AntisymQ", "[", "X", "]"}], "||", 
   RowBox[{"SymQ", "[", "X", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HasSymQ", "[", "X__", "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"And", ",", 
    RowBox[{"Map", "[", 
     RowBox[{"HasSymQ", ",", 
      RowBox[{"{", "X", "}"}]}], "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615074651085396*^9, 3.615074703136807*^9}, {
   3.61507750321348*^9, 3.615077507260771*^9}, {3.61674004555344*^9, 
   3.616740119021782*^9}, {3.649736291144725*^9, 3.6497362974005537`*^9}, {
   3.649743997212097*^9, 3.649744037564673*^9}, {3.649744098628327*^9, 
   3.649744100144492*^9}, {3.6498028124410133`*^9, 3.649802814579805*^9}, 
   3.64981423619244*^9}],

Cell["\<\

The action of  mv  on a tensor with symmetry,\
\>", "Text",
 CellChangeTimes->{{3.615018256551462*^9, 3.615018279656267*^9}, 
   3.615018556600965*^9, {3.64982705089802*^9, 3.6498270612522*^9}, {
   3.649827347981765*^9, 3.6498273494701014`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"mv", "[", "n__", "]"}], "[", 
    RowBox[{"X_", "?", "SymQ"}], "]"}], ":=", "X"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"mv", "[", "n__", "]"}], "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"X_", "?", "SymQ"}], ")"}], "[", "s__", "]"}], "]"}], ":=", 
   RowBox[{"X", "[", "s", "]"}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.613261611671962*^9, 3.613261654052648*^9}, {
  3.613983585734869*^9, 3.6139835926655397`*^9}, {3.615018524094647*^9, 
  3.615018524941818*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "68", "]"}]], "Output"],

Cell[BoxData[
 RowBox[{"rule", "[", "69", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"mv", "[", "n__", "]"}], "[", 
    RowBox[{"X_", "?", "AntisymQ"}], "]"}], ":=", 
   RowBox[{"X", "  ", 
    RowBox[{"mvSignature", "[", "n", "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"mv", "[", "n__", "]"}], "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"X_", "?", "AntisymQ"}], ")"}], "[", "s__", "]"}], "]"}], ":=", 
   
   RowBox[{
    RowBox[{"X", "[", "s", "]"}], "  ", 
    RowBox[{"mvSignature", "[", "n", "]"}]}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6132616752544613`*^9, 3.613261690807156*^9}, {
  3.613983586576886*^9, 3.613983593498746*^9}, {3.6150177625264387`*^9, 
  3.615017765739893*^9}, {3.615018305998333*^9, 3.6150183406249647`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "70", "]"}]], "Output"],

Cell[BoxData[
 RowBox[{"rule", "[", "71", "]"}]], "Output"]
}, Open  ]],

Cell["11/09/2015,", "Text",
 CellChangeTimes->{{3.6509622222887907`*^9, 3.650962226081094*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"AntisymQ", "[", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
        RowBox[{"X_", "/;", 
         RowBox[{
          RowBox[{"FieldLikeQ", "[", "X", "]"}], "&&", 
          RowBox[{"deg2Q", "[", "X", "]"}]}]}], ",", "\[CurlyEpsilon]4"}], 
       "\[RightAngleBracket]"}], "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]], "]"}], ":=", "True"}], "]"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.650961985646675*^9, 3.650962107203052*^9}, {
  3.650962139346945*^9, 3.6509621649152327`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "72", "]"}]], "Output"]
}, Open  ]],

Cell["11/11/2015.  To allow for raising and lowering by metric,", "Text",
 CellChangeTimes->{{3.6509622222887907`*^9, 3.650962226081094*^9}, {
  3.656183979941989*^9, 3.6561840224370823`*^9}, {3.656184264129778*^9, 
  3.656184294913225*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"SymQ", "[", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"g_", "?", "SymQ"}], ",", 
       RowBox[{"X_", "?", "SymQ"}], ",", 
       RowBox[{"g_", "?", "SymQ"}]}], "\[RightAngleBracket]"}], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"deg", "[", "g", "]"}], "===", "2"}], "&&", 
      RowBox[{
       RowBox[{"deg", "[", "X", "]"}], "===", "2"}]}]}], "]"}], ":=", 
   "True"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650961985646675*^9, 3.650962107203052*^9}, {
  3.650962139346945*^9, 3.6509621649152327`*^9}, {3.656184315953124*^9, 
  3.656184427983474*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "73", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"AntisymQ", "[", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"g_", "?", "SymQ"}], ",", 
       RowBox[{"X_", "?", "AntisymQ"}], ",", 
       RowBox[{"g_", "?", "SymQ"}]}], "\[RightAngleBracket]"}], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"deg", "[", "g", "]"}], "===", "2"}], "&&", 
      RowBox[{
       RowBox[{"deg", "[", "X", "]"}], "===", "2"}]}]}], "]"}], ":=", 
   "True"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650961985646675*^9, 3.650962107203052*^9}, {
  3.650962139346945*^9, 3.6509621649152327`*^9}, {3.656184315953124*^9, 
  3.656184427983474*^9}, {3.6561844600150137`*^9, 3.6561844688466797`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "74", "]"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Declaring a tensor symmetric                                                  \
                             ---  AddRule  is on all rules.    \
\>", "Subsection",
 CellChangeTimes->{{3.6117004172917347`*^9, 3.611700487110237*^9}, {
   3.611700901848016*^9, 3.611701130920413*^9}, {3.611701234361413*^9, 
   3.611701302550877*^9}, {3.611701786139716*^9, 3.6117017862152348`*^9}, {
   3.61170200910107*^9, 3.6117020329203777`*^9}, 3.611996273648815*^9, {
   3.6119963087668657`*^9, 3.611996325229361*^9}, {3.612145566621338*^9, 
   3.61214560729216*^9}, {3.612145987296035*^9, 3.612146026046085*^9}, {
   3.613115509619932*^9, 3.613115518386891*^9}, {3.613982720587635*^9, 
   3.613982722989057*^9}, {3.613983515648406*^9, 3.6139835196812487`*^9}, {
   3.6152535888541927`*^9, 3.6152535919996853`*^9}, 3.615254082496846*^9, {
   3.649540180322996*^9, 3.649540180482896*^9}, 3.65531927265067*^9}],

Cell["\<\
We should also allow for symmetry declarations on specified slots of a \
tensor.   At the moment only fully symmetric tensors are considered.\
\>", "Text",
 CellChangeTimes->{{3.615276974772485*^9, 3.615277034645142*^9}, {
  3.615277095733205*^9, 3.6152771348532333`*^9}}],

Cell[CellGroupData[{

Cell["AssumeSymmetric[ ],   ForgetAssumeSymmetric[ ]", "Subsubsection",
 CellChangeTimes->{{3.615277043892955*^9, 3.615277069589961*^9}, {
   3.6556638576657343`*^9, 3.655663859209412*^9}, 3.655663936016262*^9}],

Cell["\<\
By returning a string instead of using  Print[ ],  we can suppress output by \
terminating with ; . 
To get nice output from the mapped call, use Column,  \
\>", "Text",
 CellChangeTimes->{{3.6124918371870403`*^9, 3.6124919294795427`*^9}, {
  3.6131777413028584`*^9, 3.6131777415736113`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AssumeSymmetric", "[", "X_List", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AssumeSymmetric", "[", "#", "]"}], "&"}], ",", "X"}], "]"}], "//",
     "Column"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ForgetAssumeSymmetric", "[", "X_List", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ForgetAssumeSymmetric", "[", "#", "]"}], "&"}], ",", "X"}], 
     "]"}], "//", "Column"}], ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612229992128016*^9, 3.612230025059886*^9}, {
   3.612231475357093*^9, 3.612231527517959*^9}, 3.6122316124149513`*^9, {
   3.612231936415811*^9, 3.612231951477086*^9}, {3.612491702414846*^9, 
   3.612491719767754*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AssumeSymmetric", "[", 
   RowBox[{"X_", "/;", 
    RowBox[{"!", 
     RowBox[{
      RowBox[{"Head", "[", "X", "]"}], "===", "List"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "msg", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{
           RowBox[{"FieldType", "[", "X", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "===", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"msg", "=", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
           "\"\<AssumeSymmetric: \>\"", ",", "X", ",", 
            "\"\< has slots of mixed type, FieldType[\>\"", ",", "X", ",", 
            "\"\<]\[MediumSpace]=\[ThickSpace]\>\"", ",", 
            RowBox[{"FieldType", "[", "X", "]"}], ",", 
            "\"\<, so can not be declared fully symmetric.\>\""}], "}"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "msg", "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"AntisymQ", "[", "X", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Tensor \>\"", ",", "X", ",", 
          "\"\< is already declared antisymmetric.\>\""}], "]"}], ";", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<AssumeSymmetric: To re-declare \>\"", ",", "X", ",", 
          "\"\< as symmetric, first use either \
ForgetAssumeAntisymmetric[\>\"", ",", "X", ",", "\"\<] or ClearField[\>\"", 
          ",", "X", ",", "\"\<].\>\""}], " ", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", 
         RowBox[{"deg", "[", "X", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<AssumeSymmetric: deg[\>\"", ",", "X", ",", 
          "\"\<] does not evaluate to an integer. See  ? NewField  for \
declaring the degree of a tensor field.\>\""}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"deg", "[", "X", "]"}], ">", "1"}], ",", 
       RowBox[{
        RowBox[{"SymQ", "[", "X", "]"}], "=", "True"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"deg", "[", "X", "]"}], "===", "0"}], "||", " ", 
        RowBox[{
         RowBox[{"deg", "[", "X", "]"}], "===", "1"}]}], ",", 
       RowBox[{
       "msg", "=", 
        "\"\<By definition, SymQ[X] = False  and  AntisymQ[X] = False  for \
any X of degree 0 or 1.\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"deg", "[", "X", "]"}], "===", "2"}], ",", 
       RowBox[{"msg", "=", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<The degree \[VeryThinSpace]\>\"", ",", 
           RowBox[{"deg", "[", "X", "]"}], ",", "\"\< tensor field \>\"", ",",
            "X", ",", "\"\< is now assumed to be symmetric.\>\""}], "}"}], 
         "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"deg", "[", "X", "]"}], ">", "2"}], ",", 
       RowBox[{"msg", "=", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<The degree \[VeryThinSpace]\>\"", ",", 
           RowBox[{"deg", "[", "X", "]"}], ",", "\"\< tensor field \>\"", ",",
            "X", ",", "\"\< is now assumed to be fully symmetric.\>\""}], 
          "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", "msg"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612131275685307*^9, 3.612131362690638*^9}, {
   3.6121314170590963`*^9, 3.6121315206632566`*^9}, {3.612131567703618*^9, 
   3.6121317362152987`*^9}, {3.6121317675108356`*^9, 
   3.6121317801045856`*^9}, {3.612131819573062*^9, 3.612131825475898*^9}, {
   3.612131897813253*^9, 3.612131909910613*^9}, {3.612133597180396*^9, 
   3.612133817688952*^9}, {3.6121338591140127`*^9, 3.612133899930686*^9}, {
   3.612141200458763*^9, 3.612141316764625*^9}, 3.612141348412816*^9, 
   3.61214141113457*^9, {3.612141540052064*^9, 3.612141652056589*^9}, {
   3.612141690058359*^9, 3.612141720037983*^9}, {3.612141769273343*^9, 
   3.6121418699492292`*^9}, {3.612141939768426*^9, 3.612141969217457*^9}, {
   3.6121420186575317`*^9, 3.612142271127427*^9}, 3.612142330057331*^9, {
   3.6121423913056583`*^9, 3.6121425034375477`*^9}, {3.6121426575042477`*^9, 
   3.612142674305335*^9}, {3.6121429435993013`*^9, 3.612143071637199*^9}, 
   3.612143834058402*^9, {3.612143884274171*^9, 3.612143982812853*^9}, {
   3.612144015596409*^9, 3.612144020571937*^9}, {3.612151496676177*^9, 
   3.612151518684782*^9}, {3.612151558286539*^9, 3.612151615305161*^9}, {
   3.612151652807845*^9, 3.6121516770305223`*^9}, {3.612151715696498*^9, 
   3.61215172589299*^9}, {3.6121518758795967`*^9, 3.6121518853159857`*^9}, {
   3.612152118079082*^9, 3.612152126050218*^9}, {3.6121521566779118`*^9, 
   3.612152224236055*^9}, {3.612153935684826*^9, 3.612153942643235*^9}, {
   3.6121540640361357`*^9, 3.612154065361722*^9}, {3.612154139170847*^9, 
   3.612154141471779*^9}, {3.612229798845441*^9, 3.612229806126741*^9}, {
   3.6122298426209784`*^9, 3.6122299729143887`*^9}, {3.612230137940304*^9, 
   3.612230196273549*^9}, {3.612230492057967*^9, 3.6122305524180527`*^9}, {
   3.61223059424319*^9, 3.6122306605145483`*^9}, {3.612230694004448*^9, 
   3.612230712791893*^9}, {3.6122314159111557`*^9, 3.612231439064382*^9}, {
   3.612231632008478*^9, 3.612231644304049*^9}, {3.6122320278171263`*^9, 
   3.61223203527989*^9}, {3.612232948977992*^9, 3.612232952592038*^9}, {
   3.612237517712137*^9, 3.6122375191441927`*^9}, 3.612238053245146*^9, {
   3.612491087477174*^9, 3.61249109850674*^9}, {3.612491206094294*^9, 
   3.6124912203821573`*^9}, {3.612557116105966*^9, 3.612557141664523*^9}, {
   3.612557185364235*^9, 3.612557366352089*^9}, {3.612570087636147*^9, 
   3.6125701222319813`*^9}, 3.6126020228599787`*^9, {3.612864153273446*^9, 
   3.612864186530684*^9}, {3.613119512974667*^9, 3.613119524839662*^9}, {
   3.613168039447369*^9, 3.6131681068669167`*^9}, {3.6131697359093323`*^9, 
   3.613169740049679*^9}, {3.61317074009016*^9, 3.6131707455309143`*^9}, {
   3.613173949912013*^9, 3.613173974903132*^9}, 3.613174013382576*^9, 
   3.6131760311563873`*^9, {3.613186016641634*^9, 3.613186020998625*^9}, {
   3.613188916496208*^9, 3.613188960680421*^9}, {3.613189005287237*^9, 
   3.613189010744487*^9}, 3.614230580460964*^9, 3.614230694377452*^9, {
   3.6150683812512617`*^9, 3.615068406176722*^9}, {3.615068446726306*^9, 
   3.615068492797282*^9}, {3.615068538354657*^9, 3.6150687367376003`*^9}, 
   3.6150688111826982`*^9, {3.6150688550223227`*^9, 3.615068883250267*^9}, {
   3.61506904154237*^9, 3.6150690681787767`*^9}, {3.615069177380055*^9, 
   3.615069194676824*^9}, {3.615069723025878*^9, 3.615069732071063*^9}, {
   3.615069783898728*^9, 3.615069819700713*^9}, {3.615069892196702*^9, 
   3.615069904653981*^9}, {3.6498374022904377`*^9, 3.6498375326553583`*^9}, 
   3.649838309255125*^9, {3.649838724752285*^9, 3.6498387338550377`*^9}, 
   3.649838780747486*^9, 3.649839273229723*^9, {3.655629830996797*^9, 
   3.655629857586625*^9}, {3.655662576680895*^9, 3.655662736632872*^9}, {
   3.655662838983321*^9, 3.65566313101154*^9}, {3.655663165474971*^9, 
   3.655663218834283*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ForgetAssumeSymmetric", "[", 
   RowBox[{"X_", "/;", 
    RowBox[{"!", 
     RowBox[{
      RowBox[{"Head", "[", "X", "]"}], "===", "List"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"u", ",", "msg"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"SymQ", "[", "X", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"msg", "=", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
           "\"\<No change made: Tensor field \>\"", ",", "X", ",", 
            "\"\< was not symmetric.\>\""}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "msg", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SymQ", "[", "X", "]"}], "=."}], ";", "\[IndentingNewLine]", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Tensor field \>\"", ",", "X", ",", 
        "\"\< is no longer assumed to be symmetric.\>\""}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612146461318947*^9, 3.61214647150817*^9}, {
   3.6121465060408373`*^9, 3.612146601259465*^9}, {3.612152278287436*^9, 
   3.612152289157095*^9}, {3.612153921645578*^9, 3.612153931068001*^9}, {
   3.6121546026656113`*^9, 3.612154649779387*^9}, 3.612207081226246*^9, 
   3.6122321678808603`*^9, {3.612232225492456*^9, 3.61223235384398*^9}, 
   3.612258052182589*^9, {3.612258314408064*^9, 3.612258327429167*^9}, {
   3.612258475916232*^9, 3.612258485289953*^9}, {3.612491262712932*^9, 
   3.612491425001212*^9}, {3.61257017486652*^9, 3.6125702127753677`*^9}, 
   3.6126020034091187`*^9, {3.612864301163994*^9, 3.6128643129286346`*^9}, {
   3.612865447927987*^9, 3.6128654737552834`*^9}, {3.613168132049797*^9, 
   3.6131681575148*^9}, 3.613170604228388*^9, {3.6131708937988033`*^9, 
   3.613170902487629*^9}, {3.613171017975389*^9, 3.6131710214816093`*^9}, {
   3.613193924171109*^9, 3.61319395041433*^9}, {3.613194058108086*^9, 
   3.613194272308173*^9}, {3.613195119385159*^9, 3.613195121318495*^9}, {
   3.6142307097801857`*^9, 3.6142307198217077`*^9}, 3.649838414231751*^9, {
   3.6498384698353662`*^9, 3.64983856653111*^9}, {3.649839446405806*^9, 
   3.6498394502295713`*^9}, {3.655663340240439*^9, 3.655663426239272*^9}, {
   3.655663811898323*^9, 3.655663823034308*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Simplification:  The induced symmetry on  mv[ ]  allows partial sorting of \
the slot sequence in  mv[ ]\
\>", "Subsubsection",
 CellChangeTimes->{{3.613189126068007*^9, 3.613189144692054*^9}, {
   3.615276810500452*^9, 3.615276919764772*^9}, {3.615279475549217*^9, 
   3.6152794803172207`*^9}, 3.655663856665841*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"mv", "[", "n__", "]"}], "[", 
     RowBox[{"Y1___", "\[CircleTimes]", 
      RowBox[{"(", 
       RowBox[{"X_", "?", "SymQ"}], ")"}], "\[CircleTimes]", "Y2___"}], "]"}],
     "/;", 
    RowBox[{
     RowBox[{"IntegerQ", "[", 
      RowBox[{"deg", "[", "X", "]"}], "]"}], "&&", 
     RowBox[{"!", 
      RowBox[{"PartiallySortedQ", "[", 
       RowBox[{
        RowBox[{"{", "n", "}"}], ",", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], "+", 
         RowBox[{"Range", "[", 
          RowBox[{"deg", "[", "X", "]"}], "]"}]}]}], "]"}]}]}]}], ":=", 
   RowBox[{
    RowBox[{"mv", "[", 
     RowBox[{"PartiallySort", "[", 
      RowBox[{
       RowBox[{"{", "n", "}"}], ",", 
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", 
        RowBox[{"Range", "[", 
         RowBox[{"deg", "[", "X", "]"}], "]"}]}]}], "]"}], "]"}], "[", 
    RowBox[{"Y1", "\[CircleTimes]", "X", "\[CircleTimes]", "Y2"}], "]"}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.613171101923752*^9, 3.613171133720441*^9}, {
  3.613174196417557*^9, 3.61317421278447*^9}, {3.613177898731756*^9, 
  3.613177943921829*^9}, {3.6131891635097857`*^9, 3.613189211935176*^9}, {
  3.6131923585075274`*^9, 3.6131923703650703`*^9}, {3.613982744916315*^9, 
  3.6139827582957363`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "75", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"mv", "[", "n__", "]"}], "[", 
     RowBox[{"Y1___", "\[CircleTimes]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X_", "?", "SymQ"}], ")"}], "[", "s__", "]"}], 
      "\[CircleTimes]", "Y2___"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"IntegerQ", "[", 
      RowBox[{"deg", "[", 
       RowBox[{"X", "[", "s", "]"}], "]"}], "]"}], "&&", 
     RowBox[{"!", 
      RowBox[{"PartiallySortedQ", "[", 
       RowBox[{
        RowBox[{"{", "n", "}"}], ",", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], "+", 
         RowBox[{"Range", "[", 
          RowBox[{"deg", "[", 
           RowBox[{"X", "[", "s", "]"}], "]"}], "]"}]}]}], "]"}]}]}]}], ":=", 
   
   RowBox[{
    RowBox[{"mv", "[", 
     RowBox[{"PartiallySort", "[", 
      RowBox[{
       RowBox[{"{", "n", "}"}], ",", 
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", 
        RowBox[{"Range", "[", 
         RowBox[{"deg", "[", 
          RowBox[{"X", "[", "s", "]"}], "]"}], "]"}]}]}], "]"}], "]"}], "[", 
    RowBox[{"Y1", "\[CircleTimes]", 
     RowBox[{"X", "[", "s", "]"}], "\[CircleTimes]", "Y2"}], "]"}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.613189225458022*^9, 3.613189263039609*^9}, 
   3.6131895078647423`*^9, {3.613192330701354*^9, 3.613192348337162*^9}, 
   3.613192385584453*^9, {3.613982752495343*^9, 3.613982760833002*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "76", "]"}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "\nStarting from the begining of  x,  replace those  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["x", "j"], "\[Element]", " ", "y"}], TraditionalForm]]],
 "  with the elements of  Sort[ y ],  using up the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["y", "j"], TraditionalForm]]],
 " in sorted order, "
}], "Text",
 CellChangeTimes->{{3.6121342032239857`*^9, 3.612134419896821*^9}, {
   3.612134460473423*^9, 3.6121347383779287`*^9}, {3.612134864571595*^9, 
   3.612134868666189*^9}, {3.612135304732473*^9, 3.612135305195223*^9}, {
   3.6121354678395157`*^9, 3.612135487932315*^9}, {3.612135561231407*^9, 
   3.61213557233228*^9}, 3.6121356116446457`*^9, {3.6121356448446417`*^9, 
   3.6121356887170687`*^9}, {3.612135730942196*^9, 3.6121358855014133`*^9}, {
   3.612135953839075*^9, 3.612136033470812*^9}, {3.612136063507638*^9, 
   3.612136093884701*^9}, {3.612136136383819*^9, 3.6121361446070347`*^9}, {
   3.6121425516152563`*^9, 3.612142635310829*^9}, 3.615018650409807*^9}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "PartiallySort", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PartiallySort", "[", 
   RowBox[{"x_List", ",", "y_List"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s", ",", "imax", ",", "z", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s", " ", "=", " ", 
      RowBox[{"Sort", "[", "y", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"imax", "=", 
      RowBox[{"Length", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", "x"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"y", ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"z", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"First", "[", "s", "]"}]}], ";", 
           RowBox[{"s", "=", 
            RowBox[{"Rest", "[", "s", "]"}]}]}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"s", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"{", 
        RowBox[{"i", ",", "imax"}], "}"}]}], " ", "]"}], ";", 
     "\[IndentingNewLine]", "z"}]}], "]"}]}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Do[ ] variables must be module variables",
  FontWeight->"Bold"],
 " "
}], "Text"],

Cell["\<\
The following example shows that Do[ ] variables must be declared as module \
variables,\
\>", "Text"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"fred1", ",", "fred2"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fred1", "[", "x_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"y", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"y", "=", 
        RowBox[{"x", "+", "i"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2"}], "}"}]}], "]"}], ";", "y"}]}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fred2", "[", "x_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "y", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"y", "=", 
        RowBox[{"x", "+", "i"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2"}], "}"}]}], "]"}], ";", "y"}]}], 
   "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"{", 
  RowBox[{
   RowBox[{"i", "=."}], ",", 
   RowBox[{"fred1", "[", "i", "]"}], ",", "i"}], "}"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"i", "=."}], ",", 
   RowBox[{"fred2", "[", "i", "]"}], ",", "i"}], "}"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Null", ",", 
   RowBox[{"2", "+", "i"}], ",", "i"}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Null", ",", "4", ",", "i"}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"fred1", ",", "fred2", ",", "x", ",", "i"}], "]"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Table[ ] variables must be module variables",
  FontWeight->"Bold"],
 " "
}], "Text"],

Cell["\<\
The following example shows that Table[ ] variables must be declared as \
module variables,\
\>", "Text"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"fred1", ",", "fred2"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fred1", "[", "x_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "i", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"x", "+", "i"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "2"}], "}"}]}], "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fred2", "[", "x_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"x", "+", "i"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "2"}], "}"}]}], "]"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"{", 
  RowBox[{
   RowBox[{"i", "=."}], ",", 
   RowBox[{"fred1", "[", "i", "]"}], ",", "i"}], "}"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"i", "=."}], ",", 
   RowBox[{"fred2", "[", "i", "]"}], ",", "i"}], "}"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Null", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "+", "i"}], ",", 
     RowBox[{"2", "+", "i"}]}], "}"}], ",", "i"}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Null", ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], ",", "i"}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"fred1", ",", "fred2", ",", "x", ",", "i"}], "]"}]], "Input"]
}, Open  ]],

Cell["\<\
The  mv[ ]  rule was debugged by adding the line   Print[ x, \
\[CloseCurlyDoubleQuote]  \[OpenCurlyDoubleQuote], y ] ;   as the first line \
of the following module, \
\>", "Text",
 CellChangeTimes->{{3.6121342032239857`*^9, 3.612134419896821*^9}, {
   3.612134460473423*^9, 3.6121347383779287`*^9}, {3.612134864571595*^9, 
   3.612134868666189*^9}, {3.612135304732473*^9, 3.612135305195223*^9}, {
   3.6121354678395157`*^9, 3.612135487932315*^9}, {3.612135561231407*^9, 
   3.61213557233228*^9}, 3.6121356116446457`*^9, {3.6121356448446417`*^9, 
   3.6121356887170687`*^9}, {3.612135730942196*^9, 3.6121358855014133`*^9}, {
   3.612135953839075*^9, 3.612136033470812*^9}, {3.612136063507638*^9, 
   3.612136093884701*^9}, {3.612136136383819*^9, 3.6121361446070347`*^9}, {
   3.6121425516152563`*^9, 3.612142635310829*^9}, {3.6121584274461813`*^9, 
   3.6121584938028173`*^9}, {3.612158718279274*^9, 3.612158738646592*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "PartiallySortedQ", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PartiallySortedQ", "[", 
   RowBox[{"x_List", ",", "y_List"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s", ",", "i", ",", "imax"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"s", " ", "=", " ", 
      RowBox[{"Sort", "[", "y", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"imax", "=", 
      RowBox[{"Length", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"i", " ", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"s", "===", 
          RowBox[{"{", "}"}]}]}], "&&", " ", 
        RowBox[{"i", "\[LessEqual]", "imax"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"y", ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "===", 
              RowBox[{"First", "[", "s", "]"}]}]}], ",", 
            RowBox[{"Return", "[", "False", "]"}], ",", 
            RowBox[{"s", "=", 
             RowBox[{"Rest", "[", "s", "]"}]}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i", "++"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "True"}]}], "]"}]}]}], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{"Clear", "[", "PartiallySortedQdebug", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PartiallySortedQdebug", "[", 
   RowBox[{"x_List", ",", "y_List"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s", ",", "i", ",", "imax"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"x", ",", "\"\< \>\"", ",", "y"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"s", " ", "=", " ", 
      RowBox[{"Sort", "[", "y", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"imax", "=", 
      RowBox[{"Length", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"i", " ", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"!", 
         RowBox[{"s", "===", 
          RowBox[{"{", "}"}]}]}], "&&", " ", 
        RowBox[{"i", "\[LessEqual]", "imax"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"y", ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "===", 
              RowBox[{"First", "[", "s", "]"}]}]}], ",", 
            RowBox[{"Return", "[", "False", "]"}], ",", 
            RowBox[{"s", "=", 
             RowBox[{"Rest", "[", "s", "]"}]}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i", "++"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "True"}]}], "]"}]}]}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing", "Subsubsection",
 CellChangeTimes->{{3.61501868370548*^9, 3.615018685290142*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"PartiallySort", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "5", ",", "6", ",", "3", ",", "5", ",", "7", ",", "4", ",", "2", ",", "9",
      ",", "6", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5", ",", "2", ",", "2"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"PartiallySortedQ", "[", 
  RowBox[{"%", ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5", ",", "2", ",", "2"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6121376105214033`*^9, 3.612137686002305*^9}, {
  3.612140701154697*^9, 3.612140723714141*^9}, {3.612154020288477*^9, 
  3.6121540206397533`*^9}, {3.612228667893014*^9, 3.612228668658317*^9}, {
  3.613186853190638*^9, 3.613186865064479*^9}, {3.615277195197927*^9, 
  3.61527719723134*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2", ",", "6", ",", "3", ",", "2", ",", "7", ",", "4", ",", "5", ",", "9", 
   ",", "6", ",", "3", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{
  3.61318508148412*^9, 3.61318630650872*^9, 3.613186726513815*^9, 
   3.613186786061143*^9, {3.613186858700549*^9, 3.613186866956635*^9}, 
   3.615277207303596*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.61318508148412*^9, 3.61318630650872*^9, 3.613186726513815*^9, 
   3.613186786061143*^9, {3.613186858700549*^9, 3.613186866956635*^9}, 
   3.6152772073088093`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PartiallySort", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.61215747620263*^9, 3.6121574908735523`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6121570314987583`*^9, 3.612157167071937*^9, {3.612157482193766*^9, 
   3.612157491329789*^9}, 3.612228679158514*^9, 3.6122422335780993`*^9, 
   3.612244613244371*^9, 3.612245417570524*^9, 3.6122466023930273`*^9, 
   3.612246825908413*^9, 3.612257841682352*^9, 3.612263628670165*^9, 
   3.612336727297349*^9, 3.612420820120841*^9, 3.6126703195098352`*^9, 
   3.6126840025315332`*^9, 3.612686970988612*^9, 3.613186729708015*^9, 
   3.61318678738878*^9, 3.613194432525744*^9, 3.615277210103283*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AssumeSymmetric", "[", "X", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sym", "[", "]"}], "[", "X", "]"}]}], "Input",
 CellChangeTimes->{
  3.612141905967411*^9, {3.612228758223969*^9, 3.6122287598345213`*^9}, {
   3.612228940477942*^9, 3.612228944989191*^9}, 3.612232402753448*^9}],

Cell[BoxData["\<\"Tensor field \\!\\(X\\) with degree \[VeryThinSpace]2, is \
now assumed to be symmetric.\"\>"], "Output",
 CellChangeTimes->{
  3.612228761175291*^9, {3.6122323903137827`*^9, 3.6122324039338903`*^9}, 
   3.612242233586793*^9, 3.612244613252577*^9, 3.612245417643477*^9, 
   3.612246602404237*^9, 3.6122468259790783`*^9, 3.612257841693152*^9, 
   3.612257895225788*^9, 3.612258675067129*^9, 3.612263628677113*^9, 
   3.612336727406868*^9, 3.612420821775371*^9, 3.612670319562785*^9, 
   3.612684002573922*^9, 3.61268697112005*^9, 3.613194444236394*^9, 
   3.615277212663766*^9}],

Cell[BoxData["X"], "Output",
 CellChangeTimes->{
  3.612228761175291*^9, {3.6122323903137827`*^9, 3.6122324039338903`*^9}, 
   3.612242233586793*^9, 3.612244613252577*^9, 3.612245417643477*^9, 
   3.612246602404237*^9, 3.6122468259790783`*^9, 3.612257841693152*^9, 
   3.612257895225788*^9, 3.612258675067129*^9, 3.612263628677113*^9, 
   3.612336727406868*^9, 3.612420821775371*^9, 3.612670319562785*^9, 
   3.612684002573922*^9, 3.61268697112005*^9, 3.613194444236394*^9, 
   3.615277212669306*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ForgetAssumeSymmetric", "[", "X", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sym", "[", "]"}], "[", "X", "]"}]}], "Input",
 CellChangeTimes->{{3.612152013721839*^9, 3.6121520325067883`*^9}, {
   3.612154178518909*^9, 3.61215419605484*^9}, 3.612207155797328*^9, {
   3.6122287680886497`*^9, 3.61222876989937*^9}}],

Cell[BoxData["\<\"Tensor field \\!\\(X\\) is no longer assumed to be \
symmetric.\"\>"], "Output",
 CellChangeTimes->{
  3.6122287718132067`*^9, 3.6122324096815166`*^9, 3.6122422336511087`*^9, 
   3.612244613260154*^9, 3.6122454176522818`*^9, 3.612246602560934*^9, 
   3.612246825988574*^9, 3.612257841702271*^9, 3.612257897993482*^9, 
   3.6122580844553823`*^9, 3.612258677974038*^9, 3.612263628684745*^9, 
   3.6123367274180603`*^9, 3.61242082383209*^9, 3.612670319570623*^9, 
   3.61268400261967*^9, 3.6126869711319532`*^9, 3.613194447501552*^9, {
   3.6152772146955643`*^9, 3.615277226681066*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"X", "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.6122287718132067`*^9, 3.6122324096815166`*^9, 3.6122422336511087`*^9, 
   3.612244613260154*^9, 3.6122454176522818`*^9, 3.612246602560934*^9, 
   3.612246825988574*^9, 3.612257841702271*^9, 3.612257897993482*^9, 
   3.6122580844553823`*^9, 3.612258677974038*^9, 3.612263628684745*^9, 
   3.6123367274180603`*^9, 3.61242082383209*^9, 3.612670319570623*^9, 
   3.61268400261967*^9, 3.6126869711319532`*^9, 3.613194447501552*^9, {
   3.6152772146955643`*^9, 3.615277226686705*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing", "Subsubsection",
 CellChangeTimes->{{3.6150186094810123`*^9, 3.615018610873055*^9}}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", "X", "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"2", ",", "X"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumeSymmetric", "[", "X", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.615279429650165*^9, 3.615279432417877*^9}, {
   3.6152795236051903`*^9, 3.6152795255724382`*^9}, 3.615279556098653*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sym", "[", "]"}], "[", "X", "]"}]], "Input",
 CellChangeTimes->{{3.615279536961298*^9, 3.6152795384328327`*^9}}],

Cell[BoxData["X"], "Output",
 CellChangeTimes->{{3.6152795518876143`*^9, 3.6152795598079147`*^9}}]
}, Open  ]],

Cell["Should be 1x3 = 3 terms,", "Text",
 CellChangeTimes->{{3.6152795729414*^9, 3.6152795800296288`*^9}, {
  3.615282315449238*^9, 3.615282319161334*^9}, {3.615282388441587*^9, 
  3.615282389081451*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExpectedTiming", "[", 
  RowBox[{"0.02", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"sym", "[", "]"}], "[", 
     RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "//", "Simplify"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.6152762160892363`*^9, {3.615279543620598*^9, 3.615279546130858*^9}, {
   3.6152795888521767`*^9, 3.615279591672862*^9}, {3.615281322348124*^9, 
   3.61528136133856*^9}, {3.6152814541567917`*^9, 3.61528147017175*^9}, {
   3.615285997598559*^9, 3.615285998365059*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.03`", "\[InvisibleSpace]", "\<\"\[VeryThinSpace]\[VeryThinSpace]\
\[VeryThinSpace]sec, at \[VeryThinSpace]\[VeryThinSpace]\"\>", 
   "\[InvisibleSpace]", "\<\"2014-07-26 00:06\"\>", 
   "\[InvisibleSpace]", "\<\".\"\>"}],
  SequenceForm[
  0.03, "\[VeryThinSpace]\[VeryThinSpace]\[VeryThinSpace]sec, at \
\[VeryThinSpace]\[VeryThinSpace]", "2014-07-26 00:06", "."],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.615281362863058*^9, {3.615281433139122*^9, 3.6152814713903837`*^9}, 
   3.6152822603579082`*^9, 3.6152840677991953`*^9, 3.6152856553533173`*^9, {
   3.615285980488299*^9, 3.6152860000014*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "3"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"X", "\[CircleTimes]", "X"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "]"}], "[", 
     RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
     RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.615276216690434*^9, 3.615277253790783*^9, 3.6152773280756083`*^9, 
   3.615279446301877*^9, 3.615279561565112*^9, 3.61527959354912*^9, 
   3.615281362874504*^9, {3.6152814331553593`*^9, 3.61528147140224*^9}, 
   3.615282260364588*^9, 3.615284067906526*^9, 3.615285655360559*^9, {
   3.615285980669029*^9, 3.6152860001812963`*^9}}]
}, Open  ]],

Cell["Should be  1x3x5 = 15 terms,", "Text",
 CellChangeTimes->{{3.6152795729414*^9, 3.6152795800296288`*^9}, {
  3.615282306873349*^9, 3.615282384009673*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExpectedTiming", "[", 
  RowBox[{"1.18", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"sym", "[", "]"}], "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "//",
     "Simplify"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6131897924276237`*^9, 3.6131898242378683`*^9}, 
   3.613189884482853*^9, {3.613193685040205*^9, 3.613193702901354*^9}, {
   3.615069418437086*^9, 3.615069421692083*^9}, {3.615282407471828*^9, 
   3.6152824281596937`*^9}, {3.615284112038863*^9, 3.615284119485643*^9}, {
   3.615284158968091*^9, 3.6152841781993227`*^9}, {3.615284312888946*^9, 
   3.6152843133032713`*^9}, {3.615284458072866*^9, 3.615284458178115*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "1.17`", "\[InvisibleSpace]", "\<\"\[VeryThinSpace]\[VeryThinSpace]\
\[VeryThinSpace]sec, at \[VeryThinSpace]\[VeryThinSpace]\"\>", 
   "\[InvisibleSpace]", "\<\"2014-07-26 00:06\"\>", 
   "\[InvisibleSpace]", "\<\".\"\>"}],
  SequenceForm[
  1.17, "\[VeryThinSpace]\[VeryThinSpace]\[VeryThinSpace]sec, at \
\[VeryThinSpace]\[VeryThinSpace]", "2014-07-26 00:06", "."],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6152824301017*^9, {3.6152840931017227`*^9, 3.615284121916018*^9}, {
   3.615284167008003*^9, 3.6152841802506523`*^9}, 3.615284391533201*^9, 
   3.615284460889552*^9, 3.6152856604634933`*^9, 3.615285975559359*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "15"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", "X"}], 
    "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", "X"}], 
    "+", 
    RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "2", ",", "5", ",", "4", ",", "6"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "2", ",", "5", ",", "6", ",", "4"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "4", ",", "5", ",", "2", ",", "6"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "4", ",", "5", ",", "6", ",", "2"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "5", ",", "2", ",", "4", ",", "6"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "5", ",", "2", ",", "6", ",", "4"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "5", ",", "4", ",", "2", ",", "6"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "5", ",", "4", ",", "6", ",", "2"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "5", ",", "6", ",", "2", ",", "4"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "5", ",", "6", ",", "4", ",", "2"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.613193705028975*^9, 3.615271239397133*^9, 3.615276103247139*^9, 
   3.615277263551516*^9, {3.615282417692769*^9, 3.615282430258637*^9}, {
   3.615284093213585*^9, 3.615284122035248*^9}, {3.615284167172538*^9, 
   3.615284180397105*^9}, 3.6152843917581177`*^9, 3.615284461147327*^9, 
   3.615285660551629*^9, 3.6152859757326612`*^9}]
}, Open  ]],

Cell["\<\
Should be  1x3x5x7 = 105 terms.
96 sec with  mv[ ]  argument checking  (other arg checking off). 
79 sec  \
\>", "Text",
 CellChangeTimes->{{3.6152795729414*^9, 3.6152795800296288`*^9}, {
  3.615282306873349*^9, 3.615282384009673*^9}, {3.615284214928775*^9, 
  3.6152842184970083`*^9}, {3.6152847980511417`*^9, 3.615284837283477*^9}, {
  3.61528486829149*^9, 3.615284873747542*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExpectedTiming", "[", 
  RowBox[{"95.9", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"sym", "[", "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "//", "Simplify"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6152842081829367`*^9, 3.615284233946561*^9}, {
  3.615284270549088*^9, 3.615284283750454*^9}, {3.61528441437707*^9, 
  3.6152844170638742`*^9}, {3.6152845802961607`*^9, 3.61528458269839*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "96.03400100000000350064510712400078773499`8.003024936239276", 
   "\[InvisibleSpace]", "\<\" CPU seconds, at \"\>", 
   "\[InvisibleSpace]", "\<\"Fri 25 Jul 2014 23:44:43\"\>", 
   "\[InvisibleSpace]", "\<\".\"\>"}],
  SequenceForm[
  96.03400100000000350064510712400078773499`8.003024936239276, 
   " CPU seconds, at ", "Fri 25 Jul 2014 23:44:43", "."],
  Editable->False]], "Print",
 CellChangeTimes->{3.615284389940262*^9, 3.615284683362523*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "105"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "5", ",", "4", ",", "6"}], "]"}],
       "[", 
      RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}]}], 
    "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "5", ",", "6", ",", "4"}], "]"}],
       "[", 
      RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}]}], 
    "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "4", ",", "5", ",", "2", ",", "6"}], "]"}],
       "[", 
      RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}]}], 
    "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "4", ",", "5", ",", "6", ",", "2"}], "]"}],
       "[", 
      RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}]}], 
    "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "5", ",", "2", ",", "4", ",", "6"}], "]"}],
       "[", 
      RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}]}], 
    "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "5", ",", "2", ",", "6", ",", "4"}], "]"}],
       "[", 
      RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}]}], 
    "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "5", ",", "4", ",", "2", ",", "6"}], "]"}],
       "[", 
      RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}]}], 
    "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "5", ",", "4", ",", "6", ",", "2"}], "]"}],
       "[", 
      RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}]}], 
    "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "5", ",", "6", ",", "2", ",", "4"}], "]"}],
       "[", 
      RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}]}], 
    "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "5", ",", "6", ",", "4", ",", "2"}], "]"}],
       "[", 
      RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}]}], 
    "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "5", ",", "4", ",", "6"}], "]"}],
       "[", 
      RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], 
     "\[CircleTimes]", "X"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "5", ",", "6", ",", "4"}], "]"}],
       "[", 
      RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], 
     "\[CircleTimes]", "X"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "4", ",", "5", ",", "2", ",", "6"}], "]"}],
       "[", 
      RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], 
     "\[CircleTimes]", "X"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "4", ",", "5", ",", "6", ",", "2"}], "]"}],
       "[", 
      RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], 
     "\[CircleTimes]", "X"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "5", ",", "2", ",", "4", ",", "6"}], "]"}],
       "[", 
      RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], 
     "\[CircleTimes]", "X"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "5", ",", "2", ",", "6", ",", "4"}], "]"}],
       "[", 
      RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], 
     "\[CircleTimes]", "X"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "5", ",", "4", ",", "2", ",", "6"}], "]"}],
       "[", 
      RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], 
     "\[CircleTimes]", "X"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "5", ",", "4", ",", "6", ",", "2"}], "]"}],
       "[", 
      RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], 
     "\[CircleTimes]", "X"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "5", ",", "6", ",", "2", ",", "4"}], "]"}],
       "[", 
      RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], 
     "\[CircleTimes]", "X"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "5", ",", "6", ",", "4", ",", "2"}], "]"}],
       "[", 
      RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], 
     "\[CircleTimes]", "X"}], "+", 
    RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", "X"}], 
    "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", "X"}], 
    "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", "X", 
     "\[CircleTimes]", "X"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", "X", 
     "\[CircleTimes]", "X"}], "+", 
    RowBox[{
    "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
     "X"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "2", ",", "5", ",", "4", ",", "7", ",", "6", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "2", ",", "5", ",", "4", ",", "7", ",", "8", ",", 
       "6"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "2", ",", "5", ",", "6", ",", "7", ",", "4", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "2", ",", "5", ",", "6", ",", "7", ",", "8", ",", 
       "4"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "2", ",", "5", ",", "7", ",", "4", ",", "6", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "2", ",", "5", ",", "7", ",", "4", ",", "8", ",", 
       "6"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "2", ",", "5", ",", "7", ",", "6", ",", "4", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "2", ",", "5", ",", "7", ",", "6", ",", "8", ",", 
       "4"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "2", ",", "5", ",", "7", ",", "8", ",", "4", ",", 
       "6"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "2", ",", "5", ",", "7", ",", "8", ",", "6", ",", 
       "4"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "4", ",", "5", ",", "2", ",", "7", ",", "6", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "4", ",", "5", ",", "2", ",", "7", ",", "8", ",", 
       "6"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", "2", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", "8", ",", 
       "2"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "4", ",", "5", ",", "7", ",", "2", ",", "6", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "4", ",", "5", ",", "7", ",", "2", ",", "8", ",", 
       "6"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "4", ",", "5", ",", "7", ",", "6", ",", "2", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "4", ",", "5", ",", "7", ",", "6", ",", "8", ",", 
       "2"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "4", ",", "5", ",", "7", ",", "8", ",", "2", ",", 
       "6"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "4", ",", "5", ",", "7", ",", "8", ",", "6", ",", 
       "2"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "2", ",", "4", ",", "7", ",", "6", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "2", ",", "4", ",", "7", ",", "8", ",", 
       "6"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "2", ",", "6", ",", "7", ",", "4", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "2", ",", "6", ",", "7", ",", "8", ",", 
       "4"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "2", ",", "7", ",", "4", ",", "6", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "2", ",", "7", ",", "4", ",", "8", ",", 
       "6"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "2", ",", "7", ",", "6", ",", "4", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "2", ",", "7", ",", "6", ",", "8", ",", 
       "4"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "2", ",", "7", ",", "8", ",", "4", ",", 
       "6"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "2", ",", "7", ",", "8", ",", "6", ",", 
       "4"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "4", ",", "2", ",", "7", ",", "6", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "4", ",", "2", ",", "7", ",", "8", ",", 
       "6"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "4", ",", "6", ",", "7", ",", "2", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "4", ",", "6", ",", "7", ",", "8", ",", 
       "2"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "4", ",", "7", ",", "2", ",", "6", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "4", ",", "7", ",", "2", ",", "8", ",", 
       "6"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "4", ",", "7", ",", "6", ",", "2", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "4", ",", "7", ",", "6", ",", "8", ",", 
       "2"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "4", ",", "7", ",", "8", ",", "2", ",", 
       "6"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "4", ",", "7", ",", "8", ",", "6", ",", 
       "2"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "6", ",", "2", ",", "7", ",", "4", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "6", ",", "2", ",", "7", ",", "8", ",", 
       "4"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "6", ",", "4", ",", "7", ",", "2", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "6", ",", "4", ",", "7", ",", "8", ",", 
       "2"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "6", ",", "7", ",", "2", ",", "4", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "6", ",", "7", ",", "2", ",", "8", ",", 
       "4"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "6", ",", "7", ",", "4", ",", "2", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "6", ",", "7", ",", "4", ",", "8", ",", 
       "2"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "6", ",", "7", ",", "8", ",", "2", ",", 
       "4"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "6", ",", "7", ",", "8", ",", "4", ",", 
       "2"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "2", ",", "4", ",", "6", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "2", ",", "4", ",", "8", ",", 
       "6"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "2", ",", "6", ",", "4", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "2", ",", "6", ",", "8", ",", 
       "4"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "2", ",", "8", ",", "4", ",", 
       "6"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "2", ",", "8", ",", "6", ",", 
       "4"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "4", ",", "2", ",", "6", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "4", ",", "2", ",", "8", ",", 
       "6"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "4", ",", "6", ",", "2", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "4", ",", "6", ",", "8", ",", 
       "2"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "4", ",", "8", ",", "2", ",", 
       "6"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "4", ",", "8", ",", "6", ",", 
       "2"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "6", ",", "2", ",", "4", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "6", ",", "2", ",", "8", ",", 
       "4"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "6", ",", "4", ",", "2", ",", 
       "8"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "6", ",", "4", ",", "8", ",", 
       "2"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "6", ",", "8", ",", "2", ",", 
       "4"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "6", ",", "8", ",", "4", ",", 
       "2"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "8", ",", "2", ",", "4", ",", 
       "6"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "8", ",", "2", ",", "6", ",", 
       "4"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "8", ",", "4", ",", "2", ",", 
       "6"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "8", ",", "4", ",", "6", ",", 
       "2"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "8", ",", "6", ",", "2", ",", 
       "4"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{
      "1", ",", "3", ",", "5", ",", "7", ",", "8", ",", "6", ",", "4", ",", 
       "2"}], "]"}], "[", 
     RowBox[{
     "X", "\[CircleTimes]", "X", "\[CircleTimes]", "X", "\[CircleTimes]", 
      "X"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.615284286706501*^9, 3.6152843901032887`*^9, 
  3.6152846840409307`*^9}]
}, Open  ]],

Cell["The above timings were with  mv  argument checking,", "Text",
 CellChangeTimes->{{3.615286030311466*^9, 3.6152860536878853`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mv", "[", 
  RowBox[{"1", ",", "3", ",", "5"}], "]"}]], "Input",
 CellChangeTimes->{3.615284763494617*^9}],

Cell[CellGroupData[{

Cell[BoxData["\<\"The argument of mv[ ] must be a permutation of the integers \
1,2,...,n (some n), given as a sequence or list.\"\>"], "Print",
 CellChangeTimes->{3.615284764636558*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"The given argument list is \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "5"}], "}"}], 
   "\[InvisibleSpace]", "\<\".\"\>"}],
  SequenceForm["The given argument list is ", {1, 3, 5}, "."],
  Editable->False]], "Print",
 CellChangeTimes->{3.615284764890486*^9}]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.615284765155806*^9}]
}, Open  ]],

Cell["\<\
The upvalue on the 2nd rule shows that X is symmetric.  Can also see this via \
   ? x .
To clear the upvalue rule requires  ^=.\
\>", "Text",
 CellChangeTimes->{{3.6122317765183277`*^9, 3.6122318319467173`*^9}, {
   3.6122319761835012`*^9, 3.612231997831148*^9}, {3.612238158678302*^9, 
   3.612238226726243*^9}, {3.612238257190295*^9, 3.612238287142561*^9}, {
   3.612238333223487*^9, 3.612238350006504*^9}, {3.6122466147622433`*^9, 
   3.612246647722712*^9}, {3.6122582447347527`*^9, 3.612258289950355*^9}, 
   3.6152825660425663`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Definition", "[", "X", "]"}]], "Input",
 CellChangeTimes->{{3.612238312905281*^9, 3.612238317194092*^9}}],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {GridBox[{
       {
        RowBox[{
         RowBox[{"SymQ", "[", "X", "]"}], "^=", "True"}]}
      },
      BaselinePosition->{Baseline, {1, 1}},
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{"Columns" -> {{
           Scaled[0.999]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  Definition[$CellContext`X],
  Editable->False]], "Output",
 CellChangeTimes->{3.612238317720064*^9, 3.6122422323163357`*^9, 
  3.612244612127592*^9, 3.6122454167277803`*^9, 3.6122465998866243`*^9, 
  3.612246825454368*^9, 3.6122578411614532`*^9, 3.612258235551961*^9, 
  3.612263628127522*^9, 3.612336726762456*^9, 3.6124204158335657`*^9, 
  3.612670319254099*^9, 3.612684001764227*^9, 3.612686970577621*^9, 
  3.613193757739933*^9, 3.6152712396860857`*^9, 3.6152761033659573`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ForgetAssumeSymmetric", "[", "X", "]"}]], "Input",
 CellChangeTimes->{{3.613175267985365*^9, 3.613175269248282*^9}}],

Cell[BoxData["\<\"Tensor field \\!\\(X\\) is no longer assumed to be \
symmetric.\"\>"], "Output",
 CellChangeTimes->{
  3.613175273515048*^9, {3.613175311868084*^9, 3.613175338991213*^9}, 
   3.61528611289008*^9}]
}, Open  ]],

Cell[TextData[{
 "Without  X  being symmetric we should have  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["2", 
      RowBox[{"3", " "}]], "15"}], " ", "=", " ", "120"}], 
   TraditionalForm]]],
 "  terms,"
}], "Text",
 CellChangeTimes->{{3.615286256232314*^9, 3.615286267432519*^9}, {
  3.615286330840859*^9, 3.615286334072702*^9}, {3.615287634397315*^9, 
  3.615287682461582*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExpectedTiming", "[", 
  RowBox[{"0.95", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"sym", "[", "]"}], "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "//",
     "Simplify"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.615286118606303*^9, 3.6152861374380407`*^9}, {
  3.615287745844715*^9, 3.615287750759033*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.94`", "\[InvisibleSpace]", "\<\"\[VeryThinSpace]\[VeryThinSpace]\
\[VeryThinSpace]sec, at \[VeryThinSpace]\[VeryThinSpace]\"\>", 
   "\[InvisibleSpace]", "\<\"2014-07-26 00:35\"\>", 
   "\[InvisibleSpace]", "\<\".\"\>"}],
  SequenceForm[
  0.94, "\[VeryThinSpace]\[VeryThinSpace]\[VeryThinSpace]sec, at \
\[VeryThinSpace]\[VeryThinSpace]", "2014-07-26 00:35", "."],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6152862747268677`*^9, {3.615287742198612*^9, 3.615287753414168*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "120"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "4", ",", "2", ",", "3"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "4", ",", "3", ",", "2"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "3", ",", "1", ",", "4"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "4", ",", "1", ",", "3"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "4", ",", "3", ",", "1"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "4", ",", "2", ",", "3"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "4", ",", "3", ",", "2"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "3", ",", "1", ",", "4"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "4", ",", "1", ",", "3"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "4", ",", "3", ",", "1"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", "X"}], 
    "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", "X"}], 
    "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "4", ",", "2", ",", "3"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", "X"}], 
    "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "4", ",", "2", ",", "3"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "4", ",", "3", ",", "2"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", "X"}], 
    "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"1", ",", "4", ",", "3", ",", "2"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "3", ",", "1", ",", "4"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", "X"}], 
    "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "3", ",", "1", ",", "4"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", "X"}], 
    "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "4", ",", "1", ",", "3"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", "X"}], 
    "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "4", ",", "1", ",", "3"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "4", ",", "3", ",", "1"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", "X"}], 
    "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "4", ",", "3", ",", "1"}], "]"}], "[", 
      RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}]}], "+", 
    RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "+", 
    RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}]}], "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "\[CircleTimes]", 
     "X"}], "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "\[CircleTimes]", "X",
      "\[CircleTimes]", "X"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "\[CircleTimes]", "X",
      "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "\[CircleTimes]", 
     "X"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}]}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "2", ",", "5", ",", "4", ",", "6"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "2", ",", "5", ",", "6", ",", "4"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "2", ",", "6", ",", "4", ",", "5"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "2", ",", "6", ",", "5", ",", "4"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "4", ",", "5", ",", "2", ",", "6"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "4", ",", "5", ",", "6", ",", "2"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "4", ",", "6", ",", "2", ",", "5"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "4", ",", "6", ",", "5", ",", "2"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "5", ",", "2", ",", "4", ",", "6"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "5", ",", "2", ",", "6", ",", "4"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "5", ",", "4", ",", "2", ",", "6"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "5", ",", "4", ",", "6", ",", "2"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "5", ",", "6", ",", "2", ",", "4"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "5", ",", "6", ",", "4", ",", "2"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "6", ",", "2", ",", "4", ",", "5"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "6", ",", "2", ",", "5", ",", "4"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "6", ",", "4", ",", "2", ",", "5"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "6", ",", "4", ",", "5", ",", "2"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "6", ",", "5", ",", "2", ",", "4"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "6", ",", "5", ",", "4", ",", "2"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "2", ",", "5", ",", "3", ",", "6"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "2", ",", "5", ",", "6", ",", "3"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "2", ",", "6", ",", "3", ",", "5"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "2", ",", "6", ",", "5", ",", "3"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "3", ",", "5", ",", "2", ",", "6"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "3", ",", "5", ",", "6", ",", "2"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "3", ",", "6", ",", "2", ",", "5"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "3", ",", "6", ",", "5", ",", "2"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "5", ",", "2", ",", "3", ",", "6"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "5", ",", "2", ",", "6", ",", "3"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "5", ",", "3", ",", "2", ",", "6"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "5", ",", "3", ",", "6", ",", "2"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "5", ",", "6", ",", "2", ",", "3"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "5", ",", "6", ",", "3", ",", "2"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "6", ",", "2", ",", "3", ",", "5"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "6", ",", "2", ",", "5", ",", "3"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "6", ",", "3", ",", "2", ",", "5"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "6", ",", "3", ",", "5", ",", "2"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "6", ",", "5", ",", "2", ",", "3"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "6", ",", "5", ",", "3", ",", "2"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "1", ",", "5", ",", "4", ",", "6"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "1", ",", "5", ",", "6", ",", "4"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "1", ",", "6", ",", "4", ",", "5"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "1", ",", "6", ",", "5", ",", "4"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "1", ",", "6"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "1"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "4", ",", "6", ",", "1", ",", "5"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "4", ",", "6", ",", "5", ",", "1"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "5", ",", "1", ",", "4", ",", "6"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "5", ",", "1", ",", "6", ",", "4"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "5", ",", "4", ",", "1", ",", "6"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "5", ",", "4", ",", "6", ",", "1"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "5", ",", "6", ",", "1", ",", "4"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "5", ",", "6", ",", "4", ",", "1"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "6", ",", "1", ",", "4", ",", "5"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "6", ",", "1", ",", "5", ",", "4"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "6", ",", "4", ",", "1", ",", "5"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "6", ",", "4", ",", "5", ",", "1"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "6", ",", "5", ",", "1", ",", "4"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "6", ",", "5", ",", "4", ",", "1"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "1", ",", "5", ",", "3", ",", "6"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "1", ",", "5", ",", "6", ",", "3"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "1", ",", "6", ",", "3", ",", "5"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "1", ",", "6", ",", "5", ",", "3"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "3", ",", "5", ",", "1", ",", "6"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "3", ",", "5", ",", "6", ",", "1"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "3", ",", "6", ",", "1", ",", "5"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "3", ",", "6", ",", "5", ",", "1"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "5", ",", "1", ",", "3", ",", "6"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "5", ",", "1", ",", "6", ",", "3"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "5", ",", "3", ",", "1", ",", "6"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "5", ",", "3", ",", "6", ",", "1"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "5", ",", "6", ",", "1", ",", "3"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "5", ",", "6", ",", "3", ",", "1"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "6", ",", "1", ",", "3", ",", "5"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "6", ",", "1", ",", "5", ",", "3"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "6", ",", "3", ",", "1", ",", "5"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "6", ",", "3", ",", "5", ",", "1"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "6", ",", "5", ",", "1", ",", "3"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}], "+", 
    
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "6", ",", "5", ",", "3", ",", "1"}], "]"}], 
     "[", 
     RowBox[{"X", "\[CircleTimes]", "X", "\[CircleTimes]", "X"}], "]"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.615286274929187*^9, {3.615287742307747*^9, 3.6152877535180187`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearField", "[", 
  RowBox[{"{", "X", "}"}], "]"}]], "Input",
 CellChangeTimes->{
  3.612232184504174*^9, {3.615286356125211*^9, 3.6152863885732117`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Declaring a tensor antisymmetric                                              \
                           ---  AddRule  is on all rules. \
\>", "Subsection",
 CellChangeTimes->{{3.6117004172917347`*^9, 3.611700487110237*^9}, {
   3.611700901848016*^9, 3.611701130920413*^9}, {3.611701234361413*^9, 
   3.611701302550877*^9}, {3.611701786139716*^9, 3.6117017862152348`*^9}, {
   3.61170200910107*^9, 3.6117020329203777`*^9}, 3.611996273648815*^9, {
   3.6119963087668657`*^9, 3.611996325229361*^9}, {3.612145566621338*^9, 
   3.61214560729216*^9}, {3.612145987296035*^9, 3.612146026046085*^9}, {
   3.613115509619932*^9, 3.613115540595601*^9}, {3.6139827116283417`*^9, 
   3.6139827186685867`*^9}, {3.615253595007339*^9, 3.615253597535556*^9}, 
   3.615254083008902*^9, {3.649540179043145*^9, 3.649540179203144*^9}, 
   3.655319273531065*^9}],

Cell["\<\
For more detail and comments, see the code for declaring a tensor symmetric.  \
This is a cut-down modified copy of that.\
\>", "Text",
 CellChangeTimes->{{3.612146060326579*^9, 3.612146118958737*^9}, {
  3.613116642696278*^9, 3.613116696151485*^9}}],

Cell[CellGroupData[{

Cell["AssumeAntisymmetric[ ],   ForgetAssumeAntisymmetric[ ]", "Subsubsection",
 CellChangeTimes->{{3.615277043892955*^9, 3.615277069589961*^9}, {
  3.6556638576657343`*^9, 3.655663859209412*^9}, {3.655663918968646*^9, 
  3.655663934832708*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "AssumeAntisymmetric", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "ForgetAssumeAntisymmetric", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612131834219195*^9, 3.612131839413356*^9}, {
  3.612153897761991*^9, 3.612153908758218*^9}, {3.61222891338265*^9, 
  3.612228921744228*^9}, {3.6131164857742367`*^9, 3.613116502028653*^9}}],

Cell["\<\
By returning string instead of using  Print[ ],  we can suppress output by \
terminating with ; . 
To get nice output from the mapped call, use Column,  \
\>", "Text",
 CellChangeTimes->{{3.6124918371870403`*^9, 3.6124919294795427`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AssumeAntisymmetric", "[", "X_List", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"AssumeAntisymmetric", "[", "#", "]"}], "&"}], ",", "X"}], 
     "]"}], "//", "Column"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ForgetAssumeAntisymmetric", "[", "X_List", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ForgetAssumeAntisymmetric", "[", "#", "]"}], "&"}], ",", 
      "X"}], "]"}], "//", "Column"}], ")"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612229992128016*^9, 3.612230025059886*^9}, {
   3.612231475357093*^9, 3.612231527517959*^9}, 3.6122316124149513`*^9, {
   3.612231936415811*^9, 3.612231951477086*^9}, {3.612491702414846*^9, 
   3.612491719767754*^9}, {3.61311651732135*^9, 3.6131165470321617`*^9}, 
   3.6131682134121428`*^9, 3.6132412295588703`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AssumeAntisymmetric", "[", 
   RowBox[{"X_", "/;", 
    RowBox[{"!", 
     RowBox[{
      RowBox[{"Head", "[", "X", "]"}], "===", "List"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "msg", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"SymQ", "[", "X", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Tensor \>\"", ",", "X", ",", 
          "\"\< is already declared symmetric.\>\""}], "]"}], ";", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<To re-declare \>\"", ",", "X", ",", 
          "\"\< as antisymmetric, first use either \
ForgetAssumeSymmetric[\>\"", ",", "X", ",", "\"\<] or ClearField[\>\"", ",", 
          "X", ",", "\"\<].\>\""}], " ", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"IntegerQ", "[", 
         RowBox[{"deg", "[", "X", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<deg[\>\"", ",", "X", ",", 
          "\"\<] does not evaluate to an integer. See  ? NewField  for \
declaring the degree of a tensor field.\>\""}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"deg", "[", "X", "]"}], ">", "1"}], ",", 
       RowBox[{
        RowBox[{"AntisymQ", "[", "X", "]"}], "=", "True"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"deg", "[", "X", "]"}], "===", "0"}], "||", " ", 
        RowBox[{
         RowBox[{"deg", "[", "X", "]"}], "===", "1"}]}], ",", 
       RowBox[{
       "msg", "=", 
        "\"\<By definition, SymQ[X] = False  and  AntisymQ[X] = False  for \
any X of degree 0 or 1.\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"deg", "[", "X", "]"}], "===", "2"}], ",", 
       RowBox[{"msg", "=", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<The degree \[VeryThinSpace]\>\"", ",", 
           RowBox[{"deg", "[", "X", "]"}], ",", "\"\< tensor field \>\"", ",",
            "X", ",", "\"\< is now assumed to be antisymmetric.\>\""}], "}"}],
          "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"deg", "[", "X", "]"}], ">", "2"}], ",", 
       RowBox[{"msg", "=", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"\"\<The degree \[VeryThinSpace]\>\"", ",", 
           RowBox[{"deg", "[", "X", "]"}], ",", "\"\< tensor field \>\"", ",",
            "X", ",", "\"\< is now assumed to be fully antisymmetric.\>\""}], 
          "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", "msg"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612131275685307*^9, 3.612131362690638*^9}, {
   3.6121314170590963`*^9, 3.6121315206632566`*^9}, {3.612131567703618*^9, 
   3.6121317362152987`*^9}, {3.6121317675108356`*^9, 
   3.6121317801045856`*^9}, {3.612131819573062*^9, 3.612131825475898*^9}, {
   3.612131897813253*^9, 3.612131909910613*^9}, {3.612133597180396*^9, 
   3.612133817688952*^9}, {3.6121338591140127`*^9, 3.612133899930686*^9}, {
   3.612141200458763*^9, 3.612141316764625*^9}, 3.612141348412816*^9, 
   3.61214141113457*^9, {3.612141540052064*^9, 3.612141652056589*^9}, {
   3.612141690058359*^9, 3.612141720037983*^9}, {3.612141769273343*^9, 
   3.6121418699492292`*^9}, {3.612141939768426*^9, 3.612141969217457*^9}, {
   3.6121420186575317`*^9, 3.612142271127427*^9}, 3.612142330057331*^9, {
   3.6121423913056583`*^9, 3.6121425034375477`*^9}, {3.6121426575042477`*^9, 
   3.612142674305335*^9}, {3.6121429435993013`*^9, 3.612143071637199*^9}, 
   3.612143834058402*^9, {3.612143884274171*^9, 3.612143982812853*^9}, {
   3.612144015596409*^9, 3.612144020571937*^9}, {3.612151496676177*^9, 
   3.612151518684782*^9}, {3.612151558286539*^9, 3.612151615305161*^9}, {
   3.612151652807845*^9, 3.6121516770305223`*^9}, {3.612151715696498*^9, 
   3.61215172589299*^9}, {3.6121518758795967`*^9, 3.6121518853159857`*^9}, {
   3.612152118079082*^9, 3.612152126050218*^9}, {3.6121521566779118`*^9, 
   3.612152224236055*^9}, {3.612153935684826*^9, 3.612153942643235*^9}, {
   3.6121540640361357`*^9, 3.612154065361722*^9}, {3.612154139170847*^9, 
   3.612154141471779*^9}, {3.612229798845441*^9, 3.612229806126741*^9}, {
   3.6122298426209784`*^9, 3.6122299729143887`*^9}, {3.612230137940304*^9, 
   3.612230196273549*^9}, {3.612230492057967*^9, 3.6122305524180527`*^9}, {
   3.61223059424319*^9, 3.6122306605145483`*^9}, {3.612230694004448*^9, 
   3.612230712791893*^9}, {3.6122314159111557`*^9, 3.612231439064382*^9}, {
   3.612231632008478*^9, 3.612231644304049*^9}, {3.6122320278171263`*^9, 
   3.61223203527989*^9}, {3.612232948977992*^9, 3.612232952592038*^9}, {
   3.612237517712137*^9, 3.6122375191441927`*^9}, 3.612238053245146*^9, {
   3.612491087477174*^9, 3.61249109850674*^9}, {3.612491206094294*^9, 
   3.6124912203821573`*^9}, {3.612557116105966*^9, 3.612557141664523*^9}, {
   3.612557185364235*^9, 3.612557366352089*^9}, {3.612570087636147*^9, 
   3.6125701222319813`*^9}, 3.6126020228599787`*^9, {3.612864153273446*^9, 
   3.612864186530684*^9}, {3.613116570574225*^9, 3.613116585958816*^9}, {
   3.613117064022437*^9, 3.61311707336982*^9}, {3.613117105481886*^9, 
   3.613117132893509*^9}, {3.613118822259688*^9, 3.613118840243361*^9}, 
   3.613118937649458*^9, {3.613118981759803*^9, 3.613118988712572*^9}, {
   3.613119176457779*^9, 3.613119456955813*^9}, {3.613121430141239*^9, 
   3.613121443506418*^9}, {3.613121926714363*^9, 3.613121939658194*^9}, {
   3.613122035073163*^9, 3.6131220362660227`*^9}, 3.613122807049748*^9, {
   3.613166356088551*^9, 3.613166505550335*^9}, 3.613167741160084*^9, {
   3.6131947092165623`*^9, 3.6131947357923613`*^9}, 3.6142305913236837`*^9, 
   3.614230725549533*^9, {3.615068893455183*^9, 3.615068940956951*^9}, {
   3.615069006408578*^9, 3.6150690070303917`*^9}, {3.615069287509367*^9, 
   3.6150693324740467`*^9}, {3.615070140438142*^9, 3.615070179798376*^9}, {
   3.649838864880548*^9, 3.649838923599461*^9}, {3.649838974736927*^9, 
   3.649839043949445*^9}, {3.6498390859649773`*^9, 3.649839201211095*^9}, {
   3.649839300934086*^9, 3.6498393081968412`*^9}, 3.655663626449244*^9, {
   3.655663658477008*^9, 3.655663693676118*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ForgetAssumeAntisymmetric", "[", 
   RowBox[{"X_", "/;", 
    RowBox[{"!", 
     RowBox[{
      RowBox[{"Head", "[", "X", "]"}], "===", "List"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"u", ",", "msg"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"AntisymQ", "[", "X", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"msg", "=", 
         RowBox[{"\"\<Tensor field \>\"", "<>", 
          RowBox[{"ToString", "[", 
           RowBox[{"X", ",", "StandardForm"}], "]"}], "<>", 
          "\"\< was not antisymmetric. No changes made.\>\""}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"msg", "=", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
           "\"\<No change made: Tensor field \>\"", ",", "X", ",", 
            "\"\< was not antisymmetric.\>\""}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "msg", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AntisymQ", "[", "X", "]"}], "=."}], ";", "\[IndentingNewLine]", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Tensor field \>\"", ",", "X", ",", 
        "\"\< is no longer assumed to be antisymmetric.\>\""}], "}"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612146461318947*^9, 3.61214647150817*^9}, {
   3.6121465060408373`*^9, 3.612146601259465*^9}, {3.612152278287436*^9, 
   3.612152289157095*^9}, {3.612153921645578*^9, 3.612153931068001*^9}, {
   3.6121546026656113`*^9, 3.612154649779387*^9}, 3.612207081226246*^9, 
   3.6122321678808603`*^9, {3.612232225492456*^9, 3.61223235384398*^9}, 
   3.612258052182589*^9, {3.612258314408064*^9, 3.612258327429167*^9}, {
   3.612258475916232*^9, 3.612258485289953*^9}, {3.612491262712932*^9, 
   3.612491425001212*^9}, {3.61257017486652*^9, 3.6125702127753677`*^9}, 
   3.6126020034091187`*^9, {3.612864301163994*^9, 3.6128643129286346`*^9}, {
   3.612865447927987*^9, 3.6128654737552834`*^9}, {3.613116724853771*^9, 
   3.613116735878566*^9}, {3.61312140217065*^9, 3.613121413276284*^9}, 
   3.613166556218013*^9, {3.6131669090960493`*^9, 3.613166951913369*^9}, 
   3.6131677528756647`*^9, {3.6131945344925117`*^9, 3.6131945792957497`*^9}, {
   3.613195101977213*^9, 3.6131951042629747`*^9}, {3.614230597956621*^9, 
   3.6142306150095663`*^9}, 3.649839349994961*^9, {3.649839380526065*^9, 
   3.649839404373987*^9}, {3.649839438198639*^9, 3.6498394410316677`*^9}, {
   3.655663719685574*^9, 3.6556637957705584`*^9}}],

Cell["The general rules,", "Text",
 CellChangeTimes->{{3.613194685740988*^9, 3.613194689788701*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"mv", "[", "n__", "]"}], "[", 
     RowBox[{"Y1___", "\[CircleTimes]", 
      RowBox[{"(", 
       RowBox[{"X_", "?", "AntisymQ"}], ")"}], "\[CircleTimes]", "Y2___"}], 
     "]"}], "/;", 
    RowBox[{
     RowBox[{"IntegerQ", "[", 
      RowBox[{"deg", "[", "X", "]"}], "]"}], "&&", 
     RowBox[{"!", 
      RowBox[{"PartiallySortedQ", "[", 
       RowBox[{
        RowBox[{"{", "n", "}"}], ",", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], "+", 
         RowBox[{"Range", "[", 
          RowBox[{"deg", "[", "X", "]"}], "]"}]}]}], "]"}]}]}]}], ":=", 
   RowBox[{
    RowBox[{"mvSignature", "[", "n", "]"}], 
    RowBox[{"mvSignature", "[", 
     RowBox[{"PartiallySort", "[", 
      RowBox[{
       RowBox[{"{", "n", "}"}], ",", 
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", 
        RowBox[{"Range", "[", 
         RowBox[{"deg", "[", "X", "]"}], "]"}]}]}], "]"}], "]"}], 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"PartiallySort", "[", 
       RowBox[{
        RowBox[{"{", "n", "}"}], ",", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], "+", 
         RowBox[{"Range", "[", 
          RowBox[{"deg", "[", "X", "]"}], "]"}]}]}], "]"}], "]"}], "[", 
     RowBox[{"Y1", "\[CircleTimes]", "X", "\[CircleTimes]", "Y2"}], "]"}]}]}],
   " ", "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6131947669042177`*^9, 3.6131947821540422`*^9}, {
  3.613194832822117*^9, 3.613194842051076*^9}, {3.6131948827613792`*^9, 
  3.613194883965838*^9}, {3.613194936105773*^9, 3.613194938538312*^9}, {
  3.6139825982964907`*^9, 3.613982627835178*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "77", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"mv", "[", "n__", "]"}], "[", 
     RowBox[{"Y1___", "\[CircleTimes]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"X_", "?", "AntisymQ"}], ")"}], "[", "s__", "]"}], 
      "\[CircleTimes]", "Y2___"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"IntegerQ", "[", 
      RowBox[{"deg", "[", 
       RowBox[{"X", "[", "s", "]"}], "]"}], "]"}], "&&", 
     RowBox[{"!", 
      RowBox[{"PartiallySortedQ", "[", 
       RowBox[{
        RowBox[{"{", "n", "}"}], ",", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], "+", 
         RowBox[{"Range", "[", 
          RowBox[{"deg", "[", 
           RowBox[{"X", "[", "s", "]"}], "]"}], "]"}]}]}], "]"}]}]}]}], ":=", 
   
   RowBox[{
    RowBox[{"mvSignature", "[", "n", "]"}], 
    RowBox[{"mvSignature", "[", 
     RowBox[{"PartiallySort", "[", 
      RowBox[{
       RowBox[{"{", "n", "}"}], ",", 
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", 
        RowBox[{"Range", "[", 
         RowBox[{"deg", "[", 
          RowBox[{"X", "[", "s", "]"}], "]"}], "]"}]}]}], "]"}], "]"}], 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"PartiallySort", "[", 
       RowBox[{
        RowBox[{"{", "n", "}"}], ",", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], "+", 
         RowBox[{"Range", "[", 
          RowBox[{"deg", "[", 
           RowBox[{"X", "[", "s", "]"}], "]"}], "]"}]}]}], "]"}], "]"}], "[", 
     
     RowBox[{"Y1", "\[CircleTimes]", 
      RowBox[{"X", "[", "s", "]"}], "\[CircleTimes]", "Y2"}], "]"}]}]}], " ", 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.613194892451777*^9, 3.6131949139182663`*^9}, {
  3.613982611361703*^9, 3.613982632802328*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "78", "]"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing", "Subsubsection",
 CellChangeTimes->{{3.615018449448215*^9, 3.61501845095277*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AssumeAntisymmetric", "[", "X", "]"}]], "Input",
 CellChangeTimes->{{3.613985093274366*^9, 3.6139851066008167`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Tensor \"\>", "\[InvisibleSpace]", "X", 
   "\[InvisibleSpace]", "\<\" is already declared symmetric.\"\>"}],
  SequenceForm["Tensor ", $CellContext`X, " is already declared symmetric."],
  Editable->False]], "Print",
 CellChangeTimes->{3.6152775908551617`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"To re-declare \"\>", "\[InvisibleSpace]", "X", 
   "\[InvisibleSpace]", "\<\" as antisymmetric, first use either \
ForgetAssumeSymmetric[\"\>", "\[InvisibleSpace]", "X", 
   "\[InvisibleSpace]", "\<\"] or ClearField[\"\>", "\[InvisibleSpace]", "X", 
   "\[InvisibleSpace]", "\<\"].\"\>"}],
  SequenceForm[
  "To re-declare ", $CellContext`X, 
   " as antisymmetric, first use either ForgetAssumeSymmetric[", \
$CellContext`X, "] or ClearField[", $CellContext`X, "]."],
  Editable->False]], "Print",
 CellChangeTimes->{3.6152775908592453`*^9}]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.613985097193067*^9, 3.613985108681045*^9}, 
   3.613985575450989*^9, 3.6152775908626337`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AntisymQ", "[", "X", "]"}]], "Input",
 CellChangeTimes->{3.6142306246537952`*^9}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.6139855860394907`*^9, 3.613985627878446*^9, 
  3.6152775908729343`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ForgetAssumeAntisymmetric", "[", 
  RowBox[{"{", 
   RowBox[{"X", ",", "Y", ",", "Z"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{
  3.612232184504174*^9, {3.613116741087381*^9, 3.61311674228557*^9}, 
   3.61324128569851*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"Tensor field \\!\\(X\\) was not antisymmetric. No changes \
made.\"\>"},
    {"\<\"Tensor field \\!\\(Y\\) was not antisymmetric. No changes \
made.\"\>"},
    {"\<\"Tensor field \\!\\(Z\\) was not antisymmetric. No changes made.\"\>"}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{
  3.612670319366643*^9, 3.612684002432753*^9, 3.612686970877386*^9, {
   3.613116113991795*^9, 3.613116119127904*^9}, 3.6131213897777033`*^9, 
   3.613121421050231*^9, {3.613194592480165*^9, 3.613194601729883*^9}, {
   3.613241296919404*^9, 3.613241310505183*^9}, 3.615277591075259*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "X", "]"}], "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AssumeAntisymmetric", "[", "X", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sym", "[", "]"}], "[", "X", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sym", "[", "]"}], "[", "X", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"alt", "[", "]"}], "[", "X", "]"}]}], "Input",
 CellChangeTimes->{{3.613121832528028*^9, 3.6131218540832977`*^9}, {
  3.613122830071268*^9, 3.613122863740616*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Tensor \"\>", "\[InvisibleSpace]", "X", 
   "\[InvisibleSpace]", "\<\" is already declared symmetric.\"\>"}],
  SequenceForm["Tensor ", $CellContext`X, " is already declared symmetric."],
  Editable->False]], "Print",
 CellChangeTimes->{3.615277591276589*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"To re-declare \"\>", "\[InvisibleSpace]", "X", 
   "\[InvisibleSpace]", "\<\" as antisymmetric, first use either \
ForgetAssumeSymmetric[\"\>", "\[InvisibleSpace]", "X", 
   "\[InvisibleSpace]", "\<\"] or ClearField[\"\>", "\[InvisibleSpace]", "X", 
   "\[InvisibleSpace]", "\<\"].\"\>"}],
  SequenceForm[
  "To re-declare ", $CellContext`X, 
   " as antisymmetric, first use either ForgetAssumeSymmetric[", \
$CellContext`X, "] or ClearField[", $CellContext`X, "]."],
  Editable->False]], "Print",
 CellChangeTimes->{3.615277591281024*^9}]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.613121847789318*^9, 3.613121875884968*^9}, 
   3.6131219600616827`*^9, 3.613122043645968*^9, {3.613122735328046*^9, 
   3.613122738414424*^9}, 3.613122813744525*^9, {3.6131228578775053`*^9, 
   3.6131228643686533`*^9}, 3.613194599790309*^9, 3.613195628355404*^9, 
   3.6152775912844973`*^9}],

Cell[BoxData["X"], "Output",
 CellChangeTimes->{{3.613121847789318*^9, 3.613121875884968*^9}, 
   3.6131219600616827`*^9, 3.613122043645968*^9, {3.613122735328046*^9, 
   3.613122738414424*^9}, 3.613122813744525*^9, {3.6131228578775053`*^9, 
   3.6131228643686533`*^9}, 3.613194599790309*^9, 3.613195628355404*^9, 
   3.615277591287689*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sym", "[", "]"}], "[", "X", "]"}]], "Output",
 CellChangeTimes->{{3.613121847789318*^9, 3.613121875884968*^9}, 
   3.6131219600616827`*^9, 3.613122043645968*^9, {3.613122735328046*^9, 
   3.613122738414424*^9}, 3.613122813744525*^9, {3.6131228578775053`*^9, 
   3.6131228643686533`*^9}, 3.613194599790309*^9, 3.613195628355404*^9, 
   3.615277591290264*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"alt", "[", "]"}], "[", "X", "]"}]], "Output",
 CellChangeTimes->{{3.613121847789318*^9, 3.613121875884968*^9}, 
   3.6131219600616827`*^9, 3.613122043645968*^9, {3.613122735328046*^9, 
   3.613122738414424*^9}, 3.613122813744525*^9, {3.6131228578775053`*^9, 
   3.6131228643686533`*^9}, 3.613194599790309*^9, 3.613195628355404*^9, 
   3.615277591292796*^9}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Simplification to zero due to symmetries", "Subsection",
 CellChangeTimes->{{3.6117004172917347`*^9, 3.611700487110237*^9}, {
   3.611700901848016*^9, 3.611701130920413*^9}, {3.611701234361413*^9, 
   3.611701302550877*^9}, {3.611701786139716*^9, 3.6117017862152348`*^9}, {
   3.61170200910107*^9, 3.6117020329203777`*^9}, 3.611996273648815*^9, {
   3.6119963087668657`*^9, 3.611996325229361*^9}, {3.612145566621338*^9, 
   3.61214560729216*^9}, {3.612145987296035*^9, 3.612146026046085*^9}, {
   3.613115509619932*^9, 3.613115540595601*^9}, {3.6139827116283417`*^9, 
   3.6139827186685867`*^9}, {3.615253595007339*^9, 3.615253597535556*^9}, 
   3.615254083008902*^9, {3.649540179043145*^9, 3.649540179203144*^9}, 
   3.655319273531065*^9, {3.6561017029383574`*^9, 3.656101718970038*^9}}],

Cell["\<\
Rules such as these are probably scattered about. Maybe they should be \
collected in one place here.\
\>", "Text",
 CellChangeTimes->{{3.656101742203174*^9, 3.656101824616824*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearField", "[", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y"}], "}"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{
    RowBox[{"{", "2", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"X", ",", "Y"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumeSymmetric", "[", "X", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumeAntisymmetric", "[", "Y", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.656102055935626*^9, 3.656102143712266*^9}}],

Cell["We want these to simplify to zero,", "Text",
 CellChangeTimes->{{3.656102234147521*^9, 3.656102246547615*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y", ",", "X"}], "\[RightAngleBracket]"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}]]}], "Input",
 CellChangeTimes->{{3.656102153203033*^9, 3.656102185572489*^9}}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}]]], "Output",
 CellChangeTimes->{{3.65610216864517*^9, 3.656102186221401*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], 
    "\[RightAngleBracket]"}], 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]]}]], "Output",
 CellChangeTimes->{{3.65610216864517*^9, 3.6561021862245626`*^9}}]
}, Open  ]],

Cell["Not initialized (a more general rule later),", "Text",
 CellChangeTimes->{{3.6561040811320133`*^9, 3.6561041052116632`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"X_", "?", "SymQ"}], ",", 
       RowBox[{"Y_", "?", "AntisymQ"}]}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_"}], "}"}]], "/;", 
   RowBox[{"a", "<", 
    RowBox[{"deg", "[", "X", "]"}], "\[LessEqual]", "b"}]}], ":=", 
  "0"}]], "Input",
 CellChangeTimes->{{3.656101829970436*^9, 3.656102037846171*^9}, {
  3.656104056060844*^9, 3.6561040570850153`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "329", "]"}]], "Output",
 CellChangeTimes->{3.6561022003330917`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y", ",", "X"}], "\[RightAngleBracket]"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}]]}], "Input",
 CellChangeTimes->{{3.656102153203033*^9, 3.656102185572489*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.656102206249547*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.656102206252049*^9}]
}, Open  ]],

Cell["\<\
We also need a rule for around the other way:  1st argument  AntisymQ  and \
2nd argument  SymQ.\
\>", "Text",
 CellChangeTimes->{{3.656102433008986*^9, 3.656102527951655*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ForgetAssumeSymmetric", "[", "X", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ForgetAssumeAntisymmetric", "[", "Y", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumeAntisymmetric", "[", "X", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumeSymmetric", "[", "Y", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6561022847710238`*^9, 3.656102310818609*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y", ",", "X"}], "\[RightAngleBracket]"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}]]}], "Input",
 CellChangeTimes->{{3.656102153203033*^9, 3.656102185572489*^9}}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}]]], "Output",
 CellChangeTimes->{3.656102318902581*^9}],

Cell[BoxData[
 RowBox[{"-", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], 
    "\[RightAngleBracket]"}], 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]]}]], "Output",
 CellChangeTimes->{3.65610231890545*^9}]
}, Open  ]],

Cell["Not initialized (a more general rule later),", "Text",
 CellChangeTimes->{{3.6561040811320133`*^9, 3.6561041052116632`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"X_", "?", "AntisymQ"}], ",", 
       RowBox[{"Y_", "?", "SymQ"}]}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_"}], "}"}]], "/;", 
   RowBox[{"a", "<", 
    RowBox[{"deg", "[", "X", "]"}], "\[LessEqual]", "b"}]}], ":=", 
  "0"}]], "Input",
 CellChangeTimes->{{3.656101829970436*^9, 3.656102037846171*^9}, {
  3.65610233102678*^9, 3.656102336818617*^9}, {3.65610404730936*^9, 
  3.656104048892644*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "330", "]"}]], "Output",
 CellChangeTimes->{3.656102344169874*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y", ",", "X"}], "\[RightAngleBracket]"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}]]}], "Input",
 CellChangeTimes->{{3.656102153203033*^9, 3.656102185572489*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.656102348918524*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.6561023489210777`*^9}]
}, Open  ]],

Cell["Generalize the above,", "Text",
 CellChangeTimes->{{3.656102890852964*^9, 3.6561029088269053`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"degBracket", "[", "]"}]], "Input",
 CellChangeTimes->{{3.656170524918435*^9, 3.6561705451588373`*^9}, 
   3.656170775411682*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.6561705263972*^9, 3.65617054691292*^9}, 
   3.656170776013447*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"X1___", ",", 
        RowBox[{"X_", "?", "SymQ"}], ",", 
        RowBox[{"Y_", "?", "AntisymQ"}]}], "\[RightAngleBracket]"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}]], "/;", 
    RowBox[{
     RowBox[{"degBracket", "[", "X1", "]"}], "\[LessEqual]", "a", "<", 
     RowBox[{"degBracket", "[", 
      RowBox[{"X1", ",", "X"}], "]"}], "\[LessEqual]", "b"}]}], ":=", "0"}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.65610292146697*^9, 3.65610298277829*^9}, 
   3.6561030374016237`*^9, {3.656103074825089*^9, 3.6561030968726788`*^9}, {
   3.656103138936338*^9, 3.656103144472137*^9}, 3.656103239798964*^9, {
   3.656170494807221*^9, 3.656170499063334*^9}, {3.656170746643807*^9, 
   3.656170750019638*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "79", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"X1___", ",", 
        RowBox[{"X_", "?", "SymQ"}], ",", 
        RowBox[{"Y_", "?", "AntisymQ"}], ",", "Y1__"}], 
       "\[RightAngleBracket]"}], "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}]], "/;", 
    RowBox[{
     RowBox[{"degBracket", "[", "X1", "]"}], "\[LessEqual]", "a", "<", 
     RowBox[{"degBracket", "[", 
      RowBox[{"X1", ",", "X"}], "]"}], "\[LessEqual]", "b", "<", 
     RowBox[{"degBracket", "[", 
      RowBox[{"X1", ",", "X", ",", "Y"}], "]"}]}]}], ":=", "0"}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656103248934916*^9, 3.656103275718453*^9}, 
   3.656170792541891*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "80", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"X1___", ",", 
        RowBox[{"X_", "?", "AntisymQ"}], ",", 
        RowBox[{"Y_", "?", "SymQ"}]}], "\[RightAngleBracket]"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}]], "/;", 
    RowBox[{
     RowBox[{"degBracket", "[", "X1", "]"}], "\[LessEqual]", "a", "<", 
     RowBox[{"degBracket", "[", 
      RowBox[{"X1", ",", "X"}], "]"}], "\[LessEqual]", "b"}]}], ":=", "0"}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.65610292146697*^9, 3.65610298277829*^9}, 
   3.6561030374016237`*^9, {3.656103074825089*^9, 3.6561030968726788`*^9}, {
   3.656103138936338*^9, 3.656103144472137*^9}, 3.656103239798964*^9, {
   3.6561034688200207`*^9, 3.6561034822120113`*^9}, 3.656170804030447*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "81", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"X1___", ",", 
        RowBox[{"X_", "?", "AntisymQ"}], ",", 
        RowBox[{"Y_", "?", "SymQ"}], ",", "Y1__"}], "\[RightAngleBracket]"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}]], "/;", 
    RowBox[{
     RowBox[{"degBracket", "[", "X1", "]"}], "\[LessEqual]", "a", "<", 
     RowBox[{"degBracket", "[", 
      RowBox[{"X1", ",", "X"}], "]"}], "\[LessEqual]", "b", "<", 
     RowBox[{"degBracket", "[", 
      RowBox[{"X1", ",", "X", ",", "Y"}], "]"}]}]}], ":=", "0"}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.656103248934916*^9, 3.656103275718453*^9}, {
   3.656103476131886*^9, 3.656103484707604*^9}, 3.6561708057591877`*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "82", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y", ",", "X"}], "\[RightAngleBracket]"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}]]}], "Input",
 CellChangeTimes->{{3.656102153203033*^9, 3.656102185572489*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.656103541416065*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.656103541418858*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearField", "[", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y"}], "}"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{
    RowBox[{"{", "4", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"X", ",", "Y"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumeSymmetric", "[", "X", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumeAntisymmetric", "[", "Y", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.656102055935626*^9, 3.656102143712266*^9}, {
  3.6561036028184557`*^9, 3.656103603666256*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "4"}], "}"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "5"}], "}"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "6"}], "}"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"2", ",", "4"}], "}"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"2", ",", "5"}], "}"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"2", ",", "6"}], "}"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"3", ",", "4"}], "}"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"3", ",", "5"}], "}"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X", ",", "Y"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"3", ",", "6"}], "}"}]]}], "}"}]], "Input",
 CellChangeTimes->{{3.656102153203033*^9, 3.656102185572489*^9}, {
   3.656103655074133*^9, 3.6561037741760483`*^9}, 3.656103807072193*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.656103625478331*^9, {3.656103758179369*^9, 3.656103774803955*^9}, 
   3.656103808453005*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearField", "[", 
   RowBox[{"{", 
    RowBox[{"X1", ",", "Y1"}], "}"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{
    RowBox[{"{", "3", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"X1", ",", "Y1"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.656102055935626*^9, 3.656102143712266*^9}, {
  3.6561036028184557`*^9, 3.656103603666256*^9}, {3.656103815439559*^9, 
  3.656103825263455*^9}, {3.656103944494129*^9, 3.656103944589843*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X1", ",", "X", ",", "Y"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], "+", "1"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X1", ",", "X", ",", "Y"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "5"}], "}"}], "+", "1"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X1", ",", "X", ",", "Y"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "6"}], "}"}], "+", "1"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X1", ",", "X", ",", "Y"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], "+", "1"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X1", ",", "X", ",", "Y"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "5"}], "}"}], "+", "1"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X1", ",", "X", ",", "Y"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "6"}], "}"}], "+", "1"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X1", ",", "X", ",", "Y"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], "+", "1"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X1", ",", "X", ",", "Y"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "5"}], "}"}], "+", "1"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X1", ",", "X", ",", "Y"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], "+", "1"}]]}], "}"}]], "Input",
 CellChangeTimes->{{3.656102153203033*^9, 3.656102185572489*^9}, {
   3.656103655074133*^9, 3.6561037741760483`*^9}, 3.656103807072193*^9, {
   3.6561038379139433`*^9, 3.656103884812174*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.656103888706458*^9, 3.656103906940895*^9}, 
   3.656103951622345*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X1", ",", "X", ",", "Y", ",", "Y1"}], "\[RightAngleBracket]"}],
      "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "4"}], "}"}], "+", "1"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X1", ",", "X", ",", "Y", ",", "Y1"}], "\[RightAngleBracket]"}],
      "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "5"}], "}"}], "+", "1"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X1", ",", "X", ",", "Y", ",", "Y1"}], "\[RightAngleBracket]"}],
      "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], "+", "1"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X1", ",", "X", ",", "Y", ",", "Y1"}], "\[RightAngleBracket]"}],
      "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "5"}], "}"}], "+", "1"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X1", ",", "X", ",", "Y", ",", "Y1"}], "\[RightAngleBracket]"}],
      "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], "+", "1"}]], ",", "\[IndentingNewLine]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X1", ",", "X", ",", "Y", ",", "Y1"}], "\[RightAngleBracket]"}],
      "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "5"}], "}"}], "+", "1"}]]}], "}"}]], "Input",
 CellChangeTimes->{{3.656102153203033*^9, 3.656102185572489*^9}, {
   3.656103655074133*^9, 3.6561037741760483`*^9}, 3.656103807072193*^9, {
   3.6561038379139433`*^9, 3.656103884812174*^9}, {3.656103972413671*^9, 
   3.6561039832605343`*^9}, {3.656104017421783*^9, 3.65610402862086*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6561039854138117`*^9, 3.656104029256061*^9}]
}, Open  ]],

Cell[TextData[{
 "....the above are still not very general:\n    --  need intervening  Z:   \
... X, Z_\[ThinSpace]\[VeryThinSpace]_, Y,....\n    --  need other  ab  \
pairs.\n    --  need pure  \[LeftAngleBracket]  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[RightAngleBracket]", 
    RowBox[{"ab1", ",", " ", "ab2"}]], TraditionalForm]]],
 "   without \[LeftAngleBracket] , , \[RightAngleBracket] .\n    --  need to \
generalize  SymQ  and  AntisymQ  to subsets of slots of  X,Y. "
}], "Text",
 CellChangeTimes->{{3.6561041714509783`*^9, 3.656104426279594*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Simplification of  mv[ ]  by re-ordering the factors in a tensor product      \
         ---  AddRule  is on all rules.\
\>", "Subsection",
 CellChangeTimes->{{3.6117004172917347`*^9, 3.611700487110237*^9}, {
   3.611700901848016*^9, 3.611701130920413*^9}, {3.611701234361413*^9, 
   3.611701302550877*^9}, {3.611701786139716*^9, 3.6117017862152348`*^9}, {
   3.61170200910107*^9, 3.6117020329203777`*^9}, 3.611996273648815*^9, {
   3.6119963087668657`*^9, 3.611996325229361*^9}, {3.612145566621338*^9, 
   3.61214560729216*^9}, {3.612145987296035*^9, 3.612146026046085*^9}, {
   3.612202098180979*^9, 3.612202106094839*^9}, {3.612565371638568*^9, 
   3.612565387187291*^9}, {3.6125666710657663`*^9, 3.612566675757509*^9}, {
   3.612680811591254*^9, 3.612680833447319*^9}, {3.612821745972878*^9, 
   3.612821759682815*^9}, {3.612821790052359*^9, 3.612821838661235*^9}, {
   3.613978401241498*^9, 3.613978406010232*^9}, {3.615253882810371*^9, 
   3.6152538843843327`*^9}, {3.615253955248234*^9, 3.615253984224689*^9}, {
   3.61525403816079*^9, 3.6152540813769417`*^9}, {3.6152544197141047`*^9, 
   3.615254422017692*^9}, {3.615254460002015*^9, 3.6152545499694443`*^9}, {
   3.61525460750597*^9, 3.615254633313917*^9}, 3.655319276250827*^9}],

Cell["\<\
Any tensor product can be written in any factor order, provided it is \
operated on by a suitable  mv.  So which order ?   
We need a metric on the symmetric group to measure how far from the identity \
a permutation is. \
\>", "Text",
 CellChangeTimes->{{3.612565403745984*^9, 3.612565512423644*^9}, {
   3.612565609255937*^9, 3.612565724341185*^9}, 3.612680848647243*^9, {
   3.6126808869849367`*^9, 3.6126809211581297`*^9}, {3.615287934046507*^9, 
   3.6152879811508636`*^9}}],

Cell["Remember computed values,", "Text",
 CellChangeTimes->{{3.612674330694357*^9, 3.612674350517768*^9}, {
  3.612682912495768*^9, 3.612682927006976*^9}, {3.6126833106104193`*^9, 
  3.6126833223208303`*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "mvCrossingNumber", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mvCrossingNumber", "[", "n_List", "]"}], ":=", 
  RowBox[{
   RowBox[{"mvCrossingNumber", "[", "n", "]"}], "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", ",", "m", ",", "i", ",", "j"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"n", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ">", 
           RowBox[{"n", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ",", 
          RowBox[{"s", "=", 
           RowBox[{"s", "+", "1"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"m", "-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"i", "+", "1"}], ",", "m"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "s"}]}], "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6126331664781017`*^9, 3.612633375236624*^9}, {
   3.612633433889971*^9, 3.612633440405698*^9}, {3.612633505763962*^9, 
   3.612633524533308*^9}, {3.612633792627818*^9, 3.6126338693851767`*^9}, {
   3.612634436631927*^9, 3.6126344621713543`*^9}, 3.612634543880324*^9, {
   3.612634823690337*^9, 3.612634863816391*^9}, {3.612674234276264*^9, 
   3.6126742369446774`*^9}, {3.61267429836803*^9, 3.612674304721505*^9}, 
   3.6126812937911663`*^9, {3.6126829331105347`*^9, 3.612682936156864*^9}, {
   3.616213804135167*^9, 3.616213805495352*^9}}],

Cell["Equivalent compiled fn,", "Text",
 CellChangeTimes->{{3.612674330694357*^9, 3.612674350517768*^9}, {
  3.612682912495768*^9, 3.612682927006976*^9}, {3.6126833106104193`*^9, 
  3.612683339696908*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mvXnumber", "=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"n", ",", "_Integer", ",", "1", ",", "i", ",", "j"}], "}"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s", ",", "m"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"s", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"m", "=", 
         RowBox[{"Length", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ">", 
             RowBox[{"n", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ",", 
            RowBox[{"s", "=", 
             RowBox[{"s", "+", "1"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"m", "-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"i", "+", "1"}], ",", "m"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "s"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.612673265895553*^9, 3.612673402044849*^9}, {
   3.612673499117558*^9, 3.6126735293210793`*^9}, {3.6126738591487913`*^9, 
   3.612673867326058*^9}, {3.612674021753701*^9, 3.612674114026223*^9}, {
   3.612682328819542*^9, 3.612682345878394*^9}, {3.612682390674531*^9, 
   3.6126824235725737`*^9}, {3.612682454358108*^9, 3.6126824608370447`*^9}, {
   3.6126833659476643`*^9, 3.612683370776984*^9}, {3.612684012047741*^9, 
   3.612684013375018*^9}, 3.615286583849702*^9, {3.616213832502708*^9, 
   3.6162138349511213`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"perms", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{"List", ",", "#"}], "]"}], "&"}], ",", 
    RowBox[{"Apply", "[", 
     RowBox[{"List", ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"sym", "[", 
          RowBox[{"Range", "[", "3", "]"}], "]"}], "[", "]"}], 
        RowBox[{"3", "!"}]}], "//", "Expand"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"mvCrossingNumber", ",", "perms"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"mvXnumber", ",", "perms"}], "]"}]}], "Input",
 CellChangeTimes->{{3.612683100931959*^9, 3.6126831040209618`*^9}, {
  3.6126831776792583`*^9, 3.612683187884202*^9}, {3.612683403193637*^9, 
  3.612683406363415*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.612683104832934*^9, 3.612683189729601*^9, {3.612683384610312*^9, 
   3.6126834124425364`*^9}, 3.612684017217762*^9, 3.612686975591894*^9, 
   3.615277594506578*^9, 3.6152864889722424`*^9, 3.616213866095052*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "1", ",", "2", ",", "2", ",", "3"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.612683104832934*^9, 3.612683189729601*^9, {3.612683384610312*^9, 
   3.6126834124425364`*^9}, 3.612684017217762*^9, 3.612686975591894*^9, 
   3.615277594506578*^9, 3.6152864889722424`*^9, 3.616213866103109*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "1", ",", "2", ",", "2", ",", "3"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.612683104832934*^9, 3.612683189729601*^9, {3.612683384610312*^9, 
   3.6126834124425364`*^9}, 3.612684017217762*^9, 3.612686975591894*^9, 
   3.615277594506578*^9, 3.6152864889722424`*^9, 3.616213866109082*^9}]
}, Open  ]],

Cell["Remembering computed values is faster than compiling the fn,", "Text",
 CellChangeTimes->{{3.612674330694357*^9, 3.612674350517768*^9}, {
  3.612682912495768*^9, 3.612682927006976*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"perms", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{"List", ",", "#"}], "]"}], "&"}], ",", 
     RowBox[{"Apply", "[", 
      RowBox[{"List", ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"sym", "[", 
           RowBox[{"Range", "[", "7", "]"}], "]"}], "[", "]"}], 
         RowBox[{"7", "!"}]}], "//", "Expand"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{"mvCrossingNumber", ",", "perms"}], "]"}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{"mvCrossingNumber", ",", "perms"}], "]"}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{"mvXnumber", ",", "perms"}], "]"}], ";"}], "]"}]}], "Input",
 CellChangeTimes->{{3.612682869237914*^9, 3.6126828728723087`*^9}, {
  3.61268321104714*^9, 3.6126832196731367`*^9}, {3.612683426205695*^9, 
  3.612683429510689*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.43202699999999999436184339174360502511`5.656110802651459", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{3.6126828790264807`*^9, 3.612683263259964*^9, 
  3.6126834369600077`*^9, 3.6126840232620792`*^9, 3.6126869767631083`*^9, 
  3.6152775972689133`*^9, 3.61528649149032*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.00800000000000000016653345369377348106`3.9236899002715675", ",", 
   "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.6126828790264807`*^9, 3.612683263259964*^9, 
  3.6126834369600077`*^9, 3.6126840232620792`*^9, 3.6126869767631083`*^9, 
  3.6152775972689133`*^9, 3.615286491498205*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.01600100000000000133315580796988797374`4.224747038492471", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{3.6126828790264807`*^9, 3.612683263259964*^9, 
  3.6126834369600077`*^9, 3.6126840232620792`*^9, 3.6126869767631083`*^9, 
  3.6152775972689133`*^9, 3.6152864915841227`*^9}]
}, Open  ]],

Cell["\<\
Crossing number is the primary ordering,  then order by the index list if \
crossing number is the same,\
\>", "Text",
 CellChangeTimes->{{3.612565788496058*^9, 3.612565837782002*^9}, {
  3.612565875876987*^9, 3.612565903077797*^9}, {3.612660037512721*^9, 
  3.6126600768832693`*^9}, {3.6126601317729197`*^9, 3.612660181321102*^9}, {
  3.612661272891971*^9, 3.6126612870015*^9}, {3.612665167105682*^9, 
  3.6126651827800903`*^9}, {3.612683773893017*^9, 3.6126838306751547`*^9}, {
  3.6126840475721693`*^9, 3.612684057860384*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CrossingOrderedQ", "[", 
   RowBox[{"n1_", ",", "n2_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"mvCrossingNumber", "[", "n1", "]"}], "\[LessEqual]", 
   RowBox[{"mvCrossingNumber", "[", "n2", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612660364863583*^9, 3.612660374269289*^9}, {
  3.612660580706658*^9, 3.612660582847712*^9}}],

Cell["Two equivalent defns. The second should be faster,", "Text",
 CellChangeTimes->{{3.612565788496058*^9, 3.612565837782002*^9}, {
  3.612565875876987*^9, 3.612565903077797*^9}, {3.612660037512721*^9, 
  3.6126600768832693`*^9}, {3.6126601317729197`*^9, 3.612660181321102*^9}, {
  3.612661272891971*^9, 3.6126612870015*^9}, {3.612665167105682*^9, 
  3.6126651827800903`*^9}, {3.612683773893017*^9, 3.6126838306751547`*^9}, {
  3.6126840475721693`*^9, 3.612684057860384*^9}, {3.612813321542391*^9, 
  3.612813345349414*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mvOrderedQ", "[", 
   RowBox[{"n1_List", ",", "n2_List"}], "]"}], ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CrossingOrderedQ", "[", 
      RowBox[{"n1", ",", "n2"}], "]"}], "&&", 
     RowBox[{"CrossingOrderedQ", "[", 
      RowBox[{"n2", ",", "n1"}], "]"}]}], ",", 
    RowBox[{"mvListOrderedQ", "[", 
     RowBox[{"n1", ",", "n2"}], "]"}], ",", 
    RowBox[{"CrossingOrderedQ", "[", 
     RowBox[{"n1", ",", "n2"}], "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mvOrderedQ", "[", 
   RowBox[{"n1_List", ",", "n2_List"}], "]"}], ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"mvCrossingNumber", "[", "n1", "]"}], "===", 
     RowBox[{"mvCrossingNumber", "[", "n2", "]"}]}], ",", 
    RowBox[{"mvListOrderedQ", "[", 
     RowBox[{"n1", ",", "n2"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mvCrossingNumber", "[", "n1", "]"}], "<", 
     RowBox[{"mvCrossingNumber", "[", "n2", "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6128131278154182`*^9, 3.6128132271758966`*^9}}],

Cell["\<\
To properly order mv argument lists, we need to use equal-length arguments or \
code the ordering by hand,\
\>", "Text",
 CellChangeTimes->{{3.612565788496058*^9, 3.612565837782002*^9}, {
  3.612565875876987*^9, 3.612565903077797*^9}, {3.612660037512721*^9, 
  3.6126600768832693`*^9}, {3.6126601317729197`*^9, 3.612660181321102*^9}, {
  3.612661272891971*^9, 3.6126612870015*^9}, {3.612665167105682*^9, 
  3.612665232324257*^9}, {3.612665724981237*^9, 3.612665736719015*^9}, {
  3.6126658670472193`*^9, 3.6126658887838573`*^9}, {3.612666049238598*^9, 
  3.612666077184886*^9}, {3.612683544051511*^9, 3.612683605554089*^9}, {
  3.612686230461784*^9, 3.6126862320615253`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"OrderedQ", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3", ",", "5", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OrderedQ", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3", ",", "5", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "2", ",", "1", ",", "4", ",", "5"}], "}"}]}], "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.612665804810398*^9, 3.6126658241094923`*^9}, {
  3.6126658940542183`*^9, 3.6126659199715023`*^9}, {3.612666106535274*^9, 
  3.612666158085124*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.612665816432197*^9, 3.612665825584483*^9}, {
   3.612665903504752*^9, 3.6126659221684637`*^9}, {3.612666112897756*^9, 
   3.612666122240844*^9}, 3.612666158705493*^9, 3.612671143735523*^9, 
   3.612684067220973*^9, 3.612686977072405*^9, 3.615277597925995*^9, 
   3.615286492343946*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.612665816432197*^9, 3.612665825584483*^9}, {
   3.612665903504752*^9, 3.6126659221684637`*^9}, {3.612666112897756*^9, 
   3.612666122240844*^9}, 3.612666158705493*^9, 3.612671143735523*^9, 
   3.612684067220973*^9, 3.612686977072405*^9, 3.615277597925995*^9, 
   3.61528649234767*^9}]
}, Open  ]],

Cell["Code the ordering by hand,", "Text",
 CellChangeTimes->{{3.612565788496058*^9, 3.612565837782002*^9}, {
  3.612565875876987*^9, 3.612565903077797*^9}, {3.612660037512721*^9, 
  3.6126600768832693`*^9}, {3.6126601317729197`*^9, 3.612660181321102*^9}, {
  3.612661272891971*^9, 3.6126612870015*^9}, {3.612665167105682*^9, 
  3.612665232324257*^9}, {3.612665724981237*^9, 3.612665736719015*^9}, {
  3.6126658670472193`*^9, 3.6126658887838573`*^9}, {3.612666049238598*^9, 
  3.612666077184886*^9}, {3.612683544051511*^9, 3.612683605554089*^9}, {
  3.612683655875906*^9, 3.61268365755439*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mvListOrderedQ", "[", 
   RowBox[{"n1_List", ",", "n2_List"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"n1", "===", 
      RowBox[{"{", "}"}]}], "||", 
     RowBox[{"n2", "===", 
      RowBox[{"{", "}"}]}], "||", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"First", "[", "n1", "]"}], "<", 
       RowBox[{"First", "[", "n2", "]"}]}], ")"}]}], ",", "True", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"First", "[", "n1", "]"}], "===", 
       RowBox[{"First", "[", "n2", "]"}]}], ",", " ", 
      RowBox[{"mvListOrderedQ", "[", 
       RowBox[{
        RowBox[{"Rest", "[", "n1", "]"}], ",", 
        RowBox[{"Rest", "[", "n2", "]"}]}], "]"}], ",", "False"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612671954195408*^9, 3.6126720484055157`*^9}, {
   3.612672105346381*^9, 3.612672118934134*^9}, {3.612672150823189*^9, 
   3.6126721553079653`*^9}, {3.612672203208397*^9, 3.6126724155513363`*^9}, {
   3.6126727842100353`*^9, 3.612672786897263*^9}, {3.612673006800462*^9, 
   3.612673044902028*^9}, 3.612673076306723*^9}],

Cell["\<\
Adjacent swaps may suffice,  and they are 20% faster than swapping  X1, X2  \
when not adjacent,\
\>", "Text",
 CellChangeTimes->{{3.612565788496058*^9, 3.612565837782002*^9}, {
  3.612565875876987*^9, 3.612565903077797*^9}, {3.612660037512721*^9, 
  3.6126600768832693`*^9}, {3.6126601317729197`*^9, 3.612660181321102*^9}, {
  3.612661272891971*^9, 3.6126612870015*^9}, {3.6126642675673313`*^9, 
  3.6126643063280973`*^9}, {3.612664507517538*^9, 3.612664507897004*^9}, {
  3.612667321561736*^9, 3.6126674281665583`*^9}, {3.6126845597028437`*^9, 
  3.612684577654435*^9}, {3.612685659275628*^9, 3.612685682331379*^9}, {
  3.612686247438135*^9, 3.612686275069965*^9}}],

Cell["Timing[sadj = \
sym[][X1\[CircleTimes]X2\[CircleTimes]X3\[CircleTimes]X4];]", "Text",
 CellChangeTimes->{{3.612684618173696*^9, 3.61268463335786*^9}, {
   3.612684695550209*^9, 3.6126847035341997`*^9}, {3.612684827993802*^9, 
   3.612684840687023*^9}, {3.6126848889125347`*^9, 3.612684896942198*^9}, 
   3.612685649777975*^9}],

Cell["{82.4132, Null}", "Text",
 CellChangeTimes->{3.612684704863368*^9, 3.612685014944916*^9, 
  3.6126856497787848`*^9}],

Cell["Timing[sgen = \
sym[][X1\[CircleTimes]X2\[CircleTimes]X3\[CircleTimes]X4];]", "Text",
 CellChangeTimes->{{3.6126849077290373`*^9, 3.612684909696601*^9}, 
   3.6126856497796*^9}],

Cell["{100.926, Null}", "Text",
 CellChangeTimes->{3.6126853079232683`*^9, 3.612685649780328*^9}],

Cell["sgen === sadj", "Text",
 CellChangeTimes->{{3.6126847596266403`*^9, 3.6126847898664913`*^9}, 
   3.612685865378516*^9}],

Cell["True", "Text",
 CellChangeTimes->{{3.6126847632318897`*^9, 3.612684790911401*^9}, 
   3.612685535056628*^9, 3.612685865379257*^9}],

Cell["\<\
General pair-wise swaps based on  mvOrderedQ  will order the factors within \
any tensor product. Here we swap  X1,  X2   if    ! mvOrderedQ ,
This is not initialized.  Adjacent swaps is faster.\
\>", "Text",
 CellChangeTimes->{{3.612565788496058*^9, 3.612565837782002*^9}, {
  3.612565875876987*^9, 3.612565903077797*^9}, {3.612660037512721*^9, 
  3.6126600768832693`*^9}, {3.6126601317729197`*^9, 3.612660181321102*^9}, {
  3.612661272891971*^9, 3.6126612870015*^9}, {3.6126642675673313`*^9, 
  3.6126643063280973`*^9}, {3.612664507517538*^9, 3.612664507897004*^9}, {
  3.612667321561736*^9, 3.6126674281665583`*^9}, {3.613963177564349*^9, 
  3.61396321088942*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mv", "[", "n__Integer", "]"}], "[", 
    RowBox[{
    "Y1___", "\[CircleTimes]", "X1_", "\[CircleTimes]", "Y2___", 
     "\[CircleTimes]", "X2_", "\[CircleTimes]", "Y3___"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"IntegerQ", "[", 
     RowBox[{"deg", "[", "X1", "]"}], "]"}], "&&", 
    RowBox[{"IntegerQ", "[", 
     RowBox[{"deg", "[", "X2", "]"}], "]"}], "&&", 
    RowBox[{"IntegerQ", "[", 
     RowBox[{"deg", "[", "Y1", "]"}], "]"}], "&&", 
    RowBox[{"IntegerQ", "[", 
     RowBox[{"deg", "[", "Y2", "]"}], "]"}], "&&", 
    RowBox[{"IntegerQ", "[", 
     RowBox[{"deg", "[", "Y3", "]"}], "]"}], "&&", 
    RowBox[{"!", 
     RowBox[{"mvOrderedQ", "[", 
      RowBox[{
       RowBox[{"{", "n", "}"}], ",", 
       RowBox[{"Apply", "[", 
        RowBox[{"List", ",", 
         RowBox[{"mvSwapped", "[", 
          RowBox[{
           RowBox[{"{", "n", "}"}], ",", 
           RowBox[{"deg", "[", "Y1", "]"}], ",", 
           RowBox[{"deg", "[", "X1", "]"}], ",", 
           RowBox[{"deg", "[", "Y2", "]"}], ",", 
           RowBox[{"deg", "[", "X2", "]"}], ",", 
           RowBox[{"deg", "[", "Y3", "]"}]}], "]"}]}], "]"}]}], "]"}]}]}]}], ":=",
   "  ", 
  RowBox[{
   RowBox[{"mvSwapped", "[", 
    RowBox[{
     RowBox[{"{", "n", "}"}], ",", 
     RowBox[{"deg", "[", "Y1", "]"}], ",", 
     RowBox[{"deg", "[", "X1", "]"}], ",", 
     RowBox[{"deg", "[", "Y2", "]"}], ",", 
     RowBox[{"deg", "[", "X2", "]"}], ",", 
     RowBox[{"deg", "[", "Y3", "]"}]}], "]"}], "[", 
   RowBox[{
   "Y1", "\[CircleTimes]", "X2", "\[CircleTimes]", "Y2", "\[CircleTimes]", 
    "X1", "\[CircleTimes]", "Y3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.612207528698896*^9, 3.612207566167646*^9}, {
   3.612208331828244*^9, 3.6122085173184643`*^9}, {3.6122087412764263`*^9, 
   3.612208800760625*^9}, 3.612209259583975*^9, {3.612209972249522*^9, 
   3.612209977850235*^9}, {3.612210045276464*^9, 3.612210048026244*^9}, {
   3.612210195230248*^9, 3.612210237549611*^9}, {3.6122112337310658`*^9, 
   3.612211253496937*^9}, {3.612212328395769*^9, 3.612212360247452*^9}, {
   3.612212793242075*^9, 3.612212818791462*^9}, {3.612212952908514*^9, 
   3.6122129679838037`*^9}, {3.612214627754335*^9, 3.612214635057537*^9}, {
   3.612214823433256*^9, 3.612214828984169*^9}, {3.61221503696776*^9, 
   3.612215050789095*^9}, {3.612215150744013*^9, 3.612215170182664*^9}, {
   3.6126600169024553`*^9, 3.61266002910102*^9}, {3.612660197794146*^9, 
   3.6126602117254972`*^9}, {3.612660409524345*^9, 3.612660410834816*^9}, {
   3.612660443854767*^9, 3.612660453483841*^9}, 3.612660511792169*^9, {
   3.61266055002077*^9, 3.612660563059909*^9}, {3.612660750395599*^9, 
   3.61266076132474*^9}, {3.612660812325021*^9, 3.6126608422766733`*^9}, {
   3.612661172071301*^9, 3.612661255657156*^9}, {3.612662210188401*^9, 
   3.612662211693227*^9}, {3.612663991127103*^9, 3.612663992883613*^9}, {
   3.612664396801632*^9, 3.61266448204284*^9}, {3.612667435676352*^9, 
   3.612667436439725*^9}, {3.61266748305278*^9, 3.6126674968623447`*^9}, {
   3.613963101446701*^9, 3.61396311113526*^9}, {3.6139631579017563`*^9, 
   3.613963161843625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mv", "[", "n__Integer", "]"}], "[", 
    RowBox[{
    "Y1___", "\[CircleTimes]", "X1_", "\[CircleTimes]", "Y2___", 
     "\[CircleTimes]", "X2_", "\[CircleTimes]", "Y3___"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"IntegerQ", "[", 
     RowBox[{"deg", "[", "X1", "]"}], "]"}], "&&", 
    RowBox[{"IntegerQ", "[", 
     RowBox[{"deg", "[", "X2", "]"}], "]"}], "&&", 
    RowBox[{"IntegerQ", "[", 
     RowBox[{"deg", "[", "Y1", "]"}], "]"}], "&&", 
    RowBox[{"IntegerQ", "[", 
     RowBox[{"deg", "[", "Y2", "]"}], "]"}], "&&", 
    RowBox[{"IntegerQ", "[", 
     RowBox[{"deg", "[", "Y3", "]"}], "]"}], "&&", 
    RowBox[{"!", 
     RowBox[{"mvOrderedQ", "[", 
      RowBox[{
       RowBox[{"{", "n", "}"}], ",", 
       RowBox[{"Apply", "[", 
        RowBox[{"List", ",", 
         RowBox[{"mvSwapped", "[", 
          RowBox[{
           RowBox[{"{", "n", "}"}], ",", 
           RowBox[{"deg", "[", "Y1", "]"}], ",", 
           RowBox[{"deg", "[", "X1", "]"}], ",", 
           RowBox[{"deg", "[", "Y2", "]"}], ",", 
           RowBox[{"deg", "[", "X2", "]"}], ",", 
           RowBox[{"deg", "[", "Y3", "]"}]}], "]"}]}], "]"}]}], "]"}]}]}]}], 
  "=."}]], "Input",
 CellChangeTimes->{{3.612668213992065*^9, 3.6126682143527803`*^9}}],

Cell["\<\
Adjacent swaps based on  mvOrderedQ,  with checking that  X1  and  X2   are \
not composite  (the checking can make it run almost 2x faster),\
\>", "Text",
 CellChangeTimes->{{3.612565788496058*^9, 3.612565837782002*^9}, {
   3.612565875876987*^9, 3.612565903077797*^9}, {3.612660037512721*^9, 
   3.6126600768832693`*^9}, {3.6126601317729197`*^9, 3.612660181321102*^9}, {
   3.612661272891971*^9, 3.6126612870015*^9}, {3.612668063919509*^9, 
   3.6126680782549667`*^9}, 3.612685694059713*^9, {3.61281929579163*^9, 
   3.6128192998179083`*^9}, {3.612819382412425*^9, 3.612819413019519*^9}, {
   3.6128194642681103`*^9, 3.612819467852096*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"mv", "[", "n__Integer", "]"}], "[", 
     RowBox[{"Y1___", "\[CircleTimes]", 
      RowBox[{"(", 
       RowBox[{"X1_", "/;", 
        RowBox[{"FreeQ", "[", 
         RowBox[{"X1", ",", "CircleTimes"}], "]"}]}], ")"}], "\[CircleTimes]", 
      RowBox[{"(", 
       RowBox[{"X2_", "/;", 
        RowBox[{"FreeQ", "[", 
         RowBox[{"X2", ",", "CircleTimes"}], "]"}]}], ")"}], "\[CircleTimes]",
       "Y3___"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"IntegerQ", "[", 
      RowBox[{"deg", "[", "X1", "]"}], "]"}], "&&", 
     RowBox[{"IntegerQ", "[", 
      RowBox[{"deg", "[", "X2", "]"}], "]"}], "&&", 
     RowBox[{"IntegerQ", "[", 
      RowBox[{"deg", "[", "Y1", "]"}], "]"}], "&&", 
     RowBox[{"IntegerQ", "[", 
      RowBox[{"deg", "[", "Y3", "]"}], "]"}], "&&", 
     RowBox[{"!", 
      RowBox[{"mvOrderedQ", "[", 
       RowBox[{
        RowBox[{"{", "n", "}"}], ",", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", 
          RowBox[{"mvSwapped", "[", 
           RowBox[{
            RowBox[{"{", "n", "}"}], ",", 
            RowBox[{"deg", "[", "Y1", "]"}], ",", 
            RowBox[{"deg", "[", "X1", "]"}], ",", 
            RowBox[{"deg", "[", "X2", "]"}], ",", 
            RowBox[{"deg", "[", "Y3", "]"}]}], "]"}]}], "]"}]}], "]"}]}]}]}], 
   ":=", "  ", 
   RowBox[{
    RowBox[{"mvSwapped", "[", 
     RowBox[{
      RowBox[{"{", "n", "}"}], ",", 
      RowBox[{"deg", "[", "Y1", "]"}], ",", 
      RowBox[{"deg", "[", "X1", "]"}], ",", 
      RowBox[{"deg", "[", "X2", "]"}], ",", 
      RowBox[{"deg", "[", "Y3", "]"}]}], "]"}], "[", 
    RowBox[{
    "Y1", "\[CircleTimes]", "X2", "\[CircleTimes]", "X1", "\[CircleTimes]", 
     "Y3"}], "]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.612207528698896*^9, 3.612207566167646*^9}, {
   3.612208331828244*^9, 3.6122085173184643`*^9}, {3.6122087412764263`*^9, 
   3.612208800760625*^9}, 3.612209259583975*^9, {3.612209972249522*^9, 
   3.612209977850235*^9}, {3.612210045276464*^9, 3.612210048026244*^9}, {
   3.612210195230248*^9, 3.612210237549611*^9}, {3.6122112337310658`*^9, 
   3.612211253496937*^9}, {3.612212328395769*^9, 3.612212360247452*^9}, {
   3.612212793242075*^9, 3.612212818791462*^9}, {3.612212952908514*^9, 
   3.6122129679838037`*^9}, {3.612214627754335*^9, 3.612214635057537*^9}, {
   3.612214823433256*^9, 3.612214828984169*^9}, {3.61221503696776*^9, 
   3.612215050789095*^9}, {3.612215150744013*^9, 3.612215170182664*^9}, {
   3.6126600169024553`*^9, 3.61266002910102*^9}, {3.612660197794146*^9, 
   3.6126602117254972`*^9}, {3.612660409524345*^9, 3.612660410834816*^9}, {
   3.612660443854767*^9, 3.612660453483841*^9}, 3.612660511792169*^9, {
   3.61266055002077*^9, 3.612660563059909*^9}, {3.612660750395599*^9, 
   3.61266076132474*^9}, {3.612660812325021*^9, 3.6126608422766733`*^9}, {
   3.612661172071301*^9, 3.612661255657156*^9}, {3.612662210188401*^9, 
   3.612662211693227*^9}, {3.612663991127103*^9, 3.612663992883613*^9}, {
   3.612664396801632*^9, 3.61266448204284*^9}, {3.612667435676352*^9, 
   3.612667436439725*^9}, {3.61266748305278*^9, 3.6126674968623447`*^9}, {
   3.6126681413938313`*^9, 3.612668199356238*^9}, {3.6128122425318203`*^9, 
   3.612812245731531*^9}, 3.612813514728867*^9, {3.612817630264862*^9, 
   3.6128176912735853`*^9}, {3.613963241045888*^9, 3.61396324798507*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "83", "]"}]], "Output"]
}, Open  ]],

Cell["This is for adjacent swaps  (no Y between X1, X2),", "Text",
 CellChangeTimes->{{3.612565788496058*^9, 3.612565837782002*^9}, {
  3.612565875876987*^9, 3.612565903077797*^9}, {3.612660037512721*^9, 
  3.6126600768832693`*^9}, {3.6126601317729197`*^9, 3.612660181321102*^9}, {
  3.612661272891971*^9, 3.6126612870015*^9}, {3.6126645906863947`*^9, 
  3.612664628392832*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mvSwapped", "[", 
   RowBox[{
   "n_List", ",", "y1_Integer", ",", "x1_Integer", ",", "x2_Integer", ",", 
    "y2_Integer"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"mv", "[", "n", "]"}], "[", 
   RowBox[{"mvInverse", "[", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Range", "[", "y1", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Range", "[", "x2", "]"}], "+", "y1", "+", "x1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Range", "[", "x1", "]"}], "+", "y1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Range", "[", "y2", "]"}], "+", "y1", "+", "x1", "+", "x2"}]}],
      "]"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6126608540272837`*^9, 3.6126610556836767`*^9}, {
   3.61266108784791*^9, 3.612661162237383*^9}, {3.6126903567407722`*^9, 
   3.612690430682864*^9}, {3.61269071955119*^9, 3.612690786621295*^9}, {
   3.612690817698546*^9, 3.612690834953012*^9}, {3.612715400301241*^9, 
   3.61271540097473*^9}, 3.614835721729228*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mvSwappedDebug", "[", 
   RowBox[{
   "n_List", ",", "y1_Integer", ",", "x1_Integer", ",", "x2_Integer", ",", 
    "y2_Integer"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mvs", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mvs", "=", 
      RowBox[{
       RowBox[{"mv", "[", "n", "]"}], "[", 
       RowBox[{"mvInverse", "[", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Range", "[", "y1", "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Range", "[", "x2", "]"}], "+", "y1", "+", "x1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Range", "[", "x1", "]"}], "+", "y1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Range", "[", "y2", "]"}], "+", "y1", "+", "x1", "+", 
           "x2"}]}], "]"}], "]"}], "]"}]}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{
      "n", ",", "\"\< \>\"", ",", "mvs", ",", "\"\< \>\"", ",", "y1", ",", 
       "\"\< \>\"", ",", "x1", ",", "\"\< \>\"", ",", "x2", ",", "\"\< \>\"", 
       ",", "y2"}], "]"}], ";", "mvs"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6126608540272837`*^9, 3.6126610556836767`*^9}, {
   3.61266108784791*^9, 3.612661162237383*^9}, {3.6126903567407722`*^9, 
   3.612690430682864*^9}, {3.61269071955119*^9, 3.612690807453148*^9}, {
   3.612715407638123*^9, 3.61271540823131*^9}, {3.6128655533661213`*^9, 
   3.6128655750784187`*^9}, 3.6148357288268414`*^9}],

Cell["This is for general swaps  (maybe a Y between X1, X2),", "Text",
 CellChangeTimes->{{3.612565788496058*^9, 3.612565837782002*^9}, {
  3.612565875876987*^9, 3.612565903077797*^9}, {3.612660037512721*^9, 
  3.6126600768832693`*^9}, {3.6126601317729197`*^9, 3.612660181321102*^9}, {
  3.612661272891971*^9, 3.6126612870015*^9}, {3.6126645906863947`*^9, 
  3.612664647502187*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mvSwapped", "[", 
   RowBox[{
   "n_List", ",", "y1_Integer", ",", "x1_Integer", ",", "y2_Integer", ",", 
    "x2_Integer", ",", "y3_Integer"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"mv", "[", "n", "]"}], "[", 
   RowBox[{"mvInverse", "[", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Range", "[", "y1", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Range", "[", "x2", "]"}], "+", "y1", "+", "x1", "+", "y2"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Range", "[", "y2", "]"}], "+", "y1", "+", "x1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Range", "[", "x1", "]"}], "+", "y1"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Range", "[", "y3", "]"}], "+", "y1", "+", "x1", "+", "y2", 
       "+", "x2"}]}], "\[IndentingNewLine]", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6126608540272837`*^9, 3.6126610556836767`*^9}, {
   3.61266108784791*^9, 3.612661162237383*^9}, {3.6126646598884172`*^9, 
   3.612664694641407*^9}, {3.612664728752132*^9, 3.612664745488721*^9}, {
   3.612664783681581*^9, 3.612664813984371*^9}, {3.612715412862647*^9, 
   3.612715413426528*^9}, 3.614835730168236*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearField", "[", "X", "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"2", ",", "X"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ExpectedTiming", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"sym", "[", "]"}], "[", 
     RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "//", "Simplify"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.613963355183469*^9, 3.613963372180698*^9}, {
  3.615286718995636*^9, 3.615286749934697*^9}, {3.61528710661266*^9, 
  3.615287146418826*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
  "0.02`", "\[InvisibleSpace]", "\<\"\[VeryThinSpace]\[VeryThinSpace]\
\[VeryThinSpace]sec, at \[VeryThinSpace]\[VeryThinSpace]\"\>", 
   "\[InvisibleSpace]", "\<\"2014-07-26 00:25\"\>", 
   "\[InvisibleSpace]", "\<\".\"\>"}],
  SequenceForm[
  0.02, "\[VeryThinSpace]\[VeryThinSpace]\[VeryThinSpace]sec, at \
\[VeryThinSpace]\[VeryThinSpace]", "2014-07-26 00:25", "."],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6152867370201807`*^9, 3.61528675248985*^9}, {
  3.615287111569219*^9, 3.615287147212699*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "12"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"X", "\[CircleTimes]", "X"}], "+", 
    RowBox[{"X", "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "\[CircleTimes]", 
     "X"}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}], "\[CircleTimes]", 
     RowBox[{
      RowBox[{"mv", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "[", "X", "]"}]}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "2", ",", "4"}], "]"}], "[", 
     RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "4", ",", "2"}], "]"}], "[", 
     RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "2", ",", "3"}], "]"}], "[", 
     RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "4", ",", "3", ",", "2"}], "]"}], "[", 
     RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "1", ",", "4"}], "]"}], "[", 
     RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "3", ",", "4", ",", "1"}], "]"}], "[", 
     RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "1", ",", "3"}], "]"}], "[", 
     RowBox[{"X", "\[CircleTimes]", "X"}], "]"}], "+", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "4", ",", "3", ",", "1"}], "]"}], "[", 
     RowBox[{"X", "\[CircleTimes]", "X"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.61396337485079*^9, {3.613963466872622*^9, 3.6139634695911407`*^9}, 
   3.613963611364931*^9, 3.615277599620685*^9, 3.615286493888248*^9, {
   3.615286737130773*^9, 3.615286752574759*^9}, {3.6152871116519547`*^9, 
   3.615287147221582*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing", "Subsubsection",
 CellChangeTimes->{{3.6152870576598597`*^9, 3.61528705933917*^9}}],

Cell["This gets swapped to correct order,", "Text",
 CellChangeTimes->{{3.612690080911524*^9, 3.612690102431287*^9}, {
  3.612715545434657*^9, 3.612715548425997*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearField", "[", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y"}], "}"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"2", ",", "X"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"1", ",", "Y"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumeSymmetric", "[", "X", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"1", ",", "3", ",", "2"}], "]"}], "[", 
  RowBox[{"X", "\[CircleTimes]", "Y"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"2", ",", "1", ",", "3"}], "]"}], "[", 
  RowBox[{"Y", "\[CircleTimes]", "X"}], "]"}]}], "Input",
 CellChangeTimes->{{3.612689816082489*^9, 3.6126899053844223`*^9}, {
  3.6139782749853363`*^9, 3.6139783179317923`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"1", ",", "3", ",", "2"}], "]"}], "[", 
  RowBox[{"X", "\[CircleTimes]", "Y"}], "]"}]], "Output",
 CellChangeTimes->{3.612689908020796*^9, 3.612715535706314*^9, 
  3.6139783227992764`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[29]:\"\>", "\[InvisibleSpace]", "\<\"   \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"mv", "[", "n__Integer", "]"}], "[", 
       RowBox[{"Y1___", "\[CircleTimes]", 
        RowBox[{"(", 
         RowBox[{"X1_", "/;", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"X1", ",", "CircleTimes"}], "]"}]}], ")"}], 
        "\[CircleTimes]", 
        RowBox[{"(", 
         RowBox[{"X2_", "/;", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"X2", ",", "CircleTimes"}], "]"}]}], ")"}], 
        "\[CircleTimes]", "Y3___"}], "]"}], "/;", 
      RowBox[{
       RowBox[{"IntegerQ", "[", 
        RowBox[{"deg", "[", "X1", "]"}], "]"}], "&&", 
       RowBox[{"IntegerQ", "[", 
        RowBox[{"deg", "[", "X2", "]"}], "]"}], "&&", 
       RowBox[{"IntegerQ", "[", 
        RowBox[{"deg", "[", "Y1", "]"}], "]"}], "&&", 
       RowBox[{"IntegerQ", "[", 
        RowBox[{"deg", "[", "Y3", "]"}], "]"}], "&&", 
       RowBox[{"!", 
        RowBox[{"mvOrderedQ", "[", 
         RowBox[{
          RowBox[{"{", "n", "}"}], ",", 
          RowBox[{"List", "@@", 
           RowBox[{"mvSwapped", "[", 
            RowBox[{
             RowBox[{"{", "n", "}"}], ",", 
             RowBox[{"deg", "[", "Y1", "]"}], ",", 
             RowBox[{"deg", "[", "X1", "]"}], ",", 
             RowBox[{"deg", "[", "X2", "]"}], ",", 
             RowBox[{"deg", "[", "Y3", "]"}]}], "]"}]}]}], "]"}]}]}]}], ":=", 
     
     RowBox[{
      RowBox[{"mvSwapped", "[", 
       RowBox[{
        RowBox[{"{", "n", "}"}], ",", 
        RowBox[{"deg", "[", "Y1", "]"}], ",", 
        RowBox[{"deg", "[", "X1", "]"}], ",", 
        RowBox[{"deg", "[", "X2", "]"}], ",", 
        RowBox[{"deg", "[", "Y3", "]"}]}], "]"}], "[", 
      RowBox[{
      "Y1", "\[CircleTimes]", "X2", "\[CircleTimes]", "X1", "\[CircleTimes]", 
       "Y3"}], "]"}]}],
    HoldForm]}],
  SequenceForm["rule[29]:", "   ", 
   HoldForm[Condition[
      $CellContext`mv[
       Pattern[$CellContext`n, 
        BlankSequence[Integer]]][
       CircleTimes[
        Pattern[$CellContext`Y1, 
         BlankNullSequence[]], 
        Condition[
         Pattern[$CellContext`X1, 
          Blank[]], 
         FreeQ[$CellContext`X1, CircleTimes]], 
        Condition[
         Pattern[$CellContext`X2, 
          Blank[]], 
         FreeQ[$CellContext`X2, CircleTimes]], 
        Pattern[$CellContext`Y3, 
         BlankNullSequence[]]]], 
      And[
       IntegerQ[
        $CellContext`deg[$CellContext`X1]], 
       IntegerQ[
        $CellContext`deg[$CellContext`X2]], 
       IntegerQ[
        $CellContext`deg[$CellContext`Y1]], 
       IntegerQ[
        $CellContext`deg[$CellContext`Y3]], 
       Not[
        $CellContext`mvOrderedQ[{$CellContext`n}, 
         Apply[List, 
          $CellContext`mvSwapped[{$CellContext`n}, 
           $CellContext`deg[$CellContext`Y1], 
           $CellContext`deg[$CellContext`X1], 
           $CellContext`deg[$CellContext`X2], 
           $CellContext`deg[$CellContext`Y3]]]]]]] := \
$CellContext`mvSwapped[{$CellContext`n}, 
      $CellContext`deg[$CellContext`Y1], 
      $CellContext`deg[$CellContext`X1], 
      $CellContext`deg[$CellContext`X2], 
      $CellContext`deg[$CellContext`Y3]][
      CircleTimes[$CellContext`Y1, $CellContext`X2, $CellContext`X1, \
$CellContext`Y3]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.613978322807605*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mv", "[", 
   RowBox[{"1", ",", "3", ",", "2"}], "]"}], "[", 
  RowBox[{"X", "\[CircleTimes]", "Y"}], "]"}]], "Output",
 CellChangeTimes->{3.612689908020796*^9, 3.612715535706314*^9, 
  3.6139783228126698`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"mvCrossingNumber", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "3", ",", "2"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"mvCrossingNumber", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "1", ",", "3"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.612689979234887*^9, 3.612689997655787*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.612689998641967*^9, 3.612715558682033*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.612689998641967*^9, 3.612715558684968*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"mvOrderedQ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "3"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"mvOrderedQ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "2"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.612690025714541*^9, 3.6126900487663927`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.612690036335693*^9, 3.612690049551971*^9}, 
   3.612715561214477*^9}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.612690036335693*^9, 3.612690049551971*^9}, 
   3.612715561217354*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatchQ", "[", 
  RowBox[{
   RowBox[{"Hold", "[", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"2", ",", "1", ",", "3"}], "]"}], "[", 
     RowBox[{"Y", "\[CircleTimes]", "X"}], "]"}], "]"}], ",", 
   RowBox[{"Hold", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", "n__Integer", "]"}], "[", 
      RowBox[{
      "Y1___", "\[CircleTimes]", "X1_", "\[CircleTimes]", "X2_", 
       "\[CircleTimes]", "Y3___"}], "]"}], "/;", 
     RowBox[{
      RowBox[{"IntegerQ", "[", 
       RowBox[{"deg", "[", "X1", "]"}], "]"}], "&&", 
      RowBox[{"IntegerQ", "[", 
       RowBox[{"deg", "[", "X2", "]"}], "]"}], "&&", 
      RowBox[{"IntegerQ", "[", 
       RowBox[{"deg", "[", "Y1", "]"}], "]"}], "&&", 
      RowBox[{"IntegerQ", "[", 
       RowBox[{"deg", "[", "Y3", "]"}], "]"}], "&&", 
      RowBox[{"!", 
       RowBox[{"mvOrderedQ", "[", 
        RowBox[{
         RowBox[{"{", "n", "}"}], ",", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", 
           RowBox[{"mvSwappedDebug", "[", 
            RowBox[{
             RowBox[{"{", "n", "}"}], ",", 
             RowBox[{"deg", "[", "Y1", "]"}], ",", 
             RowBox[{"deg", "[", "X1", "]"}], ",", 
             RowBox[{"deg", "[", "X2", "]"}], ",", 
             RowBox[{"deg", "[", "Y3", "]"}]}], "]"}]}], "]"}]}], "]"}]}]}]}],
     "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6126901465516357`*^9, 3.6126902538236513`*^9}, {
   3.612690510238825*^9, 3.612690513423685*^9}, 3.6126908757297077`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "3"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", 
   RowBox[{"mv", "[", 
    RowBox[{"1", ",", "3", ",", "2"}], "]"}], 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm[{2, 1, 3}, " ", 
   $CellContext`mv[1, 3, 2], " ", 0, " ", 1, " ", 2, " ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.61269044538457*^9, 3.612690514603519*^9, 
  3.612690877422073*^9, 3.612715563856243*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.612690194047936*^9, 3.612690255136868*^9}, 
   3.612690445431321*^9, 3.612690514638926*^9, 3.612690877457778*^9, 
   3.612715563895074*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatchQ", "[", 
  RowBox[{
   RowBox[{"Hold", "[", 
    RowBox[{
     RowBox[{"mv", "[", 
      RowBox[{"1", ",", "3", ",", "2"}], "]"}], "[", 
     RowBox[{"X", "\[CircleTimes]", "Y"}], "]"}], "]"}], ",", 
   RowBox[{"Hold", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"mv", "[", "n__Integer", "]"}], "[", 
      RowBox[{
      "Y1___", "\[CircleTimes]", "X1_", "\[CircleTimes]", "X2_", 
       "\[CircleTimes]", "Y3___"}], "]"}], "/;", 
     RowBox[{
      RowBox[{"IntegerQ", "[", 
       RowBox[{"deg", "[", "X1", "]"}], "]"}], "&&", 
      RowBox[{"IntegerQ", "[", 
       RowBox[{"deg", "[", "X2", "]"}], "]"}], "&&", 
      RowBox[{"IntegerQ", "[", 
       RowBox[{"deg", "[", "Y1", "]"}], "]"}], "&&", 
      RowBox[{"IntegerQ", "[", 
       RowBox[{"deg", "[", "Y3", "]"}], "]"}], "&&", 
      RowBox[{"!", 
       RowBox[{"mvOrderedQ", "[", 
        RowBox[{
         RowBox[{"{", "n", "}"}], ",", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", 
           RowBox[{"mvSwappedDebug", "[", 
            RowBox[{
             RowBox[{"{", "n", "}"}], ",", 
             RowBox[{"deg", "[", "Y1", "]"}], ",", 
             RowBox[{"deg", "[", "X1", "]"}], ",", 
             RowBox[{"deg", "[", "X2", "]"}], ",", 
             RowBox[{"deg", "[", "Y3", "]"}]}], "]"}]}], "]"}]}], "]"}]}]}]}],
     "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6126902978874397`*^9, 3.6126903010536003`*^9}, {
  3.612690867249055*^9, 3.612690869090095*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "2"}], "}"}], 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", 
   RowBox[{"mv", "[", 
    RowBox[{"2", ",", "1", ",", "3"}], "]"}], 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "0", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\" \"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm[{1, 3, 2}, " ", 
   $CellContext`mv[2, 1, 3], " ", 0, " ", 2, " ", 1, " ", 0],
  Editable->False]], "Print",
 CellChangeTimes->{3.612690447913086*^9, 3.612690517580345*^9, 
  3.6126908821076508`*^9, 3.612715566655789*^9}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.612690302177044*^9, 3.612690447961157*^9, 
  3.61269051760419*^9, 3.6126908821311626`*^9, 3.612715566689691*^9}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "The general contraction bracket  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "  ", "X", "  ", "\[RightAngleBracket]"}], 
    
    RowBox[{" ", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        SubscriptBox["a", "1"], 
        SubscriptBox["b", "1"]}], "}"}], ",", " ", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{
         SubscriptBox["a", "2"], 
         SubscriptBox["b", "2"]}], "}"}], " ", "..."}]}]}]], 
   TraditionalForm]], "None"],
 "                                     "
}], "Subsection",
 CellChangeTimes->{{3.6117004172917347`*^9, 3.611700487110237*^9}, {
   3.611700901848016*^9, 3.611701130920413*^9}, {3.611701234361413*^9, 
   3.611701302550877*^9}, {3.611701786139716*^9, 3.6117017862152348`*^9}, {
   3.61170200910107*^9, 3.6117020329203777`*^9}, 3.611996273648815*^9, {
   3.6119963087668657`*^9, 3.611996325229361*^9}, {3.612145566621338*^9, 
   3.61214560729216*^9}, {3.612145987296035*^9, 3.612146026046085*^9}, {
   3.612202098180979*^9, 3.612202106094839*^9}, {3.612565371638568*^9, 
   3.612565387187291*^9}, {3.6125666710657663`*^9, 3.612566675757509*^9}, {
   3.612680811591254*^9, 3.612680833447319*^9}, {3.612821745972878*^9, 
   3.612821759682815*^9}, {3.612821790052359*^9, 3.612821838661235*^9}, {
   3.612825269874935*^9, 3.61282536426092*^9}, {3.6139630498808403`*^9, 
   3.6139630516475286`*^9}, {3.6142076142590017`*^9, 
   3.6142076311344833`*^9}, {3.614235211962811*^9, 3.6142352834393187`*^9}, {
   3.6142358306077347`*^9, 3.614235846456574*^9}, {3.614237631663192*^9, 
   3.614237640972167*^9}, {3.6146596384396152`*^9, 3.614659678143455*^9}, {
   3.6152482076122923`*^9, 3.6152482416833897`*^9}, {3.615259704613853*^9, 
   3.615259725288356*^9}, 3.615278888107016*^9, {3.615373933052381*^9, 
   3.615373943931031*^9}, {3.615869144796835*^9, 3.615869147405692*^9}}],

Cell[TextData[{
 "Thoughts on notation. \nThe Qn is whether it would make sense to combine \
the 2 sorts of brackets and allow multiple args within a subscripted \
bracket... \n\nIf  we are to be able to do   \[LeftAngleBracket] x1,  \
\[LeftAngleBracket] x2 ,  x3 \[RightAngleBracket],  x4 ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[RightAngleBracket]", "ab"], TraditionalForm]]],
 "   \[Rule]   \[LeftAngleBracket] x1,  x2,  x3,  x4 ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[RightAngleBracket]", "ab"], TraditionalForm]]],
 "    without changing the subscript pairs ab, then slot counting must not \
count the comma contracted slots.\nEg.  suppose the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["x", 
    RowBox[{" ", "i"}]], TraditionalForm]]],
 "  are deg 2.  If we count all slots, then  setting  y =  \
\[LeftAngleBracket] x2 ,  x3 \[RightAngleBracket],  shows that the slots in  \
\[LeftAngleBracket] x1,  y,  x4 \[RightAngleBracket]  are labeled 1,...,6,  \
but those in  \[LeftAngleBracket] x1,  x2,  x3,  x4 \[RightAngleBracket]  are \
 1,....,8.   \nSo counting that way is inconsistent with not having to update \
 ab  after such a trivial transformation.\n\nThus, only uncontracted slots \
should be counted within  \[LeftAngleBracket] x1,  x2,  x3,  x4 \
\[RightAngleBracket] ,  regarding  ab  values.  So it makes sense to separate \
comma and subscript contraction and write double \npairs of brackets,   \
\[LeftAngleBracket]\[LeftAngleBracket] , , , ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[RightAngleBracket]", "\[RightAngleBracket]"}], "ab__"], 
   TraditionalForm]]],
 " .  It is then clear that comma contraction is done first and therefore \
contracted slots are not counted when specifying a subscript ab.\nHaving \
separate functions for comma and subscript contraction also makes writing \
separate rules possible."
}], "Text",
 CellChangeTimes->{{3.615372709424302*^9, 3.615372829728888*^9}, {
   3.615372902753089*^9, 3.615373195570262*^9}, {3.6153733392505503`*^9, 
   3.615373496451219*^9}, {3.6153735342752867`*^9, 3.615373588051491*^9}, {
   3.615373660915534*^9, 3.615373838820579*^9}, {3.615373900692857*^9, 
   3.615373902504982*^9}, {3.61537416314133*^9, 3.615374502053659*^9}, 
   3.6153745516386547`*^9, {3.64990157497082*^9, 3.649901666023141*^9}}],

Cell["Needs to simplify,", "Text",
 CellChangeTimes->{{3.649986429872994*^9, 3.649986444128327*^9}}],

Cell["\<\
Ver4:  This did not simplify. Should be done properly as a general case, not \
like this.
             See the section on symbolic  Sym[ ]  to see a whole class of \
similar simplifications that are needed,  \
\>", "Text",
 CellChangeTimes->{{3.650165856587232*^9, 3.650165902906345*^9}, {
  3.650243472301757*^9, 3.6502435523171673`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"a1", ",", "a2"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"3", ",", 
   RowBox[{"{", 
    RowBox[{"a1", ",", "a2"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"deg", "[", 
  RowBox[{"{", 
   RowBox[{"a1", ",", "a2"}], "}"}], "]"}], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", "\[CircleTimes]", "a2"}], "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"3", ",", "4"}], "}"}]]}], "Input",
 CellChangeTimes->{{3.6498996044834013`*^9, 3.6498996355566187`*^9}, {
   3.6501657227032423`*^9, 3.650165747698764*^9}, 3.650165916447639*^9, {
   3.6501659705568733`*^9, 3.650166013819194*^9}, {3.6501660963634453`*^9, 
   3.650166100329859*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{{3.649899628043116*^9, 3.6498996380935583`*^9}, 
   3.6501657117430468`*^9, 3.65016591769806*^9, {3.650166002126734*^9, 
   3.650166014320076*^9}, 3.6501661009746437`*^9}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", "\[CircleTimes]", "a2"}], "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"3", ",", "4"}], "}"}]]], "Output",
 CellChangeTimes->{{3.649899628043116*^9, 3.6498996380935583`*^9}, 
   3.6501657117430468`*^9, 3.65016591769806*^9, {3.650166002126734*^9, 
   3.650166014320076*^9}, 3.6501661009780903`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X1_", "\[CircleTimes]", "X2_"}], "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}]], "/;", 
    RowBox[{
     RowBox[{"a", "===", 
      RowBox[{"deg", "[", "X1", "]"}]}], "&&", 
     RowBox[{"b", "===", 
      RowBox[{"a", "+", "1"}]}]}]}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X1", ",", "X2"}], "\[RightAngleBracket]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6501661070498953`*^9, 3.650166187657217*^9}, {
  3.6501662839939737`*^9, 3.65016629007301*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "84", "]"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", "0", "\[RightAngleBracket]"}]], "Input"],

Cell[CellGroupData[{

Cell["Error messages,  argument checking", "Subsubsection",
 CellChangeTimes->{{3.6152481623228827`*^9, 3.6152481681471777`*^9}, {
   3.615363782932117*^9, 3.615363791892191*^9}, 3.6155075403760567`*^9, 
   3.615868974491681*^9, {3.616041504662033*^9, 3.616041522039879*^9}, 
   3.655574307520924*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArgumentCheck", "[", "\[IndentingNewLine]", 
  RowBox[{"AddRule", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", "X_", "\[RightAngleBracket]"}], 
      "ab__List"], "/;", 
     RowBox[{"!", 
      RowBox[{"DuplicateFreeQ", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "ab", "}"}], "]"}], "]"}]}]}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<Duplicate slot numbers. Contraction slots need to be \
distinct.\>\"", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<The given subscript slot pairs are: \>\"", ",", "ab"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Hold", "[", 
       SubscriptBox[
        RowBox[{"\[LeftAngleBracket]", "X", "\[RightAngleBracket]"}], "ab"], 
       "]"}]}], ")"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6499024169785357`*^9, 3.649902441137295*^9}, {
   3.6499041478018227`*^9, 3.649904151678823*^9}, 3.64990422357537*^9, {
   3.649904560085458*^9, 3.6499045646454268`*^9}, {3.6499046125954723`*^9, 
   3.6499046255081997`*^9}, 3.649904812945636*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "274", "]"}]], "Output",
 CellChangeTimes->{{3.6499046317606983`*^9, 3.6499046476948147`*^9}, 
   3.649904680420862*^9, {3.649904804268334*^9, 3.649904814334736*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArgumentCheck", "[", "\[IndentingNewLine]", 
  RowBox[{"AddRule", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", "X_", "\[RightAngleBracket]"}], 
      "ab__List"], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"Max", "[", "ab", "]"}], ">", 
       RowBox[{"deg", "[", "X", "]"}]}], "||", " ", 
      RowBox[{
       RowBox[{"Min", "[", "ab", "]"}], "<", "1"}]}]}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<A contraction subscript is out of range.\>\"", " ", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<For the given argument, slot values should be in the range 1 to \
\>\"", ",", 
        RowBox[{"deg", "[", "X", "]"}], ",", "\"\<.\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<The given subscript slot pairs are: \>\"", ",", "ab"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Hold", "[", 
       SubscriptBox[
        RowBox[{"\[LeftAngleBracket]", "X", "\[RightAngleBracket]"}], "ab"], 
       "]"}]}], ")"}]}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6160406745570307`*^9, 3.6160410711244802`*^9}, {
  3.616041366217545*^9, 3.616041367062312*^9}, {3.616230130594728*^9, 
  3.616230173136726*^9}, {3.649905043088266*^9, 3.649905045817696*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "85", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArgumentCheck", "[", "\[IndentingNewLine]", 
  RowBox[{"AddRule", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", "X__", "\[RightAngleBracket]"}], 
      "ab__List"], "/;", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"{", "X", "}"}], "]"}], ">", "1"}]}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", 
       "\"\<The general contraction bracket \[LeftAngleBracket]\
\[VeryThinSpace]_\[VeryThinSpace]\!\(\*SubscriptBox[\(\[RightAngleBracket]\), \
\(__\)]\) only takes a single argument:\>\"", " ", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Hold", "[", 
       SubscriptBox[
        RowBox[{"\[LeftAngleBracket]", "X", "\[RightAngleBracket]"}], "ab"], 
       "]"}]}], ")"}]}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6160406745570307`*^9, 3.6160410711244802`*^9}, {
  3.616041366217545*^9, 3.616041367062312*^9}, {3.616230130594728*^9, 
  3.616230173136726*^9}, {3.649905043088266*^9, 3.649905045817696*^9}, {
  3.649905784213035*^9, 3.6499058878555717`*^9}, {3.649905934240168*^9, 
  3.649906012669828*^9}, {3.6499060453411913`*^9, 3.649906114028878*^9}, {
  3.649906145980151*^9, 3.649906165435245*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "86", "]"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Basic properties   ---  OrderedPairsQ", "Subsubsection",
 CellChangeTimes->{{3.6152481623228827`*^9, 3.6152481681471777`*^9}, {
   3.615363782932117*^9, 3.615363791892191*^9}, 3.6155075403760567`*^9, 
   3.615868974491681*^9, 3.655574306448172*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "X_", "\[RightAngleBracket]"}], 
    "ab__List"], "]"}], ":=", 
  RowBox[{
   RowBox[{"deg", "[", "X", "]"}], "-", 
   RowBox[{"2", 
    RowBox[{"Length", "[", 
     RowBox[{"{", "ab", "}"}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.480320979832328*^9, 3.480320983408492*^9}, 
   3.480321068961637*^9, {3.6153547131240187`*^9, 3.6153548661979723`*^9}, {
   3.615534764671425*^9, 3.615534787260837*^9}}],

Cell["\<\
The subscript contraction bracket only ever takes one tensor argument,\
\>", "Text",
 CellChangeTimes->{{3.615374618533206*^9, 3.61537466846954*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", "X_", "\[RightAngleBracket]"}], 
     "ab__List"], "/;", 
    RowBox[{"!", 
     RowBox[{"OrderedPairsQ", "[", 
      RowBox[{"{", "ab", "}"}], "]"}]}]}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "X", "\[RightAngleBracket]"}], 
    RowBox[{"OrderedPairs", "[", 
     RowBox[{"{", "ab", "}"}], "]"}]]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6151761281181087`*^9, 3.615176153958192*^9}, {
   3.615176196102412*^9, 3.61517626287271*^9}, {3.615176787529771*^9, 
   3.615176800666195*^9}, {3.615176960554467*^9, 3.615176967535049*^9}, {
   3.6151770801993723`*^9, 3.615177103786438*^9}, {3.615177447163343*^9, 
   3.615177474379822*^9}, 3.615179519730114*^9, {3.6151967710608673`*^9, 
   3.615196771812655*^9}, {3.6151979285660257`*^9, 3.615197936230171*^9}, {
   3.615329345625341*^9, 3.615329347833482*^9}, {3.615329394761724*^9, 
   3.615329396585947*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "87", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
... could match  ab__List   better using   ab : { {_, _ } .. } .   The  ..  \
is Repeated.\
\>", "Text",
 CellChangeTimes->{{3.615418758630495*^9, 3.615418848827607*^9}, {
  3.6155118410121527`*^9, 3.6155118429163*^9}},
 CellID->1452602318],

Cell["Here   ab_List   is a list of pairs,", "Text",
 CellChangeTimes->{{3.6153293100341578`*^9, 3.615329336546826*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"OrderedPairs", "[", "ab_List", "]"}], ":=", " ", 
  RowBox[{"Apply", "[", 
   RowBox[{"Sequence", ",", 
    RowBox[{"Sort", "[", 
     RowBox[{"Map", "[", 
      RowBox[{"Sort", ",", "ab"}], "]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615177159151106*^9, 3.615177195336013*^9}, {
  3.615177230280195*^9, 3.6151772405462914`*^9}, {3.6151777819008102`*^9, 
  3.61517778743679*^9}, {3.6151967525331182`*^9, 3.6151967618451147`*^9}, {
  3.61519705774881*^9, 3.615197058437068*^9}, {3.615329259528943*^9, 
  3.615329277480526*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"OrderedPairsQ", "[", "ab_List", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"OrderedPairs", "[", "ab", "]"}], "}"}], "===", "ab"}]}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.6151791879670143`*^9, 3.615179208847535*^9}, {
  3.6151970756046047`*^9, 3.6151970763402348`*^9}, {3.615329254727841*^9, 
  3.615329258391715*^9}}],

Cell["\<\
For easy inputting of subscripts without having to type the braces,\
\>", "Text",
 CellChangeTimes->{{3.61519713769452*^9, 3.6151972393268557`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "X_", "\[RightAngleBracket]"}], 
    "ab__Integer"], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "X", "\[RightAngleBracket]"}], 
    RowBox[{"Apply", "[", 
     RowBox[{"Sequence", ",", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"{", "ab", "}"}], ",", "2"}], "]"}]}], "]"}]]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615196795346171*^9, 3.615196859476864*^9}, {
   3.615197957101959*^9, 3.615197959895219*^9}, 3.615289938908658*^9, 
   3.6153746835221987`*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "88", "]"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples", "Subsubsection",
 CellChangeTimes->{{3.6153676471066103`*^9, 3.6153676480024767`*^9}, {
  3.615367724594769*^9, 3.6153677337306967`*^9}}],

Cell["\<\

Non-list subscripts are partitioned and sorted,\
\>", "Text",
 CellChangeTimes->{{3.615367671570503*^9, 3.615367712690838*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", "X", "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "1"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", "X", "\[RightAngleBracket]"}], 
  RowBox[{"3", ",", "1", ",", "2", ",", "4", ",", "5", ",", "6"}]]}], "Input",\

 CellChangeTimes->{{3.615197312307241*^9, 3.615197313662333*^9}, {
  3.615197352426141*^9, 3.6151973541943617`*^9}}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", "X", "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}]]], "Output",
 CellChangeTimes->{3.615197315876048*^9, 3.615197357208549*^9, 
  3.615329688347677*^9, 3.61533047634387*^9, 3.615367716602606*^9, 
  3.6153747022645817`*^9, 3.61537475251079*^9}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", "X", "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}]}]]], "Output",
 CellChangeTimes->{3.615197315876048*^9, 3.615197357208549*^9, 
  3.615329688347677*^9, 3.61533047634387*^9, 3.615367716602606*^9, 
  3.6153747022645817`*^9, 3.615374752514172*^9}]
}, Open  ]],

Cell["Duplicate slot numbers are caught,", "Text",
 CellChangeTimes->{{3.615367671570503*^9, 3.615367712690838*^9}, {
  3.615497847924951*^9, 3.6154978699732323`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", "X", "\[RightAngleBracket]"}], 
  RowBox[{"3", ",", "1", ",", "2", ",", "4", ",", "3", ",", "6"}]]], "Input",
 CellChangeTimes->{{3.615497339416766*^9, 3.615497339496643*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Duplicate slot numbers. Contraction slots need to be \
distinct.\"\>"], "Print",
 CellChangeTimes->{
  3.61549740260291*^9, 3.615497451336714*^9, {3.6154974912045813`*^9, 
   3.615497531687079*^9}, {3.615497706908193*^9, 3.615497743340293*^9}, 
   3.615497784179734*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"The given slot pairs are: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6"}], "}"}]}],
  SequenceForm["The given slot pairs are: ", {1, 3}, {2, 4}, {3, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.61549740260291*^9, 3.615497451336714*^9, {3.6154974912045813`*^9, 
   3.615497531687079*^9}, {3.615497706908193*^9, 3.615497743340293*^9}, 
   3.615497784185034*^9}]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.6154973407864103`*^9, 3.6154974026068583`*^9, 3.615497451421685*^9, {
   3.615497491288412*^9, 3.615497531771389*^9}, {3.615497707104268*^9, 
   3.6154977435076*^9}, 3.6154977841875467`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing  --  OrderedPairs", "Subsubsection",
 CellChangeTimes->{{3.6151767604358187`*^9, 3.615176761811982*^9}, {
  3.615328671105125*^9, 3.615328699952887*^9}}],

Cell["Using Sort is faster than check and swap,", "Text",
 CellChangeTimes->{{3.6151766748677273`*^9, 3.6151766982920647`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sort", "[", 
  RowBox[{"Map", "[", 
   RowBox[{"Sort", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.615176885976275*^9, 3.615176913963605*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.615176895654845*^9, 3.615176916374271*^9}, 
   3.615329724280093*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"Sort", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "5"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.61517638719674*^9, 3.6151764190170307`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.61517641950986*^9, 3.615329724454157*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"abSwap", "[", 
   RowBox[{"{", 
    RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"a", "<", "b"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b", ",", "a"}], "}"}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"abSwap", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "5"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.615176517993622*^9, 3.615176521513447*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.615176524022121*^9, 3.615176549974127*^9}, 
   3.615178721049552*^9, 3.615329724624702*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"Sort", ",", "    ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", "5"}], "}"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "100000"}], "}"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"abSwap", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", "5"}], "}"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "100000"}], "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.61517661003096*^9, 3.615176637613278*^9}, {
  3.615176705856748*^9, 3.615176714128978*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.22801399999999999446131937475001905113`5.378561426666411", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.615176630914847*^9, 3.615176656954357*^9}, 
   3.6151767160454082`*^9, 3.6151787492932787`*^9, 3.615329724992791*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.76004700000000002813038690874236635864`5.901440362415047", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.615176630914847*^9, 3.615176656954357*^9}, 
   3.6151767160454082`*^9, 3.6151787492932787`*^9, 3.6153297257679377`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"p", "=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"RandomSample", "[", 
     RowBox[{"Range", "[", "200", "]"}], "]"}], ",", "2"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.6151786620601177`*^9, 3.6151787008316298`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"170", ",", "192"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"166", ",", "50"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"142", ",", "47"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "99"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"38", ",", "93"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"69", ",", "82"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "186"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"144", ",", "162"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"187", ",", "95"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"21", ",", "60"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"119", ",", "55"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"65", ",", "195"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"200", ",", "173"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"36", ",", "123"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"158", ",", "136"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"103", ",", "159"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "64"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"109", ",", "16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"137", ",", "122"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"63", ",", "46"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"101", ",", "171"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"89", ",", "184"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"130", ",", "73"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"168", ",", "19"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"199", ",", "58"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"67", ",", "167"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"189", ",", "29"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"127", ",", "154"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"151", ",", "139"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"104", ",", "20"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"115", ",", "66"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"188", ",", "128"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"165", ",", "37"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"129", ",", "42"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"121", ",", "135"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"57", ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"79", ",", "156"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"70", ",", "149"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"110", ",", "27"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"100", ",", "88"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"178", ",", "48"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"133", ",", "155"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"190", ",", "193"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"56", ",", "25"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"163", ",", "28"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"78", ",", "52"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"175", ",", "61"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"180", ",", "40"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"152", ",", "35"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"53", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"117", ",", "84"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"39", ",", "147"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"176", ",", "105"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"96", ",", "111"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"112", ",", "92"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", "182"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"85", ",", "134"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"108", ",", "98"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "75"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"97", ",", "177"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"174", ",", "22"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"132", ",", "91"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"107", ",", "90"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"23", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "80"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"33", ",", "185"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"124", ",", "102"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"181", ",", "131"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"143", ",", "161"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"157", ",", "94"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"83", ",", "77"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"18", ",", "32"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"62", ",", "118"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"87", ",", "31"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"71", ",", "138"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"43", ",", "14"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"148", ",", "114"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"30", ",", "145"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"198", ",", "194"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"169", ",", "45"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"74", ",", "125"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"183", ",", "191"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"150", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"41", ",", "160"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"120", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"72", ",", "26"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"49", ",", "54"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"116", ",", "59"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"153", ",", "196"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"197", ",", "17"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"141", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"86", ",", "81"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"34", ",", "51"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"172", ",", "76"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"126", ",", "24"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"113", ",", "146"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"179", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "68"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"164", ",", "44"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"140", ",", "106"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.615178670350527*^9, 3.615178697744054*^9}, 
   3.615329725958284*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"Sort", ",", "    ", "p"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "10000"}], "}"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"abSwap", ",", "p"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "10000"}], "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.61517661003096*^9, 3.615176637613278*^9}, {
  3.615176705856748*^9, 3.615176714128978*^9}, {3.6151787694915237`*^9, 
  3.6151787912496433`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.49203099999999999614175294482265599072`5.71259237926815", ",", "Null"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.615178783003798*^9, 3.615178792784216*^9}, 
   3.615329726598805*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2.38814899999999985524823387095239013433`6.398661332830377", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.615178783003798*^9, 3.615178792784216*^9}, 
   3.6153297289878597`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "abSwap", "]"}]], "Input",
 CellChangeTimes->{{3.615178010217773*^9, 3.615178017307019*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"OrderedPairs", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.615177015975765*^9, 3.615177028011498*^9}, {
  3.615177759150057*^9, 3.615177764940835*^9}}],

Cell[BoxData[
 RowBox[{"OrderedPairs", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.6151770489672737`*^9, 3.615177068215478*^9}, {
   3.615177766776688*^9, 3.615177792876996*^9}, 3.615329729158201*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"q", "=", 
  RowBox[{"OrderedPairs", "[", "p", "]"}]}]], "Input",
 CellChangeTimes->{{3.615178836389732*^9, 3.61517884959682*^9}}],

Cell[BoxData[
 RowBox[{"Sequence", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "141"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "80"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "53"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "68"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "186"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "120"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "150"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "23"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "179"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "64"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "75"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "99"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13", ",", "57"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14", ",", "43"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", "182"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"16", ",", "109"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"17", ",", "197"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"18", ",", "32"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"19", ",", "168"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"20", ",", "104"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"21", ",", "60"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"22", ",", "174"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"24", ",", "126"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"25", ",", "56"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"26", ",", "72"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"27", ",", "110"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"28", ",", "163"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"29", ",", "189"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"30", ",", "145"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"31", ",", "87"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"33", ",", "185"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"34", ",", "51"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"35", ",", "152"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"36", ",", "123"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"37", ",", "165"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"38", ",", "93"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"39", ",", "147"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"40", ",", "180"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"41", ",", "160"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"42", ",", "129"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"44", ",", "164"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"45", ",", "169"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"46", ",", "63"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"47", ",", "142"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"48", ",", "178"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"49", ",", "54"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"50", ",", "166"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"52", ",", "78"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"55", ",", "119"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"58", ",", "199"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"59", ",", "116"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"61", ",", "175"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"62", ",", "118"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"65", ",", "195"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"66", ",", "115"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"67", ",", "167"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"69", ",", "82"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"70", ",", "149"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"71", ",", "138"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"73", ",", "130"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"74", ",", "125"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"76", ",", "172"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"77", ",", "83"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"79", ",", "156"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"81", ",", "86"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"84", ",", "117"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"85", ",", "134"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"88", ",", "100"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"89", ",", "184"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"90", ",", "107"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"91", ",", "132"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"92", ",", "112"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"94", ",", "157"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"95", ",", "187"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"96", ",", "111"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"97", ",", "177"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"98", ",", "108"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"101", ",", "171"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"102", ",", "124"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"103", ",", "159"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"105", ",", "176"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"106", ",", "140"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"113", ",", "146"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"114", ",", "148"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"121", ",", "135"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"122", ",", "137"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"127", ",", "154"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"128", ",", "188"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"131", ",", "181"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"133", ",", "155"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"136", ",", "158"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"139", ",", "151"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"143", ",", "161"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"144", ",", "162"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"153", ",", "196"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"170", ",", "192"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"173", ",", "200"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"183", ",", "191"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"190", ",", "193"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"194", ",", "198"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.6151788507220297`*^9, 3.615329729309404*^9}]
}, Open  ]],

Cell["\<\
Checking sameness of the sort is  2x  faster than verifying the sort.   \
Temporary fn   OrderedPairsQ1  verifies the sort,\
\>", "Text",
 CellChangeTimes->{{3.6151790690340652`*^9, 3.615179132458356*^9}, {
  3.615179399531187*^9, 3.615179445999407*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"OrderedPairsQ1", "[", "ab__", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"Apply", "[", 
    RowBox[{"Less", ",", " ", 
     RowBox[{"Map", "[", 
      RowBox[{"First", ",", 
       RowBox[{"{", "ab", "}"}]}], "]"}]}], "]"}], "&&", 
   RowBox[{"Apply", "[", 
    RowBox[{"And", ",", 
     RowBox[{"Map", "[", 
      RowBox[{"Less", ",", 
       RowBox[{"{", "ab", "}"}]}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6151792565791893`*^9, 3.6151792712189503`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"sq", "=", 
   RowBox[{"Sequence", "[", "q", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"OrderedPairsQ", "[", "sq", "]"}], "===", 
     RowBox[{"{", "sq", "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "100000"}], "}"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"OrderedPairsQ1", "[", "sq", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "100000"}], "}"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "OrderedPairsQ1", "]"}]}], "Input",
 CellChangeTimes->{{3.6151781090716343`*^9, 3.615178131505355*^9}, {
  3.615178184805153*^9, 3.615178190836628*^9}, {3.615178256519094*^9, 
  3.6151783568858747`*^9}, {3.615178470743328*^9, 3.6151784772381363`*^9}, {
  3.615178879732421*^9, 3.6151789552507668`*^9}, {3.615179327174139*^9, 
  3.615179359793054*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.44802799999999998181721139189903624356`5.671905069834692", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.615178958234085*^9, 3.615178965003487*^9}, {
   3.615179225508613*^9, 3.615179230525138*^9}, 3.6151793626842833`*^9, 
   3.615329729899481*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "25.82561499999999909960024524480104446411`7.432650585694947", ",", 
   "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.615178958234085*^9, 3.615178965003487*^9}, {
   3.615179225508613*^9, 3.615179230525138*^9}, 3.6151793626842833`*^9, 
   3.615329755728689*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Nested brackets", "Subsubsection",
 CellChangeTimes->{{3.615349719345826*^9, 3.615349724129532*^9}, {
   3.61535141453445*^9, 3.615351437238566*^9}, {3.615352709738884*^9, 
   3.6153527136428947`*^9}, {3.615363336916357*^9, 3.615363340964303*^9}, 
   3.615367323377013*^9, {3.615498149253887*^9, 3.615498165333634*^9}, 
   3.615868976267872*^9, 3.655574295936241*^9}],

Cell[TextData[{
 "It doesn\[CloseCurlyQuote]t want to match to a blank sequence for Y because \
it wont try the rule  ",
 Cell[BoxData[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"\[CircleTimes]", "X_"}], ")"}], ":=", "X"}]],
  CellChangeTimes->{{3.615499203827704*^9, 3.615499206522071*^9}, {
   3.6154992517079697`*^9, 3.615499255946762*^9}, {3.6154996265237083`*^9, 
   3.6154996350675077`*^9}}],
 " at the same time,"
}], "Text",
 CellChangeTimes->{{3.615499683127687*^9, 3.615499760728097*^9}, {
  3.615499913564933*^9, 3.615499933448391*^9}, {3.615499996760503*^9, 
  3.615500007032675*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatchQ", "[", 
  RowBox[{
   RowBox[{"Hold", "[", 
    RowBox[{"\[CircleTimes]", "x"}], "]"}], ",", 
   RowBox[{"Hold", "[", 
    RowBox[{"Y1___", "\[CircleTimes]", "x"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatchQ", "[", 
  RowBox[{
   RowBox[{"Hold", "[", "x", "]"}], ",", 
   RowBox[{"Hold", "[", 
    RowBox[{"Y1___", "\[CircleTimes]", "x"}], "]"}]}], "]"}]}], "Input"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.615500014249968*^9, 3.6157477385774813`*^9}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.615500014249968*^9, 3.6157477385826283`*^9}]
}, Closed]],

Cell["So we need 4 rules,", "Text",
 CellChangeTimes->{{3.615500364424843*^9, 3.615500366808957*^9}, {
  3.6155004821699333`*^9, 3.615500485289462*^9}, {3.615500516809368*^9, 
  3.615500516985371*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", "X_", "\[RightAngleBracket]"}], 
      "ab1__List"], "\[RightAngleBracket]"}], "ab2__List"], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "X", "\[RightAngleBracket]"}], 
    RowBox[{"ab1ab2", "[", 
     RowBox[{
      RowBox[{"{", "ab1", "}"}], ",", 
      RowBox[{"{", "ab2", "}"}]}], "]"}]]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6151795791667547`*^9, 3.615179593159851*^9}, {
   3.61519737163503*^9, 3.615197422805444*^9}, {3.6151979666885757`*^9, 
   3.6151979711261*^9}, {3.6151994670483217`*^9, 3.615199583915052*^9}, {
   3.615200027198238*^9, 3.615200030909411*^9}, {3.615200215214778*^9, 
   3.615200215421769*^9}, {3.615203438143342*^9, 3.61520346657553*^9}, 
   3.615289941804987*^9, 3.615323644799953*^9, {3.615498290590704*^9, 
   3.61549835438374*^9}, {3.615498511919777*^9, 3.6154985181608667`*^9}, {
   3.615499669380023*^9, 3.61549967221047*^9}, {3.6155004984031878`*^9, 
   3.615500507269443*^9}, {3.6155015625159187`*^9, 3.615501571285372*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "89", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1__", "\[CircleTimes]", 
       SubscriptBox[
        RowBox[{"\[LeftAngleBracket]", "X_", "\[RightAngleBracket]"}], 
        "ab1__List"]}], "\[RightAngleBracket]"}], "ab2__List"], "/;", 
    RowBox[{"IntegerQ", "[", 
     RowBox[{"deg", "[", "Y1", "]"}], "]"}]}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1", "\[CircleTimes]", "X"}], "\[RightAngleBracket]"}], 
    RowBox[{"ab1ab2", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "ab1", "}"}], "+", 
       RowBox[{"deg", "[", "Y1", "]"}]}], ",", 
      RowBox[{"{", "ab2", "}"}]}], "]"}]]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.615500514162664*^9, 3.615501587012311*^9, 
  3.615501840579002*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "90", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       RowBox[{"\[LeftAngleBracket]", "X_", "\[RightAngleBracket]"}], 
       "ab1__List"], "\[CircleTimes]", "Y2__"}], "\[RightAngleBracket]"}], 
    "ab2__List"], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X", "\[CircleTimes]", "Y2"}], "\[RightAngleBracket]"}], 
    RowBox[{"ab1ab2", "[", 
     RowBox[{
      RowBox[{"{", "ab1", "}"}], ",", 
      RowBox[{"{", "ab2", "}"}]}], "]"}]]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.6155005281467257`*^9, 3.615500565074057*^9, 
  3.615501594083746*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "91", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1__", "\[CircleTimes]", 
       SubscriptBox[
        RowBox[{"\[LeftAngleBracket]", "X_", "\[RightAngleBracket]"}], 
        "ab1__List"], "\[CircleTimes]", "Y2__"}], "\[RightAngleBracket]"}], 
     "ab2__List"], "/;", 
    RowBox[{"IntegerQ", "[", 
     RowBox[{"deg", "[", "Y1", "]"}], "]"}]}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1", "\[CircleTimes]", "X", "\[CircleTimes]", "Y2"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"ab1ab2", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "ab1", "}"}], "+", 
       RowBox[{"deg", "[", "Y1", "]"}]}], ",", 
      RowBox[{"{", "ab2", "}"}]}], "]"}]]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615500534178031*^9, 3.6155005475707607`*^9}, {
  3.615501785958911*^9, 3.6155018305511303`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "92", "]"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ab1ab2", "[", 
   RowBox[{"ab1_List", ",", "ab2_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"f1", ",", "f2", ",", "n", ",", "slots"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"f1", "=", 
      RowBox[{"Flatten", "[", "ab1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"f2", "=", 
      RowBox[{"Flatten", "[", "ab2", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", " ", "=", " ", 
      RowBox[{"Max", "[", 
       RowBox[{"f1", ",", 
        RowBox[{
         RowBox[{"Max", "[", "f2", "]"}], "+", 
         RowBox[{"Length", "[", "f1", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"slots", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Range", "[", "n", "]"}], ",", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"f1", ",", "#"}], "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"OrderedPairs", "[", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"f1", ",", 
          RowBox[{"slots", "[", 
           RowBox[{"[", "f2", "]"}], "]"}]}], "]"}], ",", "2"}], "]"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615202162932757*^9, 3.61520242992185*^9}, {
  3.615202464865452*^9, 3.615202516899674*^9}, {3.61520274614734*^9, 
  3.615202746420107*^9}, {3.615202906995926*^9, 3.615202913716093*^9}, {
  3.615202996724972*^9, 3.615203000676445*^9}, {3.615203155460203*^9, 
  3.61520320720953*^9}, {3.615203246356481*^9, 3.615203256916791*^9}, {
  3.615203287957823*^9, 3.6152033835899878`*^9}, {3.6153295757602873`*^9, 
  3.61532960131345*^9}, {3.6157481303822308`*^9, 3.6157481336619062`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearField", "[", "y1", "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"3", ",", "y1"}], "]"}], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "x", "\[RightAngleBracket]"}], 
    RowBox[{"3", ",", "5"}]], "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "3"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"y1", "\[CircleTimes]", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", "x", "\[RightAngleBracket]"}], 
     RowBox[{"3", ",", "5"}]]}], "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "3"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", "x", "\[RightAngleBracket]"}], 
     RowBox[{"3", ",", "5"}]], "\[CircleTimes]", "y2"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "3"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"y1", "\[CircleTimes]", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", "x", "\[RightAngleBracket]"}], 
     RowBox[{"3", ",", "5"}]], "\[CircleTimes]", "y2"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "3"}]]}], "Input",
 CellChangeTimes->{{3.615203485866485*^9, 3.6152035380757732`*^9}, {
  3.615501706687406*^9, 3.615501744306734*^9}, {3.615502067907433*^9, 
  3.615502087220434*^9}}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", "x", "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}]}]]], "Output",
 CellChangeTimes->{
  3.615203505920486*^9, 3.6152035397579536`*^9, 3.615329688905925*^9, 
   3.615331199478148*^9, 3.615352677484098*^9, 3.615367798084244*^9, 
   3.6154985648041677`*^9, 3.6155016326850233`*^9, 3.6155017496338987`*^9, 
   3.615501872417251*^9, {3.615502056463936*^9, 3.615502089275317*^9}, 
   3.615510824841116*^9}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"y1", "\[CircleTimes]", "x"}], "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "8"}], "}"}]}]]], "Output",
 CellChangeTimes->{
  3.615203505920486*^9, 3.6152035397579536`*^9, 3.615329688905925*^9, 
   3.615331199478148*^9, 3.615352677484098*^9, 3.615367798084244*^9, 
   3.6154985648041677`*^9, 3.6155016326850233`*^9, 3.6155017496338987`*^9, 
   3.615501872417251*^9, {3.615502056463936*^9, 3.615502089275317*^9}, 
   3.6155108248447*^9}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"x", "\[CircleTimes]", "y2"}], "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}]}]]], "Output",
 CellChangeTimes->{
  3.615203505920486*^9, 3.6152035397579536`*^9, 3.615329688905925*^9, 
   3.615331199478148*^9, 3.615352677484098*^9, 3.615367798084244*^9, 
   3.6154985648041677`*^9, 3.6155016326850233`*^9, 3.6155017496338987`*^9, 
   3.615501872417251*^9, {3.615502056463936*^9, 3.615502089275317*^9}, 
   3.61551082484764*^9}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"y1", "\[CircleTimes]", "x", "\[CircleTimes]", "y2"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "8"}], "}"}]}]]], "Output",
 CellChangeTimes->{
  3.615203505920486*^9, 3.6152035397579536`*^9, 3.615329688905925*^9, 
   3.615331199478148*^9, 3.615352677484098*^9, 3.615367798084244*^9, 
   3.6154985648041677`*^9, 3.6155016326850233`*^9, 3.6155017496338987`*^9, 
   3.615501872417251*^9, {3.615502056463936*^9, 3.615502089275317*^9}, 
   3.615510824850466*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Take out  \[CircleTimes]  factors to shrink ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "   ", "\[RightAngleBracket]"}], "ab"], 
   TraditionalForm]]],
 " "
}], "Subsubsection",
 CellChangeTimes->{{3.6142975261838493`*^9, 3.6142975286619167`*^9}, {
   3.614298492952876*^9, 3.614298502042636*^9}, {3.6146544966705847`*^9, 
   3.61465451746035*^9}, {3.615365276057357*^9, 3.6153652852530622`*^9}, {
   3.615365465434198*^9, 3.615365466826229*^9}, {3.615687410263824*^9, 
   3.6156874128394012`*^9}, {3.6158716691638813`*^9, 3.615871716555942*^9}, 
   3.61587190188507*^9, 3.655574294976419*^9}],

Cell["\<\
The following code makes use of the relation  \[CircleTimes]v_ = v ,   so \
that   Rest[ x \[CircleTimes] y ] = y,\
\>", "Text",
 CellChangeTimes->{{3.614298296699026*^9, 3.6142983354473677`*^9}, 
   3.614896700802964*^9}],

Cell[TextData[{
 "If  none of the contracted slot positions  ",
 Cell[BoxData[
  FormBox["ab__", TraditionalForm]]],
 "  occur in the first argument of  \[CircleTimes], then pull out that tensor \
product factor..."
}], "Text",
 CellChangeTimes->{{3.478521348524732*^9, 3.478521367997245*^9}, {
   3.478521995402616*^9, 3.478522005330361*^9}, {3.478522082794157*^9, 
   3.478522380056022*^9}, 3.478522415777293*^9, {3.478522542569283*^9, 
   3.478522547072749*^9}, {3.478522672464452*^9, 3.47852282811114*^9}, {
   3.478522866720887*^9, 3.478522910998042*^9}, {3.478523013006232*^9, 
   3.478523063845325*^9}, {3.478523294797873*^9, 3.478523315180198*^9}, {
   3.478523421036623*^9, 3.478523455373287*^9}, {3.478523509195832*^9, 
   3.478523578355614*^9}, {3.478523821778841*^9, 3.478524070826569*^9}, {
   3.478524122176394*^9, 3.478524185184386*^9}, {3.478524340830039*^9, 
   3.478524400607762*^9}, {3.478524843318779*^9, 3.478525228555697*^9}, {
   3.478525654133307*^9, 3.47852582850393*^9}, {3.47852588911241*^9, 
   3.47852622600454*^9}, {3.478526677795962*^9, 3.478526776484335*^9}, {
   3.478526889750424*^9, 3.478526949794981*^9}, {3.47852727452154*^9, 
   3.4785272751774*^9}, {3.478527306713869*^9, 3.47852733310468*^9}, {
   3.478527406985081*^9, 3.478527413939544*^9}, {3.478528120382391*^9, 
   3.47852812958848*^9}, {3.478528192756685*^9, 3.478528220109628*^9}, {
   3.478529193768579*^9, 3.478529219839461*^9}, {3.478529292912798*^9, 
   3.478529294543033*^9}, {3.478529493455744*^9, 3.47852950568608*^9}, {
   3.478532420268942*^9, 3.478532480480057*^9}, 3.478703460819037*^9, {
   3.478703667748659*^9, 3.4787036791852*^9}, {3.478703842688146*^9, 
   3.478703858827889*^9}, {3.478704637672439*^9, 3.478704863019877*^9}, {
   3.478704899735583*^9, 3.478704924252704*^9}, {3.478705143616218*^9, 
   3.478705179720568*^9}, {3.47877489559973*^9, 3.478774907484824*^9}, 
   3.614298546922606*^9, {3.615686662610551*^9, 3.615686670578375*^9}, {
   3.615871769979899*^9, 3.6158718043006973`*^9}, {3.61587184058843*^9, 
   3.6158718878523703`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", "v_CircleTimes", "\[RightAngleBracket]"}],
      "ab__List"], "/;", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"Min", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "ab", "}"}], "]"}], "]"}], ">", 
      RowBox[{"deg", "[", 
       RowBox[{"First", "[", "v", "]"}], "]"}]}], "]"}]}], ":=", 
   RowBox[{
    RowBox[{"First", "[", "v", "]"}], "\[CircleTimes]", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Rest", "[", "v", "]"}], "\[RightAngleBracket]"}], 
     RowBox[{"Apply", "[", 
      RowBox[{"Sequence", ",", 
       RowBox[{
        RowBox[{"{", "ab", "}"}], "-", 
        RowBox[{"deg", "[", 
         RowBox[{"First", "[", "v", "]"}], "]"}]}]}], "]"}]]}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.478704460992132*^9, 3.478704492432724*^9}, {
   3.47870453327036*^9, 3.478704558528715*^9}, {3.478704982886998*^9, 
   3.478705044486556*^9}, {3.478705801007725*^9, 3.478705832049161*^9}, {
   3.478795432473217*^9, 3.478795436299525*^9}, {3.479721988778705*^9, 
   3.479721988791135*^9}, {3.480324513371323*^9, 3.480324592587219*^9}, {
   3.612831103851893*^9, 3.612831108832123*^9}, 3.6128312086107693`*^9, 
   3.6128312410061483`*^9, 3.6128340852138453`*^9, 3.612834610299836*^9, 
   3.614113900359779*^9, {3.614113971320026*^9, 3.614113977158732*^9}, {
   3.614398734967033*^9, 3.614398737496612*^9}, {3.6143989086485767`*^9, 
   3.6143989117204742`*^9}, {3.615686678237564*^9, 3.6156866822702293`*^9}, 
   3.615686716750462*^9, {3.615686757134583*^9, 3.615686800528532*^9}, {
   3.615686838129546*^9, 3.615686874945148*^9}, {3.653875845965551*^9, 
   3.6538758580265827`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "93", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
If  none of the contracted slot positions  ab__  occur in the last argument \
of  \[CircleTimes], then pull out that tensor product factor...\
\>", "Text",
 CellChangeTimes->{{3.478521348524732*^9, 3.478521367997245*^9}, {
   3.478521995402616*^9, 3.478522005330361*^9}, {3.478522082794157*^9, 
   3.478522380056022*^9}, 3.478522415777293*^9, {3.478522542569283*^9, 
   3.478522547072749*^9}, {3.478522672464452*^9, 3.47852282811114*^9}, {
   3.478522866720887*^9, 3.478522910998042*^9}, {3.478523013006232*^9, 
   3.478523063845325*^9}, {3.478523294797873*^9, 3.478523315180198*^9}, {
   3.478523421036623*^9, 3.478523455373287*^9}, {3.478523509195832*^9, 
   3.478523578355614*^9}, {3.478523821778841*^9, 3.478524070826569*^9}, {
   3.478524122176394*^9, 3.478524185184386*^9}, {3.478524340830039*^9, 
   3.478524400607762*^9}, {3.478524843318779*^9, 3.478525228555697*^9}, {
   3.478525654133307*^9, 3.47852582850393*^9}, {3.47852588911241*^9, 
   3.47852622600454*^9}, {3.478526677795962*^9, 3.478526776484335*^9}, {
   3.478526889750424*^9, 3.478526949794981*^9}, {3.47852727452154*^9, 
   3.4785272751774*^9}, {3.478527306713869*^9, 3.47852733310468*^9}, {
   3.478527406985081*^9, 3.478527413939544*^9}, {3.478528120382391*^9, 
   3.47852812958848*^9}, {3.478528192756685*^9, 3.478528220109628*^9}, {
   3.478529193768579*^9, 3.478529219839461*^9}, {3.478529292912798*^9, 
   3.478529294543033*^9}, {3.478529493455744*^9, 3.47852950568608*^9}, {
   3.478532420268942*^9, 3.478532480480057*^9}, 3.478703460819037*^9, {
   3.478703667748659*^9, 3.4787036791852*^9}, {3.478703842688146*^9, 
   3.478703858827889*^9}, {3.478704637672439*^9, 3.478704863019877*^9}, {
   3.478704899735583*^9, 3.478704924252704*^9}, {3.478705143616218*^9, 
   3.478705195253281*^9}, {3.478774901949986*^9, 3.478774903565379*^9}, 
   3.614298549066429*^9, {3.615686971461074*^9, 3.6156869761967773`*^9}, {
   3.6158718161883163`*^9, 3.615871884317424*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", "v_CircleTimes", "\[RightAngleBracket]"}],
      "ab__List"], "/;", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "ab", "}"}], "]"}], "]"}], "\[LessEqual]", 
      RowBox[{"deg", "[", 
       RowBox[{"Most", "[", "v", "]"}], "]"}]}], "]"}]}], ":=", 
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Most", "[", "v", "]"}], "\[RightAngleBracket]"}], "ab"], 
    "\[CircleTimes]", 
    RowBox[{"Last", "[", "v", "]"}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.478704460992132*^9, 3.478704492432724*^9}, {
   3.47870453327036*^9, 3.478704558528715*^9}, {3.478704982886998*^9, 
   3.478705044486556*^9}, 3.478705203444723*^9, {3.478705310214776*^9, 
   3.478705323218999*^9}, {3.478705382943751*^9, 3.478705413005293*^9}, 
   3.478705832583681*^9, {3.478789657310134*^9, 3.478789708028699*^9}, {
   3.478795438551851*^9, 3.478795440346237*^9}, {3.479721988846744*^9, 
   3.479721988852726*^9}, {3.480324629523034*^9, 3.480324665010145*^9}, {
   3.612831171322173*^9, 3.612831176622294*^9}, {3.612831251600534*^9, 
   3.6128312590359783`*^9}, 3.61283408794538*^9, 3.612834611799624*^9, 
   3.614113902597829*^9, {3.614113983348971*^9, 3.614113985927022*^9}, {
   3.614398729254889*^9, 3.614398732215399*^9}, {3.6143988694301453`*^9, 
   3.614398872002825*^9}, {3.614399028389586*^9, 3.6143990314764347`*^9}, {
   3.615686984957412*^9, 3.6156871004136972`*^9}, {3.615687370050858*^9, 
   3.615687376691111*^9}, {3.6538758655850163`*^9, 3.653875869594871*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "94", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
The reason for the  Simplify[ ]  in the above code is to allow for unknown \
degree, \
\>", "Text",
 CellChangeTimes->{{3.653875916100951*^9, 3.653875969396422*^9}, {
  3.653876051939307*^9, 3.653876052755316*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "X", "]"}], "+", "1"}], ">", 
  RowBox[{"deg", "[", "X", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"deg", "[", "X", "]"}], "+", "1"}], ">", 
   RowBox[{"deg", "[", "X", "]"}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.653875727706427*^9, 3.653875741625483*^9}, {
  3.653876006630364*^9, 3.653876037991436*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "+", 
   RowBox[{"deg", "[", "X", "]"}]}], ">", 
  RowBox[{"deg", "[", "X", "]"}]}]], "Output",
 CellChangeTimes->{{3.65387573369641*^9, 3.65387574237072*^9}, {
  3.653875981670747*^9, 3.653876039899877*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Max", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"deg", "[", "X", "]"}], "+", "1"}], ",", 
   RowBox[{"deg", "[", "X", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Max", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"deg", "[", "X", "]"}], "+", "1"}], ",", 
    RowBox[{"deg", "[", "X", "]"}]}], "]"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.6538758043311567`*^9, 3.653875820990067*^9}, {
  3.653876017543084*^9, 3.6538760214801197`*^9}}],

Cell[BoxData[
 RowBox[{"Max", "[", 
  RowBox[{
   RowBox[{"deg", "[", "X", "]"}], ",", 
   RowBox[{"1", "+", 
    RowBox[{"deg", "[", "X", "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{{3.653875816202648*^9, 3.653875822361586*^9}, {
  3.653876022265114*^9, 3.6538760421574183`*^9}}],

Cell[BoxData[
 RowBox[{"1", "+", 
  RowBox[{"deg", "[", "X", "]"}]}]], "Output",
 CellChangeTimes->{{3.653875816202648*^9, 3.653875822361586*^9}, {
  3.653876022265114*^9, 3.653876042162476*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing", "Subsubsection",
 CellChangeTimes->{{3.615687130006043*^9, 3.615687132805348*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"2", ",", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
    "x4", "\[CircleTimes]", "x5"}], "\[RightAngleBracket]"}], 
  RowBox[{"4", ",", "8"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
    "x4"}], "\[RightAngleBracket]"}], 
  RowBox[{"4", ",", "6"}]]}], "Input",
 CellChangeTimes->{{3.614398346938725*^9, 3.614398516070458*^9}, {
  3.615687170513546*^9, 3.615687200491002*^9}}],

Cell[BoxData[
 RowBox[{"x1", "\[CircleTimes]", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
    "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", "x4", "\[CircleTimes]", 
     "x5"}], "\[RightAngleBracket]"}], 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}]]}]], "Output",
 CellChangeTimes->{3.614400388521392*^9, 3.615687154401223*^9, 
  3.615687201870635*^9}],

Cell[BoxData[
 RowBox[{"x1", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"x2", ",", 
    RowBox[{"rev", "[", "x3", "]"}]}], "\[RightAngleBracket]"}], 
  "\[CircleTimes]", "x4"}]], "Output",
 CellChangeTimes->{3.614400388521392*^9, 3.615687154401223*^9, 
  3.615687201877256*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"x1", ",", "x5", ",", "x234"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x5"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"3", ",", 
   RowBox[{"{", "x234", "}"}]}], "]"}], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"x1", "\[CircleTimes]", "x234", "\[CircleTimes]", "x5"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "4"}]]}], "Input",
 CellChangeTimes->{{3.614398346938725*^9, 3.614398516070458*^9}, {
   3.614398596019719*^9, 3.614398692384359*^9}, {3.6156873110920763`*^9, 
   3.61568732387471*^9}, 3.615687388176236*^9}],

Cell[BoxData[
 RowBox[{"x1", "\[CircleTimes]", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", "x234", "\[RightAngleBracket]"}], 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]], "\[CircleTimes]", "x5"}]], "Output",
 CellChangeTimes->{
  3.614398662535247*^9, 3.614398697941142*^9, 3.614406021849558*^9, 
   3.6156872680704947`*^9, {3.615687325076556*^9, 3.615687335857033*^9}, {
   3.615687380744068*^9, 3.615687390862706*^9}}]
}, Open  ]]
}, Closed]],

Cell["Old code -- nothing initialized", "Subsubsection",
 CellChangeTimes->{{3.615868924027411*^9, 3.6158689435184317`*^9}, 
   3.615868977755467*^9, 3.655574290384473*^9}],

Cell[CellGroupData[{

Cell["Basic properties   ---  UnorderedFactorsQ      ---  old", \
"Subsubsection",
 CellChangeTimes->{{3.615503407550481*^9, 3.615503415214711*^9}, {
  3.6155034899028273`*^9, 3.615503493166857*^9}, {3.61550751061585*^9, 
  3.615507548395577*^9}, {3.615507848281208*^9, 3.615507856056802*^9}, {
  3.615517401891588*^9, 3.615517406740383*^9}}],

Cell["\<\
Cant do this!  Free slots have to stay in order. Would need to introduce mv[ \
].\
\>", "Text",
 CellChangeTimes->{{3.615517329699725*^9, 3.615517362516287*^9}}],

Cell["\<\

Order the factors by degree then OrderedQ.  Highest degree first,\
\>", "Text",
 CellChangeTimes->{{3.615507568263755*^9, 3.6155076198163347`*^9}}],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
      "Y1___", "\[CircleTimes]", "X1_", "\[CircleTimes]", "X2_", 
       "\[CircleTimes]", "Y2___"}], "\[RightAngleBracket]"}], "ab__List"], "/;", 
    RowBox[{
     RowBox[{"IntegerQ", "[", 
      RowBox[{"deg", "[", "Y1", "]"}], "]"}], "&&", 
     RowBox[{"UnorderedFactorsQ", "[", 
      RowBox[{"X1", ",", "X2"}], "]"}]}]}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
     "Y1", "\[CircleTimes]", "X2", "\[CircleTimes]", "X1", "\[CircleTimes]", 
      "Y2"}], "\[RightAngleBracket]"}], 
    RowBox[{"abFactorSwap", "[", 
     RowBox[{
      RowBox[{"{", "ab", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], ",", 
        RowBox[{"deg", "[", "X1", "]"}], ",", 
        RowBox[{"deg", "[", "X2", "]"}]}], "}"}]}], "]"}]]}], "]"}]], "Input"],

Cell["\<\
This returns  True  if  X1, X2 are known to be in the wrong order and False \
otherwise,\
\>", "Text",
 CellChangeTimes->{{3.615507903656753*^9, 3.61550795108123*^9}, {
  3.6155106145767403`*^9, 3.615510689233224*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"UnorderedFactorsQ", "[", 
   RowBox[{"X1_", ",", "X2_"}], "]"}], ":=", 
  RowBox[{"TrueQ", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"deg", "[", "X1", "]"}], "<", 
     RowBox[{"deg", "[", "X2", "]"}]}], "||", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"deg", "[", "X1", "]"}], "===", 
       RowBox[{"deg", "[", "X2", "]"}]}], ")"}], "&&", 
     RowBox[{"!", 
      RowBox[{"OrderedQ", "[", 
       RowBox[{"{", 
        RowBox[{"X1", ",", "X2"}], "}"}], "]"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.615504188467894*^9, 3.615504317225528*^9}, {
  3.615507860242693*^9, 3.615507891841591*^9}, {3.6155079864819736`*^9, 
  3.6155080104501677`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"abFactorSwap", "[", 
   RowBox[{"ab_List", ",", 
    RowBox[{"{", 
     RowBox[{"degY_Integer", ",", "degX1_Integer", ",", "degX2_Integer"}], 
     "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n0", ",", "n1", ",", "n2", ",", "swap"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n0", "=", "degY"}], ";", "\[IndentingNewLine]", 
     RowBox[{"n1", "=", 
      RowBox[{"n0", "+", "degX1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n2", "=", 
      RowBox[{"n1", "+", "degX2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"swap", "[", "n_", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n0", "<", "n", "\[LessEqual]", "n1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"n", "+", "degX2"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"n1", "<", "n", "\[LessEqual]", "n2"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"n", "-", "degX1"}], ",", "\[IndentingNewLine]", "n"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Apply", "[", 
      RowBox[{"Sequence", ",", 
       RowBox[{"Map", "[", 
        RowBox[{"swap", ",", "ab", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.615504593379983*^9, 3.615504609828627*^9}, {
  3.615506759017383*^9, 3.6155068040477324`*^9}, {3.615506897814052*^9, 
  3.6155069206857157`*^9}, {3.615506964845886*^9, 3.615507052352138*^9}, {
  3.615507087632453*^9, 3.615507157046677*^9}, {3.6155071952983503`*^9, 
  3.615507271860717*^9}, {3.615507305653116*^9, 3.615507422804906*^9}, {
  3.6155074561338882`*^9, 3.6155074719271793`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"y1", ",", "x1", ",", "x2", ",", "y2"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"3", ",", 
   RowBox[{"{", 
    RowBox[{"y1", ",", "x1", ",", "x2", ",", "y2"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"x1", "\[CircleTimes]", "x2"}], "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "4"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"x2", "\[CircleTimes]", "x1"}], "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "4"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "y1", "\[CircleTimes]", "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", 
    "y2"}], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "2", ",", "5", ",", "8", ",", "3", ",", "11"}]]}], "Input",\

 CellChangeTimes->{{3.61550812400902*^9, 3.615508275167665*^9}, {
  3.615509916101975*^9, 3.615509916228088*^9}, {3.615509974438381*^9, 
  3.6155100131426287`*^9}}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"x1", "\[CircleTimes]", "x2"}], "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"2", ",", "4"}], "}"}]]], "Output",
 CellChangeTimes->{{3.615508265334848*^9, 3.615508276252305*^9}, {
   3.615509896054597*^9, 3.6155099168987417`*^9}, 3.6155099834613533`*^9, 
   3.615510014454939*^9}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"x1", "\[CircleTimes]", "x2"}], "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"1", ",", "5"}], "}"}]]], "Output",
 CellChangeTimes->{{3.615508265334848*^9, 3.615508276252305*^9}, {
   3.615509896054597*^9, 3.6155099168987417`*^9}, 3.6155099834613533`*^9, 
   3.61551001445837*^9}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "y1", "\[CircleTimes]", 
    "y2"}], "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "11"}], "}"}]}]]], "Output",
 CellChangeTimes->{{3.615508265334848*^9, 3.615508276252305*^9}, {
   3.615509896054597*^9, 3.6155099168987417`*^9}, 3.6155099834613533`*^9, 
   3.615510014461485*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Nested brackets around a comma expression   ----   old", "Subsubsection",
 CellChangeTimes->{{3.615349719345826*^9, 3.615349724129532*^9}, {
   3.61535141453445*^9, 3.615351484423154*^9}, {3.615352703259014*^9, 
   3.61535270631492*^9}, {3.615363328404315*^9, 3.6153633317643023`*^9}, 
   3.615367318129233*^9, {3.615374815237824*^9, 3.615374819269886*^9}}],

Cell["Old code.   Counting is no longer correct.", "Text",
 CellChangeTimes->{{3.615374935702036*^9, 3.615374955718602*^9}}],

Cell["\<\
This transformation is in reverse simplification direction, so is a named \
RuleDelayed,\
\>", "Text",
 CellChangeTimes->{{3.615324067032547*^9, 3.615324121465021*^9}, {
  3.615331681782857*^9, 3.615331703158943*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CommaToProduct", " ", "=", " ", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "X__", "\[RightAngleBracket]"}], 
    "ab__List"], "\[RuleDelayed]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"(", 
      RowBox[{"\[CircleTimes]", "X"}], ")"}], "\[RightAngleBracket]"}], 
    RowBox[{"abComma", "[", 
     RowBox[{
      RowBox[{"{", "ab", "}"}], ",", 
      RowBox[{"{", "X", "}"}]}], "]"}]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6153241381140203`*^9, 3.615324144155789*^9}, {
   3.615324177132166*^9, 3.615324263406664*^9}, {3.615324294606286*^9, 
   3.615324329182507*^9}, {3.615324801935425*^9, 3.615324803823386*^9}, {
   3.615324840080078*^9, 3.615324910960642*^9}, {3.61532496387455*^9, 
   3.615324969105523*^9}, 3.615331718464126*^9, {3.6153749018714437`*^9, 
   3.6153749056491127`*^9}, {3.6153749664298687`*^9, 3.61537496778964*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", "X__", "\[RightAngleBracket]"}], 
   "ab__List"], "\[RuleDelayed]", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"\[CircleTimes]", "X"}], "\[RightAngleBracket]"}], 
   RowBox[{"abComma", "[", 
    RowBox[{
     RowBox[{"{", "ab", "}"}], ",", 
     RowBox[{"{", "X", "}"}]}], "]"}]]}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"abComma", "[", 
   RowBox[{"ab_List", ",", "X_List"}], "]"}], ":=", 
  RowBox[{"OrderedPairs", "[", 
   RowBox[{"Join", "[", 
    RowBox[{"ab", ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", 
          RowBox[{"#", "+", "1"}]}], "}"}], "&"}], ",", 
       RowBox[{"Most", "[", 
        RowBox[{"PartialSum", "[", 
         RowBox[{"deg", "[", "X", "]"}], "]"}], "]"}]}], "]"}]}], "]"}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615324922974246*^9, 3.615325031584907*^9}, {
  3.615328752178769*^9, 3.615328823992587*^9}, {3.6153288705694036`*^9, 
  3.615328939723145*^9}, {3.615328980299699*^9, 3.615328991884098*^9}, {
  3.615329072650785*^9, 3.615329074970561*^9}, {3.6153296237720737`*^9, 
  3.615329630859955*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PartialSum", "[", 
    RowBox[{"{", "}"}], "]"}], "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PartialSum", "[", "x_List", "]"}], ":=", " ", 
  RowBox[{"Prepend", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "[", "x", "]"}], "+", 
     RowBox[{"PartialSum", "[", 
      RowBox[{"Rest", "[", "x", "]"}], "]"}]}], ",", 
    RowBox[{"First", "[", "x", "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615325111748549*^9, 3.61532519107358*^9}, {
   3.6153252451692123`*^9, 3.615325361908348*^9}, {3.615326749238414*^9, 
   3.615326750661902*^9}, 3.615327278455502*^9, {3.615328063032835*^9, 
   3.615328068855959*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing  --  PartialSum", "Subsubsection",
 CellChangeTimes->{{3.615326872477516*^9, 3.615326902381987*^9}, {
   3.615328706097937*^9, 3.615328717344694*^9}, 3.6153640841323757`*^9, 
   3.615364174548929*^9}],

Cell["\<\
The recursive defn of  PartialSum  is faster than Do loop for lists with \
length less than about 10, and only 3x slower for length 1000.
The Recursive will eventually exceed  $RecursionLimit  for long lists.
The Do loop time goes up quadratically!!   Must be the Append.... should use \
Sow/Reap.\
\>", "Text",
 CellChangeTimes->{{3.6153269294374933`*^9, 3.61532698646185*^9}, {
  3.615327376174667*^9, 3.615327426655026*^9}, {3.615327649935812*^9, 
  3.6153278258080673`*^9}, {3.615327948639964*^9, 3.615328027712082*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PartialSum1", "[", 
    RowBox[{"{", "}"}], "]"}], "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PartialSum1", "[", "x_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", ",", "s", ",", "n", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lastp", "=", 
      RowBox[{"First", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"p", "=", 
      RowBox[{"{", "lastp", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"lastp", "+=", 
         RowBox[{"x", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"p", ",", "lastp"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "p"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.615325111748549*^9, 3.61532519107358*^9}, {
   3.6153252451692123`*^9, 3.615325361908348*^9}, {3.615325576004655*^9, 
   3.615325595715555*^9}, {3.6153256393802147`*^9, 3.615325663653615*^9}, {
   3.615325769410296*^9, 3.6153258083549757`*^9}, {3.615325890451499*^9, 
   3.615325967397399*^9}, {3.615326059077836*^9, 3.6153261099586782`*^9}, {
   3.6153263790473127`*^9, 3.615326612874057*^9}, 3.6153280528773537`*^9, 
   3.6153281030053053`*^9, {3.616213928023012*^9, 3.616213928583067*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"PartialSum1", "[", 
  RowBox[{"{", 
   RowBox[{
   "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", "8", 
    ",", "9", ",", "10"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PartialSum", "[", 
  RowBox[{"{", 
   RowBox[{
   "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", "8", 
    ",", "9", ",", "10"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.615325370879077*^9, 3.6153253829467287`*^9}, {
  3.615326842186125*^9, 3.615326846551773*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "3", ",", "6", ",", "10", ",", "15", ",", "21", ",", "28", ",", 
   "36", ",", "45", ",", "55"}], "}"}]], "Output",
 CellChangeTimes->{
  3.615325383634388*^9, 3.6153256739303417`*^9, 3.615326619755303*^9, 
   3.6153268471412153`*^9, 3.615327077268135*^9, 3.615327287960114*^9, 
   3.61532743519398*^9, {3.615328094810821*^9, 3.615328107218645*^9}, 
   3.6153281630691767`*^9, 3.615329689900474*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "3", ",", "6", ",", "10", ",", "15", ",", "21", ",", "28", ",", 
   "36", ",", "45", ",", "55"}], "}"}]], "Output",
 CellChangeTimes->{
  3.615325383634388*^9, 3.6153256739303417`*^9, 3.615326619755303*^9, 
   3.6153268471412153`*^9, 3.615327077268135*^9, 3.615327287960114*^9, 
   3.61532743519398*^9, {3.615328094810821*^9, 3.615328107218645*^9}, 
   3.6153281630691767`*^9, 3.615329689904464*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"PartialSum1", "[", 
    RowBox[{"Range", "[", "10000", "]"}], "]"}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"PartialSum", "[", 
    RowBox[{"Range", "[", "10000", "]"}], "]"}], ";"}], "]"}]}], "Input",
 CellChangeTimes->{{3.615327529189685*^9, 3.6153275300534267`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.33602100000000001411848415955319069326`5.546966333226391", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.615327541917329*^9, 3.6153275529913*^9}, {
   3.6153281135744123`*^9, 3.615328121346929*^9}, {3.6153281658627977`*^9, 
   3.615328174189392*^9}, 3.615329690599715*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"$RecursionLimit", "::", "reclim"}], "MessageName"], ":", 
  " ", "\<\"Recursion depth of \[NoBreak]\\!\\(1024\\)\[NoBreak] exceeded. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/$RecursionLimit/reclim\\\", ButtonNote -> \
\\\"$RecursionLimit::reclim\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.6153281659514713`*^9, 3.615328174284527*^9}, 
   3.615329690604711*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.08400599999999999734079381141782505438`4.944910219268086", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.615327541917329*^9, 3.6153275529913*^9}, {
   3.6153281135744123`*^9, 3.615328121346929*^9}, {3.6153281658627977`*^9, 
   3.615328174189392*^9}, 3.615329690608659*^9}]
}, Open  ]],

Cell["\<\
The Do loop time goes up quadratically (!)  because of the Append .... should \
use Sow/Reap.
10x longer list than above, 100x longer time,\
\>", "Text",
 CellChangeTimes->{{3.615328230952734*^9, 3.6153283100164957`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"PartialSum1", "[", 
    RowBox[{"Range", "[", "100000", "]"}], "]"}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.615327865334309*^9, 3.615327890245521*^9}, 
   3.615328188038822*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "32.2620160000000026911948225460946559906`7.52929141552412", ",", "Null"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6153278592001057`*^9, 3.615327888187442*^9}, 
   3.615327923184031*^9, 3.615328183983056*^9, 3.615328222532815*^9, 
   3.615329723019623*^9}]
}, Open  ]],

Cell["The Do loop is 2x faster for list length 1000,", "Text",
 CellChangeTimes->{{3.615328230952734*^9, 3.6153283100164957`*^9}, {
  3.615328358640586*^9, 3.615328381120822*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"PartialSum1", "[", 
    RowBox[{"Range", "[", "1000", "]"}], "]"}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"PartialSum", "[", 
    RowBox[{"Range", "[", "1000", "]"}], "]"}], ";"}], "]"}]}], "Input",
 CellChangeTimes->{{3.615328326119072*^9, 3.615328330166595*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.00800000000000000016653345369377348106`3.9236899002715675", ",", 
   "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.615328336029468*^9, 3.615329723181116*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.02400199999999999903033121029238827759`4.400847344690172", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{3.615328336029468*^9, 3.6153297232060547`*^9}]
}, Open  ]],

Cell["The Do loop is 5x faster for list length 100,", "Text",
 CellChangeTimes->{{3.615328230952734*^9, 3.6153283100164957`*^9}, {
  3.615328358640586*^9, 3.615328381120822*^9}, {3.615328457648838*^9, 
  3.615328461184548*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"PartialSum1", "[", 
     RowBox[{"Range", "[", "100", "]"}], "]"}], ",", 
    RowBox[{"{", "100", "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"PartialSum", "[", 
     RowBox[{"Range", "[", "100", "]"}], "]"}], ",", 
    RowBox[{"{", "100", "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6153267910776453`*^9, 3.615326815018203*^9}, {
  3.61532721327288*^9, 3.615327236742272*^9}, {3.615328418683045*^9, 
  3.615328419481182*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.03200200000000000266631161593977594748`4.5257770341564525", ",", 
   "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.615327238688743*^9, 3.615327442215848*^9, {3.6153274843050823`*^9, 
   3.6153274881657677`*^9}, 3.6153284223629427`*^9, 3.615329723387725*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.18801200000000001244515601683815475553`5.294785482583008", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.615327238688743*^9, 3.615327442215848*^9, {3.6153274843050823`*^9, 
   3.6153274881657677`*^9}, 3.6153284223629427`*^9, 3.6153297234448233`*^9}]
}, Open  ]],

Cell["The Do loop is about the same for list length 10,", "Text",
 CellChangeTimes->{{3.615328230952734*^9, 3.6153283100164957`*^9}, {
  3.615328358640586*^9, 3.615328381120822*^9}, {3.615328457648838*^9, 
  3.615328461184548*^9}, {3.615328509440934*^9, 3.615328520016789*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"PartialSum1", "[", 
     RowBox[{"Range", "[", "10", "]"}], "]"}], ",", 
    RowBox[{"{", "1000", "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"PartialSum", "[", 
     RowBox[{"Range", "[", "10", "]"}], "]"}], ",", 
    RowBox[{"{", "1000", "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6153267910776453`*^9, 3.615326815018203*^9}, {
  3.61532721327288*^9, 3.61532721482714*^9}, {3.6153274643614397`*^9, 
  3.6153274731911573`*^9}, {3.615328485595385*^9, 3.61532849477748*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.05200300000000000061328719880293647293`4.736628311642577", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.615326796316195*^9, 3.615326815837346*^9}, 
   3.615327215817525*^9, {3.615327446710257*^9, 3.615327479018791*^9}, {
   3.615328477888631*^9, 3.615328495539216*^9}, 3.615329723648451*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.06000400000000000177990955307905096561`4.798780115663672", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.615326796316195*^9, 3.615326815837346*^9}, 
   3.615327215817525*^9, {3.615327446710257*^9, 3.615327479018791*^9}, {
   3.615328477888631*^9, 3.615328495539216*^9}, 3.615329723707241*^9}]
}, Open  ]],

Cell["Recursion is faster for list length < 8,", "Text",
 CellChangeTimes->{{3.615328230952734*^9, 3.6153283100164957`*^9}, {
  3.615328358640586*^9, 3.615328381120822*^9}, {3.615328457648838*^9, 
  3.615328461184548*^9}, {3.615328509440934*^9, 3.615328583504978*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"PartialSum1", "[", 
     RowBox[{"Range", "[", "8", "]"}], "]"}], ",", 
    RowBox[{"{", "1000", "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"PartialSum", "[", 
     RowBox[{"Range", "[", "8", "]"}], "]"}], ",", 
    RowBox[{"{", "1000", "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6153267910776453`*^9, 3.615326815018203*^9}, {
  3.61532721327288*^9, 3.61532721482714*^9}, {3.6153274643614397`*^9, 
  3.6153274731911573`*^9}, {3.615327584599826*^9, 3.6153275858990593`*^9}, {
  3.615328559579035*^9, 3.615328587934052*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.05200300000000000061328719880293647293`4.736628311642577", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.6153275868426723`*^9, {3.615328563149199*^9, 3.615328589037652*^9}, 
   3.615329723889628*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.04400300000000000044675374510916299187`4.6640821997437945", ",", 
   "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6153275868426723`*^9, {3.615328563149199*^9, 3.615328589037652*^9}, 
   3.615329723935841*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"PartialSum1", "[", 
     RowBox[{"Range", "[", "2", "]"}], "]"}], ",", 
    RowBox[{"{", "1000", "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"PartialSum", "[", 
     RowBox[{"Range", "[", "2", "]"}], "]"}], ",", 
    RowBox[{"{", "1000", "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.615328600600968*^9, 3.615328601848331*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.02400199999999999903033121029238827759`4.400847344690172", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{3.61532860284156*^9, 3.615329724084352*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.0120000000000000002498001805406602216`4.099781159327249", ",", "Null"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.61532860284156*^9, 3.61532972408954*^9}]
}, Open  ]],

Cell["", "Text"],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"4", ",", 
   RowBox[{"{", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}]}], "]"}]}], "Input",\

 CellChangeTimes->{{3.615329721271151*^9, 3.615329768426516*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "\[RightAngleBracket]"}], 
  
  RowBox[{
  "1", ",", "11", ",", "2", ",", "7", ",", "6", ",", "15", ",", "14", ",", 
   "16"}]], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "\[RightAngleBracket]"}], 
   RowBox[{
   "1", ",", "11", ",", "2", ",", "7", ",", "6", ",", "15", ",", "14", ",", 
    "16"}]], "/.", "CommaToProduct"}]}], "Input",
 CellChangeTimes->{{3.615329777257666*^9, 3.6153297862002583`*^9}, {
   3.615330105353395*^9, 3.615330135786434*^9}, {3.6153313573764257`*^9, 
   3.615331380502701*^9}, 3.615331735682588*^9}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "\[RightAngleBracket]"}], 
  
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "11"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14", ",", "16"}], "}"}]}]]], "Output",
 CellChangeTimes->{
  3.615331257955675*^9, {3.6153313704159403`*^9, 3.615331381934773*^9}, 
   3.6153317384043827`*^9, 3.6153527631260157`*^9, 3.6153679521245604`*^9}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", "\[CircleTimes]", 
    "a4"}], "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "11"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14", ",", "16"}], "}"}]}]]], "Output",
 CellChangeTimes->{
  3.615331257955675*^9, {3.6153313704159403`*^9, 3.615331381934773*^9}, 
   3.6153317384043827`*^9, 3.6153527631260157`*^9, 3.615367952127954*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"abComma", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "11"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "15"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"14", ",", "16"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.615331923548456*^9, 3.6153319536796494`*^9}}],

Cell[BoxData[
 RowBox[{"Sequence", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "11"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"14", ",", "16"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.615331956089094*^9, 3.615352766284729*^9, 
  3.615367953797206*^9}]
}, Open  ]],

Cell["\<\
We can now use   abComma  to combine general bracket expressions that have \
multiple  X,\
\>", "Text",
 CellChangeTimes->{{3.615331438070574*^9, 3.6153314971265497`*^9}, {
   3.615331780103154*^9, 3.615331792311224*^9}, {3.615333129210285*^9, 
   3.6153331329222803`*^9}, 3.615367900067356*^9}],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", "X__", "\[RightAngleBracket]"}], 
      "ab1__List"], "\[RightAngleBracket]"}], "ab2__List"], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"(", 
      RowBox[{"\[CircleTimes]", "X"}], ")"}], "\[RightAngleBracket]"}], 
    RowBox[{"ab1ab2", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"abComma", "[", 
        RowBox[{
         RowBox[{"{", "ab1", "}"}], ",", 
         RowBox[{"{", "X", "}"}]}], "]"}], "}"}], ",", 
      RowBox[{"{", "ab2", "}"}]}], "]"}]]}], "]"}]], "Input",
 CellChangeTimes->{
  3.615331775246539*^9, {3.615331819756998*^9, 3.615331852782155*^9}, {
   3.615331887469613*^9, 3.615331898497776*^9}, {3.6153319836790133`*^9, 
   3.615332011503929*^9}, {3.61536888238522*^9, 3.6153688865925083`*^9}}],

Cell["\<\
We still need a rule to put the commas back in, so this is only half way \
simplified,\
\>", "Text",
 CellChangeTimes->{{3.6153689327105722`*^9, 3.615368968167245*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"4", ",", 
   RowBox[{"{", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"1", ",", "11", ",", "2", ",", "7"}]], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "4"}]]}], "Input",
 CellChangeTimes->{{3.615367962186496*^9, 3.61536796383436*^9}}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", "\[CircleTimes]", 
    "a4"}], "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "11"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "14"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "13"}], "}"}]}]]], "Output",
 CellChangeTimes->{3.61536796590915*^9, 3.615368898960693*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Single bracket around a non-subscripted bracket expression     ----   old\
\>", "Subsubsection",
 CellChangeTimes->{{3.615363077100058*^9, 3.6153631027720423`*^9}, {
   3.6153632817324*^9, 3.615363320452384*^9}, {3.6153633693003063`*^9, 
   3.615363370036381*^9}, 3.615367312113865*^9, {3.615375479703602*^9, 
   3.615375480608563*^9}}],

Cell["\<\
Since a subscripted bracket expression is   Subscript[ AngleBracket[ ... ], \
... ]    we can not have any rules that apply for a top-level  \
\[LeftAngleBracket] ... \[RightAngleBracket]   (ie. Head == AngleBracket)  \
because 
such rules would get used within the  Subscript  function. (This was not a \
problem in  tpTensorVer2  because only the subscripted angle bracket had one \
argument and only
the non-subscripted bracket had more than one argument. So rules for one or \
the other were distinguished by the number of arguments.)

This is the same as the previous case but with no subscripts,  ab1 = { },  on \
the inside bracket,\
\>", "Text",
 CellChangeTimes->{{3.6153632216198997`*^9, 3.615363257428356*^9}, {
   3.615363379892082*^9, 3.615363416804418*^9}, {3.6153642092852287`*^9, 
   3.615364232229217*^9}, {3.6153696346007357`*^9, 3.615369792393434*^9}, {
   3.615369840665531*^9, 3.6153701673229237`*^9}, 3.6153702045702667`*^9}],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", "X__", "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], "ab2__List"], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"(", 
      RowBox[{"\[CircleTimes]", "X"}], ")"}], "\[RightAngleBracket]"}], 
    RowBox[{"ab1ab2", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"abComma", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", "X", "}"}]}], "]"}], "}"}], ",", 
      RowBox[{"{", "ab2", "}"}]}], "]"}]]}], "]"}]], "Input",
 CellChangeTimes->{
  3.615331775246539*^9, {3.615331819756998*^9, 3.615331852782155*^9}, {
   3.615331887469613*^9, 3.615331898497776*^9}, {3.6153319836790133`*^9, 
   3.615332011503929*^9}, {3.61536313098927*^9, 3.615363132668339*^9}, {
   3.6153631987644787`*^9, 3.615363199932207*^9}, {3.615369169457924*^9, 
   3.6153691745603523`*^9}}],

Cell["\<\
We still need a rule to put the commas back in, so this is only half way \
simplified,\
\>", "Text",
 CellChangeTimes->{{3.6153689327105722`*^9, 3.615368968167245*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"4", ",", 
   RowBox[{"{", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a1", ",", "a2", ",", "a3"}], "\[RightAngleBracket]"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "4", ",", "2", ",", "6"}]]}], "Input",
 CellChangeTimes->{{3.61536802977151*^9, 3.615368040459898*^9}, {
  3.6153690110240583`*^9, 3.61536902787267*^9}}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "9"}], "}"}]}]]], "Output",
 CellChangeTimes->{
  3.615368042452538*^9, 3.6153680912215757`*^9, {3.615368997398202*^9, 
   3.615369028482481*^9}, 3.615369178547825*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
A pair of adjacent subscripts on adjacent tensors --- delete subscript pair \
and replace tensor product by comma        ---- old code\
\>", "Subsubsection",
 CellChangeTimes->{{3.615351652983083*^9, 3.61535172979944*^9}, {
   3.615363444724176*^9, 3.615363467908186*^9}, {3.615367334113309*^9, 
   3.6153673634893713`*^9}, {3.615367398945533*^9, 3.615367407425569*^9}, {
   3.615375436215618*^9, 3.615375451047707*^9}, 3.616214415419026*^9, 
   3.6555742859685783`*^9}],

Cell[TextData[{
 "Subscript numbers refer to the slots of the tensor product of the  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["X", 
    RowBox[{" ", "i"}]], TraditionalForm]]],
 " , ie. those of  (\[CircleTimes] X).  Replacing a  \[CircleTimes]  by a \
comma does not change any subscript numbers."
}], "Text",
 CellChangeTimes->{{3.615332702344947*^9, 3.6153329088897343`*^9}, {
  3.615351606007629*^9, 3.615351606407398*^9}}],

Cell["\<\
This is the rule that replaces subscript pairs by commas whenever possible.  \
This is the default rule that is the reverse of  CommaToProduct.  After \
defining this rule,
any transformation by CommaToProduct  will be automatically undone. 
A straight forward tensor product to comma is only done if the tensor product \
factors are not vectors. The vector case is done elsewhere. \
\>", "Text",
 CellChangeTimes->{{3.6153329526174507`*^9, 3.6153331224581537`*^9}, {
   3.615333155082672*^9, 3.615333218234626*^9}, {3.615333271946563*^9, 
   3.615333272250746*^9}, {3.615333309498828*^9, 3.6153334049389267`*^9}, {
   3.615338830649045*^9, 3.61533892943322*^9}, 3.6153393977864933`*^9, {
   3.615363508836934*^9, 3.615363537220879*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1___", ",", 
       RowBox[{"X1__", "\[CircleTimes]", "X2__"}], ",", "Y2___"}], 
      "\[RightAngleBracket]"}], "ab__List"], "/;", 
    RowBox[{
     RowBox[{
      RowBox[{"deg", "[", "X1", "]"}], ">", "1"}], "&&", 
     RowBox[{
      RowBox[{"deg", "[", "X2", "]"}], ">", "1"}], "&&", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", 
          RowBox[{"deg", "[", "X1", "]"}]}], ",", 
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", 
          RowBox[{"deg", "[", "X1", "]"}], "+", "1"}]}], "}"}]}], "]"}]}]}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1", ",", 
      RowBox[{"(", 
       RowBox[{"\[CircleTimes]", "X1"}], ")"}], ",", 
      RowBox[{"(", 
       RowBox[{"\[CircleTimes]", "X2"}], ")"}], ",", "Y2"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"Apply", "[", 
     RowBox[{"Sequence", ",", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"{", "ab", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"deg", "[", "Y1", "]"}], "+", 
           RowBox[{"deg", "[", "X1", "]"}]}], ",", 
          RowBox[{
           RowBox[{"deg", "[", "Y1", "]"}], "+", 
           RowBox[{"deg", "[", "X1", "]"}], "+", "1"}]}], "}"}]}], "]"}]}], 
     "]"}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.615333580611764*^9, 3.6153336074073343`*^9}, {
  3.615333676015444*^9, 3.615333715809112*^9}, {3.615333955761775*^9, 
  3.615334082468196*^9}, {3.6153342224699593`*^9, 3.6153342988232307`*^9}, {
  3.615334511449233*^9, 3.615334512760944*^9}, {3.6153345965209618`*^9, 
  3.615334710380542*^9}, {3.615334791260804*^9, 3.615334814161285*^9}, {
  3.615335260976157*^9, 3.615335270256744*^9}, {3.615335426335496*^9, 
  3.61533545176052*^9}, {3.61533587272162*^9, 3.6153358777780037`*^9}, {
  3.6153362099547586`*^9, 3.615336234691126*^9}, {3.615336265923904*^9, 
  3.6153362710751038`*^9}, {3.6153363016829433`*^9, 3.615336347441571*^9}, {
  3.6153543966385508`*^9, 3.615354403934272*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "105", "]"}]], "Output",
 CellChangeTimes->{3.615354404681231*^9, 3.6153692208552217`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{
   "a1", ",", "a2", ",", "a3", ",", "a4", ",", "x1", ",", "x2", ",", "x3"}], 
   "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"4", ",", 
   RowBox[{"{", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"2", ",", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.615335516726878*^9, 3.615335547190343*^9}, {
  3.615349236487872*^9, 3.6153492820576677`*^9}}],

Cell[BoxData[
 RowBox[{"StartDebug", "[", "]"}]], "Input",
 CellChangeTimes->{{3.6153543865893497`*^9, 3.615354390693446*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"x1", ",", 
    RowBox[{"a1", "\[CircleTimes]", "a2"}], ",", "x2"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "8", ",", "4", ",", "5"}]]], "Input",
 CellChangeTimes->{{3.615352833615616*^9, 3.6153528529961767`*^9}, {
  3.615354307971891*^9, 3.61535430950708*^9}, {3.615369338670793*^9, 
  3.615369344333312*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]98\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1__", ",", 
      RowBox[{"X_CircleTimes", "/;", 
       RowBox[{
        RowBox[{"Length", "[", "X", "]"}], "===", "2"}]}], ",", "Y2__"}], 
     "\[RightAngleBracket]"}], ":=", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1", ",", 
       RowBox[{"First", "[", "X", "]"}]}], "\[RightAngleBracket]"}], 
     "\[CircleTimes]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"Last", "[", "X", "]"}], ",", "Y2"}], 
      "\[RightAngleBracket]"}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]98\[VeryThinSpace]]:", "  ", 
   Defer[AngleBracket[
      Pattern[$CellContext`Y1, 
       BlankSequence[]], 
      Condition[
       Pattern[$CellContext`X, 
        Blank[CircleTimes]], Length[$CellContext`X] === 2], 
      Pattern[$CellContext`Y2, 
       BlankSequence[]]] := CircleTimes[
      AngleBracket[$CellContext`Y1, 
       First[$CellContext`X]], 
      AngleBracket[
       Last[$CellContext`X], $CellContext`Y2]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.615369367998171*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"x1", ",", 
       RowBox[{"First", "[", 
        RowBox[{"a1", "\[CircleTimes]", "a2"}], "]"}]}], 
      "\[RightAngleBracket]"}], "\[CircleTimes]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"Last", "[", 
        RowBox[{"a1", "\[CircleTimes]", "a2"}], "]"}], ",", "x2"}], 
      "\[RightAngleBracket]"}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    CircleTimes[
     AngleBracket[$CellContext`x1, 
      First[
       CircleTimes[$CellContext`a1, $CellContext`a2]]], 
     AngleBracket[
      Last[
       CircleTimes[$CellContext`a1, $CellContext`a2]], $CellContext`x2]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6153693681503897`*^9}]
}, Open  ]],

Cell[BoxData[
 SubscriptBox[
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"x1", ",", "a1"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a2", ",", "x2"}], "\[RightAngleBracket]"}]}], 
  RowBox[{"1", ",", "8", ",", "4", ",", "5"}]]], "Output",
 CellChangeTimes->{
  3.615352855836484*^9, {3.615354267934586*^9, 3.6153542782865877`*^9}, 
   3.6153543107159653`*^9, 3.61535459235149*^9, 3.615369251304528*^9, {
   3.61536934739744*^9, 3.6153693681553507`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", ",", "a2", ",", 
    RowBox[{"x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3"}], ",", "a3",
     ",", "a4"}], "\[RightAngleBracket]"}], 
  RowBox[{"10", ",", "11"}]]], "Input",
 CellChangeTimes->{{3.615335472536603*^9, 3.615335513141814*^9}, 
   3.6153492256508636`*^9, {3.615349300309969*^9, 3.615349301878316*^9}, 
   3.6153493631609793`*^9}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a1", ",", "a2", ",", "x1"}], "\[RightAngleBracket]"}], 
   "\[CircleTimes]", "x2", "\[CircleTimes]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"x3", ",", "a3", ",", "a4"}], "\[RightAngleBracket]"}]}], 
  RowBox[{"10", ",", "11"}]]], "Output",
 CellChangeTimes->{3.6153493030101967`*^9, 3.615349365819035*^9, 
  3.615352809340313*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Forming a comma contraction from a subscript pair", "Subsubsection",
 CellChangeTimes->{{3.6153755823598146`*^9, 3.615375619047966*^9}, {
   3.6154146294614964`*^9, 3.6154146337324333`*^9}, 3.615869101756271*^9, 
   3.6555742811365843`*^9}],

Cell[TextData[{
 "It is not clear that a comma expression should always replace a subscript \
contraction on adjacent slots (of a pair of adjacent tensors). The problem is \
that\nafter a comma expression is formed the two tensors can not be moved \
independently, and some other factor arrangement might be better.    \n\nWe \
need to be sure to be going in simplification direction. This will certainly \
be the case if comma contraction is limited to arguments that are degree 1 or \
2.\n\n    --  between a vector and any tensor on its first or last slot. \n   \
 --  between deg 2 tensors   ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["X", 
     RowBox[{"1", " "}]], " "}], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["X", "2"], TraditionalForm]]],
 "  with no free (uncontracted) slots of other tensors between the slots of   \
",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["X", 
     RowBox[{"1", " "}]], " "}], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["X", "2"], TraditionalForm]]],
 ".   Move  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["X", "2"], TraditionalForm]]],
 " next to  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["X", "1"], TraditionalForm]]],
 " and if necessary,\n         reverse one of ",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    SubscriptBox["X", 
     RowBox[{"1", " "}]], " "}], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["X", "2"], TraditionalForm]]],
 " to get a comma contraction. The result is one less slot pair and \
effectively one less deg 2 tensor.\n    --  between 2 vectors.  Take out the \
scalar inner product."
}], "Text",
 CellChangeTimes->{{3.61537565376783*^9, 3.615375661543934*^9}, {
   3.615414638644533*^9, 3.6154146565167027`*^9}, {3.61541471541256*^9, 
   3.615414818277178*^9}, {3.6154155989389668`*^9, 3.615416046124913*^9}, {
   3.6154160983177433`*^9, 3.615416201998374*^9}, {3.615416339119328*^9, 
   3.615416520689007*^9}, {3.615511102387507*^9, 3.6155111528514433`*^9}, {
   3.615511694357492*^9, 3.615511709684567*^9}, {3.6155117774885263`*^9, 
   3.615511788780498*^9}, 3.6155118563402843`*^9, 3.615536782252438*^9}]
}, Closed]],

Cell[BoxData[
 RowBox[{"<", "\[AliasDelimiter]"}]], "Input"],

Cell[CellGroupData[{

Cell["\<\
Contraction on a pair of vectors                                              \
    (nothing initialized)               \
\>", "Subsubsection",
 CellChangeTimes->{{3.615416564959765*^9, 3.615416576944047*^9}, {
   3.6155219596864767`*^9, 3.6155219776910686`*^9}, 3.6155220510306807`*^9, {
   3.6155705483173513`*^9, 3.615570565660597*^9}, {3.615699578021125*^9, 
   3.615699588700533*^9}, 3.6158688652113543`*^9, {3.655574257776927*^9, 
   3.655574260032843*^9}, {3.6555743284797907`*^9, 3.655574328847748*^9}}],

Cell["\<\
Two versions have been written. They have about the same timing. The pattern \
matching is perhaps quicker on simple cases, and is simpler code, so we use \
that.

Update:  The code for contracting a vector with a tensor can also do 2 \
vectors.  We now use just that (fewer rules to check).\
\>", "Text",
 CellChangeTimes->{{3.615522210598958*^9, 3.615522247383478*^9}, {
  3.615523128842085*^9, 3.615523156490799*^9}, {3.61552318826615*^9, 
  3.6155232114664783`*^9}, {3.615534550359502*^9, 3.615534621798469*^9}, {
  3.615699073858366*^9, 3.6156991051386347`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
    Version 1 --- full argument re-write                                      \
    (nothing initialized)\
\>", "Subsubsection",
 CellChangeTimes->{{3.615416564959765*^9, 3.615416576944047*^9}, {
   3.6155219596864767`*^9, 3.6155219776910686`*^9}, {3.615522056726643*^9, 
   3.61552207279149*^9}, 3.615522198406918*^9, {3.615523585291272*^9, 
   3.615523598363447*^9}, {3.61569956434081*^9, 3.6156995670612307`*^9}, {
   3.655574325536105*^9, 3.6555743271520157`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", "X_CircleTimes", "\[RightAngleBracket]"}],
      "ab__List"], "/;", 
    RowBox[{"VecVecContractionQ", "[", 
     RowBox[{"X", ",", 
      RowBox[{"{", "ab", "}"}]}], "]"}]}], ":=", 
   RowBox[{"VecVecContraction", "[", 
    RowBox[{"X", ",", 
     RowBox[{"{", "ab", "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.615416592511899*^9, 3.6154167246315928`*^9}, 
   3.615416804537263*^9, {3.615516388296134*^9, 3.6155163940561533`*^9}, {
   3.615516589978766*^9, 3.6155165974333963`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "87", "]"}]], "Output",
 CellChangeTimes->{3.615516395352516*^9, 3.615516626819661*^9}]
}, Open  ]],

Cell["\<\
This returns a list  d = DegreeOfSlotOwner[ X ]  of length deg[X],  such that \
  d[[ n ]]   is the degree of the tensor that owns slot  n  in the tensor \
product X,\
\>", "Text",
 CellChangeTimes->{{3.615418361976863*^9, 3.615418483177958*^9}, {
  3.61542853623145*^9, 3.615428595012599*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DegreeOfSlotOwner", "[", "X_CircleTimes", "]"}], ":=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"#", ",", 
        RowBox[{"{", "#", "}"}]}], "]"}], "&"}], ",", 
     RowBox[{"deg", "[", 
      RowBox[{"Apply", "[", 
       RowBox[{"List", ",", "X"}], "]"}], "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.615418259971026*^9, 3.6154183515170937`*^9}, {
  3.615418486156863*^9, 3.615418527981845*^9}, {3.6154194133142548`*^9, 
  3.615419498439652*^9}, {3.6154196006643887`*^9, 3.615419606391382*^9}}],

Cell["\<\
This returns a list p = PositionOfSlotOwner[ X ]  of length deg[X],  such \
that   p[[ n ]]   is the position of the factor (in the tensor product X) of \
the factor that owns slot  n,\
\>", "Text",
 CellChangeTimes->{{3.615418361976863*^9, 3.615418483177958*^9}, {
   3.61541982411313*^9, 3.615419888033402*^9}, {3.615427721449279*^9, 
   3.615427744746125*^9}, {3.61542778515307*^9, 3.615427838305525*^9}, 
   3.615428266262233*^9, {3.615428518772264*^9, 3.615428552292144*^9}, {
   3.6154286173449183`*^9, 3.615428678516821*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PositionOfSlotOwner", "[", "X_CircleTimes", "]"}], ":=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"#1", ",", 
        RowBox[{"{", "#2", "}"}]}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "X", "]"}], "]"}], ",", 
       RowBox[{"deg", "[", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", "X"}], "]"}], "]"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.615419668395041*^9, 3.615419696293201*^9}, {
   3.6154277760528917`*^9, 3.615427778132864*^9}, 3.6154278552672*^9, {
   3.615428123674086*^9, 3.615428143466506*^9}, {3.615428193178464*^9, 
   3.615428228395965*^9}, 3.615428261292911*^9, {3.61542842924548*^9, 
   3.615428447357379*^9}}],

Cell["\<\
...... this is not initialized, and is defined differently elsewhere.\
\>", "Text",
 CellChangeTimes->{{3.616283819218679*^9, 3.616283858081553*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{"1", ",", "x1"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"2", ",", "x2"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"3", ",", "x3"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"4", ",", "x4"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"DegreeOfSlotOwner", "[", 
  RowBox[{
  "x2", "\[CircleTimes]", "x1", "\[CircleTimes]", "x3", "\[CircleTimes]", 
   "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", "x4", "\[CircleTimes]", 
   "x1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PositionOfSlotOwner", "[", 
  RowBox[{
  "x2", "\[CircleTimes]", "x1", "\[CircleTimes]", "x3", "\[CircleTimes]", 
   "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", "x4", "\[CircleTimes]", 
   "x1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.615419568786488*^9, 3.615419587171536*^9}, {
  3.615419708590269*^9, 3.615419713954732*^9}, {3.61542829360989*^9, 
  3.615428296121299*^9}, {3.615428339961115*^9, 3.615428380126232*^9}, {
  3.615512166875866*^9, 3.615512170674032*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2", ",", "2", ",", "1", ",", "3", ",", "3", ",", "3", ",", "2", ",", "2", 
   ",", "3", ",", "3", ",", "3", ",", "4", ",", "4", ",", "4", ",", "4", ",", 
   "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.615419587902227*^9, 3.615419610382801*^9}, 
   3.615428307037624*^9, {3.615428355916656*^9, 3.6154283816664677`*^9}, 
   3.6154284511394053`*^9, 3.615511901781651*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "1", ",", "2", ",", "3", ",", "3", ",", "3", ",", "4", ",", "4", 
   ",", "5", ",", "5", ",", "5", ",", "6", ",", "6", ",", "6", ",", "6", ",", 
   "7"}], "}"}]], "Output",
 CellChangeTimes->{{3.615419587902227*^9, 3.615419610382801*^9}, 
   3.615428307037624*^9, {3.615428355916656*^9, 3.6154283816664677`*^9}, 
   3.6154284511394053`*^9, 3.6155119017850027`*^9}]
}, Open  ]],

Cell["\<\
This returns  True  (or False otherwise)  if  ab  specifies a contraction \
between at least one pair of vectors within the tensor product X,\
\>", "Text",
 CellChangeTimes->{{3.615432114224547*^9, 3.615432171696947*^9}, {
  3.615432204192864*^9, 3.6154322927853622`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VecVecContractionQ", "[", 
   RowBox[{"X_CircleTimes", ",", "ab_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "d", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "ab", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"DegreeOfSlotOwner", "[", "X", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"TrueQ", "[", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"d", "[", 
            RowBox[{"[", 
             RowBox[{"ab", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "===", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}]}], ",", 
          RowBox[{"Return", "[", "True", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "]"}]}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.615416756083942*^9, 3.615416788917551*^9}, {
   3.6154170477669477`*^9, 3.615417205229055*^9}, {3.615417255757031*^9, 
   3.6154172609094963`*^9}, {3.615417307789646*^9, 3.615417320013596*^9}, {
   3.615417363453985*^9, 3.615417408350997*^9}, {3.615417449823241*^9, 
   3.6154174606938963`*^9}, {3.6154175000173893`*^9, 3.615417546610626*^9}, {
   3.615417699603174*^9, 3.615417760099885*^9}, {3.61541779038772*^9, 
   3.6154178291565943`*^9}, {3.615428765378791*^9, 3.615428836435319*^9}, {
   3.615428898436151*^9, 3.61542892494839*^9}, {3.6154289978769903`*^9, 
   3.615429051299933*^9}, {3.61542925882092*^9, 3.615429308085718*^9}, {
   3.6154293396860533`*^9, 3.615429381570938*^9}, {3.615429428515184*^9, 
   3.615429515539831*^9}, {3.6154298964049807`*^9, 3.6154299110300694`*^9}, {
   3.61542995327077*^9, 3.615430052984146*^9}, 3.61543009140874*^9, {
   3.615430134009798*^9, 3.615430188809266*^9}, {3.615430226985813*^9, 
   3.615430246346253*^9}, {3.6154303021561213`*^9, 3.615430303097726*^9}, {
   3.615430632650222*^9, 3.615430682956196*^9}, {3.615430729244351*^9, 
   3.615430730875825*^9}, {3.615430773260257*^9, 3.61543079501824*^9}, {
   3.6154308509361553`*^9, 3.6154308779609547`*^9}, {3.615431140282292*^9, 
   3.6154311498986607`*^9}, {3.615431209802854*^9, 3.615431213501556*^9}, {
   3.6154312464429893`*^9, 3.615431275883616*^9}, {3.615431556923904*^9, 
   3.6154315650921173`*^9}, {3.615431662863556*^9, 3.6154316996768627`*^9}, {
   3.6154318098851833`*^9, 3.61543183681364*^9}, {3.615431904957933*^9, 
   3.61543192654217*^9}, {3.6154319834695187`*^9, 3.6154320126376133`*^9}, 
   3.615432063484879*^9, {3.615432336573843*^9, 3.615432338925604*^9}, 
   3.615432419967211*^9, {3.616213954966378*^9, 3.616213955367341*^9}}],

Cell["\<\
This does any specified vector contractions and returns the result,\
\>", "Text",
 CellChangeTimes->{{3.615432114224547*^9, 3.615432171696947*^9}, {
  3.615432204192864*^9, 3.6154322927853622`*^9}, {3.615432364497346*^9, 
  3.6154324033294992`*^9}, {3.615432748386716*^9, 3.615432756835009*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VecVecContraction", "[", 
   RowBox[{"X_CircleTimes", ",", "ab0_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "n", ",", "d", ",", "p", ",", "s1", ",", "s2", ",", "c", ",", "ab", ",", 
      "factors", ",", "degX", ",", "shift", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"degX", "=", 
      RowBox[{"deg", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"shift", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "degX", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"factors", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "X", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ab", "=", "ab0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "ab0", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"DegreeOfSlotOwner", "[", "X", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p", "=", 
      RowBox[{"PositionOfSlotOwner", "[", "X", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{"[", 
            RowBox[{"ab0", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "===", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s1", ",", "s2"}], "}"}], "=", 
           RowBox[{"ab0", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"factors", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"factors", ",", 
             RowBox[{"p", "[", 
              RowBox[{"[", "s1", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"factors", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"factors", ",", 
             RowBox[{"p", "[", 
              RowBox[{"[", "s2", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ab", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"ab", ",", 
             RowBox[{"{", 
              RowBox[{"s1", ",", "s2"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"++", 
             RowBox[{"shift", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"s1", "+", "1"}], ",", "degX"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"++", 
             RowBox[{"shift", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"s2", "+", "1"}], ",", "degX"}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"c", "=", 
           RowBox[{"c", " ", 
            RowBox[{"\[LeftAngleBracket]", 
             RowBox[{
              RowBox[{"X", "[", 
               RowBox[{"[", 
                RowBox[{"p", "[", 
                 RowBox[{"[", "s1", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"X", "[", 
               RowBox[{"[", 
                RowBox[{"p", "[", 
                 RowBox[{"[", "s2", "]"}], "]"}], "]"}], "]"}]}], 
             "\[RightAngleBracket]"}]}]}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ab", "===", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"c", " ", 
        RowBox[{"X", "[", 
         RowBox[{"[", "factors", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ab", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "-", 
              RowBox[{"shift", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], ")"}], "&"}], ",", "ab", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"c", " ", 
         SubscriptBox[
          RowBox[{"\[LeftAngleBracket]", 
           RowBox[{"X", "[", 
            RowBox[{"[", "factors", "]"}], "]"}], "\[RightAngleBracket]"}], 
          RowBox[{"Apply", "[", 
           RowBox[{"Sequence", ",", "ab"}], "]"}]]}]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.615432406819723*^9, 3.61543241403776*^9}, {
   3.615432456391035*^9, 3.615432483740135*^9}, {3.615432775806065*^9, 
   3.615433162409433*^9}, {3.615433196856349*^9, 3.615433318794712*^9}, {
   3.615433456026657*^9, 3.6154335415311117`*^9}, {3.615433658635376*^9, 
   3.615433677804661*^9}, {3.615433992765057*^9, 3.6154340544306173`*^9}, {
   3.6154340974549427`*^9, 3.61543409857298*^9}, {3.615434141052867*^9, 
   3.615434226605369*^9}, {3.6154342630239773`*^9, 3.615434278382056*^9}, {
   3.615442040109003*^9, 3.615442064700259*^9}, {3.6154469407080507`*^9, 
   3.61544700000847*^9}, {3.6154471809980297`*^9, 3.61544721393254*^9}, {
   3.615447353799938*^9, 3.615447395016691*^9}, {3.615447522951919*^9, 
   3.6154475285859737`*^9}, {3.615494611132568*^9, 3.6154946801748667`*^9}, {
   3.615494917147294*^9, 3.61549498864003*^9}, {3.615495044128173*^9, 
   3.615495089118362*^9}, {3.615495154240025*^9, 3.61549520185569*^9}, {
   3.6154953141103067`*^9, 3.615495393217926*^9}, {3.6154954316821737`*^9, 
   3.6154954388986807`*^9}, {3.6155119972738323`*^9, 3.615512004707041*^9}, 
   3.615515931167675*^9, {3.615516086827979*^9, 3.615516090320573*^9}, {
   3.615517578717394*^9, 3.6155175867889957`*^9}, 3.6155217501366377`*^9, {
   3.6155224951122637`*^9, 3.615522554074678*^9}, {3.616213987902494*^9, 
   3.616213988204606*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "x2", "\[CircleTimes]", "x1", "\[CircleTimes]", "x1", "\[CircleTimes]", 
    "x3", "\[CircleTimes]", "x2", "\[CircleTimes]", "x1", "\[CircleTimes]", 
    "x3", "\[CircleTimes]", "x4", "\[CircleTimes]", "x1", "\[CircleTimes]", 
    "x2"}], "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"5", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "18"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "19"}], "}"}]}]]], "Input",
 CellChangeTimes->{{3.615516738888616*^9, 3.6155167541677523`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"x1", ",", "x1"}], "\[RightAngleBracket]"}], "2"], " ", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
    "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", "x2", "\[CircleTimes]", 
     "x3", "\[CircleTimes]", "x4", "\[CircleTimes]", "x2"}], 
    "\[RightAngleBracket]"}], 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "10"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "12"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "15"}], "}"}]}]]}]], "Output",
 CellChangeTimes->{
  3.615516766896398*^9, 3.6155167991730003`*^9, {3.6155174595100803`*^9, 
   3.6155174775614653`*^9}, 3.615517710521894*^9, 3.615521578856267*^9, 
   3.615522559061008*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
    Version 2 --- one pair at a time using pattern matching          (nothing \
initialized)\
\>", "Subsubsection",
 CellChangeTimes->{{3.615416564959765*^9, 3.615416576944047*^9}, {
  3.6155219596864767`*^9, 3.615522028150798*^9}, {3.615522168391107*^9, 
  3.615522200022915*^9}, {3.615699111219214*^9, 3.615699112515918*^9}, {
  3.6156995681969643`*^9, 3.6156995685493183`*^9}, {3.655574333535779*^9, 
  3.6555743345599546`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1___", "\[CircleTimes]", 
       RowBox[{"X1_", "?", "deg1Q"}], "\[CircleTimes]", "Y2___", 
       "\[CircleTimes]", 
       RowBox[{"X2_", "?", "deg1Q"}], "\[CircleTimes]", "Y3___"}], 
      "\[RightAngleBracket]"}], "ab__List"], "/;", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"{", "ab", "}"}], "]"}], ">", "1"}], "&&", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", 
          RowBox[{"deg", "[", "Y2", "]"}], "+", "2"}]}], "}"}]}], "]"}]}]}], ":=", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X1", ",", "X2"}], "\[RightAngleBracket]"}], 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1", "\[CircleTimes]", "Y2", "\[CircleTimes]", "Y3"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{"abDrop", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", "  ", 
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", 
          RowBox[{"deg", "[", "Y2", "]"}], "+", "2"}]}], "}"}]}], "]"}]]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6155188211099577`*^9, 3.615519026772093*^9}, {
   3.6155190734121323`*^9, 3.615519106228709*^9}, {3.615519149925062*^9, 
   3.615519167334277*^9}, {3.615520303898307*^9, 3.615520311082643*^9}, 
   3.615521138114152*^9, {3.61552268389635*^9, 3.6155226988872557`*^9}, 
   3.615523565256736*^9, 3.615523682714923*^9, {3.615533454771903*^9, 
   3.615533480564653*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "53", "]"}]], "Output",
 CellChangeTimes->{3.615520317008586*^9, 3.615521142592881*^9, 
  3.615522860540125*^9, 3.615528365491045*^9, 3.61553355471731*^9, 
  3.6156027726370173`*^9, 3.615606931869541*^9, 3.615680726130669*^9, 
  3.615682411973208*^9, 3.6156836172605953`*^9, 3.615684517391561*^9, 
  3.615685132257955*^9, 3.615690898819188*^9, 3.6156924121587133`*^9, 
  3.6156954105196543`*^9, 3.615698557265231*^9}]
}, Open  ]],

Cell["\<\
abDrop[ ]   re-calculates  ab  after dropping slots  {s1, s2}.   This \
function is also used in the following section. It has been moved to there so \
that nothing here need be initialized. \
\>", "Text",
 CellChangeTimes->{{3.6155335808676367`*^9, 3.6155336508044367`*^9}, {
   3.615699187474575*^9, 3.615699215203232*^9}, 3.653877603568379*^9, {
   3.653877642575891*^9, 3.653877671775502*^9}}],

Cell["\<\
For the case of a single  ab pair,  so there are no subscripts after doing \
the contraction, \
\>", "Text",
 CellChangeTimes->{{3.615523448906678*^9, 3.6155235222348843`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1___", "\[CircleTimes]", 
       RowBox[{"X1_", "?", "deg1Q"}], "\[CircleTimes]", "Y2___", 
       "\[CircleTimes]", 
       RowBox[{"X2_", "?", "deg1Q"}], "\[CircleTimes]", "Y3___"}], 
      "\[RightAngleBracket]"}], "ab_List"], "/;", 
    RowBox[{"ab", "===", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", 
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", 
        RowBox[{"deg", "[", "Y2", "]"}], "+", "2"}]}], "}"}]}]}], ":=", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X1", ",", "X2"}], "\[RightAngleBracket]"}], 
    RowBox[{"Y1", "\[CircleTimes]", "Y2", "\[CircleTimes]", "Y3"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.615522717222457*^9, 3.615522799316573*^9}, {
  3.615523018806471*^9, 3.615523019158174*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "54", "]"}]], "Output",
 CellChangeTimes->{3.615522809866268*^9, 3.615523020570588*^9, 
  3.6155280100561867`*^9, 3.6156027728080463`*^9, 3.6156069319319077`*^9, 
  3.6156807262853813`*^9, 3.615682412065287*^9, 3.615683617377239*^9, 
  3.615684517653348*^9, 3.615685132392302*^9, 3.615690899596252*^9, 
  3.6156924122853394`*^9, 3.615695410629252*^9, 3.6156985574182673`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Timing", "Subsubsection",
 CellChangeTimes->{{3.615523379946517*^9, 3.615523382762805*^9}}],

Cell["\<\
Timing tests.   To compare Ver1 ans Ver2 ,  need to add suitable   UnsetRule  \
and  ResetRule,   \
\>", "Text",
 CellChangeTimes->{{3.615523246314103*^9, 3.615523313018447*^9}, {
  3.6156955284915237`*^9, 3.615695548170953*^9}}],

Cell[BoxData[
 RowBox[{"StopDebug", "[", "]"}]], "Input",
 CellChangeTimes->{{3.615529106561668*^9, 3.615529112611017*^9}, {
  3.615529143071032*^9, 3.615529143137232*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
       "x2", "\[CircleTimes]", "x1", "\[CircleTimes]", "x1", "\[CircleTimes]",
         "x3", "\[CircleTimes]", "x2", "\[CircleTimes]", "x1", 
        "\[CircleTimes]", "x3", "\[CircleTimes]", "x4", "\[CircleTimes]", 
        "x1", "\[CircleTimes]", "x2"}], "\[RightAngleBracket]"}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"5", ",", "15"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "13"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "18"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6", ",", "19"}], "}"}]}]], ",", 
     RowBox[{"{", "1000", "}"}]}], "]"}], ";", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
     "x2", "\[CircleTimes]", "x1", "\[CircleTimes]", "x1", "\[CircleTimes]", 
      "x3", "\[CircleTimes]", "x2", "\[CircleTimes]", "x1", "\[CircleTimes]", 
      "x3", "\[CircleTimes]", "x4", "\[CircleTimes]", "x1", "\[CircleTimes]", 
      "x2"}], "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "15"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "18"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "19"}], "}"}]}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.6155216081899233`*^9, 3.615521631520125*^9}, {
  3.615521675956627*^9, 3.615521677940384*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.67204200000000002823696831910638138652`5.847996328890372", ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"x1", ",", "x1"}], "\[RightAngleBracket]"}], "2"], " ", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
      "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", "x2", "\[CircleTimes]", 
       "x3", "\[CircleTimes]", "x4", "\[CircleTimes]", "x2"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "12"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "15"}], "}"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.615521613543063*^9, 3.615521647420334*^9}, {
   3.615521679722433*^9, 3.6155217091244783`*^9}, {3.6155217681716547`*^9, 
   3.615521772022006*^9}, {3.615522342415494*^9, 3.615522359886105*^9}, 
   3.615527999644678*^9, {3.615528376024148*^9, 3.615528378886204*^9}, {
   3.615529152183819*^9, 3.615529197437275*^9}, {3.615529313311782*^9, 
   3.615529321766388*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"Do", "[", 
    RowBox[{
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
       "x2", "\[CircleTimes]", "x1", "\[CircleTimes]", "x3", "\[CircleTimes]",
         "x1"}], "\[RightAngleBracket]"}], 
      RowBox[{"{", 
       RowBox[{"3", ",", "7"}], "}"}]], ",", 
     RowBox[{"{", "1000", "}"}]}], "]"}], ";", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
     "x2", "\[CircleTimes]", "x1", "\[CircleTimes]", "x3", "\[CircleTimes]", 
      "x1"}], "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"3", ",", "7"}], "}"}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.6155223892980556`*^9, 3.615522453553491*^9}, {
  3.6155225976833887`*^9, 3.615522597793715*^9}, {3.615523063203705*^9, 
  3.6155230633182707`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.16400999999999998912869614287046715617`5.235470241890844", ",", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"x1", ",", "x1"}], "\[RightAngleBracket]"}], " ", 
    RowBox[{"x2", "\[CircleTimes]", "x3"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.61552245428827*^9, {3.6155225702087297`*^9, 3.61552260326723*^9}, {
   3.6155230952937737`*^9, 3.615523107151083*^9}, {3.615528003000989*^9, 
   3.615528012185905*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Contraction on a vector slot and the first or last slot of a tensor\
\>", "Subsubsection",
 CellChangeTimes->{{3.615416564959765*^9, 3.615416576944047*^9}, {
   3.6155219596864767`*^9, 3.6155219776910686`*^9}, 3.6155220510306807`*^9, {
   3.6155241333408203`*^9, 3.615524157100938*^9}, {3.615524766366678*^9, 
   3.61552479667101*^9}, 3.615525805457952*^9, {3.615868830204987*^9, 
   3.6158688312752323`*^9}, 3.6158688619959927`*^9, 3.655574253905417*^9}],

Cell["\<\
Do the  vector-vector special case first and faster, since it is probably \
more common,
(this took 3x longer when added as rule[215] instead of rule[52])\
\>", "Text",
 CellChangeTimes->{{3.6156993427236433`*^9, 3.615699403028501*^9}, {
  3.615699475093853*^9, 3.615699507893214*^9}, {3.615699684504223*^9, 
  3.615699772310917*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"x1_", "?", "deg1Q"}], "\[CircleTimes]", 
       RowBox[{"x2_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]], ":=", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"x1", ",", "x2"}], "\[RightAngleBracket]"}]}]}], "]"}]], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.616736750030283*^9, 3.616736750473034*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "95", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
This re-calculates  ab  after dropping contracted slots  { s1,  s2 } .  The   \
Simplify[ ]   is to allow for symbolic degree calculations.
11/11/2015:   Added check that  s1<s2. Probably not needed, but safer.\
\>", "Text",
 CellChangeTimes->{{3.6155335808676367`*^9, 3.6155336508044367`*^9}, {
   3.615699187474575*^9, 3.615699215203232*^9}, {3.6156992661635923`*^9, 
   3.61569930354322*^9}, 3.61569942482084*^9, {3.653877698159176*^9, 
   3.653877740094673*^9}, {3.656174344694673*^9, 3.6561743979084253`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"abDrop", "[", 
    RowBox[{"ab_List", ",", 
     RowBox[{"{", 
      RowBox[{"s1_", ",", "s2_"}], "}"}]}], "]"}], "/;", 
   RowBox[{"Simplify", "[", 
    RowBox[{"s1", "<", "s2"}], "]"}]}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "f", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"f", ":=", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{"#", ">", "s2"}], "]"}], ",", 
         RowBox[{"#", "-", "2"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Simplify", "[", 
            RowBox[{"#", ">", "s1"}], "]"}], ",", 
           RowBox[{"#", "-", "1"}], ",", "#"}], "]"}]}], "]"}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Apply", "[", 
      RowBox[{"Sequence", ",", 
       RowBox[{"Map", "[", 
        RowBox[{"f", ",", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"ab", ",", 
           RowBox[{"{", 
            RowBox[{"s1", ",", "s2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615519182220378*^9, 3.61551920558062*^9}, {
   3.615519253102808*^9, 3.615519294222681*^9}, {3.615519357855008*^9, 
   3.615519473367627*^9}, {3.6155197407871513`*^9, 3.6155198223410892`*^9}, {
   3.6155198739892263`*^9, 3.6155199943436947`*^9}, {3.615520165224642*^9, 
   3.61552026676221*^9}, {3.615521339089737*^9, 3.615521349217729*^9}, {
   3.615528963656398*^9, 3.615528979320806*^9}, {3.615529520217683*^9, 
   3.615529549417317*^9}, {3.615529759865176*^9, 3.615529780123232*^9}, {
   3.615529821738859*^9, 3.615529830437214*^9}, 3.6155299059635553`*^9, 
   3.615530024731254*^9, {3.615530066347973*^9, 3.615530066679414*^9}, {
   3.615530150651466*^9, 3.615530157343408*^9}, 3.615530330458902*^9, {
   3.615530362455016*^9, 3.615530382090383*^9}, {3.6155327751039877`*^9, 
   3.615532804543454*^9}, {3.653877763136941*^9, 3.653877779744729*^9}, {
   3.6561744073966417`*^9, 3.656174421081852*^9}}],

Cell["\<\

These rules are for when there are also other contractions, so the result is \
still a subscript contraction,

Case 1:    v \[CircleTimes] ... \[CircleTimes] X  \[Rule]  \
\[LeftAngleBracket] v,  X \[RightAngleBracket] ,\
\>", "Text",
 CellChangeTimes->{{3.6155243984774723`*^9, 3.615524448141636*^9}, {
  3.615524817166747*^9, 3.615524817983055*^9}, {3.6155258853613777`*^9, 
  3.615525986674035*^9}, {3.61552627089847*^9, 3.6155263275063457`*^9}, {
  3.615526395298663*^9, 3.6155264066591997`*^9}, {3.6155287682968807`*^9, 
  3.615528847769367*^9}, {3.615528902825807*^9, 3.6155289058652554`*^9}, {
  3.6155325999859133`*^9, 3.615532605506342*^9}, {3.615534648663823*^9, 
  3.615534652886158*^9}, {3.6155824991055183`*^9, 3.615582555311795*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1___", "\[CircleTimes]", 
       RowBox[{"v_", "?", "deg1Q"}], "\[CircleTimes]", "Y2___", 
       "\[CircleTimes]", "X_", "\[CircleTimes]", "Y3___"}], 
      "\[RightAngleBracket]"}], "ab__List"], "/;", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"{", "ab", "}"}], "]"}], ">", "1"}], "&&", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", 
          RowBox[{"deg", "[", "Y2", "]"}], "+", "2"}]}], "}"}]}], "]"}]}]}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1", "\[CircleTimes]", "Y2", "\[CircleTimes]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"v", ",", "X"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
      "Y3"}], "\[RightAngleBracket]"}], 
    RowBox[{"abDrop", "[", 
     RowBox[{
      RowBox[{"{", "ab", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", "  ", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], "+", 
         RowBox[{"deg", "[", "Y2", "]"}], "+", "2"}]}], "}"}]}], "]"}]]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615524174523245*^9, 3.615524214142749*^9}, {
   3.615524350909939*^9, 3.615524388156005*^9}, {3.615524508092145*^9, 
   3.615524580828635*^9}, {3.615524854317019*^9, 3.615524893949706*^9}, {
   3.615525866109659*^9, 3.615525876256049*^9}, {3.615525939616222*^9, 
   3.615525960896935*^9}, {3.615526000624298*^9, 3.61552600265693*^9}, 
   3.615526169536879*^9, {3.615528713302992*^9, 3.615528723687277*^9}, {
   3.6155288627918787`*^9, 3.615528887767749*^9}, 3.615530335530772*^9, {
   3.615532487454544*^9, 3.615532505231838*^9}, {3.615532727072027*^9, 
   3.615532750208996*^9}, 3.6155328201280613`*^9, {3.615533393889756*^9, 
   3.615533394801265*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "96", "]"}]], "Output"]
}, Open  ]],

Cell["Case 2:    v \[CircleTimes] ... \[CircleTimes] X  \[Rule]  \
\[LeftAngleBracket] X,  v \[RightAngleBracket] ,", "Text",
 CellChangeTimes->{{3.6155243984774723`*^9, 3.615524448141636*^9}, {
  3.615524604926227*^9, 3.6155246065743856`*^9}, {3.61552482641475*^9, 
  3.61552482884687*^9}, {3.615525903361619*^9, 3.615525912065419*^9}, {
  3.615525969761691*^9, 3.6155259765620604`*^9}, {3.615526012961856*^9, 
  3.615526013570134*^9}, {3.615526337618602*^9, 3.615526347666732*^9}, {
  3.615526400424749*^9, 3.615526410114915*^9}, {3.615528772968883*^9, 
  3.615528791464916*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1___", "\[CircleTimes]", 
       RowBox[{"v_", "?", "deg1Q"}], "\[CircleTimes]", "Y2___", 
       "\[CircleTimes]", "X_", "\[CircleTimes]", "Y3___"}], 
      "\[RightAngleBracket]"}], "ab__List"], "/;", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"{", "ab", "}"}], "]"}], ">", "1"}], "&&", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", 
          RowBox[{"deg", "[", "Y2", "]"}], "+", 
          RowBox[{"deg", "[", "X", "]"}], "+", "1"}]}], "}"}]}], "]"}]}]}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1", "\[CircleTimes]", "Y2", "\[CircleTimes]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"X", ",", "v"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
      "Y3"}], "\[RightAngleBracket]"}], 
    RowBox[{"abDrop", "[", 
     RowBox[{
      RowBox[{"{", "ab", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", "  ", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], "+", 
         RowBox[{"deg", "[", "Y2", "]"}], "+", 
         RowBox[{"deg", "[", "X", "]"}], "+", "1"}]}], "}"}]}], "]"}]]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615524174523245*^9, 3.615524214142749*^9}, {
   3.615524350909939*^9, 3.615524388156005*^9}, {3.615524508092145*^9, 
   3.615524612177024*^9}, 3.615524914782971*^9, {3.615526069025262*^9, 
   3.61552611092901*^9}, {3.6155261732713203`*^9, 3.615526210384893*^9}, {
   3.615528732200041*^9, 3.6155287539438066`*^9}, {3.615528867943302*^9, 
   3.615528894236587*^9}, {3.615532822705336*^9, 3.6155328686902323`*^9}, {
   3.615533390625914*^9, 3.6155333912197638`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "97", "]"}]], "Output"]
}, Open  ]],

Cell["Case 3:   X \[CircleTimes] ... \[CircleTimes] v  \[Rule]  \
\[LeftAngleBracket] v,  X \[RightAngleBracket] ,", "Text",
 CellChangeTimes->{{3.6155243984774723`*^9, 3.615524448141636*^9}, {
   3.615524628190187*^9, 3.6155246304302053`*^9}, 3.615524833422669*^9, {
   3.615526256466462*^9, 3.615526260275629*^9}, {3.615526354802761*^9, 
   3.6155263639866457`*^9}, {3.615526402016457*^9, 3.615526412435161*^9}, {
   3.615528776489167*^9, 3.615528792664741*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
      "Y1___", "\[CircleTimes]", "X_", "\[CircleTimes]", "Y2___", 
       "\[CircleTimes]", 
       RowBox[{"v_", "?", "deg1Q"}], "\[CircleTimes]", "Y3___"}], 
      "\[RightAngleBracket]"}], "ab__List"], "/;", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"{", "ab", "}"}], "]"}], ">", "1"}], "&&", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", 
          RowBox[{"deg", "[", "X", "]"}], "+", 
          RowBox[{"deg", "[", "Y2", "]"}], "+", "1"}]}], "}"}]}], "]"}]}]}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1", "\[CircleTimes]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"v", ",", "X"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
      "Y2", "\[CircleTimes]", "Y3"}], "\[RightAngleBracket]"}], 
    RowBox[{"abDrop", "[", 
     RowBox[{
      RowBox[{"{", "ab", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", "  ", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], "+", 
         RowBox[{"deg", "[", "Y2", "]"}], "+", 
         RowBox[{"deg", "[", "X", "]"}], "+", "1"}]}], "}"}]}], "]"}]]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615524174523245*^9, 3.615524214142749*^9}, {
   3.615524350909939*^9, 3.615524388156005*^9}, {3.615524508092145*^9, 
   3.615524580828635*^9}, {3.615524655244164*^9, 3.615524672608787*^9}, {
   3.615524919937524*^9, 3.615524924847054*^9}, {3.6155261200655212`*^9, 
   3.6155261352012*^9}, 3.615526176480899*^9, {3.615526496289212*^9, 
   3.615526502385038*^9}, {3.615526620661697*^9, 3.615526653878915*^9}, {
   3.615528733600761*^9, 3.615528758360395*^9}, {3.615528872536088*^9, 
   3.6155288958881598`*^9}, {3.615532928128916*^9, 3.615532978034828*^9}, {
   3.6155333873484097`*^9, 3.615533387971826*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "98", "]"}]], "Output"]
}, Open  ]],

Cell["Case 4:    X \[CircleTimes] ... \[CircleTimes] v  \[Rule]  \
\[LeftAngleBracket] X,  v \[RightAngleBracket] ,", "Text",
 CellChangeTimes->{{3.6155243984774723`*^9, 3.615524448141636*^9}, {
   3.615524628190187*^9, 3.6155246304302053`*^9}, {3.6155246833266582`*^9, 
   3.615524684051585*^9}, 3.6155248372703876`*^9, {3.6155263691227617`*^9, 
   3.615526414755148*^9}, {3.615528783496826*^9, 3.615528793976698*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
      "Y1___", "\[CircleTimes]", "X_", "\[CircleTimes]", "Y2___", 
       "\[CircleTimes]", 
       RowBox[{"v_", "?", "deg1Q"}], "\[CircleTimes]", "Y3___"}], 
      "\[RightAngleBracket]"}], "ab__List"], "/;", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"{", "ab", "}"}], "]"}], ">", "1"}], "&&", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", 
          RowBox[{"deg", "[", "X", "]"}]}], ",", 
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", 
          RowBox[{"deg", "[", "X", "]"}], "+", 
          RowBox[{"deg", "[", "Y2", "]"}], "+", "1"}]}], "}"}]}], "]"}]}]}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1", "\[CircleTimes]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"X", ",", "v"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
      "Y2", "\[CircleTimes]", "Y3"}], "\[RightAngleBracket]"}], 
    RowBox[{"abDrop", "[", 
     RowBox[{
      RowBox[{"{", "ab", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], "+", 
         RowBox[{"deg", "[", "X", "]"}]}], ",", "  ", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], "+", 
         RowBox[{"deg", "[", "Y2", "]"}], "+", 
         RowBox[{"deg", "[", "X", "]"}], "+", "1"}]}], "}"}]}], "]"}]]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615524174523245*^9, 3.615524214142749*^9}, {
  3.615524350909939*^9, 3.615524388156005*^9}, {3.615524508092145*^9, 
  3.615524580828635*^9}, {3.615524655244164*^9, 3.61552469432104*^9}, {
  3.615524922363229*^9, 3.6155249307663107`*^9}, {3.615526144801346*^9, 
  3.615526178542642*^9}, {3.615526507089271*^9, 3.6155265094890842`*^9}, {
  3.615526672064152*^9, 3.615526701280064*^9}, {3.615528735264091*^9, 
  3.615528761612774*^9}, {3.6155288778811913`*^9, 3.6155288978309383`*^9}, {
  3.6155330222101107`*^9, 3.615533040371284*^9}, {3.615533371714077*^9, 
  3.615533384484527*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "99", "]"}]], "Output"]
}, Open  ]],

Cell["\<\

These rules are for when there is just the one contraction, so the result has \
no subscript contraction,

Case 1:    v \[CircleTimes] ... \[CircleTimes] X  \[Rule]  \
\[LeftAngleBracket] v,  X \[RightAngleBracket] ,\
\>", "Text",
 CellChangeTimes->{{3.6155243984774723`*^9, 3.615524448141636*^9}, {
  3.615524817166747*^9, 3.615524817983055*^9}, {3.6155258853613777`*^9, 
  3.615525986674035*^9}, {3.61552627089847*^9, 3.6155263275063457`*^9}, {
  3.615526395298663*^9, 3.6155264066591997`*^9}, {3.6155287682968807`*^9, 
  3.615528847769367*^9}, {3.615528902825807*^9, 3.6155289058652554`*^9}, {
  3.6155325999859133`*^9, 3.615532605506342*^9}, {3.615534648663823*^9, 
  3.615534652886158*^9}, {3.6155824991055183`*^9, 3.615582605520604*^9}, {
  3.615583017249886*^9, 3.615583022626708*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1___", "\[CircleTimes]", 
       RowBox[{"v_", "?", "deg1Q"}], "\[CircleTimes]", "Y2___", 
       "\[CircleTimes]", "X_", "\[CircleTimes]", "Y3___"}], 
      "\[RightAngleBracket]"}], "ab_List"], "/;", 
    RowBox[{"ab", "===", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", 
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", 
        RowBox[{"deg", "[", "Y2", "]"}], "+", "2"}]}], "}"}]}]}], ":=", 
   RowBox[{"Y1", "\[CircleTimes]", "Y2", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"v", ",", "X"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
    "Y3"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615524174523245*^9, 3.615524214142749*^9}, {
   3.615524350909939*^9, 3.615524388156005*^9}, {3.615524508092145*^9, 
   3.615524580828635*^9}, {3.615524854317019*^9, 3.615524893949706*^9}, {
   3.615525866109659*^9, 3.615525876256049*^9}, {3.615525939616222*^9, 
   3.615525960896935*^9}, {3.615526000624298*^9, 3.61552600265693*^9}, 
   3.615526169536879*^9, {3.615528713302992*^9, 3.615528723687277*^9}, {
   3.6155288627918787`*^9, 3.615528887767749*^9}, 3.615530335530772*^9, {
   3.615532487454544*^9, 3.615532505231838*^9}, {3.615532727072027*^9, 
   3.615532750208996*^9}, 3.6155328201280613`*^9, {3.615533393889756*^9, 
   3.615533394801265*^9}, {3.615582616238925*^9, 3.615582631696745*^9}, {
   3.6155826706717587`*^9, 3.6155826802367907`*^9}, {3.615583006572894*^9, 
   3.615583011260069*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "100", "]"}]], "Output"]
}, Open  ]],

Cell["Case 2:    v \[CircleTimes] ... \[CircleTimes] X  \[Rule]  \
\[LeftAngleBracket] X,  v \[RightAngleBracket] ,", "Text",
 CellChangeTimes->{{3.6155243984774723`*^9, 3.615524448141636*^9}, {
  3.615524604926227*^9, 3.6155246065743856`*^9}, {3.61552482641475*^9, 
  3.61552482884687*^9}, {3.615525903361619*^9, 3.615525912065419*^9}, {
  3.615525969761691*^9, 3.6155259765620604`*^9}, {3.615526012961856*^9, 
  3.615526013570134*^9}, {3.615526337618602*^9, 3.615526347666732*^9}, {
  3.615526400424749*^9, 3.615526410114915*^9}, {3.615528772968883*^9, 
  3.615528791464916*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1___", "\[CircleTimes]", 
       RowBox[{"v_", "?", "deg1Q"}], "\[CircleTimes]", "Y2___", 
       "\[CircleTimes]", "X_", "\[CircleTimes]", "Y3___"}], 
      "\[RightAngleBracket]"}], "ab_List"], "/;", 
    RowBox[{"ab", "===", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", 
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", 
        RowBox[{"deg", "[", "Y2", "]"}], "+", 
        RowBox[{"deg", "[", "X", "]"}], "+", "1"}]}], "}"}]}]}], ":=", 
   RowBox[{"Y1", "\[CircleTimes]", "Y2", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X", ",", "v"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
    "Y3"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615524174523245*^9, 3.615524214142749*^9}, {
   3.615524350909939*^9, 3.615524388156005*^9}, {3.615524508092145*^9, 
   3.615524612177024*^9}, 3.615524914782971*^9, {3.615526069025262*^9, 
   3.61552611092901*^9}, {3.6155261732713203`*^9, 3.615526210384893*^9}, {
   3.615528732200041*^9, 3.6155287539438066`*^9}, {3.615528867943302*^9, 
   3.615528894236587*^9}, {3.615532822705336*^9, 3.6155328686902323`*^9}, {
   3.615533390625914*^9, 3.6155333912197638`*^9}, {3.615582619216074*^9, 
   3.615582633845648*^9}, 3.615582686267851*^9, {3.6155827198566093`*^9, 
   3.615582756240271*^9}, {3.6155830385574913`*^9, 3.6155830435812693`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "101", "]"}]], "Output"]
}, Open  ]],

Cell["Case 3:   X \[CircleTimes] ... \[CircleTimes] v  \[Rule]  \
\[LeftAngleBracket] v,  X \[RightAngleBracket] ,", "Text",
 CellChangeTimes->{{3.6155243984774723`*^9, 3.615524448141636*^9}, {
   3.615524628190187*^9, 3.6155246304302053`*^9}, 3.615524833422669*^9, {
   3.615526256466462*^9, 3.615526260275629*^9}, {3.615526354802761*^9, 
   3.6155263639866457`*^9}, {3.615526402016457*^9, 3.615526412435161*^9}, {
   3.615528776489167*^9, 3.615528792664741*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
      "Y1___", "\[CircleTimes]", "X_", "\[CircleTimes]", "Y2___", 
       "\[CircleTimes]", 
       RowBox[{"v_", "?", "deg1Q"}], "\[CircleTimes]", "Y3___"}], 
      "\[RightAngleBracket]"}], "ab_List"], "/;", 
    RowBox[{"ab", "===", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", 
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", 
        RowBox[{"deg", "[", "X", "]"}], "+", 
        RowBox[{"deg", "[", "Y2", "]"}], "+", "1"}]}], "}"}]}]}], ":=", 
   RowBox[{"Y1", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"v", ",", "X"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
    "Y2", "\[CircleTimes]", "Y3"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615524174523245*^9, 3.615524214142749*^9}, {
   3.615524350909939*^9, 3.615524388156005*^9}, {3.615524508092145*^9, 
   3.615524580828635*^9}, {3.615524655244164*^9, 3.615524672608787*^9}, {
   3.615524919937524*^9, 3.615524924847054*^9}, {3.6155261200655212`*^9, 
   3.6155261352012*^9}, 3.615526176480899*^9, {3.615526496289212*^9, 
   3.615526502385038*^9}, {3.615526620661697*^9, 3.615526653878915*^9}, {
   3.615528733600761*^9, 3.615528758360395*^9}, {3.615528872536088*^9, 
   3.6155288958881598`*^9}, {3.615532928128916*^9, 3.615532978034828*^9}, {
   3.6155333873484097`*^9, 3.615533387971826*^9}, {3.61558262097266*^9, 
   3.615582636329214*^9}, 3.615582691372039*^9, {3.61558272153603*^9, 
   3.615582757931085*^9}, {3.615583049997628*^9, 3.6155830556447697`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "102", "]"}]], "Output"]
}, Open  ]],

Cell["Case 4:    X \[CircleTimes] ... \[CircleTimes] v  \[Rule]  \
\[LeftAngleBracket] X,  v \[RightAngleBracket] ,", "Text",
 CellChangeTimes->{{3.6155243984774723`*^9, 3.615524448141636*^9}, {
   3.615524628190187*^9, 3.6155246304302053`*^9}, {3.6155246833266582`*^9, 
   3.615524684051585*^9}, 3.6155248372703876`*^9, {3.6155263691227617`*^9, 
   3.615526414755148*^9}, {3.615528783496826*^9, 3.615528793976698*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
      "Y1___", "\[CircleTimes]", "X_", "\[CircleTimes]", "Y2___", 
       "\[CircleTimes]", 
       RowBox[{"v_", "?", "deg1Q"}], "\[CircleTimes]", "Y3___"}], 
      "\[RightAngleBracket]"}], "ab_List"], "/;", 
    RowBox[{"ab", "===", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", 
        RowBox[{"deg", "[", "X", "]"}]}], ",", 
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", 
        RowBox[{"deg", "[", "X", "]"}], "+", 
        RowBox[{"deg", "[", "Y2", "]"}], "+", "1"}]}], "}"}]}]}], ":=", 
   RowBox[{"Y1", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X", ",", "v"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
    "Y2", "\[CircleTimes]", "Y3"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615524174523245*^9, 3.615524214142749*^9}, {
  3.615524350909939*^9, 3.615524388156005*^9}, {3.615524508092145*^9, 
  3.615524580828635*^9}, {3.615524655244164*^9, 3.61552469432104*^9}, {
  3.615524922363229*^9, 3.6155249307663107`*^9}, {3.615526144801346*^9, 
  3.615526178542642*^9}, {3.615526507089271*^9, 3.6155265094890842`*^9}, {
  3.615526672064152*^9, 3.615526701280064*^9}, {3.615528735264091*^9, 
  3.615528761612774*^9}, {3.6155288778811913`*^9, 3.6155288978309383`*^9}, {
  3.6155330222101107`*^9, 3.615533040371284*^9}, {3.615533371714077*^9, 
  3.615533384484527*^9}, {3.615582622207209*^9, 3.6155826384932213`*^9}, {
  3.6155826951875277`*^9, 3.61558275904523*^9}, {3.615583062254064*^9, 
  3.615583066573266*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "103", "]"}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "----------------------------------------------------------------------------\
------------------------------------------------------------------------------\
---------------------------------------------------------\nNot used,  not \
initialized.\n\nThis returns True if the first free slot of  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["X", "1"], "\[CircleTimes]"}], "..."}], " ", 
      "\[CircleTimes]", " ", 
      SubscriptBox["X", "n"]}], " ", "\[RightAngleBracket]"}], 
    RowBox[{"ab", " "}]], TraditionalForm]]],
 " is the first or last slot of one of the factors in X."
}], "Text",
 CellChangeTimes->{{3.616898643252122*^9, 3.616898665140287*^9}, {
  3.6168987235404577`*^9, 3.6168988736851187`*^9}, {3.616899199158093*^9, 
  3.6168993644226*^9}, {3.616903796755682*^9, 3.616903815300147*^9}, {
  3.61690385176361*^9, 3.616903858436037*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FirstFreeIsAnEndSlotQ", "[", 
   RowBox[{"Xdegs_List", ",", "ab_List"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"deg", ",", "free"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"deg", "=", 
      RowBox[{"Total", "[", "Xdegs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"free", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Range", "[", "deg", "]"}], ",", 
        RowBox[{"Flatten", "[", "ab", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"FactorSlotRange", "[", "Xdegs", "]"}], ",", 
       RowBox[{"Min", "[", "free", "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.61689866824818*^9, 3.6168987172736397`*^9}, 
   3.616898865850004*^9, {3.616899006346858*^9, 3.616899014203475*^9}, {
   3.616899372300543*^9, 3.616899419840776*^9}, {3.6168994973109083`*^9, 
   3.6168996241616163`*^9}, {3.616899714530281*^9, 3.616899923617928*^9}, {
   3.616900170795429*^9, 3.6169002354925823`*^9}, {3.616900451781826*^9, 
   3.616900460325636*^9}, 3.616901431496728*^9, 3.6169017376257553`*^9, 
   3.616903127946309*^9}],

Cell[TextData[{
 "This returns True if the last free slot of  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["X", "1"], "\[CircleTimes]"}], "..."}], " ", 
      "\[CircleTimes]", " ", 
      SubscriptBox["X", "n"]}], " ", "\[RightAngleBracket]"}], 
    RowBox[{"ab", " "}]], TraditionalForm]]],
 " is the first or last slot of one of the factors in X."
}], "Text",
 CellChangeTimes->{{3.616898643252122*^9, 3.616898665140287*^9}, {
  3.6168987235404577`*^9, 3.6168988736851187`*^9}, {3.616899199158093*^9, 
  3.6168993644226*^9}, {3.616901564796997*^9, 3.616901565773082*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LastFreeIsAnEndSlotQ", "[", 
   RowBox[{"Xdegs_List", ",", "ab_List"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"deg", ",", "free"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"deg", "=", 
      RowBox[{"Total", "[", "Xdegs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"free", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Range", "[", "deg", "]"}], ",", 
        RowBox[{"Flatten", "[", "ab", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"FactorSlotRange", "[", "Xdegs", "]"}], ",", 
       RowBox[{"Max", "[", "free", "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.61689866824818*^9, 3.6168987172736397`*^9}, 
   3.616898865850004*^9, {3.616899006346858*^9, 3.616899014203475*^9}, {
   3.616899372300543*^9, 3.616899419840776*^9}, {3.6168994973109083`*^9, 
   3.6168996241616163`*^9}, {3.616899714530281*^9, 3.616899923617928*^9}, {
   3.616900170795429*^9, 3.6169002354925823`*^9}, {3.616900451781826*^9, 
   3.616900460325636*^9}, 3.616901431496728*^9, {3.616901658313428*^9, 
   3.6169016683010397`*^9}, 3.616901734905813*^9, 3.6169031265933*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ab", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "10"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FirstFreeIsAnEndSlotQ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}], 
   ",", "ab"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"LastFreeIsAnEndSlotQ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}], 
   ",", "ab"}], "]"}]}], "Input",
 CellChangeTimes->{{3.616901138607287*^9, 3.616901179988303*^9}, {
  3.616901223943274*^9, 3.616901292305622*^9}, {3.6169013651290083`*^9, 
  3.616901387239423*^9}, {3.616901715883314*^9, 3.616901719865809*^9}, {
  3.616903149693449*^9, 3.616903157788546*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6169031662601843`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6169031662670918`*^9}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------------------------------------------\
\>", "Text",
 CellChangeTimes->{3.616903834232893*^9}],

Cell["\<\
These rules are for taking a contracted vector inside a general bracket if it \
can bind to the first or last slot of one of the factors.\
\>", "Text",
 CellChangeTimes->{{3.616894905607896*^9, 3.6168949282962418`*^9}, {
   3.616894980008452*^9, 3.616895047753191*^9}, 3.6168956139307632`*^9, 
   3.6168959342356787`*^9}],

Cell["\<\
This re-calculates  ab  after dropping slot  { s }.   In the rules that \
follow,  s  will be either the first or last slot position that does not \
appear in  ab,\
\>", "Text",
 CellChangeTimes->{{3.6155335808676367`*^9, 3.6155336508044367`*^9}, {
   3.615699187474575*^9, 3.615699215203232*^9}, {3.6156992661635923`*^9, 
   3.61569930354322*^9}, 3.61569942482084*^9, {3.616898052834342*^9, 
   3.616898061666266*^9}, {3.6168981969788227`*^9, 3.616898211698948*^9}, {
   3.616898373107606*^9, 3.616898414691477*^9}, 3.616898521252139*^9, {
   3.6538797001197157`*^9, 3.653879748759037*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"abDrop", "[", 
   RowBox[{"ab_List", ",", "s_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "f", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"f", ":=", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{"#", ">", "s"}], "]"}], ",", 
         RowBox[{"#", "-", "1"}], ",", "#"}], "]"}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Apply", "[", 
      RowBox[{"Sequence", ",", 
       RowBox[{"Map", "[", 
        RowBox[{"f", ",", "ab", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615519182220378*^9, 3.61551920558062*^9}, {
   3.615519253102808*^9, 3.615519294222681*^9}, {3.615519357855008*^9, 
   3.615519473367627*^9}, {3.6155197407871513`*^9, 3.6155198223410892`*^9}, {
   3.6155198739892263`*^9, 3.6155199943436947`*^9}, {3.615520165224642*^9, 
   3.61552026676221*^9}, {3.615521339089737*^9, 3.615521349217729*^9}, {
   3.615528963656398*^9, 3.615528979320806*^9}, {3.615529520217683*^9, 
   3.615529549417317*^9}, {3.615529759865176*^9, 3.615529780123232*^9}, {
   3.615529821738859*^9, 3.615529830437214*^9}, 3.6155299059635553`*^9, 
   3.615530024731254*^9, {3.615530066347973*^9, 3.615530066679414*^9}, {
   3.615530150651466*^9, 3.615530157343408*^9}, 3.615530330458902*^9, {
   3.615530362455016*^9, 3.615530382090383*^9}, {3.6155327751039877`*^9, 
   3.615532804543454*^9}, {3.6168980755510483`*^9, 3.616898102303018*^9}, {
   3.6168981357903337`*^9, 3.616898142381942*^9}, {3.616898176814864*^9, 
   3.616898182637198*^9}, {3.6538798333842783`*^9, 3.653879838760426*^9}, 
   3.653880295379059*^9}],

Cell["\<\
Range[ ]  can only be used with integer arguments, hence the integer degree \
tests in the following code,\
\>", "Text",
 CellChangeTimes->{{3.653876589900565*^9, 3.653876611516387*^9}, {
  3.653876672827611*^9, 3.653876687835346*^9}, {3.65387673716264*^9, 
  3.6538767679145412`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Range", "[", 
  RowBox[{"1", ",", "n"}], "]"}]], "Input",
 CellChangeTimes->{{3.653876690897832*^9, 3.653876717244937*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Range", "::", "range"}], "MessageName"], ":", 
  " ", "\<\"Range specification in \[NoBreak]\\!\\(Range[\\(\\(1, n\\)\\)]\\)\
\[NoBreak] does not have appropriate bounds. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Range/range\\\", ButtonNote -> \
\\\"Range::range\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.6538766968065653`*^9, 3.653876717585565*^9}}],

Cell[BoxData[
 RowBox[{"Range", "[", 
  RowBox[{"1", ",", "n"}], "]"}]], "Output",
 CellChangeTimes->{{3.653876696811569*^9, 3.653876717590567*^9}}]
}, Open  ]],

Cell["\<\
.... this is why we test for integer degree in the following code.\
\>", "Text",
 CellChangeTimes->{{3.653876589900565*^9, 3.653876611516387*^9}, {
  3.653876672827611*^9, 3.653876687835346*^9}, {3.65387673716264*^9, 
  3.6538767679145412`*^9}, {3.653879791814538*^9, 3.6538798173501472`*^9}}],

Cell["v  binds with the first slot of  factor X : ", "Text",
 CellChangeTimes->{{3.6168956223464193`*^9, 3.6168956479145727`*^9}, 
   3.616895937595194*^9, {3.616903880787915*^9, 3.616903902323605*^9}, {
   3.653876498957762*^9, 3.653876500685711*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"Y1___", "\[CircleTimes]", "X_", "\[CircleTimes]", "Y2___"}], 
        "\[RightAngleBracket]"}], "ab__List"], ",", 
      RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{
     RowBox[{"IntegerQ", "[", 
      RowBox[{
       RowBox[{"deg", "[", "X", "]"}], "+", 
       RowBox[{"deg", "[", "Y2", "]"}]}], "]"}], "&&", "\[IndentingNewLine]", 
     
     RowBox[{"!", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", "ab", "}"}], ",", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], "&&", " ", 
     RowBox[{"SubsetQ", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "ab", "}"}], "]"}], ",", 
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", 
        RowBox[{"Range", "[", 
         RowBox[{"2", ",", 
          RowBox[{
           RowBox[{"deg", "[", "X", "]"}], "+", 
           RowBox[{"deg", "[", "Y2", "]"}]}]}], "]"}]}]}], "]"}]}]}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1", "\[CircleTimes]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"v", ",", "X"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
      "Y2"}], "\[RightAngleBracket]"}], 
    RowBox[{"abDrop", "[", 
     RowBox[{
      RowBox[{"{", "ab", "}"}], ",", 
      RowBox[{
       RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}]}], "]"}]]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.616895062947616*^9, 3.616895136098083*^9}, {
   3.616895180098284*^9, 3.6168952296344547`*^9}, {3.616895262194017*^9, 
   3.616895398868985*^9}, {3.616895528484123*^9, 3.616895591495892*^9}, {
   3.616895729831025*^9, 3.61689574247136*^9}, {3.6168958373830433`*^9, 
   3.6168958492341757`*^9}, {3.6168958792726088`*^9, 3.616895918999423*^9}, 
   3.6168960650637417`*^9, {3.616896450241495*^9, 3.6168964623135653`*^9}, {
   3.616896521705714*^9, 3.616896578719427*^9}, {3.616904030404706*^9, 
   3.616904065765068*^9}, {3.653876801712459*^9, 3.653876820624672*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "104", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"v_", "?", "deg1Q"}], ",", 
      SubscriptBox[
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"Y1___", "\[CircleTimes]", "X_", "\[CircleTimes]", "Y2___"}], 
        "\[RightAngleBracket]"}], "ab__List"]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{
     RowBox[{"IntegerQ", "[", 
      RowBox[{"deg", "[", "Y1", "]"}], "]"}], "&&", "\[IndentingNewLine]", 
     RowBox[{"!", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", "ab", "}"}], ",", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], "&&", " ", 
     RowBox[{"SubsetQ", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "ab", "}"}], "]"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", 
         RowBox[{"deg", "[", "Y1", "]"}]}], "]"}]}], "]"}]}]}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1", "\[CircleTimes]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"v", ",", "X"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
      "Y2"}], "\[RightAngleBracket]"}], 
    RowBox[{"abDrop", "[", 
     RowBox[{
      RowBox[{"{", "ab", "}"}], ",", 
      RowBox[{
       RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}]}], "]"}]]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.616895978423337*^9, 3.616895984663505*^9}, {
  3.616896032390932*^9, 3.6168960684068317`*^9}, {3.616896607094696*^9, 
  3.616896616028757*^9}, {3.616904070788549*^9, 3.616904096435388*^9}, {
  3.65387689455086*^9, 3.653876910463204*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "105", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
v  binds with the last slot of factor  X  if all the slots of  Y2  have been \
contracted out,\
\>", "Text",
 CellChangeTimes->{{3.6168956223464193`*^9, 3.6168956479145727`*^9}, {
  3.616895761882759*^9, 3.616895764234784*^9}, {3.616895938859128*^9, 
  3.616895943547624*^9}, {3.616903917901835*^9, 3.616903918515471*^9}, {
  3.653875011584428*^9, 3.653875062127749*^9}, {3.653876263632681*^9, 
  3.653876263920537*^9}, {3.6538765049576817`*^9, 3.653876516861691*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"Y1___", "\[CircleTimes]", "X_", "\[CircleTimes]", "Y2___"}], 
        "\[RightAngleBracket]"}], "ab__List"], ",", 
      RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{
     RowBox[{"IntegerQ", "[", 
      RowBox[{"deg", "[", "Y2", "]"}], "]"}], "&&", "\[IndentingNewLine]", 
     RowBox[{"!", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", "ab", "}"}], ",", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], "+", 
         RowBox[{"deg", "[", "X", "]"}]}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], "&&", " ", 
     RowBox[{"SubsetQ", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "ab", "}"}], "]"}], ",", 
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", 
        RowBox[{"deg", "[", "X", "]"}], "+", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", 
          RowBox[{"deg", "[", "Y2", "]"}]}], "]"}]}]}], "]"}]}]}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1", "\[CircleTimes]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"X", ",", "v"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
      "Y2"}], "\[RightAngleBracket]"}], 
    RowBox[{"abDrop", "[", 
     RowBox[{
      RowBox[{"{", "ab", "}"}], ",", 
      RowBox[{
       RowBox[{"deg", "[", "Y1", "]"}], "+", 
       RowBox[{"deg", "[", "X", "]"}]}]}], "]"}]]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.616895062947616*^9, 3.616895136098083*^9}, {
   3.616895180098284*^9, 3.6168952296344547`*^9}, {3.616895262194017*^9, 
   3.616895398868985*^9}, {3.616895528484123*^9, 3.616895591495892*^9}, {
   3.616895729831025*^9, 3.61689574247136*^9}, {3.6168958373830433`*^9, 
   3.6168958492341757`*^9}, {3.6168958792726088`*^9, 3.616895918999423*^9}, 
   3.6168960650637417`*^9, {3.616896450241495*^9, 3.6168964623135653`*^9}, {
   3.616896521705714*^9, 3.616896578719427*^9}, {3.616896724228821*^9, 
   3.616896726987548*^9}, {3.616896805868938*^9, 3.616896823180879*^9}, {
   3.616896901180985*^9, 3.616896904061495*^9}, {3.6169041083731728`*^9, 
   3.6169041396211987`*^9}, {3.616904693289439*^9, 3.616904746776326*^9}, 
   3.65387512088629*^9, 3.653876236970559*^9, {3.653876425157769*^9, 
   3.653876427957546*^9}, {3.653876930413479*^9, 3.653876935092175*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "106", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
v  binds with the last slot of factor  X  if all the other slots of   X  and \
all the slots of  Y1  have been contracted out,\
\>", "Text",
 CellChangeTimes->{{3.6168956223464193`*^9, 3.6168956479145727`*^9}, {
  3.616895761882759*^9, 3.616895764234784*^9}, {3.616895938859128*^9, 
  3.616895943547624*^9}, {3.616903917901835*^9, 3.616903918515471*^9}, {
  3.653875011584428*^9, 3.653875062127749*^9}, {3.653876263632681*^9, 
  3.65387629777623*^9}, {3.653876360543618*^9, 3.653876386031039*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"v_", "?", "deg1Q"}], ",", 
      SubscriptBox[
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"Y1___", "\[CircleTimes]", "X_", "\[CircleTimes]", "Y2___"}], 
        "\[RightAngleBracket]"}], "ab__List"]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{
     RowBox[{"IntegerQ", "[", 
      RowBox[{
       RowBox[{"deg", "[", "Y1", "]"}], "+", 
       RowBox[{"deg", "[", "X", "]"}]}], "]"}], "&&", "\[IndentingNewLine]", 
     RowBox[{"!", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", "ab", "}"}], ",", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], "+", 
         RowBox[{"deg", "[", "X", "]"}]}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], "&&", " ", 
     RowBox[{"SubsetQ", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"{", "ab", "}"}], "]"}], ",", 
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", 
          RowBox[{"deg", "[", "X", "]"}], "-", "1"}]}], "]"}]}], "]"}]}]}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1", "\[CircleTimes]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"X", ",", "v"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
      "Y2"}], "\[RightAngleBracket]"}], 
    RowBox[{"abDrop", "[", 
     RowBox[{
      RowBox[{"{", "ab", "}"}], ",", 
      RowBox[{
       RowBox[{"deg", "[", "Y1", "]"}], "+", 
       RowBox[{"deg", "[", "X", "]"}]}]}], "]"}]]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.616895978423337*^9, 3.616895984663505*^9}, {
   3.616896032390932*^9, 3.6168960684068317`*^9}, {3.616896607094696*^9, 
   3.616896616028757*^9}, {3.6168967312612886`*^9, 3.616896734560685*^9}, {
   3.616896877727727*^9, 3.616896909260955*^9}, {3.616904144116341*^9, 
   3.6169041556754436`*^9}, 3.616904759064073*^9, 3.653875316342125*^9, 
   3.6538762416582813`*^9, {3.65387640984558*^9, 3.653876422072204*^9}, {
   3.653876949126606*^9, 3.6538769618270884`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "107", "]"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Testing  --- Taking  v inside ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "  ", "\[RightAngleBracket]"}], "ab"], 
   TraditionalForm]]]
}], "Subsubsection",
 CellChangeTimes->{{3.615582144991081*^9, 3.615582163791741*^9}, {
   3.616896933902717*^9, 3.616896973166916*^9}, 3.61690862986374*^9}],

Cell["\<\
These were fairly well tested by code for dipole radiation at infty.\
\>", "Text",
 CellChangeTimes->{{3.616908558503271*^9, 3.616908593175519*^9}}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4", ",", "a5", ",", "v"}], 
   "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ClearField", "[", 
  RowBox[{"{", "Y", "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{"1", ",", "v"}], "]"}], ";", " ", 
  RowBox[{"NewField", "[", 
   RowBox[{"2", ",", " ", 
    RowBox[{"{", 
     RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4", ",", "a5"}], "}"}]}], 
   "]"}], ";", " ", 
  RowBox[{"NewField", "[", 
   RowBox[{"4", ",", "Y"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.61689698836686*^9, 3.616897039914528*^9}, {
  3.616904271470162*^9, 3.616904296142234*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
     "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", "\[CircleTimes]", 
      "a4", "\[CircleTimes]", "a5"}], "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "7"}], "}"}]}]]}], "\[RightAngleBracket]"}]], "Input",\

 CellChangeTimes->{{3.616897045322627*^9, 3.61689711829457*^9}}],

Cell[BoxData[
 RowBox[{"a3", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"v", ",", 
    RowBox[{"rev", "[", "a2", "]"}], ",", "a1", ",", "a4"}], 
   "\[RightAngleBracket]"}], "\[CircleTimes]", "a5"}]], "Output",
 CellChangeTimes->{
  3.616897126869886*^9, 3.616897645131618*^9, {3.616904169954232*^9, 
   3.616904191144313*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
     "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", "\[CircleTimes]", 
      "a4", "\[CircleTimes]", "a5"}], "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "6"}], "}"}]]}], "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{{3.616897330295001*^9, 3.616897338486299*^9}}],

Cell[BoxData[
 RowBox[{"a2", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a3", ",", "a1", ",", "v"}], "\[RightAngleBracket]"}], 
  "\[CircleTimes]", "a4", "\[CircleTimes]", "a5"}]], "Output",
 CellChangeTimes->{3.616897339699678*^9, 3.61689765384265*^9, 
  3.616903957235754*^9, 3.616904199033395*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"a1", "\[CircleTimes]", "Y"}], "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"2", ",", "5"}], "}"}]]}], "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{
  3.616904260299369*^9, {3.616904306859563*^9, 3.616904321370616*^9}}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"Y", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"v", ",", "a1"}], "\[RightAngleBracket]"}]}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"3", ",", "5"}], "}"}]]], "Output",
 CellChangeTimes->{3.61690432528876*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"a1", "\[CircleTimes]", "Y"}], "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"2", ",", "6"}], "}"}]]}], "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{{3.616904585658841*^9, 3.6169045857711573`*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"Y", ",", 
   RowBox[{"rev", "[", "a1", "]"}], ",", "v"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.616904586365294*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"a1", "\[CircleTimes]", "Y"}], "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}]}]]}], "\[RightAngleBracket]"}]], "Input",\

 CellChangeTimes->{{3.6169046167027597`*^9, 3.616904632044937*^9}}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"v", ",", "Y"}], "\[RightAngleBracket]"}]}], 
   "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}]}]]], "Output",
 CellChangeTimes->{3.61690463473181*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing", "Subsubsection",
 CellChangeTimes->{{3.615582144991081*^9, 3.615582163791741*^9}}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"v", ",", "X", ",", "Y1", ",", "Y2", ",", "Y3"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{"1", ",", "v"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"2", ",", 
    RowBox[{"{", 
     RowBox[{"X", ",", "Y1", ",", "Y2", ",", "Y3"}], "}"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.615582210774118*^9, 3.615582283592564*^9}, {
  3.615582320584494*^9, 3.6155823217040663`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "Y1", "\[CircleTimes]", "v", "\[CircleTimes]", "Y2", "\[CircleTimes]", "X",
     "\[CircleTimes]", "Y3"}], "\[RightAngleBracket]"}], 
  RowBox[{"3", ",", "6"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "Y1", "\[CircleTimes]", "v", "\[CircleTimes]", "Y2", "\[CircleTimes]", "X",
     "\[CircleTimes]", "Y3"}], "\[RightAngleBracket]"}], 
  RowBox[{"3", ",", "7"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "Y1", "\[CircleTimes]", "X", "\[CircleTimes]", "Y2", "\[CircleTimes]", "v",
     "\[CircleTimes]", "Y3"}], "\[RightAngleBracket]"}], 
  RowBox[{"3", ",", "7"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "Y1", "\[CircleTimes]", "X", "\[CircleTimes]", "Y2", "\[CircleTimes]", "v",
     "\[CircleTimes]", "Y3"}], "\[RightAngleBracket]"}], 
  RowBox[{"4", ",", "7"}]]}], "Input",
 CellChangeTimes->{{3.615582329119014*^9, 3.6155823662450314`*^9}, {
  3.615583364870598*^9, 3.615583406074901*^9}}],

Cell[BoxData[
 RowBox[{"Y1", "\[CircleTimes]", "Y2", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"v", ",", "X"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
  "Y3"}]], "Output",
 CellChangeTimes->{
  3.615582369793273*^9, {3.6155833542452908`*^9, 3.6155833701585913`*^9}, 
   3.615583407376851*^9, 3.615602823315229*^9}],

Cell[BoxData[
 RowBox[{"Y1", "\[CircleTimes]", "Y2", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"X", ",", "v"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
  "Y3"}]], "Output",
 CellChangeTimes->{
  3.615582369793273*^9, {3.6155833542452908`*^9, 3.6155833701585913`*^9}, 
   3.615583407376851*^9, 3.615602823317256*^9}],

Cell[BoxData[
 RowBox[{"Y1", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"v", ",", "X"}], "\[RightAngleBracket]"}], "\[CircleTimes]", "Y2", 
  "\[CircleTimes]", "Y3"}]], "Output",
 CellChangeTimes->{
  3.615582369793273*^9, {3.6155833542452908`*^9, 3.6155833701585913`*^9}, 
   3.615583407376851*^9, 3.615602823319055*^9}],

Cell[BoxData[
 RowBox[{"Y1", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"X", ",", "v"}], "\[RightAngleBracket]"}], "\[CircleTimes]", "Y2", 
  "\[CircleTimes]", "Y3"}]], "Output",
 CellChangeTimes->{
  3.615582369793273*^9, {3.6155833542452908`*^9, 3.6155833701585913`*^9}, 
   3.615583407376851*^9, 3.615602823320609*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "Y1", "\[CircleTimes]", "v", "\[CircleTimes]", "Y2", "\[CircleTimes]", "X",
     "\[CircleTimes]", "Y3"}], "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "4", ",", "3", ",", "6"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "Y1", "\[CircleTimes]", "v", "\[CircleTimes]", "Y2", "\[CircleTimes]", "X",
     "\[CircleTimes]", "Y3"}], "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "4", ",", "3", ",", "7"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "Y1", "\[CircleTimes]", "X", "\[CircleTimes]", "Y2", "\[CircleTimes]", "v",
     "\[CircleTimes]", "Y3"}], "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "5", ",", "3", ",", "7"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "Y1", "\[CircleTimes]", "X", "\[CircleTimes]", "Y2", "\[CircleTimes]", "v",
     "\[CircleTimes]", "Y3"}], "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "5", ",", "4", ",", "7"}]]}], "Input",
 CellChangeTimes->{{3.615583479896994*^9, 3.615583512524685*^9}, {
  3.615583606289002*^9, 3.615583636778303*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"Y1", ",", "Y2"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"v", ",", "X"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
  "Y3"}]], "Output",
 CellChangeTimes->{3.6155835152380533`*^9, 3.6155836380699244`*^9, 
  3.615584014496479*^9, 3.6156045001956673`*^9, 3.615604530808831*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"Y1", ",", "Y2"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"X", ",", "v"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
  "Y3"}]], "Output",
 CellChangeTimes->{3.6155835152380533`*^9, 3.6155836380699244`*^9, 
  3.615584014496479*^9, 3.6156045001956673`*^9, 3.615604530811241*^9}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"Y1", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"v", ",", "X"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
    "Y2", "\[CircleTimes]", "Y3"}], "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"2", ",", "4"}], "}"}]]], "Output",
 CellChangeTimes->{3.6155835152380533`*^9, 3.6155836380699244`*^9, 
  3.615584014496479*^9, 3.6156045001956673`*^9, 3.6156045308132277`*^9}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"Y1", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X", ",", "v"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
    "Y2", "\[CircleTimes]", "Y3"}], "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"2", ",", "4"}], "}"}]]], "Output",
 CellChangeTimes->{3.6155835152380533`*^9, 3.6155836380699244`*^9, 
  3.615584014496479*^9, 3.6156045001956673`*^9, 3.6156045308152437`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Contraction between two deg 2 tensors with no other tensor\[CloseCurlyQuote]s \
free slots between them  \
\>", "Subsubsection",
 CellChangeTimes->{{3.615536993163718*^9, 3.615537067275907*^9}, {
   3.6155375790852137`*^9, 3.615537580173667*^9}, 3.615605142051715*^9, {
   3.616888659911993*^9, 3.6168887109520807`*^9}, {3.6168887484242563`*^9, 
   3.6168888099764557`*^9}, {3.6168915109428673`*^9, 3.616891512109952*^9}, 
   3.6555742669608097`*^9}],

Cell["\<\
13/8/2014.   This should only be done to sort the factors in a  2-chain, \
terminated 2-chain (deg 1), or closed 2-chain (deg 0). \
\>", "Text",
 CellChangeTimes->{{3.616891521389915*^9, 3.616891647617346*^9}}],

Cell["\<\
If there are no other tensor\[CloseCurlyQuote]s free slots between X1 and X2, \
then we can put X2 next to X1 and use a comma contraction.\
\>", "Text",
 CellChangeTimes->{{3.615537595564871*^9, 3.615537661181965*^9}, {
  3.6155769695924807`*^9, 3.615576969912431*^9}}],

Cell["\<\
abMoveQ[ ]   returns  True  if   ab  specifies a contraction on slot  x1 of  \
X1  and  x2 of  X2   (thus  x1, x2 = 1 or 2),  \
\>", "Text",
 CellChangeTimes->{{3.615575843270549*^9, 3.6155761551275578`*^9}, {
  3.6155762265679417`*^9, 3.615576274871828*^9}, {3.61557694824921*^9, 
  3.615576980488793*^9}, {3.615577655866419*^9, 3.6155777095304527`*^9}, {
  3.615578398586855*^9, 3.615578401503306*^9}, {3.616566139117343*^9, 
  3.616566140989314*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"abMoveQ", "[", 
   RowBox[{"ab_List", ",", 
    RowBox[{"{", 
     RowBox[{"degY1_Integer", ",", "degY2_Integer"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x1_", ",", "x2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"MemberQ", "[", 
    RowBox[{"ab", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "+", "degY1"}], ",", 
       RowBox[{"x2", "+", "degY1", "+", "degY2", "+", "2"}]}], "}"}]}], "]"}],
    "&&", 
   RowBox[{"SubsetQ", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", "ab", "]"}], ",", 
     RowBox[{"Range", "[", 
      RowBox[{
       RowBox[{"degY1", "+", "3"}], ",", 
       RowBox[{"degY1", "+", "degY2", "+", "2"}]}], "]"}]}], 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6155774704675283`*^9, 3.615577634613413*^9}, {
   3.615577952773876*^9, 3.6155779744533987`*^9}, {3.6155784045829573`*^9, 
   3.615578411083235*^9}, {3.615602966310655*^9, 3.615602989992426*^9}, 
   3.615603060542102*^9}],

Cell["\<\
The contraction is on slot  x1 of  X1  and  x2 of  X2  (thus  x1, x2 = 1 or 2).
{s1, s2}  is the slot pair to be deleted,\
\>", "Text",
 CellChangeTimes->{{3.615570866461088*^9, 3.615570884397743*^9}, {
  3.615572641712838*^9, 3.6155726556010523`*^9}, {3.6155780873383417`*^9, 
  3.615578142970558*^9}, {3.615578198842772*^9, 3.615578221643342*^9}, {
  3.61557831901873*^9, 3.615578324347115*^9}, {3.6155783650987997`*^9, 
  3.6155783668317833`*^9}, {3.615578434235054*^9, 3.615578450539543*^9}, {
  3.615579455644614*^9, 3.615579457436515*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"abMove", "[", 
   RowBox[{"ab_List", ",", 
    RowBox[{"{", 
     RowBox[{"degY1_", ",", "degY2_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x1_", ",", "x2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"f", ",", "s1", ",", "s2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s1", "=", 
      RowBox[{"degY1", "+", "x1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"s2", "=", 
      RowBox[{"degY1", "+", "degY2", "+", "2", " ", "+", " ", "x2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f", ":=", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"#", ">", 
          RowBox[{"degY1", "+", "degY2", "+", "4"}]}], ",", 
         RowBox[{"#", "-", "2"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"#", ">", 
            RowBox[{"degY1", "+", "degY2", "+", "2"}]}], ",", 
           RowBox[{"degY1", "+", "2"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#", ">", 
              RowBox[{"degY1", "+", "2"}]}], ",", "#", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#", ">", "degY1"}], ",", 
               RowBox[{"degY1", "+", "1"}], ",", "#"}], "]"}]}], "]"}]}], 
          "]"}]}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Apply", "[", 
      RowBox[{"Sequence", ",", 
       RowBox[{"Map", "[", 
        RowBox[{"f", ",", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"ab", ",", 
           RowBox[{"{", 
            RowBox[{"s1", ",", "s2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615519182220378*^9, 3.61551920558062*^9}, {
   3.615519253102808*^9, 3.615519294222681*^9}, {3.615519357855008*^9, 
   3.615519473367627*^9}, {3.6155197407871513`*^9, 3.6155198223410892`*^9}, {
   3.6155198739892263`*^9, 3.6155199943436947`*^9}, {3.615520165224642*^9, 
   3.61552026676221*^9}, {3.615521339089737*^9, 3.615521349217729*^9}, {
   3.615528963656398*^9, 3.615528979320806*^9}, {3.615529520217683*^9, 
   3.615529549417317*^9}, {3.615529759865176*^9, 3.615529780123232*^9}, {
   3.615529821738859*^9, 3.615529830437214*^9}, 3.6155299059635553`*^9, 
   3.615530024731254*^9, {3.615530066347973*^9, 3.615530066679414*^9}, {
   3.615530150651466*^9, 3.615530157343408*^9}, 3.615530330458902*^9, {
   3.615530362455016*^9, 3.615530382090383*^9}, {3.6155327751039877`*^9, 
   3.615532804543454*^9}, {3.615570578809185*^9, 3.615570766702879*^9}, {
   3.6155708269891853`*^9, 3.6155708547070503`*^9}, {3.615570905342461*^9, 
   3.61557092471633*^9}, {3.6155709808594837`*^9, 3.615571006636327*^9}, {
   3.615571124668914*^9, 3.615571170461274*^9}, {3.615571260093627*^9, 
   3.6155712601574793`*^9}, {3.61557136995012*^9, 3.615571370254676*^9}, {
   3.615573210593109*^9, 3.615573251494234*^9}, {3.615578060059348*^9, 
   3.615578070043447*^9}, 3.615578154090074*^9, {3.61557824266718*^9, 
   3.61557827001112*^9}, {3.615578330859064*^9, 3.615578358443585*^9}, {
   3.615578428603037*^9, 3.615578489223192*^9}, {3.61557861871784*^9, 
   3.615578628032157*^9}, {3.615578666220907*^9, 3.615578666750017*^9}, {
   3.615578880525299*^9, 3.6155790003981953`*^9}, {3.6155790681746798`*^9, 
   3.61557911147124*^9}, {3.6155793539974537`*^9, 3.6155793628772097`*^9}}],

Cell["\<\

These rules are for when there are also other contractions, so the result is \
still a subscript contraction.\
\>", "Text",
 CellChangeTimes->{{3.6155243984774723`*^9, 3.615524448141636*^9}, {
  3.615524817166747*^9, 3.615524817983055*^9}, {3.6155258853613777`*^9, 
  3.615525986674035*^9}, {3.61552627089847*^9, 3.6155263275063457`*^9}, {
  3.615526395298663*^9, 3.6155264066591997`*^9}, {3.6155287682968807`*^9, 
  3.615528847769367*^9}, {3.615528902825807*^9, 3.6155289058652554`*^9}, {
  3.6155325999859133`*^9, 3.615532605506342*^9}, {3.615534648663823*^9, 
  3.615534652886158*^9}, {3.6155824991055183`*^9, 3.615582555311795*^9}, {
  3.615603445294034*^9, 3.6156034655341873`*^9}}],

Cell["Case 1.  Contraction on slot 1 of  X1 and slot 1 of  X2,   ", "Text",
 CellChangeTimes->{{3.615537791133367*^9, 3.615537835298162*^9}, {
  3.615572687200982*^9, 3.6155726935372133`*^9}, {3.615577836922209*^9, 
  3.615577868506701*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1___", "\[CircleTimes]", 
       RowBox[{"X1_", "?", "deg2Q"}], "\[CircleTimes]", "Y2___", 
       "\[CircleTimes]", 
       RowBox[{"X2_", "?", "deg2Q"}], "\[CircleTimes]", "Y3___"}], 
      "\[RightAngleBracket]"}], "ab__List"], "/;", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"{", "ab", "}"}], "]"}], ">", "1"}], "&&", 
     RowBox[{"abMoveQ", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], ",", 
         RowBox[{"deg", "[", "Y2", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}]}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1", "\[CircleTimes]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
        RowBox[{"rev", "[", "X1", "]"}], ",", "X2"}], 
       "\[RightAngleBracket]"}], "\[CircleTimes]", "Y2", "\[CircleTimes]", 
      "Y3"}], "\[RightAngleBracket]"}], 
    RowBox[{"abMove", "[", 
     RowBox[{
      RowBox[{"{", "ab", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], ",", 
        RowBox[{"deg", "[", "Y2", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "]"}]]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615537086389353*^9, 3.61553717891571*^9}, {
   3.6155372403552713`*^9, 3.615537374981909*^9}, {3.615537411704688*^9, 
   3.615537496427437*^9}, {3.615537691756116*^9, 3.615537693468109*^9}, {
   3.615537845788074*^9, 3.615537897101246*^9}, {3.6155379381581573`*^9, 
   3.6155379962073917`*^9}, 3.6155381614554653`*^9, {3.615538242623954*^9, 
   3.615538246948532*^9}, {3.615538369456678*^9, 3.615538406015028*^9}, {
   3.615573376386232*^9, 3.61557338923564*^9}, {3.6155734237631197`*^9, 
   3.615573437588418*^9}, {3.615574249097747*^9, 3.615574251672333*^9}, 
   3.6155770355748663`*^9, {3.615577739509665*^9, 3.615577774008832*^9}, 
   3.615577931176399*^9, {3.6155794179722548`*^9, 3.615579427499948*^9}, 
   3.615603044769508*^9, {3.615603245390646*^9, 3.615603246892798*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "108", "]"}]], "Output"]
}, Open  ]],

Cell["Case 2.  Contraction on slot 1 of  X1 and slot 2 of  X2,   ", "Text",
 CellChangeTimes->{{3.615537791133367*^9, 3.615537835298162*^9}, {
  3.6155714437103157`*^9, 3.615571444814664*^9}, {3.615572697383553*^9, 
  3.615572707920794*^9}, {3.615577846634037*^9, 3.615577877946698*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1___", "\[CircleTimes]", 
       RowBox[{"X1_", "?", "deg2Q"}], "\[CircleTimes]", "Y2___", 
       "\[CircleTimes]", 
       RowBox[{"X2_", "?", "deg2Q"}], "\[CircleTimes]", "Y3___"}], 
      "\[RightAngleBracket]"}], "ab__List"], "/;", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"{", "ab", "}"}], "]"}], ">", "1"}], "&&", 
     RowBox[{"abMoveQ", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], ",", 
         RowBox[{"deg", "[", "Y2", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], "]"}]}]}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1", "\[CircleTimes]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
        RowBox[{"rev", "[", "X1", "]"}], ",", 
        RowBox[{"rev", "[", "X2", "]"}]}], "\[RightAngleBracket]"}], 
      "\[CircleTimes]", "Y2", "\[CircleTimes]", "Y3"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"abMove", "[", 
     RowBox[{
      RowBox[{"{", "ab", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], ",", 
        RowBox[{"deg", "[", "Y2", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], "]"}]]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615537086389353*^9, 3.61553717891571*^9}, {
   3.6155372403552713`*^9, 3.615537374981909*^9}, {3.615537411704688*^9, 
   3.615537496427437*^9}, {3.615537691756116*^9, 3.615537693468109*^9}, {
   3.615537845788074*^9, 3.615537897101246*^9}, {3.6155379381581573`*^9, 
   3.6155379962073917`*^9}, 3.6155381614554653`*^9, {3.615538242623954*^9, 
   3.615538246948532*^9}, {3.615538369456678*^9, 3.615538406015028*^9}, {
   3.615571436704052*^9, 3.6155714671039257`*^9}, {3.615573406185526*^9, 
   3.615573438979566*^9}, {3.615574234968904*^9, 3.615574243528016*^9}, 
   3.6155770405031033`*^9, 3.6155777933616962`*^9, {3.61557788194587*^9, 
   3.615577882057063*^9}, 3.615577932406896*^9, {3.615579409883757*^9, 
   3.61557942980411*^9}, 3.615603048420532*^9, {3.615603241679862*^9, 
   3.615603243021634*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "109", "]"}]], "Output"]
}, Open  ]],

Cell["Case 3.  Contraction on slot 2 of  X1 and slot 1 of  X2,   ", "Text",
 CellChangeTimes->{{3.615537791133367*^9, 3.615537835298162*^9}, {
  3.6155714437103157`*^9, 3.615571444814664*^9}, {3.615571690478923*^9, 
  3.615571699263332*^9}, {3.615572699149734*^9, 3.615572710229374*^9}, {
  3.6155778900901613`*^9, 3.615577899930686*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1___", "\[CircleTimes]", 
       RowBox[{"X1_", "?", "deg2Q"}], "\[CircleTimes]", "Y2___", 
       "\[CircleTimes]", 
       RowBox[{"X2_", "?", "deg2Q"}], "\[CircleTimes]", "Y3___"}], 
      "\[RightAngleBracket]"}], "ab__List"], "/;", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"{", "ab", "}"}], "]"}], ">", "1"}], "&&", 
     RowBox[{"abMoveQ", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], ",", 
         RowBox[{"deg", "[", "Y2", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}]}], "]"}]}]}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1", "\[CircleTimes]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"X1", ",", "X2"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
      "Y2", "\[CircleTimes]", "Y3"}], "\[RightAngleBracket]"}], 
    RowBox[{"abMove", "[", 
     RowBox[{
      RowBox[{"{", "ab", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], ",", 
        RowBox[{"deg", "[", "Y2", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}]}], "]"}]]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615537086389353*^9, 3.61553717891571*^9}, {
   3.6155372403552713`*^9, 3.615537374981909*^9}, {3.615537411704688*^9, 
   3.615537496427437*^9}, {3.615537691756116*^9, 3.615537693468109*^9}, {
   3.615537845788074*^9, 3.615537897101246*^9}, {3.6155379381581573`*^9, 
   3.6155379962073917`*^9}, 3.6155381614554653`*^9, {3.615538242623954*^9, 
   3.615538246948532*^9}, {3.615538369456678*^9, 3.615538406015028*^9}, {
   3.615571436704052*^9, 3.6155714671039257`*^9}, {3.6155717130074577`*^9, 
   3.6155717317594624`*^9}, {3.615573409189803*^9, 3.615573462580299*^9}, 
   3.615573511920869*^9, {3.6155736178118773`*^9, 3.6155736309131527`*^9}, {
   3.61557382934864*^9, 3.615573831921494*^9}, {3.615574223285582*^9, 
   3.615574226967251*^9}, {3.615577045062446*^9, 3.615577049076708*^9}, 
   3.615577794901958*^9, {3.615577904360694*^9, 3.61557793341676*^9}, {
   3.615579400406352*^9, 3.6155794322675447`*^9}, 3.615603049806944*^9, {
   3.6156032370384502`*^9, 3.6156032386694603`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "110", "]"}]], "Output"]
}, Open  ]],

Cell["Case 4.  Contraction on slot 2 of  X1 and slot 2 of  X2,   ", "Text",
 CellChangeTimes->{{3.615537791133367*^9, 3.615537835298162*^9}, {
  3.6155714437103157`*^9, 3.615571444814664*^9}, {3.615571690478923*^9, 
  3.615571699263332*^9}, {3.615572699149734*^9, 3.615572710229374*^9}, {
  3.615572978545272*^9, 3.615572988833729*^9}, {3.615577910986082*^9, 
  3.6155779182345457`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1___", "\[CircleTimes]", 
       RowBox[{"X1_", "?", "deg2Q"}], "\[CircleTimes]", "Y2___", 
       "\[CircleTimes]", 
       RowBox[{"X2_", "?", "deg2Q"}], "\[CircleTimes]", "Y3___"}], 
      "\[RightAngleBracket]"}], "ab__List"], "/;", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"{", "ab", "}"}], "]"}], ">", "1"}], "&&", 
     RowBox[{"abMoveQ", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], ",", 
         RowBox[{"deg", "[", "Y2", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}]}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1", "\[CircleTimes]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"X1", ",", 
        RowBox[{"rev", "[", "X2", "]"}]}], "\[RightAngleBracket]"}], 
      "\[CircleTimes]", "Y2", "\[CircleTimes]", "Y3"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"abMove", "[", 
     RowBox[{
      RowBox[{"{", "ab", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], ",", 
        RowBox[{"deg", "[", "Y2", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}]}], "]"}]]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615537086389353*^9, 3.61553717891571*^9}, {
   3.6155372403552713`*^9, 3.615537374981909*^9}, {3.615537411704688*^9, 
   3.615537496427437*^9}, {3.615537691756116*^9, 3.615537693468109*^9}, {
   3.615537845788074*^9, 3.615537897101246*^9}, {3.6155379381581573`*^9, 
   3.6155379962073917`*^9}, 3.6155381614554653`*^9, {3.615538242623954*^9, 
   3.615538246948532*^9}, {3.615538369456678*^9, 3.615538406015028*^9}, {
   3.615571436704052*^9, 3.6155714671039257`*^9}, {3.6155717130074577`*^9, 
   3.6155717317594624`*^9}, {3.615572998688723*^9, 3.615573028615266*^9}, {
   3.615573411133355*^9, 3.615573434087677*^9}, 3.615573824783452*^9, {
   3.61557420397646*^9, 3.6155742099751463`*^9}, {3.6155769235096083`*^9, 
   3.6155769359583406`*^9}, {3.6155770557988243`*^9, 3.615577137272916*^9}, {
   3.61557779765939*^9, 3.615577803145214*^9}, {3.61557792119309*^9, 
   3.6155779346652327`*^9}, {3.615579375115098*^9, 3.615579391339032*^9}, 
   3.61560305122241*^9, {3.615603232190814*^9, 3.6156032340293493`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "111", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
These rules are for when there is just the one contraction, so the result has \
no subscript contractions left.
Since there is only the 1 contraction there can not be any contracted slots \
between X1,X2,  so we can drop Y2.\
\>", "Text",
 CellChangeTimes->{{3.6155243984774723`*^9, 3.615524448141636*^9}, {
  3.615524817166747*^9, 3.615524817983055*^9}, {3.6155258853613777`*^9, 
  3.615525986674035*^9}, {3.61552627089847*^9, 3.6155263275063457`*^9}, {
  3.615526395298663*^9, 3.6155264066591997`*^9}, {3.6155287682968807`*^9, 
  3.615528847769367*^9}, {3.615528902825807*^9, 3.6155289058652554`*^9}, {
  3.6155325999859133`*^9, 3.615532605506342*^9}, {3.615534648663823*^9, 
  3.615534652886158*^9}, {3.6155824991055183`*^9, 3.615582605520604*^9}, {
  3.615583017249886*^9, 3.615583022626708*^9}, {3.615603495214323*^9, 
  3.61560350019028*^9}, {3.6156037703990993`*^9, 3.615603814751239*^9}, {
  3.615603887295515*^9, 3.615603890879628*^9}, {3.615603952351837*^9, 
  3.61560404696005*^9}}],

Cell["Case 1.  Contraction on slot 1 of  X1 and slot 1 of  X2,   ", "Text",
 CellChangeTimes->{{3.615537791133367*^9, 3.615537835298162*^9}, {
  3.615572687200982*^9, 3.6155726935372133`*^9}, {3.615577836922209*^9, 
  3.615577868506701*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1___", "\[CircleTimes]", 
       RowBox[{"X1_", "?", "deg2Q"}], "\[CircleTimes]", 
       RowBox[{"X2_", "?", "deg2Q"}], "\[CircleTimes]", "Y3___"}], 
      "\[RightAngleBracket]"}], "ab_List"], "/;", 
    RowBox[{"ab", "===", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", 
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", "3"}]}], "}"}]}]}], ":=", 
   RowBox[{"Y1", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"rev", "[", "X1", "]"}], ",", "X2"}], "\[RightAngleBracket]"}], 
    "\[CircleTimes]", "Y3"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615537086389353*^9, 3.61553717891571*^9}, {
   3.6155372403552713`*^9, 3.615537374981909*^9}, {3.615537411704688*^9, 
   3.615537496427437*^9}, {3.615537691756116*^9, 3.615537693468109*^9}, {
   3.615537845788074*^9, 3.615537897101246*^9}, {3.6155379381581573`*^9, 
   3.6155379962073917`*^9}, 3.6155381614554653`*^9, {3.615538242623954*^9, 
   3.615538246948532*^9}, {3.615538369456678*^9, 3.615538406015028*^9}, {
   3.615573376386232*^9, 3.61557338923564*^9}, {3.6155734237631197`*^9, 
   3.615573437588418*^9}, {3.615574249097747*^9, 3.615574251672333*^9}, 
   3.6155770355748663`*^9, {3.615577739509665*^9, 3.615577774008832*^9}, 
   3.615577931176399*^9, {3.6155794179722548`*^9, 3.615579427499948*^9}, 
   3.615603044769508*^9, {3.615603245390646*^9, 3.615603246892798*^9}, {
   3.615603520701563*^9, 3.615603540604623*^9}, {3.6156040631668863`*^9, 
   3.615604095934408*^9}, {3.6156041317422247`*^9, 3.61560417709925*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "112", "]"}]], "Output"]
}, Open  ]],

Cell["Case 2.  Contraction on slot 1 of  X1 and slot 2 of  X2,   ", "Text",
 CellChangeTimes->{{3.615537791133367*^9, 3.615537835298162*^9}, {
  3.6155714437103157`*^9, 3.615571444814664*^9}, {3.615572697383553*^9, 
  3.615572707920794*^9}, {3.615577846634037*^9, 3.615577877946698*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1___", "\[CircleTimes]", 
       RowBox[{"X1_", "?", "deg2Q"}], "\[CircleTimes]", 
       RowBox[{"X2_", "?", "deg2Q"}], "\[CircleTimes]", "Y3___"}], 
      "\[RightAngleBracket]"}], "ab_List"], "/;", 
    RowBox[{"ab", "===", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", 
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", "4"}]}], "}"}]}]}], ":=", 
   RowBox[{"Y1", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"rev", "[", "X1", "]"}], ",", 
      RowBox[{"rev", "[", "X2", "]"}]}], "\[RightAngleBracket]"}], 
    "\[CircleTimes]", "Y3"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615537086389353*^9, 3.61553717891571*^9}, {
   3.6155372403552713`*^9, 3.615537374981909*^9}, {3.615537411704688*^9, 
   3.615537496427437*^9}, {3.615537691756116*^9, 3.615537693468109*^9}, {
   3.615537845788074*^9, 3.615537897101246*^9}, {3.6155379381581573`*^9, 
   3.6155379962073917`*^9}, 3.6155381614554653`*^9, {3.615538242623954*^9, 
   3.615538246948532*^9}, {3.615538369456678*^9, 3.615538406015028*^9}, {
   3.615573376386232*^9, 3.61557338923564*^9}, {3.6155734237631197`*^9, 
   3.615573437588418*^9}, {3.615574249097747*^9, 3.615574251672333*^9}, 
   3.6155770355748663`*^9, {3.615577739509665*^9, 3.615577774008832*^9}, 
   3.615577931176399*^9, {3.6155794179722548`*^9, 3.615579427499948*^9}, 
   3.615603044769508*^9, {3.615603245390646*^9, 3.615603246892798*^9}, {
   3.615603520701563*^9, 3.615603540604623*^9}, {3.6156040631668863`*^9, 
   3.615604095934408*^9}, {3.6156041317422247`*^9, 3.61560417709925*^9}, {
   3.615604250540495*^9, 3.615604250591777*^9}, {3.615604350724977*^9, 
   3.615604352987977*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "113", "]"}]], "Output"]
}, Open  ]],

Cell["Case 3.  Contraction on slot 2 of  X1 and slot 1 of  X2,   ", "Text",
 CellChangeTimes->{{3.615537791133367*^9, 3.615537835298162*^9}, {
  3.6155714437103157`*^9, 3.615571444814664*^9}, {3.615571690478923*^9, 
  3.615571699263332*^9}, {3.615572699149734*^9, 3.615572710229374*^9}, {
  3.6155778900901613`*^9, 3.615577899930686*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1___", "\[CircleTimes]", 
       RowBox[{"X1_", "?", "deg2Q"}], "\[CircleTimes]", 
       RowBox[{"X2_", "?", "deg2Q"}], "\[CircleTimes]", "Y3___"}], 
      "\[RightAngleBracket]"}], "ab_List"], "/;", 
    RowBox[{"ab", "===", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", "2"}], ",", 
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", "3"}]}], "}"}]}]}], ":=", 
   RowBox[{"Y1", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X1", ",", "X2"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
    "Y3"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615537086389353*^9, 3.61553717891571*^9}, {
   3.6155372403552713`*^9, 3.615537374981909*^9}, {3.615537411704688*^9, 
   3.615537496427437*^9}, {3.615537691756116*^9, 3.615537693468109*^9}, {
   3.615537845788074*^9, 3.615537897101246*^9}, {3.6155379381581573`*^9, 
   3.6155379962073917`*^9}, 3.6155381614554653`*^9, {3.615538242623954*^9, 
   3.615538246948532*^9}, {3.615538369456678*^9, 3.615538406015028*^9}, {
   3.615573376386232*^9, 3.61557338923564*^9}, {3.6155734237631197`*^9, 
   3.615573437588418*^9}, {3.615574249097747*^9, 3.615574251672333*^9}, 
   3.6155770355748663`*^9, {3.615577739509665*^9, 3.615577774008832*^9}, 
   3.615577931176399*^9, {3.6155794179722548`*^9, 3.615579427499948*^9}, 
   3.615603044769508*^9, {3.615603245390646*^9, 3.615603246892798*^9}, {
   3.615603520701563*^9, 3.615603540604623*^9}, {3.6156040631668863`*^9, 
   3.615604095934408*^9}, {3.6156041317422247`*^9, 3.61560417709925*^9}, {
   3.615604260571664*^9, 3.615604260651692*^9}, {3.615604315388053*^9, 
   3.615604316603573*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "114", "]"}]], "Output"]
}, Open  ]],

Cell["Case 4.  Contraction on slot 2 of  X1 and slot 2 of  X2,   ", "Text",
 CellChangeTimes->{{3.615537791133367*^9, 3.615537835298162*^9}, {
  3.6155714437103157`*^9, 3.615571444814664*^9}, {3.615571690478923*^9, 
  3.615571699263332*^9}, {3.615572699149734*^9, 3.615572710229374*^9}, {
  3.615572978545272*^9, 3.615572988833729*^9}, {3.615577910986082*^9, 
  3.6155779182345457`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1___", "\[CircleTimes]", 
       RowBox[{"X1_", "?", "deg2Q"}], "\[CircleTimes]", 
       RowBox[{"X2_", "?", "deg2Q"}], "\[CircleTimes]", "Y3___"}], 
      "\[RightAngleBracket]"}], "ab_List"], "/;", 
    RowBox[{"ab", "===", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", "2"}], ",", 
       RowBox[{
        RowBox[{"deg", "[", "Y1", "]"}], "+", "4"}]}], "}"}]}]}], ":=", 
   RowBox[{"Y1", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X1", ",", 
      RowBox[{"rev", "[", "X2", "]"}]}], "\[RightAngleBracket]"}], 
    "\[CircleTimes]", "Y3"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615537086389353*^9, 3.61553717891571*^9}, {
   3.6155372403552713`*^9, 3.615537374981909*^9}, {3.615537411704688*^9, 
   3.615537496427437*^9}, {3.615537691756116*^9, 3.615537693468109*^9}, {
   3.615537845788074*^9, 3.615537897101246*^9}, {3.6155379381581573`*^9, 
   3.6155379962073917`*^9}, 3.6155381614554653`*^9, {3.615538242623954*^9, 
   3.615538246948532*^9}, {3.615538369456678*^9, 3.615538406015028*^9}, {
   3.615573376386232*^9, 3.61557338923564*^9}, {3.6155734237631197`*^9, 
   3.615573437588418*^9}, {3.615574249097747*^9, 3.615574251672333*^9}, 
   3.6155770355748663`*^9, {3.615577739509665*^9, 3.615577774008832*^9}, 
   3.615577931176399*^9, {3.6155794179722548`*^9, 3.615579427499948*^9}, 
   3.615603044769508*^9, {3.615603245390646*^9, 3.615603246892798*^9}, {
   3.615603520701563*^9, 3.615603540604623*^9}, {3.6156040631668863`*^9, 
   3.615604095934408*^9}, {3.6156041317422247`*^9, 3.61560417709925*^9}, {
   3.615604270123761*^9, 3.615604273371224*^9}, {3.615604319844461*^9, 
   3.615604331196011*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "115", "]"}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "Tried unsetting this section  18:40  13/8/2014.   It is needed for some \
fairly basic simplifications like   ",
 Cell[BoxData[
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"M", "[", 
      OverscriptBox["s", "_"], "]"}], "\[CircleTimes]", 
     RowBox[{"M", "[", 
      OverscriptBox["s", "_"], "]"}]}], "\[RightAngleBracket]"}], 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}]}]]],
  CellChangeTimes->{{3.6169084624344378`*^9, 3.616908462435508*^9}}],
 " ."
}], "Text",
 CellChangeTimes->{{3.616889123432798*^9, 3.616889171364066*^9}, {
  3.6169083517668943`*^9, 3.61690851483941*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"UnsetRule", "[", 
  RowBox[{"{", 
   RowBox[{
   "71", ",", "72", ",", "73", ",", "74", ",", "75", ",", "76", ",", "77", 
    ",", "78"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.6169078267997847`*^9, 3.61690783833144*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Null", ",", "Null", ",", "Null", ",", "Null", ",", "Null", ",", "Null", 
   ",", "Null", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.616907848923299*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing", "Subsubsection",
 CellChangeTimes->{{3.615573944418972*^9, 3.615573945827422*^9}}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"X1", ",", "X2", ",", "Y1", ",", "Y2", ",", "Y3"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"2", ",", 
   RowBox[{"{", 
    RowBox[{"X1", ",", "X2", ",", "Y1", ",", "Y2", ",", "Y3"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.615573952416195*^9, 3.615574004839384*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "Y1", "\[CircleTimes]", "X1", "\[CircleTimes]", "Y2", "\[CircleTimes]", 
    "X2", "\[CircleTimes]", "Y3"}], "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}]}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "Y1", "\[CircleTimes]", "X1", "\[CircleTimes]", "Y2", "\[CircleTimes]", 
    "X2", "\[CircleTimes]", "Y3"}], "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}]}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "Y1", "\[CircleTimes]", "X1", "\[CircleTimes]", "Y2", "\[CircleTimes]", 
    "X2", "\[CircleTimes]", "Y3"}], "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}]}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "Y1", "\[CircleTimes]", "X1", "\[CircleTimes]", "Y2", "\[CircleTimes]", 
    "X2", "\[CircleTimes]", "Y3"}], "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}]}]]}], "Input",
 CellChangeTimes->{{3.615574490522545*^9, 3.615574502906014*^9}, {
  3.6155745649653873`*^9, 3.615574575773739*^9}, {3.615579686518072*^9, 
  3.6155796995279284`*^9}}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"Y1", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"rev", "[", "X1", "]"}], ",", "X2"}], "\[RightAngleBracket]"}], 
    "\[CircleTimes]", "Y2", "\[CircleTimes]", "Y3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"5", ",", "6"}], "}"}]]], "Output",
 CellChangeTimes->{
  3.6155745041979628`*^9, {3.6155745515919027`*^9, 3.615574577891878*^9}, 
   3.615574823201254*^9, 3.6155795277779417`*^9, 3.615579564335005*^9, 
   3.615579710932025*^9, 3.615581566543393*^9, 3.615605036805582*^9}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"Y1", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"rev", "[", "X1", "]"}], ",", 
      RowBox[{"rev", "[", "X2", "]"}]}], "\[RightAngleBracket]"}], 
    "\[CircleTimes]", "Y2", "\[CircleTimes]", "Y3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"5", ",", "6"}], "}"}]]], "Output",
 CellChangeTimes->{
  3.6155745041979628`*^9, {3.6155745515919027`*^9, 3.615574577891878*^9}, 
   3.615574823201254*^9, 3.6155795277779417`*^9, 3.615579564335005*^9, 
   3.615579710932025*^9, 3.615581566543393*^9, 3.6156050368094053`*^9}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"Y1", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X1", ",", "X2"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
    "Y2", "\[CircleTimes]", "Y3"}], "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"5", ",", "6"}], "}"}]]], "Output",
 CellChangeTimes->{
  3.6155745041979628`*^9, {3.6155745515919027`*^9, 3.615574577891878*^9}, 
   3.615574823201254*^9, 3.6155795277779417`*^9, 3.615579564335005*^9, 
   3.615579710932025*^9, 3.615581566543393*^9, 3.615605036812586*^9}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"Y1", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X1", ",", 
      RowBox[{"rev", "[", "X2", "]"}]}], "\[RightAngleBracket]"}], 
    "\[CircleTimes]", "Y2", "\[CircleTimes]", "Y3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"5", ",", "6"}], "}"}]]], "Output",
 CellChangeTimes->{
  3.6155745041979628`*^9, {3.6155745515919027`*^9, 3.615574577891878*^9}, 
   3.615574823201254*^9, 3.6155795277779417`*^9, 3.615579564335005*^9, 
   3.615579710932025*^9, 3.615581566543393*^9, 3.615605036815692*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"StartDebug", "[", "]"}], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "Y1", "\[CircleTimes]", "X1", "\[CircleTimes]", "Y2", "\[CircleTimes]", 
    "X2", "\[CircleTimes]", "Y3"}], "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "9"}], "}"}]}]], "\[IndentingNewLine]", 
 RowBox[{"StopDebug", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.615579792678042*^9, 3.6155798070946302`*^9}, {
  3.615580006518697*^9, 3.6155800309489183`*^9}, {3.615581535059024*^9, 
  3.615581542986546*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]62\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"Y1___", "\[CircleTimes]", 
        RowBox[{"X1_", "?", "deg2Q"}], "\[CircleTimes]", "Y2___", 
        "\[CircleTimes]", 
        RowBox[{"X2_", "?", "deg2Q"}], "\[CircleTimes]", "Y3___"}], 
       "\[RightAngleBracket]"}], "ab__List"], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "ab", "}"}], "]"}], ">", "1"}], "&&", 
      RowBox[{"abMoveQ", "[", 
       RowBox[{
        RowBox[{"{", "ab", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], ",", 
          RowBox[{"deg", "[", "Y2", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}]}], ":=", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1", "\[CircleTimes]", 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{
         RowBox[{"rev", "[", "X1", "]"}], ",", "X2"}], 
        "\[RightAngleBracket]"}], "\[CircleTimes]", "Y2", "\[CircleTimes]", 
       "Y3"}], "\[RightAngleBracket]"}], 
     RowBox[{"abMove", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], ",", 
         RowBox[{"deg", "[", "Y2", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "]"}]]}]}],
  SequenceForm["rule[\[VeryThinSpace]62\[VeryThinSpace]]:", "  ", 
   Defer[Condition[
      Subscript[
       AngleBracket[
        CircleTimes[
         Pattern[$CellContext`Y1, 
          BlankNullSequence[]], 
         PatternTest[
          Pattern[$CellContext`X1, 
           Blank[]], $CellContext`deg2Q], 
         Pattern[$CellContext`Y2, 
          BlankNullSequence[]], 
         PatternTest[
          Pattern[$CellContext`X2, 
           Blank[]], $CellContext`deg2Q], 
         Pattern[$CellContext`Y3, 
          BlankNullSequence[]]]], 
       Pattern[$CellContext`ab, 
        BlankSequence[List]]], 
      And[Length[{$CellContext`ab}] > 1, 
       $CellContext`abMoveQ[{$CellContext`ab}, {
         $CellContext`deg[$CellContext`Y1], 
         $CellContext`deg[$CellContext`Y2]}, {1, 1}]]] := Subscript[
      AngleBracket[
       CircleTimes[$CellContext`Y1, 
        AngleBracket[
         $CellContext`rev[$CellContext`X1], $CellContext`X2], \
$CellContext`Y2, $CellContext`Y3]], 
      $CellContext`abMove[{$CellContext`ab}, {
        $CellContext`deg[$CellContext`Y1], 
        $CellContext`deg[$CellContext`Y2]}, {1, 1}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6156849903348227`*^9, 3.615685197260056*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1", "\[CircleTimes]", 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{
         RowBox[{"rev", "[", "X1", "]"}], ",", "X2"}], 
        "\[RightAngleBracket]"}], "\[CircleTimes]", "Y2", "\[CircleTimes]", 
       "Y3"}], "\[RightAngleBracket]"}], 
     RowBox[{"abMove", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "9"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], ",", 
         RowBox[{"deg", "[", "Y2", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "]"}]],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Subscript[
     AngleBracket[
      CircleTimes[$CellContext`Y1, 
       AngleBracket[
        $CellContext`rev[$CellContext`X1], $CellContext`X2], $CellContext`Y2, \
$CellContext`Y3]], 
     $CellContext`abMove[{{2, 6}, {3, 7}, {5, 9}}, {
       $CellContext`deg[$CellContext`Y1], 
       $CellContext`deg[$CellContext`Y2]}, {1, 1}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6156849903348227`*^9, 3.615685197390017*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]62\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"Y1___", "\[CircleTimes]", 
        RowBox[{"X1_", "?", "deg2Q"}], "\[CircleTimes]", "Y2___", 
        "\[CircleTimes]", 
        RowBox[{"X2_", "?", "deg2Q"}], "\[CircleTimes]", "Y3___"}], 
       "\[RightAngleBracket]"}], "ab__List"], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "ab", "}"}], "]"}], ">", "1"}], "&&", 
      RowBox[{"abMoveQ", "[", 
       RowBox[{
        RowBox[{"{", "ab", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], ",", 
          RowBox[{"deg", "[", "Y2", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}]}], ":=", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1", "\[CircleTimes]", 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{
         RowBox[{"rev", "[", "X1", "]"}], ",", "X2"}], 
        "\[RightAngleBracket]"}], "\[CircleTimes]", "Y2", "\[CircleTimes]", 
       "Y3"}], "\[RightAngleBracket]"}], 
     RowBox[{"abMove", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"deg", "[", "Y1", "]"}], ",", 
         RowBox[{"deg", "[", "Y2", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "]"}]]}]}],
  SequenceForm["rule[\[VeryThinSpace]62\[VeryThinSpace]]:", "  ", 
   Defer[Condition[
      Subscript[
       AngleBracket[
        CircleTimes[
         Pattern[$CellContext`Y1, 
          BlankNullSequence[]], 
         PatternTest[
          Pattern[$CellContext`X1, 
           Blank[]], $CellContext`deg2Q], 
         Pattern[$CellContext`Y2, 
          BlankNullSequence[]], 
         PatternTest[
          Pattern[$CellContext`X2, 
           Blank[]], $CellContext`deg2Q], 
         Pattern[$CellContext`Y3, 
          BlankNullSequence[]]]], 
       Pattern[$CellContext`ab, 
        BlankSequence[List]]], 
      And[Length[{$CellContext`ab}] > 1, 
       $CellContext`abMoveQ[{$CellContext`ab}, {
         $CellContext`deg[$CellContext`Y1], 
         $CellContext`deg[$CellContext`Y2]}, {1, 1}]]] := Subscript[
      AngleBracket[
       CircleTimes[$CellContext`Y1, 
        AngleBracket[
         $CellContext`rev[$CellContext`X1], $CellContext`X2], \
$CellContext`Y2, $CellContext`Y3]], 
      $CellContext`abMove[{$CellContext`ab}, {
        $CellContext`deg[$CellContext`Y1], 
        $CellContext`deg[$CellContext`Y2]}, {1, 1}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6156849903348227`*^9, 3.615685197395884*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1", "\[CircleTimes]", 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{
         RowBox[{"rev", "[", "X1", "]"}], ",", "X2"}], 
        "\[RightAngleBracket]"}], "\[CircleTimes]", 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{
         RowBox[{"rev", "[", "Y2", "]"}], ",", "Y3"}], 
        "\[RightAngleBracket]"}]}], "\[RightAngleBracket]"}], 
     RowBox[{"abMove", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "7"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"deg", "[", 
          RowBox[{"Y1", ",", 
           RowBox[{"\[LeftAngleBracket]", 
            RowBox[{
             RowBox[{"rev", "[", "X1", "]"}], ",", "X2"}], 
            "\[RightAngleBracket]"}]}], "]"}], ",", 
         RowBox[{"deg", "[", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], "]"}]],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Subscript[
     AngleBracket[
      CircleTimes[$CellContext`Y1, 
       AngleBracket[
        $CellContext`rev[$CellContext`X1], $CellContext`X2], 
       AngleBracket[
        $CellContext`rev[$CellContext`Y2], $CellContext`Y3]]], 
     $CellContext`abMove[{{2, 6}, {5, 7}}, {
       $CellContext`deg[$CellContext`Y1, 
        AngleBracket[
         $CellContext`rev[$CellContext`X1], $CellContext`X2]], 
       $CellContext`deg[]}, {1, 1}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6156849903348227`*^9, 3.61568519758792*^9}]
}, Open  ]],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"Y1", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"rev", "[", "X1", "]"}], ",", "X2"}], "\[RightAngleBracket]"}], 
    "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"rev", "[", "Y2", "]"}], ",", "Y3"}], 
     "\[RightAngleBracket]"}]}], "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"2", ",", "5"}], "}"}]]], "Output",
 CellChangeTimes->{3.61568495806122*^9, 3.615684990679996*^9, 
  3.615685197592525*^9}]
}, Open  ]],

Cell["\<\

Shifting X2 to X1 is not the only choice.  Need to put movable factors into \
some standard position, \
\>", "Text",
 CellChangeTimes->{{3.615581591086858*^9, 3.6155816411349087`*^9}, {
  3.616894783383795*^9, 3.616894850232265*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "Y1", "\[CircleTimes]", "X1", "\[CircleTimes]", "Y2", "\[CircleTimes]", 
    "X2", "\[CircleTimes]", "Y3"}], "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "9"}], "}"}]}]]], "Input"],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"Y1", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"rev", "[", "X1", "]"}], ",", "X2"}], "\[RightAngleBracket]"}], 
    "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"rev", "[", "Y2", "]"}], ",", "Y3"}], 
     "\[RightAngleBracket]"}]}], "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"2", ",", "5"}], "}"}]]], "Output",
 CellChangeTimes->{3.6155816439530363`*^9}]
}, Open  ]],

Cell["\<\
Shifting X1 to X2 would have resulted in  Y1, Y2  together.  Y2 has no free \
slots so is moveable. \
\>", "Text",
 CellChangeTimes->{{3.615581591086858*^9, 3.615581735439784*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Pulling out scalar sub-contractions   ---  (long section, completed \
02/08/2014)\
\>", "Subsubsection",
 CellChangeTimes->{{3.615782996173129*^9, 3.615783039741869*^9}, {
   3.615784021892555*^9, 3.615784022899599*^9}, 3.615868982059802*^9, {
   3.615869024204074*^9, 3.615869051068441*^9}, {3.615869182285171*^9, 
   3.61586921614408*^9}, {3.6159484655099707`*^9, 3.6159484655781813`*^9}, 
   3.655574270256761*^9}],

Cell["\<\
(A similar problem:  Want to pull out free tensors (no contractions) if all \
the slots to the left or right of the tensor are contraced, so that no free \
slots 
will be reordered.  In the example, any tensor Y inserted between  x1, x2  or \
  x2, x3  or  x3, x4  could be pulled out to the left.)  \
\>", "Text",
 CellChangeTimes->{{3.615976103193671*^9, 3.615976117929867*^9}, {
  3.615976156314093*^9, 3.615976293290718*^9}, {3.615976330490933*^9, 
  3.615976376635083*^9}, {3.615976459275557*^9, 3.615976549916398*^9}}],

Cell["\<\
If there is a subset of factors that has no free slots and is not contracted \
with anything outside the subset, then it must be a scalar, so can be pulled \
out as a scalar factor.\
\>", "Text",
 CellChangeTimes->{{3.615783051117415*^9, 3.615783087246183*^9}, {
   3.615783166206307*^9, 3.615783246927194*^9}, {3.615783356769493*^9, 
   3.615783379311964*^9}, {3.615783508001004*^9, 3.61578355622573*^9}, {
   3.615783627009247*^9, 3.615783628817552*^9}, 3.615847582043584*^9}],

Cell["\<\
The example for all code here:         X = x1 \[CircleTimes] x2 \
\[CircleTimes] x3 \[CircleTimes] x4 \[CircleTimes] x5 \[CircleTimes] x6     \
(to get the graphic to look right try,  125%  magnification)

                                          |--|  4,5
                           x    x x    x x x    x x x x    x x x x x    x x x \
x x x
                           |___|  |_____|        |___|___________|     |
                                                                |_____________\
_|  
                            1,2        3,6                   8,16    10,18    \
                                    \
\>", "Text",
 CellChangeTimes->{{3.615857431961049*^9, 3.615857696316341*^9}, {
   3.61585772658766*^9, 3.615857878556943*^9}, 3.61585816551716*^9, {
   3.650243802937447*^9, 3.65024386239248*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ab", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "18"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{3.615858127413308*^9}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x4", ",", "x5"}], 
   "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"1", ",", "x1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"2", ",", "x2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"3", ",", "x3"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"4", ",", "x4"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"5", ",", "x5"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"6", ",", "x6"}], "]"}]}], "Input",
 CellChangeTimes->{{3.615794173992611*^9, 3.615794259930756*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{
   "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
    "x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}]}], ";"}]], "Input"],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
----------------------------------------------
This returns a list  d = FactorDegrees[ X_CircleTimes ]  of length Length[ X \
],  such that   d[[ n ]]   is the degree of the factor in position  n  of the \
the tensor product X,\
\>", "Text",
 CellChangeTimes->{{3.615418361976863*^9, 3.615418483177958*^9}, {
   3.61541982411313*^9, 3.615419888033402*^9}, {3.615427721449279*^9, 
   3.615427744746125*^9}, {3.61542778515307*^9, 3.615427838305525*^9}, 
   3.615428266262233*^9, {3.615428518772264*^9, 3.615428552292144*^9}, {
   3.6154286173449183`*^9, 3.615428678516821*^9}, {3.6157961826064243`*^9, 
   3.615796274127137*^9}, {3.61593596982885*^9, 3.6159359801500607`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FactorDegrees", "[", "X_CircleTimes", "]"}], ":=", 
  RowBox[{"deg", "[", 
   RowBox[{"Apply", "[", 
    RowBox[{"List", ",", "X"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.61579627799025*^9, 3.6157962950756702`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fdeg", "=", 
  RowBox[{"FactorDegrees", "[", 
   RowBox[{
   "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
    "x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.615796316946323*^9, 3.615796319894928*^9}, {
  3.615797042617346*^9, 3.61579704368926*^9}, {3.6158445245666924`*^9, 
  3.615844524931869*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.615796321703045*^9, 3.6157970449272623`*^9, 3.615844526570787*^9, 
   3.615975977570537*^9, {3.6162846559277763`*^9, 3.6162846619259*^9}}]
}, Open  ]],

Cell["\<\
The partial sum of factor degrees can be used to calculate the offset to add \
to the slot position in a factor to get the slot position in the tensor \
product,\
\>", "Text",
 CellChangeTimes->{{3.615847768930777*^9, 3.615847831620316*^9}, {
  3.615858293934812*^9, 3.615858302111388*^9}, {3.615858579487657*^9, 
  3.615858696097225*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PartialSum", "[", 
    RowBox[{"{", "}"}], "]"}], "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PartialSum", "[", "x_List", "]"}], ":=", " ", 
  RowBox[{"Prepend", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"First", "[", "x", "]"}], "+", 
     RowBox[{"PartialSum", "[", 
      RowBox[{"Rest", "[", "x", "]"}], "]"}]}], ",", 
    RowBox[{"First", "[", "x", "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615325111748549*^9, 3.61532519107358*^9}, {
   3.6153252451692123`*^9, 3.615325361908348*^9}, {3.615326749238414*^9, 
   3.615326750661902*^9}, 3.615327278455502*^9, {3.615328063032835*^9, 
   3.615328068855959*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"PartialSum", "[", "fdeg", "]"}], "\[IndentingNewLine]", 
 RowBox[{"offset", "=", 
  RowBox[{"Prepend", "[", 
   RowBox[{
    RowBox[{"Most", "[", 
     RowBox[{"PartialSum", "[", "fdeg", "]"}], "]"}], ",", "0"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.615858257153796*^9, 3.615858260104732*^9}, {
  3.615858727067594*^9, 3.615858728790104*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "3", ",", "6", ",", "10", ",", "15", ",", "21"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.615858261713381*^9, 3.6158587349817038`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "3", ",", "6", ",", "10", ",", "15"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.615858261713381*^9, 3.615858734988714*^9}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
----------------------------------------------
This returns a list of pairs, one for each factor in X, that are the slot \
numbers of the first and last slot of the factor in X,\
\>", "Text",
 CellChangeTimes->{{3.615847768930777*^9, 3.615847831620316*^9}, {
   3.615858293934812*^9, 3.615858302111388*^9}, {3.615858579487657*^9, 
   3.615858696097225*^9}, {3.61589193140559*^9, 3.615892036590087*^9}, 
   3.615935991222342*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FactorSlotRange", "[", "fdeg_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r1", ",", "r2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"r2", "=", 
      RowBox[{"PartialSum", "[", "fdeg", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"r1", "=", 
      RowBox[{"1", "+", 
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"Most", "[", 
          RowBox[{"PartialSum", "[", "fdeg", "]"}], "]"}], ",", "0"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"r1", ",", "r2"}], "}"}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615892119568512*^9, 3.615892345403565*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FactorSlotRange", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.615892351203861*^9, 3.6158923751092243`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"16", ",", "21"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.615892375843935*^9, 3.616900134332573*^9}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
----------------------------------------------
This returns a list of the slots that belong to the given subset of factors. \
Here  fdeg  is the list of degrees of all factors,\
\>", "Text",
 CellChangeTimes->{{3.615847768930777*^9, 3.615847831620316*^9}, {
   3.615858293934812*^9, 3.615858302111388*^9}, {3.615858579487657*^9, 
   3.615858696097225*^9}, {3.61589193140559*^9, 3.615892036590087*^9}, {
   3.615892435968419*^9, 3.615892491969921*^9}, {3.615892699505933*^9, 
   3.615892760947268*^9}, 3.615935999568893*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SlotsOfFactorSubset", "[", 
   RowBox[{"fdeg_List", ",", "fsub_List"}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Apply", "[", 
       RowBox[{"Range", ",", "#"}], "]"}], "&"}], ",", 
     RowBox[{
      RowBox[{"FactorSlotRange", "[", "fdeg", "]"}], "[", 
      RowBox[{"[", "fsub", "]"}], "]"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.615892502148592*^9, 3.61589270770896*^9}, {
  3.615892768379676*^9, 3.615892815777503*^9}, {3.615892858520155*^9, 
  3.615892925100271*^9}, {3.615893019660954*^9, 3.61589309592031*^9}, {
  3.615893162929093*^9, 3.615893225454338*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SlotsOfFactorSubset", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.615893102519722*^9, 3.61589313983589*^9}, {
  3.615894020258749*^9, 3.615894023761094*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "4", ",", "5", ",", "6", ",", "11", ",", "12", ",", "13", ",", 
   "14", ",", "15"}], "}"}]], "Output",
 CellChangeTimes->{{3.61589311930539*^9, 3.615893140991658*^9}, 
   3.615893199591392*^9, 3.61589323373673*^9, 3.615894025112554*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Range", "[", 
  RowBox[{"{", 
   RowBox[{"3", ",", "6"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.615892935970566*^9, 3.615892942873125*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.615892943510586*^9}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
----------------------------------------------
This returns a list p = PositionOfSlotOwner[ degX_List  ]  of length  \
Total[degX]  such that   p[[ n ]]   is the position of the factor (in the \
tensor product X) of the factor that owns slot  n.  
The argument is a list of  FactorDegrees  of  X.  It is written here as an \
explicit list of integers to prevent complaints about invalid iterators when
the given arguments are symbolic, \
\>", "Text",
 CellChangeTimes->{{3.615418361976863*^9, 3.615418483177958*^9}, {
   3.61541982411313*^9, 3.615419888033402*^9}, {3.615427721449279*^9, 
   3.615427744746125*^9}, {3.61542778515307*^9, 3.615427838305525*^9}, 
   3.615428266262233*^9, {3.615428518772264*^9, 3.615428552292144*^9}, {
   3.6154286173449183`*^9, 3.615428678516821*^9}, {3.6157965484969873`*^9, 
   3.6157965582415237`*^9}, {3.61579659675317*^9, 3.615796624386558*^9}, {
   3.615796690113987*^9, 3.6157967335228357`*^9}, 3.615936006924673*^9, {
   3.6159758392722673`*^9, 3.6159759397853203`*^9}, 3.61628389345866*^9}],

Cell[BoxData[
 RowBox[{"Clear", "[", "PositionOfSlotOwner", "]"}]], "Input",
 CellChangeTimes->{{3.615975955100905*^9, 3.615975959165606*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PositionOfSlotOwner", "[", 
   RowBox[{"{", "degs__Integer", "}"}], "]"}], ":=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{"#1", ",", 
        RowBox[{"{", "#2", "}"}]}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", 
         RowBox[{"{", "degs", "}"}], "]"}], "]"}], ",", 
       RowBox[{"{", "degs", "}"}]}], "}"}]}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615419668395041*^9, 3.615419696293201*^9}, {
   3.6154277760528917`*^9, 3.615427778132864*^9}, 3.6154278552672*^9, {
   3.615428123674086*^9, 3.615428143466506*^9}, {3.615428193178464*^9, 
   3.615428228395965*^9}, 3.615428261292911*^9, {3.61542842924548*^9, 
   3.615428447357379*^9}, {3.615796346921474*^9, 3.6157963873032227`*^9}, {
   3.615796641898292*^9, 3.6157966863313417`*^9}, {3.615796958973775*^9, 
   3.615796961533341*^9}, {3.615975756802204*^9, 3.615975827160467*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PositionOfSlotOwner", "[", "fdeg", "]"}]], "Input",
 CellChangeTimes->{{3.615796776356192*^9, 3.615796782392329*^9}, {
  3.615797090953511*^9, 3.6157970937739887`*^9}, {3.6158445317983427`*^9, 
  3.615844532181222*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "2", ",", "2", ",", "3", ",", "3", ",", "3", ",", "4", ",", "4", 
   ",", "4", ",", "4", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
   "6", ",", "6", ",", "6", ",", "6", ",", "6", ",", "6"}], "}"}]], "Output",
 CellChangeTimes->{3.6157967829612503`*^9, 3.615797007357142*^9, 
  3.61579709697756*^9, 3.61584453297099*^9}]
}, Open  ]],

Cell["Timing --  PositionOfSlotOwner :  Table  vs  ConstantArray", "Text",
 CellChangeTimes->{{3.615789607333756*^9, 3.6157896285015917`*^9}, {
  3.615975601721373*^9, 3.6159756044708443`*^9}}],

Cell["\<\
PositionOfSlotOwner[ ]  has been re-defined with argument List since these \
tests were done...\
\>", "Text",
 CellChangeTimes->{{3.616284033249564*^9, 3.616284097585972*^9}}],

Cell["\<\
An alternative defn of  PositionOfSlotOwner   that uses  ConstantArray  \
rather than Table,\
\>", "Text",
 CellChangeTimes->{{3.61578952789279*^9, 3.615789563205276*^9}, {
  3.6157896398460217`*^9, 3.615789641685976*^9}, {3.6157946626126223`*^9, 
  3.61579466918919*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PositionOfSlotOwner1", "[", "X_CircleTimes", "]"}], ":=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "X", "]"}], "]"}], ",", 
       RowBox[{"deg", "[", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", "X"}], "]"}], "]"}]}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.615789411070072*^9, 3.615789434523941*^9}}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"1", ",", "x1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"2", ",", "x2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"3", ",", "x3"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"4", ",", "x4"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"5", ",", "x5"}], "]"}]}], "Input",
 CellChangeTimes->{{3.61578921914782*^9, 3.61578930277356*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"PositionOfSlotOwner", "[", 
  RowBox[{
  "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
   "x4", "\[CircleTimes]", "x5"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"PositionOfSlotOwner1", "[", 
  RowBox[{
  "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
   "x4", "\[CircleTimes]", "x5"}], "]"}]}], "Input",
 CellChangeTimes->{{3.615789700107176*^9, 3.615789703293552*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "2", ",", "2", ",", "3", ",", "3", ",", "3", ",", "4", ",", "4", 
   ",", "4", ",", "4", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.615789705307604*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "2", ",", "2", ",", "3", ",", "3", ",", "3", ",", "4", ",", "4", 
   ",", "4", ",", "4", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6157897053131847`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"PositionOfSlotOwner", "[", 
     RowBox[{
     "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
      "x4", "\[CircleTimes]", "x5"}], "]"}], ",", 
    RowBox[{"{", "10000", "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"PositionOfSlotOwner1", "[", 
     RowBox[{
     "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
      "x4", "\[CircleTimes]", "x5"}], "]"}], ",", 
    RowBox[{"{", "10000", "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.615789160940856*^9, 3.615789213418786*^9}, {
  3.6157893801391373`*^9, 3.615789399084363*^9}, {3.615789486061839*^9, 
  3.615789489295001*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.2920179999999999997939426066295709461`5.4860095354805765", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.615789394585454*^9, 3.615789400168063*^9}, {
  3.6157894915160103`*^9, 3.615789498264492*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.34802199999999999802113848090812098235`5.56220661175668", ",", "Null"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.615789394585454*^9, 3.615789400168063*^9}, {
  3.6157894915160103`*^9, 3.615789498603093*^9}}]
}, Open  ]],

Cell[".... ConstantArray  is slower.", "Text",
 CellChangeTimes->{{3.615789657558463*^9, 3.615789667862268*^9}}],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
----------------------------------------------
This returns a list of factor number pairs, one such pair for each ab pair \
that specifies a contraction between the factors.
The first argument is the list of factor degrees in the tensor product. The  \
ab argument is explicit to prevent messages about invalid parts for symbolic \
ab, \
\>", "Text",
 CellChangeTimes->{{3.6157880861400023`*^9, 3.615788093964655*^9}, {
   3.615788732335903*^9, 3.6157887732966213`*^9}, {3.6157888069444427`*^9, 
   3.615788843536583*^9}, {3.6157888892970333`*^9, 3.615788909569394*^9}, {
   3.615789763622611*^9, 3.615789813975377*^9}, {3.615794276802272*^9, 
   3.615794281154477*^9}, {3.615797144916857*^9, 3.6157971872855053`*^9}, 
   3.6159360129069653`*^9, {3.6159773301598063`*^9, 3.615977384240438*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FactorPairs", "[", 
   RowBox[{
    RowBox[{"{", "degs__Integer", "}"}], ",", 
    RowBox[{"ab", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_Integer", ",", "_Integer"}], "}"}], ".."}], "}"}]}]}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "p", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"p", "=", 
      RowBox[{"PositionOfSlotOwner", "[", 
       RowBox[{"{", "degs", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", "ab", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615788038249649*^9, 3.615788072846876*^9}, {
   3.615788777027652*^9, 3.615788794709998*^9}, {3.615788920134205*^9, 
   3.615788947034442*^9}, {3.615789002489154*^9, 3.61578903730625*^9}, 
   3.615793349908293*^9, {3.61579341701696*^9, 3.615793422984523*^9}, {
   3.615794765568169*^9, 3.615794767134592*^9}, {3.615797193457903*^9, 
   3.615797214255406*^9}, {3.615977018010297*^9, 3.6159770446492653`*^9}, {
   3.615977242219038*^9, 3.615977277053444*^9}, {3.616284153676259*^9, 
   3.6162841896922398`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ab", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "18"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"fpair", "=", 
  RowBox[{"FactorPairs", "[", 
   RowBox[{"fdeg", ",", "ab"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6157943044899178`*^9, 3.6157943877875557`*^9}, {
   3.615794571100089*^9, 3.615794596300926*^9}, {3.6157947971612453`*^9, 
   3.6157947990628777`*^9}, {3.615794884176602*^9, 3.615794885168064*^9}, {
   3.615795005826016*^9, 3.615795014784321*^9}, 3.6157957861311817`*^9, {
   3.6157972235533*^9, 3.615797226607326*^9}, {3.615799000523014*^9, 
   3.615799009665917*^9}, {3.615799043928419*^9, 3.615799061835326*^9}, {
   3.61579965083572*^9, 3.6157996575685883`*^9}, {3.6158413581519527`*^9, 
   3.615841360038207*^9}, {3.615841806778349*^9, 3.615841807130205*^9}, {
   3.6158470144167337`*^9, 3.615847018072681*^9}, {3.6159760092514772`*^9, 
   3.6159760117064953`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.615794612441564*^9, 3.615794772750629*^9, 3.615794816101942*^9, 
   3.615794886436208*^9, {3.615795008076659*^9, 3.615795018213752*^9}, 
   3.6157957886786957`*^9, 3.615797232011695*^9, 3.615799014914385*^9, {
   3.6157990465869303`*^9, 3.615799066115348*^9}, {3.615799634218813*^9, 
   3.6157996592513027`*^9}, 3.615841360651025*^9, 3.61584181064937*^9, 
   3.6158470268521976`*^9, 3.615976023212636*^9, 3.615977301799528*^9, 
   3.616284635110362*^9, 3.616284668822373*^9}]
}, Open  ]],

Cell["A note on Gather", "Text",
 CellChangeTimes->{{3.615840459878796*^9, 3.615840470007321*^9}, 
   3.615840798040707*^9, 3.615948400740732*^9}],

Cell["\<\
I wanted a list of contraction groups. Each group was to be  a list of factor \
number pairs that are related to one another by a contraction
or chain of contractions. The argument is a list of factor pairs, \
\>", "Text",
 CellChangeTimes->{{3.6157880861400023`*^9, 3.615788093964655*^9}, {
   3.615788732335903*^9, 3.6157887732966213`*^9}, {3.6157888069444427`*^9, 
   3.615788843536583*^9}, {3.6157888892970333`*^9, 3.615788909569394*^9}, {
   3.615789763622611*^9, 3.615789813975377*^9}, 3.615793465133662*^9, {
   3.615793543966123*^9, 3.615793563086237*^9}, {3.615793594590476*^9, 
   3.6157936606714363`*^9}, {3.615793732959387*^9, 3.615793751503831*^9}, {
   3.615794007345278*^9, 3.615794012913506*^9}, 3.6157948548377733`*^9, {
   3.615804399429659*^9, 3.615804683784189*^9}, {3.615804740648834*^9, 
   3.615804825033012*^9}, {3.615840485336323*^9, 3.615840558327798*^9}}],

Cell["\<\
      ContractionGroups[ fpairs_List ]  :=  Gather[  fpairs,  ( ! \
Intersection[ #1,  #2 ] === { } ) & ]\
\>", "Text",
 CellChangeTimes->{{3.61579343795339*^9, 3.61579345699306*^9}, {
  3.61579364880225*^9, 3.615793651410274*^9}, {3.615793754850875*^9, 
  3.6157937670599527`*^9}, {3.61579383366749*^9, 3.6157938407435217`*^9}, {
  3.6157979541938753`*^9, 3.615797971136005*^9}, {3.6158043645792*^9, 
  3.6158043865972843`*^9}, {3.615840561175474*^9, 3.6158405626801863`*^9}}],

Cell["\<\
.... this did not work because the  Intersection[ ]  condition is not an \
equivalence relation :   a = b  and  b = c  does not imply  a = c. 
I think Gather chooses one elt to represent the equivalence class and tests \
against it. The problem is that the elements we want to gather need not have \
non-empty intersections, just non-empty intersections with some other elt in \
the gathered subset. \
\>", "Text",
 CellChangeTimes->{{3.6157880861400023`*^9, 3.615788093964655*^9}, {
   3.615788732335903*^9, 3.6157887732966213`*^9}, {3.6157888069444427`*^9, 
   3.615788843536583*^9}, {3.6157888892970333`*^9, 3.615788909569394*^9}, {
   3.615789763622611*^9, 3.615789813975377*^9}, 3.615793465133662*^9, {
   3.615793543966123*^9, 3.615793563086237*^9}, {3.615793594590476*^9, 
   3.6157936606714363`*^9}, {3.615793732959387*^9, 3.615793751503831*^9}, {
   3.615794007345278*^9, 3.615794012913506*^9}, 3.6157948548377733`*^9, {
   3.615804399429659*^9, 3.615804683784189*^9}, {3.615804740648834*^9, 
   3.615804825033012*^9}, {3.615840485336323*^9, 3.615840759128727*^9}}],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
----------------------------------------------
ConnectedFactors[ ]   is a container for lists of connected factors.  It gets \
simplified to contain the longest such lists. Eventually it contains just
lists of connected factors that are disjoint. One can start with a list of \
(connected) factor pairs and they will get gathered together to become
largest sets of connected factors,  \
\>", "Text",
 CellChangeTimes->{{3.6158408611289053`*^9, 3.615841237644569*^9}, 
   3.615841268492111*^9, 3.615841452317527*^9, {3.6158587946709967`*^9, 
   3.615858804257873*^9}, {3.615858834657584*^9, 3.615858905281108*^9}, 
   3.615936023834529*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConnectedFactors", "[", 
    RowBox[{
    "y1___List", ",", "x1_List", ",", "y2___List", ",", "x2_List", ",", 
     "y3___List"}], "]"}], "/;", 
   RowBox[{"IntersectingQ", "[", 
    RowBox[{"x1", ",", "x2"}], "]"}]}], ":=", 
  RowBox[{"ConnectedFactors", "[", 
   RowBox[{"y1", ",", "y2", ",", "y3", ",", 
    RowBox[{"Union", "[", 
     RowBox[{"x1", ",", "x2"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615843743809071*^9, 3.615843749172635*^9}, {
  3.6158441843430967`*^9, 3.6158441893833103`*^9}, {3.6158442702800083`*^9, 
  3.615844274950408*^9}}],

Cell["\<\
Make sure the lists have unique elements. If an input list never gets unioned \
with another, then this is where Union will be applied,\
\>", "Text",
 CellChangeTimes->{{3.6158589232807207`*^9, 3.6158589453785887`*^9}, {
  3.6158666119178133`*^9, 3.6158667387353277`*^9}, {3.615866821599227*^9, 
  3.615866822836154*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConnectedFactors", "[", 
    RowBox[{"y1___List", ",", "x1_List", ",", "y2___List"}], "]"}], "/;", 
   RowBox[{"!", 
    RowBox[{
     RowBox[{"Union", "[", "x1", "]"}], "===", "x1"}]}]}], ":=", 
  RowBox[{"ConnectedFactors", "[", 
   RowBox[{"y1", ",", 
    RowBox[{"Union", "[", "x1", "]"}], ",", "y2"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.615866761111259*^9, {3.615866832373296*^9, 3.615866888854165*^9}}],

Cell["Sort the connected sets by their first element,", "Text",
 CellChangeTimes->{{3.6158589232807207`*^9, 3.6158589453785887`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConnectedFactors", "[", 
    RowBox[{"y1___List", ",", "x1_List", ",", "x2_List", ",", "y2___List"}], 
    "]"}], "/;", 
   RowBox[{
    RowBox[{"First", "[", "x2", "]"}], "<", 
    RowBox[{"First", "[", "x1", "]"}]}]}], ":=", 
  RowBox[{"ConnectedFactors", "[", 
   RowBox[{"y1", ",", "x2", ",", "x1", ",", "y2"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6158438168990793`*^9, 3.615843880997963*^9}, 
   3.615844003973671*^9, {3.615844072870309*^9, 3.615844074435781*^9}, {
   3.615844125238907*^9, 3.615844147720891*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ConnectedFactors", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.615807246587987*^9, 3.615807254223201*^9}, {
  3.61583589664476*^9, 3.6158359039412537`*^9}, {3.6158368210498133`*^9, 
  3.6158368224730787`*^9}, {3.6158442146778708`*^9, 3.615844216803653*^9}}],

Cell[BoxData[
 RowBox[{"ConnectedFactors", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.615807254747055*^9, 3.615807424499034*^9, 3.6158359051312037`*^9, {
   3.615836802852051*^9, 3.615836825122251*^9}, 3.615841292454031*^9, 
   3.615843757330083*^9, 3.615843884867569*^9, 3.6158441592527037`*^9, {
   3.615844199441448*^9, 3.615844219358666*^9}, 3.615866902371266*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["ab"], "Input",
 CellChangeTimes->{{3.615810313497616*^9, 3.615810313691661*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "18"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.615810314239874*^9, 3.615841371838195*^9, 
  3.615847035442666*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["fpair"], "Input",
 CellChangeTimes->{{3.615811034110915*^9, 3.615811034298747*^9}, {
  3.6158417969691877`*^9, 3.615841797411171*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.615811035553692*^9, 3.6158413808000526`*^9, 
  3.615841813432493*^9, 3.6158470415686502`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Apply", "[", 
  RowBox[{"ConnectedFactors", ",", "fpair"}], "]"}]], "Input",
 CellChangeTimes->{{3.6158415995542183`*^9, 3.615841613797144*^9}, {
  3.61584181701165*^9, 3.615841817476488*^9}}],

Cell[BoxData[
 RowBox[{"ConnectedFactors", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.6158416144820423`*^9, 3.615841819105249*^9, 
  3.615844368369709*^9, 3.615847045714465*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fgrp", "=", 
  RowBox[{"Apply", "[", 
   RowBox[{"List", ",", 
    RowBox[{"Apply", "[", 
     RowBox[{"ConnectedFactors", ",", "fpair"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.6158414000335703`*^9, {3.615841621138085*^9, 3.615841626246346*^9}, {
   3.6158417008706493`*^9, 3.6158417186160297`*^9}, {3.615841787027121*^9, 
   3.6158417939421663`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.61584162889771*^9, 3.615841719297551*^9, 
  3.615841823007187*^9, 3.615844371380509*^9, 3.615847052432407*^9}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
----------------------------------------------
We shall use this to count the contractions made on each factor group,\
\>", "Text",
 CellChangeTimes->{{3.615859266003356*^9, 3.6158592995553913`*^9}, 
   3.615936043352234*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", "i", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Outer", "[", 
   RowBox[{"i", ",", "fgrp", ",", "fpair", ",", "1"}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6158369700555677`*^9, 3.615837060684917*^9}, {
  3.615837117199234*^9, 3.615837166631749*^9}, {3.615841645287354*^9, 
  3.615841649302865*^9}, {3.615841827558379*^9, 3.615841832805566*^9}, {
  3.615859030778002*^9, 3.6158590343595047`*^9}, {3.615859188330482*^9, 
  3.615859240203005*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"i", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "]"}], 
      RowBox[{"i", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], "]"}], 
      RowBox[{"i", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], "]"}], 
      RowBox[{"i", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "6"}], "}"}]}], "]"}], 
      RowBox[{"i", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "6"}], "}"}]}], "]"}]},
     {
      RowBox[{"i", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"4", ",", "6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "]"}], 
      RowBox[{"i", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"4", ",", "6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], "]"}], 
      RowBox[{"i", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"4", ",", "6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], "]"}], 
      RowBox[{"i", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"4", ",", "6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "6"}], "}"}]}], "]"}], 
      RowBox[{"i", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"4", ",", "6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "6"}], "}"}]}], "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6158370240735903`*^9, 3.6158370661476994`*^9, 3.615837124686808*^9, 
   3.6158371679234943`*^9, 3.6158416500811367`*^9, 3.615841834918853*^9, 
   3.615844375400552*^9, 3.615847059523777*^9, 3.6158590358299313`*^9, {
   3.615859100029633*^9, 3.615859142464739*^9}, {3.615859198141281*^9, 
   3.615859241431808*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", 
  RowBox[{"i", "\[Rule]", "IntersectingQ"}]}]], "Input",
 CellChangeTimes->{{3.6158590798206177`*^9, 3.615859135787673*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"True", ",", "True", ",", "True", ",", "False", ",", "False"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"False", ",", "False", ",", "False", ",", "True", ",", "True"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.615859094325189*^9, 3.615859139478086*^9}}]
}, Open  ]],

Cell["....then we count how many True in each sublist.", "Text",
 CellChangeTimes->{{3.615859333972267*^9, 3.615859376596589*^9}}],

Cell["\<\
This returns a list of how many contractions have been made on each factor \
group,\
\>", "Text",
 CellChangeTimes->{{3.6158422287536697`*^9, 3.6158423099701767`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CountContractions", "[", 
   RowBox[{"fpair_List", ",", "fgrp_List"}], "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"Length", ",", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{
      RowBox[{"Outer", "[", 
       RowBox[{"IntersectingQ", ",", "fgrp", ",", "fpair", ",", "1"}], "]"}], 
      ",", "False", ",", "2"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615808483330015*^9, 3.615808484309911*^9}, {
   3.615810009804249*^9, 3.6158100664286833`*^9}, {3.61581022265466*^9, 
   3.6158102882407722`*^9}, 3.6158103323691807`*^9, {3.615810431441476*^9, 
   3.6158104316656027`*^9}, {3.615810843379188*^9, 3.6158108774290533`*^9}, {
   3.615811041543393*^9, 3.6158110625206203`*^9}, {3.6158365095776978`*^9, 
   3.615836523801173*^9}, {3.615836882250113*^9, 3.6158368897886066`*^9}, {
   3.615837086251973*^9, 3.615837087323955*^9}, {3.615841995688589*^9, 
   3.615842024203108*^9}, 3.615842113433709*^9, {3.615842160970096*^9, 
   3.61584216700483*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{"fpair", "\[IndentingNewLine]", "fgrp", "\[IndentingNewLine]", 
 RowBox[{"CountContractions", "[", 
  RowBox[{"fpair", ",", "fgrp"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6158419773637657`*^9, 3.6158419856834784`*^9}, {
  3.615842032609887*^9, 3.615842055587735*^9}, {3.6158421317613163`*^9, 
  3.615842135430007*^9}, {3.6158421775055637`*^9, 3.615842181846147*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6158419870761747`*^9, {3.615842037991884*^9, 3.615842137688682*^9}, {
   3.615842173000546*^9, 3.6158421838991423`*^9}, 3.615844380479823*^9, 
   3.61584706236099*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6158419870761747`*^9, {3.615842037991884*^9, 3.615842137688682*^9}, {
   3.615842173000546*^9, 3.6158421838991423`*^9}, 3.615844380479823*^9, 
   3.615847062369515*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6158419870761747`*^9, {3.615842037991884*^9, 3.615842137688682*^9}, {
   3.615842173000546*^9, 3.6158421838991423`*^9}, 3.615844380479823*^9, 
   3.615847062375695*^9}]
}, Open  ]],

Cell["Timing   --  DeleteCases  vs  replacing by Sequence[ ]", "Text",
 CellChangeTimes->{{3.61584304970197*^9, 3.615843091910327*^9}, 
   3.61584313477534*^9, 3.615948386500375*^9}],

Cell["\<\
In   CountContractions[ ]   we could have used  False \[Rule] Sequence[ ] .  \
DeleteCases  is  2x faster (both are fast -- 100\[VeryThinSpace]\
\[VeryThinSpace]\[VeryThinSpace]000 iterations),\
\>", "Text",
 CellChangeTimes->{{3.6158431770582027`*^9, 3.6158433218004436`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"DeleteCases", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "False", ",", "True", ",", "False", ",", "False", ",", "True"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "True", ",", "True", ",", "False", ",", "False", ",", "False"}], 
         "}"}]}], "}"}], ",", "False", ",", "2"}], "]"}], ",", 
    RowBox[{"{", "100000", "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6158107235780888`*^9, 3.615810746687222*^9}, {
  3.615810794088242*^9, 3.6158107989364653`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.36402200000000001223199319611012469977`5.581727544703074", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.615810749024365*^9, {3.6158107894856777`*^9, 3.6158108121619368`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "False", ",", "True", ",", "False", ",", "False", ",", "True"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "True", ",", "True", ",", "False", ",", "False", ",", "False"}], 
        "}"}]}], "}"}], "/.", 
     RowBox[{"False", "\[Rule]", 
      RowBox[{"Sequence", "[", "]"}]}]}], ",", 
    RowBox[{"{", "100000", "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.615810759414351*^9, 3.615810771656912*^9}, {
  3.615810803288225*^9, 3.615810803669134*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.84405300000000005322675633578910492361`5.9469696310958735", ",", 
   "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.615810774960074*^9, {3.61581080672153*^9, 3.615810815126758*^9}}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
----------------------------------------------
This returns a list of the ab pairs that has been partitioned into subsets \
corresponding to contractions on the factor groups, \
\>", "Text",
 CellChangeTimes->{{3.6158422287536697`*^9, 3.6158423099701767`*^9}, {
   3.615842372242347*^9, 3.615842374034623*^9}, {3.6158424059710627`*^9, 
   3.615842426531486*^9}, {3.615842463812106*^9, 3.615842556793661*^9}, 
   3.615936052143141*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConnectedContractions", "[", 
   RowBox[{"X_CircleTimes", ",", "ab_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fpair", ",", "fdeg", ",", "fgrp", ",", "TorF"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fdeg", "=", 
      RowBox[{"FactorDegrees", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"fpair", "=", 
      RowBox[{"FactorPairs", "[", 
       RowBox[{"fdeg", ",", "ab"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fgrp", "=", 
      RowBox[{"Apply", "[", 
       RowBox[{"List", ",", 
        RowBox[{"Apply", "[", 
         RowBox[{"ConnectedFactors", ",", "fpair"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"TorF", "=", 
      RowBox[{"Outer", "[", 
       RowBox[{"IntersectingQ", ",", "fgrp", ",", "fpair", ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Pick", "[", 
         RowBox[{"ab", ",", "#"}], "]"}], "&"}], ",", "TorF"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615808483330015*^9, 3.615808484309911*^9}, {
   3.615810009804249*^9, 3.6158100664286833`*^9}, {3.61581022265466*^9, 
   3.6158102882407722`*^9}, 3.6158103323691807`*^9, {3.615810431441476*^9, 
   3.6158104316656027`*^9}, {3.615810843379188*^9, 3.6158108774290533`*^9}, {
   3.615811041543393*^9, 3.6158110625206203`*^9}, {3.6158365095776978`*^9, 
   3.615836603432899*^9}, {3.615836666566042*^9, 3.615836669928461*^9}, {
   3.615837275417725*^9, 3.615837372251981*^9}, {3.615837473135066*^9, 
   3.6158376174579477`*^9}, {3.615837693698452*^9, 3.6158377743420677`*^9}, {
   3.6158401481156282`*^9, 3.6158402791263237`*^9}, 3.615842573605254*^9, {
   3.615842637044671*^9, 3.615842665751348*^9}, 3.615842781763567*^9}],

Cell["\<\
This is the same as above, but with Print statements to see what is going on,  
(not initialized)\
\>", "Text",
 CellChangeTimes->{{3.6158422287536697`*^9, 3.6158423099701767`*^9}, {
  3.615842372242347*^9, 3.615842374034623*^9}, {3.6158424059710627`*^9, 
  3.615842426531486*^9}, {3.615842463812106*^9, 3.615842556793661*^9}, {
  3.615842676341216*^9, 3.6158427001825943`*^9}, {3.615869775664324*^9, 
  3.6158697872006903`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConnectedContractionsDemo", "[", 
   RowBox[{"X_CircleTimes", ",", "ab_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fpair", ",", "fdeg", ",", "fgrp", ",", "TorF"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fdeg", "=", 
      RowBox[{"FactorDegrees", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"fpair", "=", 
      RowBox[{"FactorPairs", "[", 
       RowBox[{"fdeg", ",", "ab"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fgrp", "=", 
      RowBox[{"Apply", "[", 
       RowBox[{"List", ",", 
        RowBox[{"Apply", "[", 
         RowBox[{"ConnectedFactors", ",", "fpair"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"TorF", "=", 
      RowBox[{"Outer", "[", 
       RowBox[{"IntersectingQ", ",", "fgrp", ",", "fpair", ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "fdeg", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "fpair", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "fgrp", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "TorF", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Pick", "[", 
         RowBox[{"ab", ",", "#"}], "]"}], "&"}], ",", "TorF"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.615808483330015*^9, 3.615808484309911*^9}, {
   3.615810009804249*^9, 3.6158100664286833`*^9}, {3.61581022265466*^9, 
   3.6158102882407722`*^9}, 3.6158103323691807`*^9, {3.615810431441476*^9, 
   3.6158104316656027`*^9}, {3.615810843379188*^9, 3.6158108774290533`*^9}, {
   3.615811041543393*^9, 3.6158110625206203`*^9}, {3.6158365095776978`*^9, 
   3.615836603432899*^9}, {3.615836666566042*^9, 3.615836669928461*^9}, {
   3.615837275417725*^9, 3.615837372251981*^9}, {3.615837473135066*^9, 
   3.6158376174579477`*^9}, {3.615837693698452*^9, 3.6158377743420677`*^9}, {
   3.6158401481156282`*^9, 3.6158402791263237`*^9}, 3.615842573605254*^9, {
   3.615842637044671*^9, 3.61584263840204*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ab", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "18"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ConnectedContractionsDemo", "[", 
  RowBox[{
   RowBox[{
   "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
    "x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}], ",", "ab"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"Length", ",", 
   RowBox[{"ConnectedContractions", "[", 
    RowBox[{
     RowBox[{
     "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
      "x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}], ",", "ab"}], 
    "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.615837624391453*^9, 3.61583765428538*^9}, {
  3.615842595375795*^9, 3.6158425980931253`*^9}, {3.6158427283264933`*^9, 
  3.615842835746511*^9}, {3.6158470752936296`*^9, 3.6158470783649597`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], 
  "}"}]], "Print",
 CellChangeTimes->{
  3.6158377783459597`*^9, 3.6158402852630568`*^9, 3.615842599222068*^9, 
   3.615842746490662*^9, {3.615842819328438*^9, 3.615842836974472*^9}, 
   3.61584438924852*^9, 3.615847081039028*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.6158377783459597`*^9, 3.6158402852630568`*^9, 3.615842599222068*^9, 
   3.615842746490662*^9, {3.615842819328438*^9, 3.615842836974472*^9}, 
   3.61584438924852*^9, 3.61584708104853*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.6158377783459597`*^9, 3.6158402852630568`*^9, 3.615842599222068*^9, 
   3.615842746490662*^9, {3.615842819328438*^9, 3.615842836974472*^9}, 
   3.61584438924852*^9, 3.615847081054508*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"True", ",", "True", ",", "True", ",", "False", ",", "False"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"False", ",", "False", ",", "False", ",", "True", ",", "True"}], 
    "}"}]}], "}"}]], "Print",
 CellChangeTimes->{
  3.6158377783459597`*^9, 3.6158402852630568`*^9, 3.615842599222068*^9, 
   3.615842746490662*^9, {3.615842819328438*^9, 3.615842836974472*^9}, 
   3.61584438924852*^9, 3.615847081060752*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "18"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.615837656105928*^9, 3.615837699616707*^9}, {
   3.61583776176722*^9, 3.615837778367914*^9}, 3.615840285287068*^9, 
   3.615842599258151*^9, 3.615842746526752*^9, {3.615842819355237*^9, 
   3.615842837001677*^9}, 3.615844389286612*^9, 3.615847081066135*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{{3.615837656105928*^9, 3.615837699616707*^9}, {
   3.61583776176722*^9, 3.615837778367914*^9}, 3.615840285287068*^9, 
   3.615842599258151*^9, 3.615842746526752*^9, {3.615842819355237*^9, 
   3.615842837001677*^9}, 3.615844389286612*^9, 3.6158470810707417`*^9}]
}, Open  ]],

Cell["\<\
....the last line is the same as the output from  CountContractions[ ].  It \
gives the number of ab pairs (contractions) that act on each factor group. \
\>", "Text",
 CellChangeTimes->{{3.6158428895021963`*^9, 3.615842991606835*^9}, {
  3.615843387816601*^9, 3.615843401848515*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"ConnectedContractions", "[", 
     RowBox[{
      RowBox[{
      "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
       "x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}], ",", "ab"}], 
     "]"}], ",", 
    RowBox[{"{", "1000", "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6158075153464212`*^9, 3.615807530503819*^9}, {
   3.615843434046571*^9, 3.615843441216778*^9}, 3.615843487553903*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.79605000000000003534950110406498424709`5.921540259964692", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.615807531284153*^9, {3.6158435359721413`*^9, 3.615843562177013*^9}, {
   3.615844401670765*^9, 3.615844406566701*^9}, 3.615847096582984*^9}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
----------------------------------------------
This returns a list of degrees of the factor groups before contraction. This \
is the sum of the degrees of the factors within the factor group.
The 1st argument is the list of factor degrees. The 2nd argument is a list of \
factor groups,\
\>", "Text",
 CellChangeTimes->{{3.6157880861400023`*^9, 3.615788093964655*^9}, {
   3.615788732335903*^9, 3.6157887732966213`*^9}, {3.6157888069444427`*^9, 
   3.615788843536583*^9}, {3.6157888892970333`*^9, 3.615788909569394*^9}, {
   3.615789763622611*^9, 3.615789813975377*^9}, 3.615793465133662*^9, {
   3.615793543966123*^9, 3.615793563086237*^9}, {3.615793594590476*^9, 
   3.6157936606714363`*^9}, {3.615793732959387*^9, 3.615793751503831*^9}, {
   3.615794007345278*^9, 3.615794012913506*^9}, 3.6157948548377733`*^9, {
   3.615795114967843*^9, 3.615795158567457*^9}, {3.615795199414358*^9, 
   3.615795202311995*^9}, {3.6157953748410187`*^9, 3.615795478551662*^9}, {
   3.615795618699347*^9, 3.6157957645878153`*^9}, {3.615795967292551*^9, 
   3.6157960405576363`*^9}, {3.6157972847258387`*^9, 3.615797332326392*^9}, 
   3.615936074364502*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FactorGroupDegree", "[", 
   RowBox[{"degX_List", ",", " ", "fgrp_List"}], "]"}], ":=", " ", 
  RowBox[{"Map", "[", 
   RowBox[{"Total", ",", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"degX", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", "fgrp", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615795935238595*^9, 3.615795950882382*^9}, {
  3.615796045392537*^9, 3.6157960489322147`*^9}, {3.61579729266613*^9, 
  3.615797299706221*^9}, {3.615797344042035*^9, 3.615797365339395*^9}, {
  3.615797396693725*^9, 3.615797434990683*^9}, {3.615797622015712*^9, 
  3.6157976534570312`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{"fdeg", "\[IndentingNewLine]", "fgrp"}], "Input",
 CellChangeTimes->{{3.6157975110829077`*^9, 3.615797516683085*^9}, {
  3.615844506610548*^9, 3.615844507014076*^9}, {3.6158445569157248`*^9, 
  3.615844556995989*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6157975127167*^9, 3.6157975178107758`*^9}, 
   3.6158445584198933`*^9, 3.615847101281719*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6157975127167*^9, 3.6157975178107758`*^9}, 
   3.6158445584198933`*^9, 3.615847101288989*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fdeg", "[", 
     RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", " ", "fgrp", ",", 
   RowBox[{"{", "2", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.615797495146233*^9, 3.615797582622752*^9}, {
  3.6158445669667*^9, 3.615844570006556*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.615797533083024*^9, 3.6157975584172983`*^9}, 
   3.615844570607869*^9, 3.6158471032830048`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"Total", ",", "%"}], "]"}]], "Input",
 CellChangeTimes->{{3.615797594295143*^9, 3.615797603820156*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.61579760553084*^9, 3.6158445751234207`*^9, 
  3.6158471044822617`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FactorGroupDegree", "[", 
  RowBox[{"fdeg", ",", "fgrp"}], "]"}]], "Input",
 CellChangeTimes->{{3.6157976738995333`*^9, 3.615797680141162*^9}, {
  3.61584459208597*^9, 3.615844594771584*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{
  3.615797680699423*^9, {3.6158445834623404`*^9, 3.6158445952774982`*^9}, 
   3.6158471060539417`*^9}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
----------------------------------------------
This returns a list of degrees of the factor groups after taking into account \
contractions within the group. That is, only the free slots of the factor \
group are counted,\
\>", "Text",
 CellChangeTimes->{{3.6157880861400023`*^9, 3.615788093964655*^9}, {
   3.615788732335903*^9, 3.6157887732966213`*^9}, {3.6157888069444427`*^9, 
   3.615788843536583*^9}, {3.6157888892970333`*^9, 3.615788909569394*^9}, {
   3.615789763622611*^9, 3.615789813975377*^9}, 3.615793465133662*^9, {
   3.615793543966123*^9, 3.615793563086237*^9}, {3.615793594590476*^9, 
   3.6157936606714363`*^9}, {3.615793732959387*^9, 3.615793751503831*^9}, {
   3.615794007345278*^9, 3.615794012913506*^9}, 3.6157948548377733`*^9, {
   3.615795114967843*^9, 3.615795158567457*^9}, {3.615795199414358*^9, 
   3.615795202311995*^9}, {3.6157953748410187`*^9, 3.615795478551662*^9}, {
   3.615795618699347*^9, 3.6157957645878153`*^9}, {3.615798153787423*^9, 
   3.615798182444358*^9}, {3.615798252492714*^9, 3.615798265180916*^9}, {
   3.615846562588456*^9, 3.61584664657222*^9}, {3.615869851808978*^9, 
   3.615869866112977*^9}, {3.615936077661522*^9, 3.6159360854131393`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FactorGroupFreeDegree", "[", 
   RowBox[{"degX_List", ",", "fpair_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "fgrp", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fgrp", "=", 
      RowBox[{"Apply", "[", 
       RowBox[{"List", ",", 
        RowBox[{"Apply", "[", 
         RowBox[{"ConnectedFactors", ",", "fpair"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FactorGroupDegree", " ", "[", 
       RowBox[{"degX", ",", "fgrp"}], " ", "]"}], "-", " ", 
      RowBox[{"2", 
       RowBox[{"CountContractions", "[", 
        RowBox[{"fpair", ",", "fgrp"}], "]"}]}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615797831308752*^9, 3.615797858627619*^9}, {
  3.615798087263376*^9, 3.6157981466754313`*^9}, {3.6158466526289062`*^9, 
  3.615846679513468*^9}, {3.6158467447876673`*^9, 3.6158467559242287`*^9}, {
  3.61584682960431*^9, 3.6158468720120087`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{"fdeg", "\[IndentingNewLine]", "fpair"}], "Input",
 CellChangeTimes->{{3.615846949680874*^9, 3.61584695273496*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.615846954738227*^9, 3.615847110482313*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.615846954738227*^9, 3.615847110489684*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FactorGroupFreeDegree", "[", 
  RowBox[{"fdeg", ",", "fpair"}], "]"}]], "Input",
 CellChangeTimes->{{3.615846908753096*^9, 3.615846957634597*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "6"}], "}"}]], "Output",
 CellChangeTimes->{3.615846921217513*^9, 3.615847112306447*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"FactorGroupFreeDegree", "[", 
     RowBox[{"fdeg", ",", "fpair"}], "]"}], ",", 
    RowBox[{"{", "1000", "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6158614141346188`*^9, 3.615861434727869*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.76004700000000002813038690874236635864`5.901440362415047", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{3.615861436181275*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"FactorGroupFreeDegree", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "5", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fgrp", "=", 
  RowBox[{"Apply", "[", 
   RowBox[{"List", ",", 
    RowBox[{"Apply", "[", 
     RowBox[{"ConnectedFactors", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.615866449841844*^9, 3.615866454965209*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6158664595224657`*^9, 3.615866932741289*^9}]
}, Open  ]],

Cell[TextData[{
 "----------------------------------------------------------------------------\
------------------------------------------------------------------------------\
------------------------------------------------\nThis returns True if there \
is a scalar contraction that can be taken out of the general contraction  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "X", "\[RightAngleBracket]"}], "ab"], 
   TraditionalForm]]],
 " ,  and False otherwise."
}], "Text",
 CellChangeTimes->{{3.6157880861400023`*^9, 3.615788093964655*^9}, {
   3.615788732335903*^9, 3.6157887732966213`*^9}, {3.6157888069444427`*^9, 
   3.615788843536583*^9}, {3.6157888892970333`*^9, 3.615788909569394*^9}, {
   3.615789763622611*^9, 3.615789813975377*^9}, 3.615793465133662*^9, {
   3.615793543966123*^9, 3.615793563086237*^9}, {3.615793594590476*^9, 
   3.6157936606714363`*^9}, {3.615793732959387*^9, 3.615793751503831*^9}, {
   3.615794007345278*^9, 3.615794012913506*^9}, 3.6157948548377733`*^9, {
   3.615795114967843*^9, 3.615795158567457*^9}, {3.615795199414358*^9, 
   3.615795202311995*^9}, {3.6157953748410187`*^9, 3.615795478551662*^9}, {
   3.615795618699347*^9, 3.6157957645878153`*^9}, {3.615798153787423*^9, 
   3.615798182444358*^9}, {3.615798252492714*^9, 3.615798265180916*^9}, {
   3.615798355900569*^9, 3.615798429694436*^9}, {3.6157984807016897`*^9, 
   3.6157984951822987`*^9}, {3.615862742487986*^9, 3.615862763609353*^9}, {
   3.6158627971598377`*^9, 3.615862799687817*^9}, {3.615862857409663*^9, 
   3.615862858024901*^9}, 3.615936097848896*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ScalarContractionQ", "[", 
   RowBox[{"X_CircleTimes", ",", "ab_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fdeg", ",", "fpair", ",", "free"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fdeg", "=", 
      RowBox[{"FactorDegrees", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"fpair", " ", "=", " ", 
      RowBox[{"FactorPairs", "[", 
       RowBox[{"fdeg", ",", "ab"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"free", "=", 
      RowBox[{"FactorGroupFreeDegree", "[", 
       RowBox[{"fdeg", ",", "fpair"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Apply", "[", 
      RowBox[{"Or", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "===", "0"}], ")"}], "&"}], ",", "free"}], "]"}]}], 
      "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.61579844344527*^9, 3.615798471350152*^9}, {
  3.615798508545834*^9, 3.61579870901656*^9}, {3.6157987482960033`*^9, 
  3.6157987744034*^9}, {3.615798813195238*^9, 3.615798930734552*^9}, {
  3.6157993124000893`*^9, 3.615799356628107*^9}, {3.615847167423612*^9, 
  3.6158471739789143`*^9}, {3.615847214457242*^9, 3.615847227084896*^9}, {
  3.6158481322904587`*^9, 3.615848135151476*^9}, {3.615848256255292*^9, 
  3.615848269234809*^9}, {3.615862835313857*^9, 3.615862854437997*^9}}],

Cell["\<\
As above, but with Print[ ],
(not initialized)\
\>", "Text",
 CellChangeTimes->{{3.6157880861400023`*^9, 3.615788093964655*^9}, {
   3.615788732335903*^9, 3.6157887732966213`*^9}, {3.6157888069444427`*^9, 
   3.615788843536583*^9}, {3.6157888892970333`*^9, 3.615788909569394*^9}, {
   3.615789763622611*^9, 3.615789813975377*^9}, 3.615793465133662*^9, {
   3.615793543966123*^9, 3.615793563086237*^9}, {3.615793594590476*^9, 
   3.6157936606714363`*^9}, {3.615793732959387*^9, 3.615793751503831*^9}, {
   3.615794007345278*^9, 3.615794012913506*^9}, 3.6157948548377733`*^9, {
   3.615795114967843*^9, 3.615795158567457*^9}, {3.615795199414358*^9, 
   3.615795202311995*^9}, {3.6157953748410187`*^9, 3.615795478551662*^9}, {
   3.615795618699347*^9, 3.6157957645878153`*^9}, {3.615798153787423*^9, 
   3.615798182444358*^9}, {3.615798252492714*^9, 3.615798265180916*^9}, {
   3.615798355900569*^9, 3.615798429694436*^9}, {3.6157984807016897`*^9, 
   3.6157984951822987`*^9}, {3.615862742487986*^9, 3.615862763609353*^9}, {
   3.6158627971598377`*^9, 3.615862799687817*^9}, {3.615862857409663*^9, 
   3.615862858024901*^9}, {3.615869935970049*^9, 3.615869956850932*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ScalarContractionDemoQ", "[", 
   RowBox[{"X_CircleTimes", ",", "ab_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fdeg", ",", "fpair", ",", "free"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fdeg", "=", 
      RowBox[{"FactorDegrees", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"fpair", " ", "=", " ", 
      RowBox[{"FactorPairs", "[", 
       RowBox[{"fdeg", ",", "ab"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"free", "=", 
      RowBox[{"FactorGroupFreeDegree", "[", 
       RowBox[{"fdeg", ",", "fpair"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<fdeg = \>\"", ",", "fdeg"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<fpair = \>\"", ",", "fpair"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<free = \>\"", ",", "free"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Apply", "[", 
      RowBox[{"Or", ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "===", "0"}], ")"}], "&"}], ",", "free"}], "]"}]}], 
      "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.61579844344527*^9, 3.615798471350152*^9}, {
  3.615798508545834*^9, 3.61579870901656*^9}, {3.6157987482960033`*^9, 
  3.6157987744034*^9}, {3.615798813195238*^9, 3.615798930734552*^9}, {
  3.6157993124000893`*^9, 3.615799356628107*^9}, {3.615847167423612*^9, 
  3.6158471739789143`*^9}, {3.615847214457242*^9, 3.615847227084896*^9}, {
  3.6158481322904587`*^9, 3.615848135151476*^9}, {3.615848256255292*^9, 
  3.615848269234809*^9}, {3.615862835313857*^9, 3.615862854437997*^9}, {
  3.615863353399095*^9, 3.6158634020395184`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ScalarContractionQ", "[", 
  RowBox[{
   RowBox[{
   "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
    "x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "18"}], "}"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ScalarContractionQ", "[", 
  RowBox[{
   RowBox[{
   "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
    "x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "18"}], "}"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ScalarContractionQ", "[", 
  RowBox[{
   RowBox[{
   "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
    "x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "18"}], "}"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.615798956564726*^9, 3.615798974758678*^9}, {
  3.6157990838656178`*^9, 3.615799085047714*^9}, {3.615847284276273*^9, 
  3.615847287981333*^9}, {3.615851245726179*^9, 3.615851261497798*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.615799087301312*^9, 3.6157993744706583`*^9, {3.615847265962377*^9, 
   3.615847293223423*^9}, 3.6158512642757807`*^9, 3.615863156212134*^9, 
   3.615863817721251*^9}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.615799087301312*^9, 3.6157993744706583`*^9, {3.615847265962377*^9, 
   3.615847293223423*^9}, 3.6158512642757807`*^9, 3.615863156212134*^9, 
   3.6158638177273073`*^9}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.615799087301312*^9, 3.6157993744706583`*^9, {3.615847265962377*^9, 
   3.615847293223423*^9}, 3.6158512642757807`*^9, 3.615863156212134*^9, 
   3.6158638177337103`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ScalarContractionDemoQ", "[", 
  RowBox[{
   RowBox[{
   "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
    "x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "18"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.615863415122864*^9, 3.615863416018416*^9}, {
  3.615863894548379*^9, 3.615863912088485*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fdeg = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}]}],
  SequenceForm["fdeg = ", {1, 2, 3, 4, 5, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6158634166088448`*^9, 3.6158637709346933`*^9, {3.6158639016952953`*^9, 
   3.615863913910562*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fpair = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6"}], "}"}]}], "}"}]}],
  SequenceForm["fpair = ", {{1, 2}, {2, 3}, {3, 3}, {4, 6}, {4, 6}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6158634166088448`*^9, 3.6158637709346933`*^9, {3.6158639016952953`*^9, 
   3.6158639139239197`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"free = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}]}],
  SequenceForm["free = ", {0, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6158634166088448`*^9, 3.6158637709346933`*^9, {3.6158639016952953`*^9, 
   3.615863913935301*^9}}]
}, Open  ]],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.615863416770382*^9, 3.61586377095809*^9, {3.61586390171348*^9, 
   3.615863913946679*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ScalarContractionDemoQ", "[", 
  RowBox[{
   RowBox[{
   "x2", "\[CircleTimes]", "x4", "\[CircleTimes]", "x5", "\[CircleTimes]", 
    "x6"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "14"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6158661662077*^9, 3.6158661989626637`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fdeg = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "5", ",", "6"}], "}"}]}],
  SequenceForm["fdeg = ", {2, 4, 5, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.615866199447934*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fpair = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}],
  SequenceForm["fpair = ", {{1, 1}, {2, 4}, {2, 4}}],
  Editable->False]], "Print",
 CellChangeTimes->{3.615866199593116*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"free = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}]}],
  SequenceForm["free = ", {2, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6158661995995283`*^9}]
}, Open  ]],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.6158661786860228`*^9, 3.615866199604741*^9}}]
}, Open  ]],

Cell["Timing ---  Flatten  vs  Apply[Sequence,#]&", "Text",
 CellChangeTimes->{{3.615850967013488*^9, 3.6158510389985523`*^9}, 
   3.615948368533243*^9}],

Cell["Flatten is 6x faster,", "Text",
 CellChangeTimes->{{3.6158510515745697`*^9, 3.6158510771270103`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Apply", "[", 
     RowBox[{"Sequence", ",", "#"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"8", ",", "16"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "18"}], "}"}]}], "}"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Flatten", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"8", ",", "16"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "18"}], "}"}]}], "}"}]}], "}"}], ",", "1"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.615850873501451*^9, 3.615850880831414*^9}, {
  3.615851087434287*^9, 3.61585109070135*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "18"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.615850881412559*^9, 3.6158510967205563`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "18"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.615850881412559*^9, 3.615851096727109*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"Sequence", ",", "#"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "6"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "5"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"8", ",", "16"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"10", ",", "18"}], "}"}]}], "}"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", "100000", "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.615850905683341*^9, 3.615850926529413*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.46802899999999997282529307085496839136`5.6908726769301925", ",", 
   "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.615850922182393*^9, 3.615850928019589*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "6"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "5"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"8", ",", "16"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"10", ",", "18"}], "}"}]}], "}"}]}], "}"}], ",", "1"}], 
     "]"}], ",", 
    RowBox[{"{", "100000", "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6158509386984167`*^9, 3.61585094325323*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.07200499999999999956035168224843800999`4.877962568002762", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{3.6158509454982843`*^9}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
----------------------------------------------
Pull out any scalar contractions. This is the rule that this whole section is \
about. The deg[ X ] test is to prevent a loop when the whole bracket \
expression 
evaluates to a scalar. The test checks that there are still some free slots,\
\>", "Text",
 CellChangeTimes->{{3.615847889907592*^9, 3.615847903844036*^9}, {
   3.6158630039935102`*^9, 3.6158630072735853`*^9}, {3.615869990258378*^9, 
   3.615870114007578*^9}, {3.615870150898171*^9, 3.615870175891148*^9}, 
   3.615936116367962*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", "X_CircleTimes", "\[RightAngleBracket]"}],
      "ab__List"], "/;", 
    RowBox[{
     RowBox[{
      RowBox[{"deg", "[", "X", "]"}], ">", 
      RowBox[{"2", 
       RowBox[{"Length", "[", 
        RowBox[{"{", "ab", "}"}], "]"}]}]}], "&&", 
     RowBox[{"ScalarContractionQ", "[", 
      RowBox[{"X", ",", 
       RowBox[{"{", "ab", "}"}]}], "]"}]}]}], ":=", 
   RowBox[{"SplitContraction", "[", 
    RowBox[{"X", ",", 
     RowBox[{"{", "ab", "}"}]}], "]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615847907488658*^9, 3.615847953274535*^9}, {
  3.615848061291314*^9, 3.615848079100595*^9}, {3.6158565831801043`*^9, 
  3.615856592763377*^9}, {3.61586289691665*^9, 3.6158629218111258`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "116", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
----------------------------------------------
We shall need to recalculate ab values after removing a set of slots. 
This function will be used to drop the slots that belong to the scalar part, \
to get the new ab for the tensor part.  
It is assumed (but not checked) that the slot numbers in arguments  ab  and  \
slots  are distinct, ie.,   IntersectingQ[ Flatten[ ab ],  slots ]  is  False .

Argument  ab  can be more general than a standard list of ab contraction \
pairs.  It is required only that the slot numbers in list  ab  appear at the \
same level.
Thus,  ab  can also be a list of groups of contraction pairs, or just a flat \
slot list. The returned value has the same nested list structure as the given \
 ab_List,\
\>", "Text",
 CellChangeTimes->{{3.615853596691881*^9, 3.6158536364693193`*^9}, 
   3.615853740069672*^9, {3.61585527249277*^9, 3.61585541764645*^9}, {
   3.6158702541154757`*^9, 3.615870281171679*^9}, {3.615870313396264*^9, 
   3.615870313876439*^9}, 3.615936341139454*^9, {3.615936677672325*^9, 
   3.615936766698269*^9}, {3.6159387689727507`*^9, 3.615938785667337*^9}, {
   3.6159467584288197`*^9, 3.61594687470263*^9}, {3.61594720872016*^9, 
   3.6159473998265953`*^9}, {3.615947435905858*^9, 3.615947760196504*^9}, {
   3.616039801821189*^9, 3.616039872460698*^9}}],

Cell["\<\
See  abDrop[ ]  for something similar that does not require use of  Range[ ], \
 so works with unknown deg.\
\>", "Text",
 CellChangeTimes->{{3.6538799381969357`*^9, 3.653879996916298*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"abAfterDroppingSlots", "[", 
   RowBox[{"ab_List", ",", "slots_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r", ",", "f"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ab", "===", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"Max", "[", "ab", "]"}], "]"}], ",", "slots"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"First", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"r", ",", "#"}], "]"}], "]"}], "]"}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{"f", ",", "ab", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Depth", "[", "ab", "]"}], "-", "1"}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615202162932757*^9, 3.61520242992185*^9}, {
   3.615202464865452*^9, 3.615202516899674*^9}, {3.61520274614734*^9, 
   3.615202746420107*^9}, {3.615202906995926*^9, 3.615202913716093*^9}, {
   3.615202996724972*^9, 3.615203000676445*^9}, {3.615203155460203*^9, 
   3.61520320720953*^9}, {3.615203246356481*^9, 3.615203256916791*^9}, {
   3.615203287957823*^9, 3.6152033835899878`*^9}, {3.6153295757602873`*^9, 
   3.61532960131345*^9}, {3.6157481303822308`*^9, 3.6157481336619062`*^9}, {
   3.615853748821352*^9, 3.615853788932905*^9}, {3.615853826081764*^9, 
   3.6158538616545553`*^9}, {3.615853911880237*^9, 3.615853949174371*^9}, 
   3.61585402124129*^9, {3.615854132152185*^9, 3.615854134969496*^9}, {
   3.615854346969996*^9, 3.615854370236499*^9}, {3.615854609687503*^9, 
   3.615854641599411*^9}, {3.615854933163744*^9, 3.615854959261951*^9}, {
   3.6158551552946787`*^9, 3.61585516991656*^9}, 3.6158552010986233`*^9, {
   3.615945203869306*^9, 3.615945227875032*^9}, {3.6159469066839046`*^9, 
   3.615946913610629*^9}, 3.6160397286133213`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "=."}], ";", 
  RowBox[{"f", "=."}], ";", 
  RowBox[{"d", "=", 
   RowBox[{"Depth", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"{", "a", "}"}], "}"}], "}"}], "}"}], "}"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"f", ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"{", "a", "}"}], "}"}], "}"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"d", "-", "1"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.615946650178932*^9, 3.615946688279697*^9}, {
  3.6159469709024067`*^9, 3.615947031690043*^9}}],

Cell[BoxData["6"], "Output",
 CellChangeTimes->{{3.615947020405521*^9, 3.615947035836651*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"f", "[", "a", "]"}], "}"}], "}"}], "}"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.615947020405521*^9, 3.6159470358431377`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"abAfterDroppingSlots", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{3.6159452385714006`*^9, 3.6159453640439997`*^9, 
  3.616039728663885*^9}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.615945241614325*^9, 3.615945368179584*^9, 
  3.6159469221612673`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"abAfterDroppingSlots", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "18"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.615855489167609*^9, 3.615855509816248*^9}, {
   3.615855579749096*^9, 3.615855585671794*^9}, 3.616039728691938*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "12"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.615855588878704*^9, 3.615946925089883*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"abAfterDroppingSlots", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "12"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "5", ",", "8", ",", "10", ",", "11"}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6158556138777037`*^9, 3.615855730713211*^9}, 
   3.61603972873028*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.615855646818159*^9, 3.615855731988596*^9, 
  3.615946927274207*^9}]
}, Open  ]],

Cell["Timing ---  First[First[ }}  vs  Part", "Text",
 CellChangeTimes->{{3.615854789418704*^9, 3.6158548130344963`*^9}, {
  3.6158548858240633`*^9, 3.6158548926195583`*^9}}],

Cell["First is 2x faster,", "Text",
 CellChangeTimes->{{3.615854863146379*^9, 3.615854871804922*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"First", "[", 
     RowBox[{"First", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3", ",", "4", ",", "6"}], "}"}], "}"}], "]"}], 
     "]"}], ",", 
    RowBox[{"{", "1000000", "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6158546930776863`*^9, 3.615854732225627*^9}, {
  3.615854835267538*^9, 3.615854841170671*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.37202400000000002133759835487580858171`5.591170871256554", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.615854726430994*^9, 3.615854733303608*^9}, 
   3.615854851389468*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"2", ",", "3", ",", "4", ",", "6"}], "}"}], "}"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"{", "1000000", "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.61585474627297*^9, 3.6158547525972433`*^9}, 
   3.6158548487309732`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.64403999999999994585664353508036583662`5.829512754614285", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{3.6158547544347887`*^9, 3.615854853880857*^9}]
}, Open  ]],

Cell["\<\
The first 5 lines of this fn are the same as those in  ConnectedContractions[ \
], 
(demo code -- not initialized)\
\>", "Text",
 CellChangeTimes->{{3.615848393862589*^9, 3.615848477319262*^9}, {
  3.6158558097593327`*^9, 3.615855817504072*^9}, {3.6158704040997763`*^9, 
  3.615870419526245*^9}}],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
----------------------------------------------
Recalculating  ab values for the scalar part is simpler.  In this case all \
slots except those listed in ab are to be dropped. So dropping those slots \
from Range
just leaves the  ab  slots. Thus,  in the above code for  \
abAfterDroppingSlots[ ]  we can set  r = Sort[Flatten[ ab ]].

Argument  ab  can be more general than a standard list of ab contraction \
pairs.  It is required only that the slot numbers in list  ab  appear at the \
same level.
Thus,  ab  can also be a list of groups of contraction pairs, or just a flat \
slot list.

This is the single argument version (no 2nd argument specifying which slots \
to drop -- assume all other slots),\
\>", "Text",
 CellChangeTimes->{{3.615853596691881*^9, 3.6158536364693193`*^9}, 
   3.615853740069672*^9, {3.61585527249277*^9, 3.61585541764645*^9}, {
   3.6158702541154757`*^9, 3.615870281171679*^9}, {3.615870313396264*^9, 
   3.615870313876439*^9}, 3.615936341139454*^9, {3.615936677672325*^9, 
   3.615936866442911*^9}, {3.615937007834773*^9, 3.615937142821409*^9}, {
   3.6159372052435703`*^9, 3.615937333853661*^9}, {3.6159373734688597`*^9, 
   3.615937376366377*^9}, {3.6159377967820053`*^9, 3.615937799263229*^9}, {
   3.615938265969141*^9, 3.6159382709306507`*^9}, {3.615938313233567*^9, 
   3.615938404449257*^9}, {3.615938828835717*^9, 3.6159388522941008`*^9}, {
   3.6159467466692743`*^9, 3.6159467500789557`*^9}, {3.615947269710897*^9, 
   3.615947281136216*^9}, 3.615947730178623*^9, {3.615947774769628*^9, 
   3.615947776451127*^9}, {3.61594790329982*^9, 3.6159479187891407`*^9}, 
   3.616039728779684*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"abAfterDroppingSlots", "[", "ab_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r", ",", "f"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"r", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"Flatten", "[", "ab", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"First", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"r", ",", "#"}], "]"}], "]"}], "]"}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{"f", ",", "ab", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Depth", "[", "ab", "]"}], "-", "1"}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615202162932757*^9, 3.61520242992185*^9}, {
   3.615202464865452*^9, 3.615202516899674*^9}, {3.61520274614734*^9, 
   3.615202746420107*^9}, {3.615202906995926*^9, 3.615202913716093*^9}, {
   3.615202996724972*^9, 3.615203000676445*^9}, {3.615203155460203*^9, 
   3.61520320720953*^9}, {3.615203246356481*^9, 3.615203256916791*^9}, {
   3.615203287957823*^9, 3.6152033835899878`*^9}, {3.6153295757602873`*^9, 
   3.61532960131345*^9}, {3.6157481303822308`*^9, 3.6157481336619062`*^9}, {
   3.615853748821352*^9, 3.615853788932905*^9}, {3.615853826081764*^9, 
   3.6158538616545553`*^9}, {3.615853911880237*^9, 3.615853949174371*^9}, 
   3.61585402124129*^9, {3.615854132152185*^9, 3.615854134969496*^9}, {
   3.615854346969996*^9, 3.615854370236499*^9}, {3.615854609687503*^9, 
   3.615854641599411*^9}, {3.615854933163744*^9, 3.615854959261951*^9}, {
   3.6158551552946787`*^9, 3.61585516991656*^9}, 3.6158552010986233`*^9, {
   3.615937154919862*^9, 3.615937177543172*^9}, 3.6159373266149807`*^9, {
   3.615937399959653*^9, 3.6159374063286533`*^9}, {3.615937786872129*^9, 
   3.615937790041252*^9}, {3.6159461163961782`*^9, 3.615946151124093*^9}, {
   3.615946279238274*^9, 3.615946286374789*^9}, {3.6159463509823008`*^9, 
   3.6159463524578543`*^9}, {3.6159469551617727`*^9, 3.61594695965928*^9}, 
   3.6160397288767033`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"abAfterDroppingSlots", "[", 
  RowBox[{"{", "}"}], "]"}]], "Input",
 CellChangeTimes->{3.616039728897573*^9}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.615947080449129*^9}]
}, Open  ]],

Cell["\<\
The single argument version of   abAfterDroppingSlots[ ]   is the  same (but \
faster) as setting the 2nd argument to be all slots not in ab,\
\>", "Text",
 CellChangeTimes->{
  3.615938236508304*^9, {3.615938287792652*^9, 3.6159382942907133`*^9}, {
   3.6159384241777277`*^9, 3.615938424962963*^9}, {3.6159388659716787`*^9, 
   3.61593886960569*^9}, {3.615947174319234*^9, 3.615947175536985*^9}, 
   3.616039728939474*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"abAfterDroppingSlots", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "6"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"8", ",", "16"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"10", ",", "18"}], "}"}]}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"abAfterDroppingSlots", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "18"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4", ",", "5", ",", "7", ",", "9", ",", "11", ",", "12", ",", "13", ",", 
     "14", ",", "15", ",", "17"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.615938189656352*^9, 3.615938205045676*^9}, {
  3.615938251988109*^9, 3.6159382555048943`*^9}, {3.616039729076038*^9, 
  3.616039729097053*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "8"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6159382228190317`*^9, 3.615938274827034*^9, 
  3.615947095402247*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "8"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6159382228190317`*^9, 3.615938274827034*^9, 
  3.615947095415311*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"abAfterDroppingSlots", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "6"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"8", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "18"}], "}"}]}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.615947953607657*^9, 3.615947969243289*^9}, 
   3.616039729134398*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "8"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.615947964025247*^9}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
----------------------------------------------
The RHS of the angle-bracket contraction rule. 
The variable names with  0, 1,  correspond to scalar and tensor parts,\
\>", "Text",
 CellChangeTimes->{{3.615936362295128*^9, 3.615936429754478*^9}, {
  3.615938666919756*^9, 3.61593867107502*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "SplitContractionDemo", "]"}]], "Input",
 CellChangeTimes->{{3.615938979005549*^9, 3.615938993753749*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SplitContraction", "[", 
   RowBox[{"X_CircleTimes", ",", "ab_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "fpair", ",", "fdeg", ",", "fgrp", ",", "fgrp0", ",", "TorF", ",", 
      "abgrps", ",", "abgrps0", ",", "free", ",", "free0", ",", "X0", ",", 
      "scalar", ",", "ftensor", ",", "Xtensor", ",", "abgrps1", ",", "ab0New",
       ",", "ab1New"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fdeg", "=", 
      RowBox[{"FactorDegrees", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"fpair", "=", 
      RowBox[{"FactorPairs", "[", 
       RowBox[{"fdeg", ",", "ab"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fgrp", "=", 
      RowBox[{"Apply", "[", 
       RowBox[{"List", ",", 
        RowBox[{"Apply", "[", 
         RowBox[{"ConnectedFactors", ",", "fpair"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"TorF", "=", 
      RowBox[{"Outer", "[", 
       RowBox[{"IntersectingQ", ",", "fgrp", ",", "fpair", ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"abgrps", " ", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Pick", "[", 
          RowBox[{"ab", ",", "#"}], "]"}], "&"}], ",", "TorF"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"free", " ", "=", " ", 
      RowBox[{
       RowBox[{"FactorGroupDegree", "[", 
        RowBox[{"fdeg", ",", "fgrp"}], "]"}], "-", 
       RowBox[{"2", 
        RowBox[{"CountContractions", "[", 
         RowBox[{"fpair", ",", "fgrp"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"free0", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "===", "0"}], ")"}], "&"}], ",", "free"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"abgrps0", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"abgrps", ",", "free0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"abgrps1", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"abgrps", ",", 
        RowBox[{"Map", "[", 
         RowBox[{"Not", ",", "free0"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ab0New", "=", 
      RowBox[{"abAfterDroppingSlots", "[", "abgrps0", "]"}]}], ";", 
     RowBox[{"ab1New", "=", 
      RowBox[{"abAfterDroppingSlots", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"abgrps1", ",", "1"}], "]"}], ",", 
        RowBox[{"Flatten", "[", "abgrps0", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fgrp0", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"fgrp", ",", "free0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"X0", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", "fgrp0"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"scalar", "=", 
      RowBox[{"Apply", "[", 
       RowBox[{"Times", ",", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox[
            RowBox[{"\[LeftAngleBracket]", "#1", "\[RightAngleBracket]"}], 
            RowBox[{"Apply", "[", 
             RowBox[{"Sequence", ",", "#2"}], "]"}]], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"X0", ",", "ab0New"}], "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ftensor", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "X", "]"}], "]"}], ",", 
        RowBox[{"Apply", "[", 
         RowBox[{"Sequence", ",", "fgrp0"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Xtensor", "=", " ", 
      RowBox[{"X", "[", 
       RowBox[{"[", " ", "ftensor", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ab1New", "===", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"scalar", " ", "Xtensor"}], ",", "\[IndentingNewLine]", 
       RowBox[{"scalar", 
        SubscriptBox[
         RowBox[{"\[LeftAngleBracket]", "Xtensor", "\[RightAngleBracket]"}], 
         RowBox[{"Apply", "[", 
          RowBox[{"Sequence", ",", "ab1New"}], "]"}]]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615808483330015*^9, 3.615808484309911*^9}, {
   3.615810009804249*^9, 3.6158100664286833`*^9}, {3.61581022265466*^9, 
   3.6158102882407722`*^9}, 3.6158103323691807`*^9, {3.615810431441476*^9, 
   3.6158104316656027`*^9}, {3.615810843379188*^9, 3.6158108774290533`*^9}, {
   3.615811041543393*^9, 3.6158110625206203`*^9}, {3.6158365095776978`*^9, 
   3.615836603432899*^9}, {3.615836666566042*^9, 3.615836669928461*^9}, {
   3.615837275417725*^9, 3.615837372251981*^9}, {3.615837473135066*^9, 
   3.6158376174579477`*^9}, {3.615837693698452*^9, 3.6158377743420677`*^9}, {
   3.6158401481156282`*^9, 3.6158402791263237`*^9}, 3.615842573605254*^9, {
   3.615842637044671*^9, 3.615842665751348*^9}, 3.615842781763567*^9, {
   3.615848346645183*^9, 3.6158483806796627`*^9}, {3.615848666774355*^9, 
   3.615848694264853*^9}, 3.615848726262145*^9, {3.615848756347116*^9, 
   3.615848780830516*^9}, {3.61584881235104*^9, 3.6158488376123943`*^9}, {
   3.615848869198429*^9, 3.615848872539442*^9}, {3.615848919707097*^9, 
   3.615848998589117*^9}, 3.615849056894621*^9, {3.615849094193913*^9, 
   3.615849098286461*^9}, {3.615849163265307*^9, 3.6158491865613823`*^9}, {
   3.615849223188822*^9, 3.6158492733124533`*^9}, {3.615849350740885*^9, 
   3.615849358272027*^9}, {3.6158494028489532`*^9, 3.615849516151473*^9}, {
   3.615849793721332*^9, 3.615849820975753*^9}, {3.6158498780769*^9, 
   3.615850019915175*^9}, {3.6158501382063932`*^9, 3.615850259745359*^9}, {
   3.615850414289064*^9, 3.6158504299012003`*^9}, {3.615850461373564*^9, 
   3.6158504906742163`*^9}, {3.615850535922145*^9, 3.615850542832406*^9}, {
   3.6158513248223867`*^9, 3.615851331798399*^9}, {3.6158513672416*^9, 
   3.6158514736426477`*^9}, {3.615851589881298*^9, 3.615851593706388*^9}, {
   3.615855854573975*^9, 3.6158559022581167`*^9}, {3.615855970001313*^9, 
   3.6158560053248863`*^9}, {3.615856836871401*^9, 3.615857072920595*^9}, {
   3.615857108281213*^9, 3.615857109176339*^9}, {3.6158572800909758`*^9, 
   3.6158572874086447`*^9}, {3.615861176054838*^9, 3.6158611801307297`*^9}, {
   3.615872955365279*^9, 3.615873013522193*^9}, {3.615873593834558*^9, 
   3.615873608944668*^9}, {3.615873882244596*^9, 3.615873910975409*^9}, {
   3.615873952270307*^9, 3.6158740185123034`*^9}, 3.6158740522578993`*^9, {
   3.615874110261504*^9, 3.615874137556477*^9}, {3.615874225652007*^9, 
   3.615874264709825*^9}, {3.615874354751473*^9, 3.6158744214631987`*^9}, 
   3.615874454079077*^9, 3.615934857642398*^9, {3.615935467001904*^9, 
   3.615935491164269*^9}, {3.6159355330530863`*^9, 3.615935619579915*^9}, {
   3.615938488586214*^9, 3.615938500873918*^9}, {3.615938545660069*^9, 
   3.6159385561143637`*^9}, 3.615938637272002*^9, {3.6159478361081142`*^9, 
   3.6159478391141167`*^9}, {3.6160397291491823`*^9, 3.6160397291641293`*^9}}],

Cell["\<\
As above but with Print[ ]. The variable names with  0, 1,  correspond to \
scalar and tensor parts,\
\>", "Text",
 CellChangeTimes->{{3.615861124141883*^9, 3.615861140750369*^9}, {
   3.615935342305593*^9, 3.615935404050976*^9}, 3.615938656895941*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SplitContractionDemo", "[", 
   RowBox[{"X_CircleTimes", ",", "ab_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "fpair", ",", "fdeg", ",", "fgrp", ",", "fgrp0", ",", "TorF", ",", 
      "abgrps", ",", "abgrps0", ",", "free", ",", "free0", ",", "X0", ",", 
      "scalar", ",", "ftensor", ",", "Xtensor", ",", "abgrps1", ",", "ab0New",
       ",", "ab1New"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fdeg", "=", 
      RowBox[{"FactorDegrees", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Print", "[", 
      RowBox[{"\"\<fdeg = \>\"", ",", "fdeg"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fpair", "=", 
      RowBox[{"FactorPairs", "[", 
       RowBox[{"fdeg", ",", "ab"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<fpair = \>\"", ",", "fpair"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fgrp", "=", 
      RowBox[{"Apply", "[", 
       RowBox[{"List", ",", 
        RowBox[{"Apply", "[", 
         RowBox[{"ConnectedFactors", ",", "fpair"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<fgrp = \>\"", ",", "fgrp"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"TorF", "=", 
      RowBox[{"Outer", "[", 
       RowBox[{"IntersectingQ", ",", "fgrp", ",", "fpair", ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<TorF = \>\"", ",", "TorF"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"abgrps", " ", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Pick", "[", 
          RowBox[{"ab", ",", "#"}], "]"}], "&"}], ",", "TorF"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<abgrps = \>\"", ",", "abgrps"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"free", " ", "=", " ", 
      RowBox[{
       RowBox[{"FactorGroupDegree", "[", 
        RowBox[{"fdeg", ",", "fgrp"}], "]"}], "-", 
       RowBox[{"2", 
        RowBox[{"CountContractions", "[", 
         RowBox[{"fpair", ",", "fgrp"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<free = \>\"", ",", "free"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"free0", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "===", "0"}], ")"}], "&"}], ",", "free"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<free0 = \>\"", ",", "free0"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"abgrps0", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"abgrps", ",", "free0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"Print", "[", 
      RowBox[{"\"\<abgrps0 = \>\"", ",", "abgrps0"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"abgrps1", "=", " ", 
      RowBox[{"Pick", "[", 
       RowBox[{"abgrps", ",", 
        RowBox[{"Map", "[", 
         RowBox[{"Not", ",", "free0"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<abgrps1 = \>\"", ",", "abgrps1"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ab0New", "=", 
      RowBox[{"abAfterDroppingSlots", "[", "abgrps0", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ab0New = \>\"", ",", "ab0New"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ab1New", "=", 
      RowBox[{"abAfterDroppingSlots", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"abgrps1", ",", "1"}], "]"}], ",", 
        RowBox[{"Flatten", "[", "abgrps0", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Flatten[abgrps1,1] = \>\"", ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"abgrps1", ",", "1"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Flatten[abgrps0] = \>\"", ",", 
       RowBox[{"Flatten", "[", "abgrps0", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ab1New = \>\"", ",", "ab1New"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fgrp0", "=", 
      RowBox[{"Pick", "[", 
       RowBox[{"fgrp", ",", "free0"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<fgrp0 = \>\"", ",", "fgrp0"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"X0", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], ",", "fgrp0"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<X0 = \>\"", ",", "X0"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"scalar", "=", 
      RowBox[{"Apply", "[", 
       RowBox[{"Times", ",", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox[
            RowBox[{"\[LeftAngleBracket]", "#1", "\[RightAngleBracket]"}], 
            RowBox[{"Apply", "[", 
             RowBox[{"Sequence", ",", "#2"}], "]"}]], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"X0", ",", "ab0New"}], "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<scalar = \>\"", ",", "scalar"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ftensor", "=", 
      RowBox[{"Complement", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "X", "]"}], "]"}], ",", 
        RowBox[{"Apply", "[", 
         RowBox[{"Sequence", ",", "fgrp0"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ftensor = \>\"", ",", "ftensor"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Xtensor", "=", " ", 
      RowBox[{"X", "[", 
       RowBox[{"[", " ", "ftensor", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Xtensor = \>\"", ",", "Xtensor"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ab1New", "===", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"scalar", " ", "Xtensor"}], ",", "\[IndentingNewLine]", 
       RowBox[{"scalar", 
        SubscriptBox[
         RowBox[{"\[LeftAngleBracket]", "Xtensor", "\[RightAngleBracket]"}], 
         RowBox[{"Apply", "[", 
          RowBox[{"Sequence", ",", "ab1New"}], "]"}]]}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.615808483330015*^9, 3.615808484309911*^9}, {
   3.615810009804249*^9, 3.6158100664286833`*^9}, {3.61581022265466*^9, 
   3.6158102882407722`*^9}, 3.6158103323691807`*^9, {3.615810431441476*^9, 
   3.6158104316656027`*^9}, {3.615810843379188*^9, 3.6158108774290533`*^9}, {
   3.615811041543393*^9, 3.6158110625206203`*^9}, {3.6158365095776978`*^9, 
   3.615836603432899*^9}, {3.615836666566042*^9, 3.615836669928461*^9}, {
   3.615837275417725*^9, 3.615837372251981*^9}, {3.615837473135066*^9, 
   3.6158376174579477`*^9}, {3.615837693698452*^9, 3.6158377743420677`*^9}, {
   3.6158401481156282`*^9, 3.6158402791263237`*^9}, 3.615842573605254*^9, {
   3.615842637044671*^9, 3.615842665751348*^9}, 3.615842781763567*^9, {
   3.615848346645183*^9, 3.6158483806796627`*^9}, {3.615848666774355*^9, 
   3.615848694264853*^9}, 3.615848726262145*^9, {3.615848756347116*^9, 
   3.615848780830516*^9}, {3.61584881235104*^9, 3.6158488376123943`*^9}, {
   3.615848869198429*^9, 3.615848872539442*^9}, {3.615848919707097*^9, 
   3.615848998589117*^9}, 3.615849056894621*^9, {3.615849094193913*^9, 
   3.615849098286461*^9}, {3.615849163265307*^9, 3.6158491865613823`*^9}, {
   3.615849223188822*^9, 3.6158492733124533`*^9}, {3.615849350740885*^9, 
   3.615849358272027*^9}, {3.6158494028489532`*^9, 3.615849516151473*^9}, {
   3.615849793721332*^9, 3.615849820975753*^9}, {3.6158498780769*^9, 
   3.615850019915175*^9}, {3.6158501382063932`*^9, 3.615850259745359*^9}, {
   3.615850414289064*^9, 3.6158504299012003`*^9}, {3.615850461373564*^9, 
   3.6158504906742163`*^9}, {3.615850535922145*^9, 3.615850542832406*^9}, {
   3.6158513248223867`*^9, 3.615851331798399*^9}, {3.6158513672416*^9, 
   3.6158514736426477`*^9}, {3.615851589881298*^9, 3.615851593706388*^9}, {
   3.615855854573975*^9, 3.6158559022581167`*^9}, {3.615855970001313*^9, 
   3.6158560053248863`*^9}, {3.615856836871401*^9, 3.615857072920595*^9}, {
   3.615857108281213*^9, 3.615857109176339*^9}, {3.6158572800909758`*^9, 
   3.6158572874086447`*^9}, {3.615861176054838*^9, 3.6158611801307297`*^9}, {
   3.615872955365279*^9, 3.615873013522193*^9}, {3.615873593834558*^9, 
   3.615873608944668*^9}, {3.615873882244596*^9, 3.615873910975409*^9}, {
   3.615873952270307*^9, 3.6158740185123034`*^9}, 3.6158740522578993`*^9, {
   3.615874110261504*^9, 3.615874137556477*^9}, {3.615874225652007*^9, 
   3.615874264709825*^9}, {3.615874354751473*^9, 3.6158744214631987`*^9}, 
   3.615874454079077*^9, 3.615934857642398*^9, {3.615935467001904*^9, 
   3.615935491164269*^9}, {3.6159355330530863`*^9, 3.615935619579915*^9}, {
   3.615938488586214*^9, 3.615938500873918*^9}, {3.615938545660069*^9, 
   3.6159385561143637`*^9}, {3.615938644609151*^9, 3.6159386453607073`*^9}, {
   3.615944160256733*^9, 3.615944202130781*^9}, {3.6159442782507877`*^9, 
   3.615944416479594*^9}, {3.615944472382556*^9, 3.615944504897334*^9}, {
   3.615944552512926*^9, 3.615944582307914*^9}, {3.61594462140639*^9, 
   3.6159446702061462`*^9}, {3.615947866775002*^9, 3.615947870171801*^9}, {
   3.616039729178829*^9, 3.616039729185162*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SplitContractionDemo", "[", 
  RowBox[{
   RowBox[{
   "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
    "x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "18"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.615851482650519*^9, 3.6158515050735598`*^9}, {
  3.615857115076681*^9, 3.615857115985097*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fdeg = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}]}],
  SequenceForm["fdeg = ", {1, 2, 3, 4, 5, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.615857087092375*^9, 3.615857117483583*^9}, 
   3.615857334206931*^9, 3.615867301467544*^9, 3.615945480909931*^9, 
   3.6159455512005243`*^9, 3.615948126412827*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fpair = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6"}], "}"}]}], "}"}]}],
  SequenceForm["fpair = ", {{1, 2}, {2, 3}, {3, 3}, {4, 6}, {4, 6}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.615857087092375*^9, 3.615857117483583*^9}, 
   3.615857334206931*^9, 3.615867301467544*^9, 3.615945480909931*^9, 
   3.6159455512005243`*^9, 3.615948126425366*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fgrp = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6"}], "}"}]}], "}"}]}],
  SequenceForm["fgrp = ", {{1, 2, 3}, {4, 6}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.615857087092375*^9, 3.615857117483583*^9}, 
   3.615857334206931*^9, 3.615867301467544*^9, 3.615945480909931*^9, 
   3.6159455512005243`*^9, 3.615948126431375*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"TorF = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"True", ",", "True", ",", "True", ",", "False", ",", "False"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"False", ",", "False", ",", "False", ",", "True", ",", "True"}],
       "}"}]}], "}"}]}],
  SequenceForm[
  "TorF = ", {{True, True, True, False, False}, {
    False, False, False, True, True}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.615857087092375*^9, 3.615857117483583*^9}, 
   3.615857334206931*^9, 3.615867301467544*^9, 3.615945480909931*^9, 
   3.6159455512005243`*^9, 3.615948126437194*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"abgrps = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"8", ",", "16"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "18"}], "}"}]}], "}"}]}], "}"}]}],
  SequenceForm["abgrps = ", {{{1, 2}, {3, 6}, {4, 5}}, {{8, 16}, {10, 18}}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.615857087092375*^9, 3.615857117483583*^9}, 
   3.615857334206931*^9, 3.615867301467544*^9, 3.615945480909931*^9, 
   3.6159455512005243`*^9, 3.615948126442773*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"free = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "6"}], "}"}]}],
  SequenceForm["free = ", {0, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.615857087092375*^9, 3.615857117483583*^9}, 
   3.615857334206931*^9, 3.615867301467544*^9, 3.615945480909931*^9, 
   3.6159455512005243`*^9, 3.615948126453245*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"free0 = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"True", ",", "False"}], "}"}]}],
  SequenceForm["free0 = ", {True, False}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.615857087092375*^9, 3.615857117483583*^9}, 
   3.615857334206931*^9, 3.615867301467544*^9, 3.615945480909931*^9, 
   3.6159455512005243`*^9, 3.615948126465095*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"abgrps0 = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}]}], "}"}], "}"}]}],
  SequenceForm["abgrps0 = ", {{{1, 2}, {3, 6}, {4, 5}}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.615857087092375*^9, 3.615857117483583*^9}, 
   3.615857334206931*^9, 3.615867301467544*^9, 3.615945480909931*^9, 
   3.6159455512005243`*^9, 3.615948126476501*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"abgrps1 = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"8", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "18"}], "}"}]}], "}"}], "}"}]}],
  SequenceForm["abgrps1 = ", {{{8, 16}, {10, 18}}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.615857087092375*^9, 3.615857117483583*^9}, 
   3.615857334206931*^9, 3.615867301467544*^9, 3.615945480909931*^9, 
   3.6159455512005243`*^9, 3.615948126486178*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ab0New = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}]}], "}"}], "}"}]}],
  SequenceForm["ab0New = ", {{{1, 2}, {3, 6}, {4, 5}}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.615857087092375*^9, 3.615857117483583*^9}, 
   3.615857334206931*^9, 3.615867301467544*^9, 3.615945480909931*^9, 
   3.6159455512005243`*^9, 3.615948126494012*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Flatten[abgrps1,1] = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "18"}], "}"}]}], "}"}]}],
  SequenceForm["Flatten[abgrps1,1] = ", {{8, 16}, {10, 18}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.615857087092375*^9, 3.615857117483583*^9}, 
   3.615857334206931*^9, 3.615867301467544*^9, 3.615945480909931*^9, 
   3.6159455512005243`*^9, 3.615948126505327*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Flatten[abgrps0] = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "6", ",", "4", ",", "5"}], "}"}]}],
  SequenceForm["Flatten[abgrps0] = ", {1, 2, 3, 6, 4, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.615857087092375*^9, 3.615857117483583*^9}, 
   3.615857334206931*^9, 3.615867301467544*^9, 3.615945480909931*^9, 
   3.6159455512005243`*^9, 3.6159481265166187`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ab1New = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "12"}], "}"}]}], "}"}]}],
  SequenceForm["ab1New = ", {{2, 10}, {4, 12}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.615857087092375*^9, 3.615857117483583*^9}, 
   3.615857334206931*^9, 3.615867301467544*^9, 3.615945480909931*^9, 
   3.6159455512005243`*^9, 3.615948126527947*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"fgrp0 = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3"}], "}"}], "}"}]}],
  SequenceForm["fgrp0 = ", {{1, 2, 3}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.615857087092375*^9, 3.615857117483583*^9}, 
   3.615857334206931*^9, 3.615867301467544*^9, 3.615945480909931*^9, 
   3.6159455512005243`*^9, 3.615948126539139*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"X0 = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3"}], "}"}]}],
  SequenceForm["X0 = ", {
    CircleTimes[$CellContext`x1, $CellContext`x2, $CellContext`x3]}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.615857087092375*^9, 3.615857117483583*^9}, 
   3.615857334206931*^9, 3.615867301467544*^9, 3.615945480909931*^9, 
   3.6159455512005243`*^9, 3.6159481265509*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"scalar = \"\>", "\[InvisibleSpace]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"x3", ",", 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"x1", ",", "x2"}], "\[RightAngleBracket]"}]}], 
      "\[RightAngleBracket]"}], "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]]}],
  SequenceForm["scalar = ", 
   Subscript[
    AngleBracket[
     AngleBracket[$CellContext`x3, 
      AngleBracket[$CellContext`x1, $CellContext`x2]]], {1, 2}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.615857087092375*^9, 3.615857117483583*^9}, 
   3.615857334206931*^9, 3.615867301467544*^9, 3.615945480909931*^9, 
   3.6159455512005243`*^9, 3.615948126562416*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ftensor = \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5", ",", "6"}], "}"}]}],
  SequenceForm["ftensor = ", {4, 5, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.615857087092375*^9, 3.615857117483583*^9}, 
   3.615857334206931*^9, 3.615867301467544*^9, 3.615945480909931*^9, 
   3.6159455512005243`*^9, 3.615948126572541*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Xtensor = \"\>", "\[InvisibleSpace]", 
   RowBox[{"x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}]}],
  SequenceForm["Xtensor = ", 
   CircleTimes[$CellContext`x4, $CellContext`x5, $CellContext`x6]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.615857087092375*^9, 3.615857117483583*^9}, 
   3.615857334206931*^9, 3.615867301467544*^9, 3.615945480909931*^9, 
   3.6159455512005243`*^9, 3.61594812657874*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"x3", ",", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"x1", ",", "x2"}], "\[RightAngleBracket]"}]}], 
     "\[RightAngleBracket]"}], "\[RightAngleBracket]"}], 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]], " ", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}], 
    "\[RightAngleBracket]"}], 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "10"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "12"}], "}"}]}]]}]], "Output",
 CellChangeTimes->{
  3.6158515065378857`*^9, {3.6158560243892107`*^9, 3.615856032078287*^9}, {
   3.615857087181982*^9, 3.61585711755837*^9}, 3.6158573343032713`*^9, 
   3.6158673015603437`*^9, 3.6159454818700523`*^9, 3.6159455513267803`*^9, 
   3.615948126584312*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
    "x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "18"}], "}"}]}]]], "Input"],

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"x3", ",", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"x1", ",", "x2"}], "\[RightAngleBracket]"}]}], 
     "\[RightAngleBracket]"}], "\[RightAngleBracket]"}], 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]], " ", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}], 
    "\[RightAngleBracket]"}], 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "10"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "12"}], "}"}]}]]}]], "Output",
 CellChangeTimes->{3.615945656906797*^9, 3.615945730427512*^9, 
  3.615948168810546*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "x2", "\[CircleTimes]", "x4", "\[CircleTimes]", "x5", "\[CircleTimes]", 
    "x6"}], "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "14"}], "}"}]}]]], "Input",
 CellChangeTimes->{{3.6158643494636497`*^9, 3.615864350090268*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", "x2", "\[RightAngleBracket]"}], 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]], " ", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}], 
    "\[RightAngleBracket]"}], 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "10"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "12"}], "}"}]}]]}]], "Output",
 CellChangeTimes->{
  3.6158643518380337`*^9, {3.615866119223104*^9, 3.61586612361865*^9}, 
   3.615867144213271*^9, 3.6159481755442944`*^9}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
----------------------------------------------\
\>", "Text",
 CellChangeTimes->{{3.615936168007399*^9, 3.6159361822102833`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Timing --- rule ordering", "Subsubsection",
 CellChangeTimes->{{3.615867807412732*^9, 3.615867821925868*^9}, 
   3.615868223559455*^9, {3.615869511070319*^9, 3.615869511873081*^9}, 
   3.655574271648656*^9}],

Cell["\<\

It is faster to pull out scalar factors before simplifying them.  Need to get \
the rules in correct order,\
\>", "Text",
 CellChangeTimes->{{3.615867850693074*^9, 3.615867899816052*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"UnsetRule", "[", "234", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ResetRule", "[", "234", "]"}]}], "Input",
 CellChangeTimes->{{3.6158641392999067`*^9, 3.615864149305551*^9}, {
  3.6158677849849577`*^9, 3.6158677880934963`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "234", "]"}]], "Output",
 CellChangeTimes->{3.6158679097569723`*^9}]
}, Open  ]],

Cell["\<\
Scalar is pulled out before it is simplified to comma contraction form,\
\>", "Text",
 CellChangeTimes->{{3.615868036678132*^9, 3.615868070439423*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"UnsetRule", "[", 
  RowBox[{"{", 
   RowBox[{"56", ",", "57"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"ResetRule", "[", 
  RowBox[{"{", 
   RowBox[{"56", ",", "57"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"StartDebug", "[", "]"}], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
    "x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "18"}], "}"}]}]]}], "Input",
 CellChangeTimes->{{3.6158676201089573`*^9, 3.6158676338076677`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Null", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.615867377828504*^9, 3.6158676397735777`*^9, 
  3.615867916701857*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"rule", "[", "56", "]"}], ",", 
   RowBox[{"rule", "[", "57", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.615867377828504*^9, 3.6158676397735777`*^9, 
  3.615867916709721*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]234\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{
      "\[LeftAngleBracket]", "X_CircleTimes", "\[RightAngleBracket]"}], 
      "ab__List"], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"deg", "[", "X", "]"}], ">", 
       RowBox[{"2", " ", 
        RowBox[{"Length", "[", 
         RowBox[{"{", "ab", "}"}], "]"}]}]}], "&&", 
      RowBox[{"ScalarContractionQ", "[", 
       RowBox[{"X", ",", 
        RowBox[{"{", "ab", "}"}]}], "]"}]}]}], ":=", 
    RowBox[{"SplitContraction", "[", 
     RowBox[{"X", ",", 
      RowBox[{"{", "ab", "}"}]}], "]"}]}]}],
  SequenceForm["rule[\[VeryThinSpace]234\[VeryThinSpace]]:", "  ", 
   Defer[Condition[
      Subscript[
       AngleBracket[
        Pattern[$CellContext`X, 
         Blank[CircleTimes]]], 
       Pattern[$CellContext`ab, 
        BlankSequence[List]]], 
      And[$CellContext`deg[$CellContext`X] > 2 Length[{$CellContext`ab}], 
       $CellContext`ScalarContractionQ[$CellContext`X, {$CellContext`ab}]]] := \
$CellContext`SplitContraction[$CellContext`X, {$CellContext`ab}]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.615867377836388*^9, 3.615867639794845*^9, 
  3.615867916718651*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"SplitContraction", "[", 
     RowBox[{
      RowBox[{
      "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
       "x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8", ",", "16"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"10", ",", "18"}], "}"}]}], "}"}]}], "]"}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    $CellContext`SplitContraction[
     CircleTimes[$CellContext`x1, $CellContext`x2, $CellContext`x3, \
$CellContext`x4, $CellContext`x5, $CellContext`x6], {{1, 2}, {3, 6}, {4, 5}, {
     8, 16}, {10, 18}}]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.615867377836388*^9, 3.615867639794845*^9, 
  3.615867916889839*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]56\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"Y1___", "\[CircleTimes]", 
        RowBox[{"v_", "?", "deg1Q"}], "\[CircleTimes]", "Y2___", 
        "\[CircleTimes]", "X_", "\[CircleTimes]", "Y3___"}], 
       "\[RightAngleBracket]"}], "ab__List"], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "ab", "}"}], "]"}], ">", "1"}], "&&", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", "ab", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"deg", "[", "Y1", "]"}], "+", 
           RowBox[{"deg", "[", "Y2", "]"}], "+", "2"}]}], "}"}]}], "]"}]}]}], 
    ":=", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1", "\[CircleTimes]", "Y2", "\[CircleTimes]", 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"v", ",", "X"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
       "Y3"}], "\[RightAngleBracket]"}], 
     RowBox[{"abDrop", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", 
          RowBox[{"deg", "[", "Y2", "]"}], "+", "2"}]}], "}"}]}], "]"}]]}]}],
  SequenceForm["rule[\[VeryThinSpace]56\[VeryThinSpace]]:", "  ", 
   Defer[Condition[
      Subscript[
       AngleBracket[
        CircleTimes[
         Pattern[$CellContext`Y1, 
          BlankNullSequence[]], 
         PatternTest[
          Pattern[$CellContext`v, 
           Blank[]], $CellContext`deg1Q], 
         Pattern[$CellContext`Y2, 
          BlankNullSequence[]], 
         Pattern[$CellContext`X, 
          Blank[]], 
         Pattern[$CellContext`Y3, 
          BlankNullSequence[]]]], 
       Pattern[$CellContext`ab, 
        BlankSequence[List]]], 
      And[Length[{$CellContext`ab}] > 1, 
       MemberQ[{$CellContext`ab}, {$CellContext`deg[$CellContext`Y1] + 
         1, $CellContext`deg[$CellContext`Y1] + \
$CellContext`deg[$CellContext`Y2] + 2}]]] := Subscript[
      AngleBracket[
       CircleTimes[$CellContext`Y1, $CellContext`Y2, 
        AngleBracket[$CellContext`v, $CellContext`X], $CellContext`Y3]], 
      $CellContext`abDrop[{$CellContext`ab}, \
{$CellContext`deg[$CellContext`Y1] + 
        1, $CellContext`deg[$CellContext`Y1] + \
$CellContext`deg[$CellContext`Y2] + 2}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.615867377836388*^9, 3.615867639794845*^9, 
  3.6158679168987827`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"x1", ",", "x2"}], "\[RightAngleBracket]"}], "\[CircleTimes]",
        "x3"}], "\[RightAngleBracket]"}], 
     RowBox[{"abDrop", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "5"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"deg", "[", "]"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"deg", "[", "]"}], "+", 
          RowBox[{"deg", "[", "]"}], "+", "2"}]}], "}"}]}], "]"}]],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Subscript[
     AngleBracket[
      CircleTimes[
       AngleBracket[$CellContext`x1, $CellContext`x2], $CellContext`x3]], 
     $CellContext`abDrop[{{1, 2}, {3, 6}, {4, 
      5}}, {$CellContext`deg[] + 1, $CellContext`deg[] + $CellContext`deg[] + 
       2}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.615867377836388*^9, 3.615867639794845*^9, 
  3.615867916904346*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]1\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"\[CircleTimes]", "v_"}], ":=", "v"}]}],
  SequenceForm["rule[\[VeryThinSpace]1\[VeryThinSpace]]:", "  ", 
   Defer[CircleTimes[
      Pattern[$CellContext`v, 
       Blank[]]] := $CellContext`v]],
  Editable->False]], "Print",
 CellChangeTimes->{3.615867377836388*^9, 3.615867639794845*^9, 
  3.6158679169105873`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"x1", ",", "x2"}], "\[RightAngleBracket]"}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    AngleBracket[$CellContext`x1, $CellContext`x2]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.615867377836388*^9, 3.615867639794845*^9, 
  3.615867917075781*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]57\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"Y1___", "\[CircleTimes]", 
        RowBox[{"v_", "?", "deg1Q"}], "\[CircleTimes]", "Y2___", 
        "\[CircleTimes]", "X_", "\[CircleTimes]", "Y3___"}], 
       "\[RightAngleBracket]"}], "ab__List"], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "ab", "}"}], "]"}], ">", "1"}], "&&", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", "ab", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"deg", "[", "Y1", "]"}], "+", 
           RowBox[{"deg", "[", "Y2", "]"}], "+", 
           RowBox[{"deg", "[", "X", "]"}], "+", "1"}]}], "}"}]}], "]"}]}]}], ":=", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1", "\[CircleTimes]", "Y2", "\[CircleTimes]", 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"X", ",", "v"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
       "Y3"}], "\[RightAngleBracket]"}], 
     RowBox[{"abDrop", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", 
          RowBox[{"deg", "[", "Y2", "]"}], "+", 
          RowBox[{"deg", "[", "X", "]"}], "+", "1"}]}], "}"}]}], "]"}]]}]}],
  SequenceForm["rule[\[VeryThinSpace]57\[VeryThinSpace]]:", "  ", 
   Defer[Condition[
      Subscript[
       AngleBracket[
        CircleTimes[
         Pattern[$CellContext`Y1, 
          BlankNullSequence[]], 
         PatternTest[
          Pattern[$CellContext`v, 
           Blank[]], $CellContext`deg1Q], 
         Pattern[$CellContext`Y2, 
          BlankNullSequence[]], 
         Pattern[$CellContext`X, 
          Blank[]], 
         Pattern[$CellContext`Y3, 
          BlankNullSequence[]]]], 
       Pattern[$CellContext`ab, 
        BlankSequence[List]]], 
      And[Length[{$CellContext`ab}] > 1, 
       MemberQ[{$CellContext`ab}, {$CellContext`deg[$CellContext`Y1] + 
         1, $CellContext`deg[$CellContext`Y1] + \
$CellContext`deg[$CellContext`Y2] + $CellContext`deg[$CellContext`X] + 1}]]] := 
    Subscript[
      AngleBracket[
       CircleTimes[$CellContext`Y1, $CellContext`Y2, 
        AngleBracket[$CellContext`X, $CellContext`v], $CellContext`Y3]], 
      $CellContext`abDrop[{$CellContext`ab}, \
{$CellContext`deg[$CellContext`Y1] + 
        1, $CellContext`deg[$CellContext`Y1] + \
$CellContext`deg[$CellContext`Y2] + $CellContext`deg[$CellContext`X] + 1}]]]],
  
  Editable->False]], "Print",
 CellChangeTimes->{3.615867377836388*^9, 3.615867639794845*^9, 
  3.615867917083136*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[CircleTimes]", 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"x3", ",", 
         RowBox[{"\[LeftAngleBracket]", 
          RowBox[{"x1", ",", "x2"}], "\[RightAngleBracket]"}]}], 
        "\[RightAngleBracket]"}]}], "\[RightAngleBracket]"}], 
     RowBox[{"abDrop", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"deg", "[", "]"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"deg", "[", "]"}], "+", 
          RowBox[{"deg", "[", "]"}], "+", 
          RowBox[{"deg", "[", "x3", "]"}], "+", "1"}]}], "}"}]}], "]"}]],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Subscript[
     AngleBracket[
      CircleTimes[
       AngleBracket[$CellContext`x3, 
        AngleBracket[$CellContext`x1, $CellContext`x2]]]], 
     $CellContext`abDrop[{{1, 4}, {2, 
      3}}, {$CellContext`deg[] + 
       1, $CellContext`deg[] + $CellContext`deg[] + \
$CellContext`deg[$CellContext`x3] + 1}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.615867377836388*^9, 3.615867639794845*^9, 
  3.615867917242975*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]1\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"\[CircleTimes]", "v_"}], ":=", "v"}]}],
  SequenceForm["rule[\[VeryThinSpace]1\[VeryThinSpace]]:", "  ", 
   Defer[CircleTimes[
      Pattern[$CellContext`v, 
       Blank[]]] := $CellContext`v]],
  Editable->False]], "Print",
 CellChangeTimes->{3.615867377836388*^9, 3.615867639794845*^9, 
  3.615867917248908*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"x3", ",", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"x1", ",", "x2"}], "\[RightAngleBracket]"}]}], 
     "\[RightAngleBracket]"}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    AngleBracket[$CellContext`x3, 
     AngleBracket[$CellContext`x1, $CellContext`x2]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.615867377836388*^9, 3.615867639794845*^9, 
  3.61586791741827*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"x3", ",", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"x1", ",", "x2"}], "\[RightAngleBracket]"}]}], 
     "\[RightAngleBracket]"}], "\[RightAngleBracket]"}], 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]], " ", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}], 
    "\[RightAngleBracket]"}], 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "10"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "12"}], "}"}]}]]}]], "Output",
 CellChangeTimes->{3.615867377828504*^9, 3.6158676397735777`*^9, 
  3.6158679174265747`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"StopDebug", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
      "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
       "x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "18"}], "}"}]}]], ",", 
    RowBox[{"{", "1000", "}"}]}], "]"}], "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "5.50834400000000012909140423289500176907`6.761620967710679", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.615867659517562*^9, 3.6158676745637836`*^9}, 
   3.615867927038559*^9}]
}, Open  ]],

Cell["\<\
Scalar is pulled out after it is simplified to comma contraction form.  This \
takes longer,\
\>", "Text",
 CellChangeTimes->{{3.615868036678132*^9, 3.615868070439423*^9}, {
  3.615868146630971*^9, 3.615868179464068*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"UnsetRule", "[", "234", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ResetRule", "[", "234", "]"}], "\[IndentingNewLine]", 
 RowBox[{"StartDebug", "[", "]"}], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
    "x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "18"}], "}"}]}]]}], "Input",
 CellChangeTimes->{{3.615867682968032*^9, 3.615867714428459*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "234", "]"}]], "Output",
 CellChangeTimes->{
  3.615867531994773*^9, {3.6158676964087353`*^9, 3.615867716302999*^9}, 
   3.615867930524096*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]56\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"Y1___", "\[CircleTimes]", 
        RowBox[{"v_", "?", "deg1Q"}], "\[CircleTimes]", "Y2___", 
        "\[CircleTimes]", "X_", "\[CircleTimes]", "Y3___"}], 
       "\[RightAngleBracket]"}], "ab__List"], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "ab", "}"}], "]"}], ">", "1"}], "&&", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", "ab", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"deg", "[", "Y1", "]"}], "+", 
           RowBox[{"deg", "[", "Y2", "]"}], "+", "2"}]}], "}"}]}], "]"}]}]}], 
    ":=", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1", "\[CircleTimes]", "Y2", "\[CircleTimes]", 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"v", ",", "X"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
       "Y3"}], "\[RightAngleBracket]"}], 
     RowBox[{"abDrop", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", 
          RowBox[{"deg", "[", "Y2", "]"}], "+", "2"}]}], "}"}]}], "]"}]]}]}],
  SequenceForm["rule[\[VeryThinSpace]56\[VeryThinSpace]]:", "  ", 
   Defer[Condition[
      Subscript[
       AngleBracket[
        CircleTimes[
         Pattern[$CellContext`Y1, 
          BlankNullSequence[]], 
         PatternTest[
          Pattern[$CellContext`v, 
           Blank[]], $CellContext`deg1Q], 
         Pattern[$CellContext`Y2, 
          BlankNullSequence[]], 
         Pattern[$CellContext`X, 
          Blank[]], 
         Pattern[$CellContext`Y3, 
          BlankNullSequence[]]]], 
       Pattern[$CellContext`ab, 
        BlankSequence[List]]], 
      And[Length[{$CellContext`ab}] > 1, 
       MemberQ[{$CellContext`ab}, {$CellContext`deg[$CellContext`Y1] + 
         1, $CellContext`deg[$CellContext`Y1] + \
$CellContext`deg[$CellContext`Y2] + 2}]]] := Subscript[
      AngleBracket[
       CircleTimes[$CellContext`Y1, $CellContext`Y2, 
        AngleBracket[$CellContext`v, $CellContext`X], $CellContext`Y3]], 
      $CellContext`abDrop[{$CellContext`ab}, \
{$CellContext`deg[$CellContext`Y1] + 
        1, $CellContext`deg[$CellContext`Y1] + \
$CellContext`deg[$CellContext`Y2] + 2}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.615867716317333*^9, 3.615867930538307*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"x1", ",", "x2"}], "\[RightAngleBracket]"}], "\[CircleTimes]",
        "x3", "\[CircleTimes]", "x4", "\[CircleTimes]", "x5", 
       "\[CircleTimes]", "x6"}], "\[RightAngleBracket]"}], 
     RowBox[{"abDrop", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"8", ",", "16"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"10", ",", "18"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"deg", "[", "]"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"deg", "[", "]"}], "+", 
          RowBox[{"deg", "[", "]"}], "+", "2"}]}], "}"}]}], "]"}]],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Subscript[
     AngleBracket[
      CircleTimes[
       AngleBracket[$CellContext`x1, $CellContext`x2], $CellContext`x3, \
$CellContext`x4, $CellContext`x5, $CellContext`x6]], 
     $CellContext`abDrop[{{1, 2}, {3, 6}, {4, 5}, {8, 16}, {10, 
      18}}, {$CellContext`deg[] + 1, $CellContext`deg[] + $CellContext`deg[] + 
       2}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.615867716317333*^9, 3.6158679305468493`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]57\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"Y1___", "\[CircleTimes]", 
        RowBox[{"v_", "?", "deg1Q"}], "\[CircleTimes]", "Y2___", 
        "\[CircleTimes]", "X_", "\[CircleTimes]", "Y3___"}], 
       "\[RightAngleBracket]"}], "ab__List"], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "ab", "}"}], "]"}], ">", "1"}], "&&", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"{", "ab", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"deg", "[", "Y1", "]"}], "+", 
           RowBox[{"deg", "[", "Y2", "]"}], "+", 
           RowBox[{"deg", "[", "X", "]"}], "+", "1"}]}], "}"}]}], "]"}]}]}], ":=", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1", "\[CircleTimes]", "Y2", "\[CircleTimes]", 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"X", ",", "v"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
       "Y3"}], "\[RightAngleBracket]"}], 
     RowBox[{"abDrop", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"deg", "[", "Y1", "]"}], "+", 
          RowBox[{"deg", "[", "Y2", "]"}], "+", 
          RowBox[{"deg", "[", "X", "]"}], "+", "1"}]}], "}"}]}], "]"}]]}]}],
  SequenceForm["rule[\[VeryThinSpace]57\[VeryThinSpace]]:", "  ", 
   Defer[Condition[
      Subscript[
       AngleBracket[
        CircleTimes[
         Pattern[$CellContext`Y1, 
          BlankNullSequence[]], 
         PatternTest[
          Pattern[$CellContext`v, 
           Blank[]], $CellContext`deg1Q], 
         Pattern[$CellContext`Y2, 
          BlankNullSequence[]], 
         Pattern[$CellContext`X, 
          Blank[]], 
         Pattern[$CellContext`Y3, 
          BlankNullSequence[]]]], 
       Pattern[$CellContext`ab, 
        BlankSequence[List]]], 
      And[Length[{$CellContext`ab}] > 1, 
       MemberQ[{$CellContext`ab}, {$CellContext`deg[$CellContext`Y1] + 
         1, $CellContext`deg[$CellContext`Y1] + \
$CellContext`deg[$CellContext`Y2] + $CellContext`deg[$CellContext`X] + 1}]]] := 
    Subscript[
      AngleBracket[
       CircleTimes[$CellContext`Y1, $CellContext`Y2, 
        AngleBracket[$CellContext`X, $CellContext`v], $CellContext`Y3]], 
      $CellContext`abDrop[{$CellContext`ab}, \
{$CellContext`deg[$CellContext`Y1] + 
        1, $CellContext`deg[$CellContext`Y1] + \
$CellContext`deg[$CellContext`Y2] + $CellContext`deg[$CellContext`X] + 1}]]]],
  
  Editable->False]], "Print",
 CellChangeTimes->{3.615867716317333*^9, 3.615867930553055*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"x3", ",", 
         RowBox[{"\[LeftAngleBracket]", 
          RowBox[{"x1", ",", "x2"}], "\[RightAngleBracket]"}]}], 
        "\[RightAngleBracket]"}], "\[CircleTimes]", "x4", "\[CircleTimes]", 
       "x5", "\[CircleTimes]", "x6"}], "\[RightAngleBracket]"}], 
     RowBox[{"abDrop", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"6", ",", "14"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"8", ",", "16"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"deg", "[", "]"}], "+", "1"}], ",", 
         RowBox[{
          RowBox[{"deg", "[", "]"}], "+", 
          RowBox[{"deg", "[", "]"}], "+", 
          RowBox[{"deg", "[", "x3", "]"}], "+", "1"}]}], "}"}]}], "]"}]],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Subscript[
     AngleBracket[
      CircleTimes[
       AngleBracket[$CellContext`x3, 
        AngleBracket[$CellContext`x1, $CellContext`x2]], $CellContext`x4, \
$CellContext`x5, $CellContext`x6]], 
     $CellContext`abDrop[{{1, 4}, {2, 3}, {6, 14}, {8, 
      16}}, {$CellContext`deg[] + 
       1, $CellContext`deg[] + $CellContext`deg[] + \
$CellContext`deg[$CellContext`x3] + 1}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.615867716317333*^9, 3.615867930778366*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]234\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{
      "\[LeftAngleBracket]", "X_CircleTimes", "\[RightAngleBracket]"}], 
      "ab__List"], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"deg", "[", "X", "]"}], ">", 
       RowBox[{"2", " ", 
        RowBox[{"Length", "[", 
         RowBox[{"{", "ab", "}"}], "]"}]}]}], "&&", 
      RowBox[{"ScalarContractionQ", "[", 
       RowBox[{"X", ",", 
        RowBox[{"{", "ab", "}"}]}], "]"}]}]}], ":=", 
    RowBox[{"SplitContraction", "[", 
     RowBox[{"X", ",", 
      RowBox[{"{", "ab", "}"}]}], "]"}]}]}],
  SequenceForm["rule[\[VeryThinSpace]234\[VeryThinSpace]]:", "  ", 
   Defer[Condition[
      Subscript[
       AngleBracket[
        Pattern[$CellContext`X, 
         Blank[CircleTimes]]], 
       Pattern[$CellContext`ab, 
        BlankSequence[List]]], 
      And[$CellContext`deg[$CellContext`X] > 2 Length[{$CellContext`ab}], 
       $CellContext`ScalarContractionQ[$CellContext`X, {$CellContext`ab}]]] := \
$CellContext`SplitContraction[$CellContext`X, {$CellContext`ab}]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.615867716317333*^9, 3.615867931007461*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"SplitContraction", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"x3", ",", 
         RowBox[{"\[LeftAngleBracket]", 
          RowBox[{"x1", ",", "x2"}], "\[RightAngleBracket]"}]}], 
        "\[RightAngleBracket]"}], "\[CircleTimes]", "x4", "\[CircleTimes]", 
       "x5", "\[CircleTimes]", "x6"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "12"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", "14"}], "}"}]}], "}"}]}], "]"}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    $CellContext`SplitContraction[
     CircleTimes[
      AngleBracket[$CellContext`x3, 
       AngleBracket[$CellContext`x1, $CellContext`x2]], $CellContext`x4, \
$CellContext`x5, $CellContext`x6], {{1, 2}, {4, 12}, {6, 14}}]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.615867716317333*^9, 3.615867931014399*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]1\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"\[CircleTimes]", "v_"}], ":=", "v"}]}],
  SequenceForm["rule[\[VeryThinSpace]1\[VeryThinSpace]]:", "  ", 
   Defer[CircleTimes[
      Pattern[$CellContext`v, 
       Blank[]]] := $CellContext`v]],
  Editable->False]], "Print",
 CellChangeTimes->{3.615867716317333*^9, 3.615867931020583*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"x3", ",", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"x1", ",", "x2"}], "\[RightAngleBracket]"}]}], 
     "\[RightAngleBracket]"}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    AngleBracket[$CellContext`x3, 
     AngleBracket[$CellContext`x1, $CellContext`x2]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.615867716317333*^9, 3.615867931026165*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"x3", ",", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"x1", ",", "x2"}], "\[RightAngleBracket]"}]}], 
     "\[RightAngleBracket]"}], "\[RightAngleBracket]"}], 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]], " ", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}], 
    "\[RightAngleBracket]"}], 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "10"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "12"}], "}"}]}]]}]], "Output",
 CellChangeTimes->{
  3.615867531994773*^9, {3.6158676964087353`*^9, 3.615867716302999*^9}, 
   3.615867931031233*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"StopDebug", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
      "x1", "\[CircleTimes]", "x2", "\[CircleTimes]", "x3", "\[CircleTimes]", 
       "x4", "\[CircleTimes]", "x5", "\[CircleTimes]", "x6"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "6"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"8", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "18"}], "}"}]}]], ",", 
    RowBox[{"{", "1000", "}"}]}], "]"}], "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "7.360459999999999780584403197281062603`6.8875048701740464", ",", "Null"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.615867568042716*^9, 3.615867736856208*^9, 
  3.615867942781713*^9}]
}, Open  ]],

Cell["Clean up demo variables,", "Text",
 CellChangeTimes->{{3.615869274509829*^9, 3.6158692920461197`*^9}}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], 
   "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=."}], ";", 
  RowBox[{"d", "=."}], ";", 
  RowBox[{"fdeg", "=."}], ";", 
  RowBox[{"fpair", "=."}], ";", 
  RowBox[{"fgrp", "=."}], ";", 
  RowBox[{"ab", "=."}], ";", 
  RowBox[{"X", "=."}], ";"}]}], "Input",
 CellChangeTimes->{{3.6158692967531233`*^9, 3.615869359142726*^9}, {
  3.615869439590057*^9, 3.615869468982883*^9}, {3.615946711463476*^9, 
  3.615946714027231*^9}, {3.615947047421542*^9, 3.615947049448318*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The special contraction bracket  \[LeftAngleBracket] x, y, z, ... \
\[RightAngleBracket]   ", "Subsection",
 CellChangeTimes->{{3.6117004172917347`*^9, 3.611700487110237*^9}, {
   3.611700901848016*^9, 3.611701130920413*^9}, {3.611701234361413*^9, 
   3.611701302550877*^9}, {3.611701786139716*^9, 3.6117017862152348`*^9}, {
   3.61170200910107*^9, 3.6117020329203777`*^9}, 3.611996273648815*^9, {
   3.6119963087668657`*^9, 3.611996325229361*^9}, {3.612145566621338*^9, 
   3.61214560729216*^9}, {3.612145987296035*^9, 3.612146026046085*^9}, {
   3.612202098180979*^9, 3.612202106094839*^9}, {3.612565371638568*^9, 
   3.612565387187291*^9}, {3.6125666710657663`*^9, 3.612566675757509*^9}, {
   3.612680811591254*^9, 3.612680833447319*^9}, {3.612821745972878*^9, 
   3.612821759682815*^9}, {3.612821790052359*^9, 3.612821838661235*^9}, {
   3.612825269874935*^9, 3.61282536426092*^9}, {3.6139630498808403`*^9, 
   3.6139630516475286`*^9}, {3.6142076142590017`*^9, 
   3.6142076311344833`*^9}, {3.614235211962811*^9, 3.6142352834393187`*^9}, {
   3.6142358306077347`*^9, 3.614235846456574*^9}, {3.614237631663192*^9, 
   3.614237640972167*^9}, {3.614241310457054*^9, 3.614241355893214*^9}, {
   3.614303155217409*^9, 3.6143031655071*^9}, {3.615252563149166*^9, 
   3.6152525654532423`*^9}, {3.6152528311174917`*^9, 3.615252835421444*^9}, {
   3.6158691514212217`*^9, 3.615869153165677*^9}}],

Cell[CellGroupData[{

Cell["deg[ ]   for   \[LeftAngleBracket]  ,  ,  ,  \[RightAngleBracket] ", \
"Subsubsection",
 CellChangeTimes->{{3.614337443117144*^9, 3.614337475085313*^9}, {
   3.614649019934627*^9, 3.614649024216331*^9}, {3.615355010819632*^9, 
   3.615355022637609*^9}, {3.6155348095163383`*^9, 3.615534824477367*^9}, 
   3.615955663803686*^9, 3.649901315258724*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"\[LeftAngleBracket]", "X__", "\[RightAngleBracket]"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"deg", "[", "X", "]"}], "-", 
   RowBox[{"2", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"{", "X", "}"}], "]"}], "-", "1"}], ")"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614244901747367*^9, 3.614245033057584*^9}, {
  3.614251426990006*^9, 3.6142514301928797`*^9}, {3.614291553718549*^9, 
  3.61429155522115*^9}, {3.615354974292425*^9, 3.61535499795679*^9}}],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------------------------\
\>", "Text",
 CellChangeTimes->{{3.6142918796899557`*^9, 3.614291886285962*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Linear algebra for  \[LeftAngleBracket]  ,  ,  ,  \
\[RightAngleBracket]", "Subsubsection",
 CellChangeTimes->{{3.614292135273897*^9, 3.614292144488965*^9}, {
  3.614337317548025*^9, 3.614337329451604*^9}, {3.615362239717678*^9, 
  3.61536224229692*^9}, {3.6153622737370567`*^9, 3.61536228525158*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"u___", ",", "0", ",", "v___"}], "\[RightAngleBracket]"}], "/;", 
     RowBox[{"!", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{"Head", ",", 
          RowBox[{"{", 
           RowBox[{"u", ",", "v"}], "}"}]}], "]"}], ",", "List"}], "]"}]}]}], 
    ":=", "0"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.478877095112795*^9, 3.47887714192196*^9}, {
   3.48031314166417*^9, 3.480313195182439*^9}, 3.480319923951108*^9, {
   3.480323523659946*^9, 3.48032352729512*^9}, {3.6128352399930477`*^9, 
   3.612835244859915*^9}, 3.614113092866776*^9, {3.614291688694797*^9, 
   3.614291712023468*^9}, 3.614295178810892*^9, {3.614896199021789*^9, 
   3.614896209881234*^9}, {3.615362483725254*^9, 3.615362488393674*^9}, {
   3.6167282107585983`*^9, 3.616728210870504*^9}, {3.62231021543885*^9, 
   3.62231027804941*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "117", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
Added  10/04/2017  for numerical work,  ( 0.  is not SameQ as 0),\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"0.", "===", "0"}]], "Input"],

Cell[BoxData["False"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"u___", ",", "0.", ",", "v___"}], "\[RightAngleBracket]"}], "/;", 
     RowBox[{"!", 
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{"Head", ",", 
          RowBox[{"{", 
           RowBox[{"u", ",", "v"}], "}"}]}], "]"}], ",", "List"}], "]"}]}]}], 
    ":=", "0"}]}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"rule", "[", "118", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1___", ",", "X_Plus", ",", "Y2___"}], "\[RightAngleBracket]"}],
     ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"Y1", ",", "#", ",", "Y2"}], "\[RightAngleBracket]"}], "&"}], 
      ",", "X"}], "]"}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614248484516878*^9, 3.614248523527133*^9}, {
   3.614251382287613*^9, 3.61425138963139*^9}, 3.614251462173685*^9, 
   3.614251514349538*^9, 3.614251945250592*^9, {3.6142520299541616`*^9, 
   3.614252033453938*^9}, 3.6142539109975653`*^9, {3.614256108750886*^9, 
   3.614256110466159*^9}, 3.615370535449089*^9, 3.6153705677149343`*^9, {
   3.616728213609967*^9, 3.616728213687098*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "119", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1___", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a_", "?", "deg0Q"}], ")"}], " ", "X_"}], ",", "Y2___"}], 
     "\[RightAngleBracket]"}], ":=", 
    RowBox[{"a", " ", 
     RowBox[{"(", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"Y1", ",", "X", ",", "Y2"}], "\[RightAngleBracket]"}], 
      ")"}]}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615370592898755*^9, 3.615370596818756*^9}, 
   3.6153706306905823`*^9, {3.616728216073011*^9, 3.616728216167697*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "120", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------------------------\
\>", "Text",
 CellChangeTimes->{{3.6142918796899557`*^9, 3.614291886285962*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Linear algebra for   ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "    ", "\[RightAngleBracket]"}], "ab"], 
   TraditionalForm]], "None"]
}], "Subsubsection",
 CellChangeTimes->{{3.614292135273897*^9, 3.614292144488965*^9}, {
  3.614337317548025*^9, 3.614337360412462*^9}, {3.614649030093692*^9, 
  3.614649035112275*^9}, {3.615362249912655*^9, 3.615362259447515*^9}, {
  3.615955801269308*^9, 3.615955802418849*^9}}],

Cell["\<\
The linear rules for    \[LeftAngleBracket]  ,  ,  ,   \[RightAngleBracket]   \
apply so we just need to get them through Subscript.\
\>", "Text",
 CellChangeTimes->{{3.61537065020293*^9, 3.6153707074995413`*^9}, {
   3.61537074812374*^9, 3.615370788651636*^9}, {3.615371042668365*^9, 
   3.615371068076346*^9}, {3.615371134316515*^9, 3.615371134636509*^9}, {
   3.615667150859048*^9, 3.6156673016752443`*^9}, 3.615667504940157*^9}],

Cell[BoxData["0"], "Output"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    SubscriptBox["0", "ab__"], ":=", "0"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.61429515576822*^9, {3.61489601811836*^9, 3.614896030309474*^9}, {
   3.615355093892416*^9, 3.6153551015073566`*^9}, {3.61536244941859*^9, 
   3.61536245508186*^9}, {3.6153707217136707`*^9, 3.6153707230563793`*^9}, 
   3.615371139841402*^9, {3.615371188721829*^9, 3.6153711894415627`*^9}, 
   3.615667257217546*^9, {3.616735354148118*^9, 3.616735354644001*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "121", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    SubscriptBox["X_Plus", "ab__"], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Subscript", "[", 
        RowBox[{"#", ",", "ab"}], "]"}], "&"}], ",", "X"}], "]"}]}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.480315414085071*^9, 3.480315434817291*^9}, 
   3.480323200672162*^9, {3.480323934514976*^9, 3.480323937965155*^9}, {
   3.612835374090095*^9, 3.612835378201292*^9}, 3.614113121662525*^9, {
   3.614896040582513*^9, 3.614896041959454*^9}, {3.6153551349201927`*^9, 
   3.615355185909696*^9}, {3.61535541901369*^9, 3.6153554244223146`*^9}, {
   3.615355502694337*^9, 3.61535550677431*^9}, {3.615370798852932*^9, 
   3.615370864626651*^9}, {3.6153711445461073`*^9, 3.615371160819433*^9}, 
   3.615667260993739*^9, {3.615667405202222*^9, 3.6156674058104887`*^9}, 
   3.615680774115559*^9, {3.6167353409987583`*^9, 3.616735341333621*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "122", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c_", "?", "deg0Q"}], " ", "X_"}], ")"}], "ab__"], ":=", 
    RowBox[{"c", " ", 
     SubscriptBox["X", "ab"]}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.480317053513765*^9, 3.480317113176906*^9}, {
   3.480323969381059*^9, 3.480323976364853*^9}, {3.612830926166206*^9, 
   3.6128309479566402`*^9}, {3.612835395079286*^9, 3.6128353978201923`*^9}, 
   3.6141131294399023`*^9, {3.6141132643645906`*^9, 3.614113270188979*^9}, {
   3.614896044007394*^9, 3.6148960452239437`*^9}, {3.615355475606381*^9, 
   3.615355528532215*^9}, {3.615370905669587*^9, 3.6153709749947023`*^9}, 
   3.615667267537096*^9, {3.615667409905409*^9, 3.615667410529689*^9}, 
   3.615680896868938*^9, {3.6167353488536587`*^9, 3.616735349237425*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "123", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", "0", "\[RightAngleBracket]"}], 
  RowBox[{"a", ",", "b"}]]], "Input",
 CellChangeTimes->{3.6156674291501493`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.615667430622417*^9, 3.615680752125619*^9, 
  3.6156809356230993`*^9, 3.615680978942934*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"2", "a"}], "+", 
    RowBox[{"3", "b"}]}], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "2"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"2", "x"}], "+", 
    RowBox[{"3", "y"}]}], "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}]]}], "Input",
 CellChangeTimes->{{3.6156673741116457`*^9, 3.615667376623199*^9}, {
  3.615667448305066*^9, 3.615667452934291*^9}, {3.615680922866479*^9, 
  3.6156809669943333`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "a", "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]]}], "+", 
  RowBox[{"3", " ", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "b", "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]]}]}]], "Output",
 CellChangeTimes->{{3.6156808757481117`*^9, 3.615680926813047*^9}, {
  3.6156809580060663`*^9, 3.615680968270788*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "x", "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]]}], "+", 
  RowBox[{"3", " ", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "y", "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]]}]}]], "Output",
 CellChangeTimes->{{3.6156808757481117`*^9, 3.615680926813047*^9}, {
  3.6156809580060663`*^9, 3.615680968279601*^9}}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------------------------\
\>", "Text",
 CellChangeTimes->{{3.6142918796899557`*^9, 3.614291886285962*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
\[LeftAngleBracket] ,  ,  , \[RightAngleBracket]   is almost flat             \
                          ---   code added 25/08/2015\
\>", "Subsubsection",
 CellChangeTimes->{{3.614261645517123*^9, 3.6142616562363787`*^9}, {
   3.614261694220573*^9, 3.6142617430046787`*^9}, {3.6142920619764767`*^9, 
   3.614292096155726*^9}, 3.614292149725548*^9, 3.6143372882216997`*^9, {
   3.649901139260384*^9, 3.649901191788299*^9}, 3.650771835087474*^9, {
   3.650772378280445*^9, 3.650772379751832*^9}, {3.650772416567691*^9, 
   3.650772418935708*^9}}],

Cell[TextData[{
 "\nVer3:   The idea was that  \[LeftAngleBracket] \[RightAngleBracket]   \
should not be changed unless the result was going to be unique, so only \
2-chains were considered, because \notherwise ambiguities could be introduced \
in combination with  \[LeftAngleBracket]  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[RightAngleBracket]", "ab"], TraditionalForm]]],
 ".  \n\nVer4:   The idea is that nested    \[LeftAngleBracket] \
\[RightAngleBracket]   have a canonical form, so we should use it.  An \
ambiguities introduced by use of   \[LeftAngleBracket]  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[RightAngleBracket]", "ab"], TraditionalForm]]],
 "   on factors with \ndeg >2  should be resolved by   \[LeftAngleBracket]  \
",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[RightAngleBracket]", "ab"], TraditionalForm]]],
 " .\n\nVer3  is faster ?  but maybe Ver4  is more general?   Only one \
collection of rules need be used...."
}], "Text",
 CellChangeTimes->{{3.650572501036804*^9, 3.650572591180202*^9}, {
  3.650572631662562*^9, 3.650572953161584*^9}, {3.650572993895096*^9, 
  3.650573064164917*^9}}],

Cell["tpTensorVer3    (not initialized)", "Text",
 CellChangeTimes->{{3.650572448445751*^9, 3.6505724883331337`*^9}, {
  3.650573070917911*^9, 3.650573106483905*^9}, {3.650573553947734*^9, 
  3.650573578299275*^9}}],

Cell["\<\
Chaining with deg 2 is OK.      .....   not sure?
We need 4 rules here because we dont want double brackets, eg.  if  Y2  were \
missing from the rhs of the 4th rule.
11:22  9/8/2014.   Previously  Y1, Y2  were unrestricted in the following 5 \
rules.  Now  deg1or2Q,\
\>", "Text",
 CellChangeTimes->{{3.614261645517123*^9, 3.6142616562363787`*^9}, {
   3.614261694220573*^9, 3.6142617430046787`*^9}, {3.6142920619764767`*^9, 
   3.614292096155726*^9}, 3.614292149725548*^9, 3.614337283069521*^9, 
   3.6155350501349077`*^9, {3.615955276282349*^9, 3.615955287371912*^9}, 
   3.615956417392137*^9, {3.6159583509401913`*^9, 3.6159583703471727`*^9}, {
   3.61653578739814*^9, 3.61653579976626*^9}, {3.616536159879216*^9, 
   3.6165362433349543`*^9}, {3.616536296374939*^9, 3.616536308871035*^9}, {
   3.616669534072023*^9, 3.6166695413835897`*^9}, 3.650573119315866*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"Y1__", "?", "deg1or2Q"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"X1_", "?", "deg2Q"}], ",", "X2__"}], 
      "\[RightAngleBracket]"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y1", ",", "X1", ",", "X2"}], "\[RightAngleBracket]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X1__", ",", 
       RowBox[{"X2_", "?", "deg2Q"}]}], "\[RightAngleBracket]"}], ",", 
     RowBox[{"Y2__", "?", "deg1or2Q"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X1", ",", "X2", ",", "Y2"}], "\[RightAngleBracket]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.614241362464374*^9, 3.614241413430987*^9}, {
   3.6142414473702707`*^9, 3.6142415647668037`*^9}, {3.614241783715252*^9, 
   3.614241808829526*^9}, {3.614251403117326*^9, 3.6142514221520243`*^9}, 
   3.614258873062808*^9, {3.614261750186638*^9, 3.614261751914625*^9}, {
   3.615956440942438*^9, 3.6159564699311247`*^9}, {3.616536249059018*^9, 
   3.6165362643435287`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "100", "]"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJwVzn0slAEAx/GTVNxl6MQqhY02FXFeOnE8h0savZCbS+o4ar1QImY7s3HZ
tFnmbbqrGC0q4ZQ/SEnuejmhtMyFzOvdc5OXLuac9Hv++O7z79cpMe1MsgmN
RktA3lLhh+3zJKGujnU+CsU1bncDIPPaK0EQjEq9qQiGX80Y3CRIFvGrRDB9
5PQOObz1wkf3GsYf0vA74dKN8EJKmdytmTKG1sDqgRW29CObF0jCYXYf3Q9O
1rfYsKFRmLz7PExWdMxRloX0FSTAGQn7L6W5nZ64AAs4YzaJsLiut5+SJ23k
ieDtWsZAMvSP1LeLobNdC10Cx3Jzr9yB6pSp5xrIyLB4rIVTn/z3kvCzqETq
sUgSkqtS1WEoHxwYYMFT3J6ZaDgx7TQvgsrRgrh8qJ5UTQzBweyz1sOQOSy6
roPLQRxbqyWSWLPuexAIea4LpnHQt+JA5EU4E26wfwa/36sPbYWBg+84L+G4
e/uxuhV8F6blda2ShKYzUNEPx7dq4g3Qv3JPzAYUhiWNpRhIYpeHuL0IMmru
mz+BO7mOZSRsLo308VsjiYe+6tJqaGKuzOuAH82GIhRQvvFo0yx0UT0tX4aD
tSLPciNJZDa556Svk4S3lWyxCu5nBrhIoaC4xVYGm1gntG/hsj2RUfSPJHrX
uCGOZjrCsjJTGeGpI1by+aHR0Fsyr42Fl8/9ckmF+rk8dhrMMv3TnwNHjncb
W6FCxm9TwWxXAf8btHxTvkUPo8QjEZRl9EkhJU/a8HMNVncpBEbIibIQrkOv
afISZfDMlx80Lx3RXTC6zQS2+ZU4UE6HvWdRujceNIRB5rBAdBIa2au/G6Ay
qzdDC/8DMBKj4Q==
  "]],

Cell[BoxData[
 RowBox[{"rule", "[", "101", "]"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJwVzn0slAEAx/GTVNxl6MQqhY02FXFeOnE8h0savZCbI3XcqfVCiWq2MxvS
tFnmbToVo0UlnPIHKcnp5YS6lhEyL+fuuclLF3N30u/547vPv1+npLRTYhMa
jZaIvKXCD1vnSWKkOtb5MJTUuN0NgMzLrwRBMCr1mjwYfjVjcJMhWcivFMH0
0ZPbZPD6Cx/ta5hwQM3vhEtXwwsoq2RuzZQxtAZWDyy3pR/auEASDrN76H5w
qr7Fhg2NQvHOM1As75ijLA3pz0uEqnz2X0pzOx1xFuZxxm2SYFFd3wAlT9rI
E8EbtYxBMfSP1LVLoLNdCz0fjmdnX7wNR1Kmn6shI8PisQZOf/LfTcLPomKp
xyJJ5F+SKg5CmXJwkAVPcHtU0XByxmleBHvH8uJy4ciUYnIIKm+dth6GzGHR
FS1cDuLYWi2RhMG6/0Eg5LkumMZB3/J9keegKlxv/wx+v1cf2goDle84L+GE
e/uRuhV8F6TldK2ShLozUD4AJzarE/TQv2JXzDoUhiWPp+hJYoeHpL0QMmru
mz+B27mOpSRsLon08TOQxEPfkZJqaGLem9MBP5oNRcihbP3RhlnoonhatgyV
tSLPMiNJZDa5Z6WvkYS3VdViJdzLDHCRQkFRi20VbGId07yFy/ZERuE/kugz
cEMczbSEZUVmb4SnlljJ5YdGQ+/8eU0svBD/yyUV6uZy2GnwpumfgSw4erTb
2ArlVfw2BbzlKuB/g5ZvyjbpYJRkNIKylD4lpORJG34aYHWXXGCEnCgL4Rr0
miHPUwarvvygeWmJ7ryxLSawza/YgXIm7D2L0r1xvz4MMocFouPQyF793QDj
7/RlaOB/LTGjhw==
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"Y1__", "?", "deg1or2Q"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"X1_", "?", "deg2Q"}], ",", "X2___", ",", 
       RowBox[{"X3_", "?", "deg2Q"}]}], "\[RightAngleBracket]"}], ",", 
     RowBox[{"Y2__", "?", "deg1or2Q"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y1", ",", "X1", ",", "X2", ",", "X3", ",", "Y2"}], 
    "\[RightAngleBracket]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.615955354533896*^9, 3.615955378491189*^9}, {
  3.615955483127236*^9, 3.615955495061808*^9}, {3.615956725404765*^9, 
  3.6159567399497433`*^9}, {3.616536273750366*^9, 3.616536277843905*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "102", "]"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJwVzW1IU2EAxfG7wlhh0ChRSCMNiYJsUyKkFT65TC+1IkOv8wUn04VkAxv7
YASbCoFggjoq10DIDGuF5BDfIMFtgqNNFJQxMjOz7bkxt1hFd9M698Phx/n0
z24w3GqUMAxTjKUfnJjdjFIyeXLLEYILd1NfhqF2QHmMQnmg13Y2Rsmyxu6V
wyJ2ebEAUt/KVjl09uRs62D7u0dVHbDE5N9YheYWThaAzHRjCw99tSTt0E9K
XDcX7Rfh0Jf43irokeZdr4dlxmTGG5hncqnGYGad65ITPpbNXB36g+7n++bZ
v5Q80RW5/XC4kK8RoBDNuf0PhrL1a00CJepdy1QXHF61738FSx6e6KcwM11/
7nyCkrrWYN8gJJMe8zT0RQOsG3ZnvNjzHdIHb62/4aDhjsKapOTyYUVb6w4l
RyL22DM4MKrMtcHNUmfac/E3q8MfoCZIjF27lHCSsuLjKTz5umTysAqeHHVw
qnJ4wb0droBW23ruPSiXtRca4Eh+3N8Gu9fnkmPQMsqNe6H+VHXlEmxOebov
DnVTn1jRkPKbVrQn8jqYgJ2BeU0Snt44oN2B6rkfelFpzLfC5PPkl2VNKoGl
qt4sUY51FYiq358RrsAmR43uBkxcEyIjUOr9aAzD/yMmLdE=
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"Y1__", "?", "deg1or2Q"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"X1_", "?", "deg2Q"}], ",", "X2___", ",", 
       RowBox[{"X3_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", 
     RowBox[{"Y2__", "?", "deg1or2Q"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1", ",", "X1", ",", "X2"}], "\[RightAngleBracket]"}], ",", 
     "Y2"}], "\[RightAngleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"Y1__", "?", "deg1or2Q"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"X1_", "?", "deg1Q"}], ",", "X2___", ",", 
       RowBox[{"X3_", "?", "deg2Q"}]}], "\[RightAngleBracket]"}], ",", 
     RowBox[{"Y2__", "?", "deg1or2Q"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y1", ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X1", ",", "X2", ",", "Y2"}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.614241362464374*^9, 3.614241413430987*^9}, {
   3.6142414473702707`*^9, 3.6142415647668037`*^9}, 3.614241783715252*^9, {
   3.614251404795587*^9, 3.614251423789899*^9}, 3.6142588919602737`*^9, 
   3.6142615922679367`*^9, 3.614261625676341*^9, {3.614261761031102*^9, 
   3.614261769051414*^9}, {3.615955538811018*^9, 3.615955544572742*^9}, {
   3.615956959025447*^9, 3.615956976865757*^9}, {3.6159570121349154`*^9, 
   3.6159570246752043`*^9}, {3.615958418361164*^9, 3.615958443622665*^9}, {
   3.615968076840971*^9, 3.615968076932488*^9}, {3.616536282703671*^9, 
   3.6165362878313513`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "103", "]"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJwVzW0s1AEAx/GTEnEREzFcJ80sc1jpPN7/XGnXRMi5SyfcyUyedi/sykbc
1Y55EbY8NCYmY2bcrClXbV3NpLu0VJeupYn7n84pFI76/V9893n5PZpXmia1
o9FoOWjub94r+gpJzPtnMWPgTVpofSx0mBgTJUArWa7lQI3IlZsPbWWiVglU
NaZ7jEBBRLT5CaxrJAUTsErJv01Z0XpimNJP1h/5At6Icz2910oSAQKGcxTM
KFG7s6GaU+R7BerrNT8pHbve1IlhWmTCOqX3yBqRAzWzRvc8yFVO6yizGENn
JdBIp+ulkBGyMV4FVc1qZwX8yL5VpITLzKXBJSg7xigxQR+LSy9laSjHn4S8
hub2sFWSEEs7p1iweum9PhJONy38SIfBwYErEtibrBLWwu6FmfkPUCO+fOgT
PHCn4LoZGny4nm6/SOLI75n7cTAiedNeCL9wWMlX4fOQXe8BOPJukjcKLwXq
4tWQ66VJ6vlDEh0XK6ufbZJETS9Xq4OM78vZW5DZF5TxDy4HFBoLtkjinFYx
roKGjW6nPph173gzCZNiy09GbZNEu2yuqQvGv52ufgwtCgNfC3MePtizCOU1
wy0bsCq+OLzFRhIpXeHyih2S8KrpXG2F+50Sgtphz8CYZwfMXL9gegoVqTyZ
apckhPLziYx9ZmLIrfIlP9xMKA1CXjo8OGc1ZcKQxW9BJdBSXMsuhakp6zo5
LBNpbaOw8bVwbApGs7IFMzD/VJvDGqRbjXxK+5bFXEqPpMHP25DPmhTZYIyv
S+4OZDdYrlG62elnaRH43f3qaAcfZTf5UbYVaiMpmeKwrTNwt14qSYHsxG1L
PzwcoJOZ4H92E6CF
  "]],

Cell[BoxData[
 RowBox[{"rule", "[", "104", "]"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJwVzW0s1AEAx/GTHoiLmBHDddLMMsetdB7vf660ayLk3KUT7mQmT7sXdmUj
7mrHvAhbHhoTkzEzbtaUq7auZtJdWqpL19LE/U/nFApH/f4vvvu8/B7NK02T
OdBotBw09zfvFX2FJOYDspgx8CYtrD4W7p8YEydAG1mu40Kt2I2XD+1l4lYp
VDeme45AYWS05QmsaySFE7BKJbhNWdF6YpjSX97PfgFvxLmd3msjiUAhwyUK
ZpRoPDhQwy3yuwIN9dqflE5db+okMI2dsE7pM7JG5EDtrMkjD/JU03rKLMbQ
WSk00ekGGWSEboxXQXWzxkUJP3JuFangMnNpcAnKjzFKzNDX6tpLWRrGDSAh
v6G5PXyVJCSyzikWrF56b2DD6aaFH+kwJCRoRQp7k9WiWti9MDP/AWollw9/
ggfvFFy3QKMvz8v9F0kc+T1zPw5GJm86iuAXLiv5KnweuuszAEfeTfJH4aUg
fbwG8ry1ST1/SKLjYmX1s02SqOnl6fSQ8X05ewsy+4Iz/sHlwEJTwRZJnNMp
x9XQuNHt3Aez7h1vJmFSbPnJqG2SaJfPNXXB+LfT1Y+hVWkU6GDOwwd7FqGi
ZrhlA1bFF0e02EkipStCUbFDEt41naut8IBzQnA77BkY8+qAmesXzE+hMpUv
V++ShEhxPpGxz0IMuVe+FERYCJVRxE+Hh+Zs5kwYuvgtuARai2s5pTA1ZV2v
gGVinX0UNr4WjU3BaFa2cAbmn2rbvwbpNpOA0rFlMZfSM2nw8zYUsCbFdhjj
55q7AzkN1muU7g6GWVokfne/OjnAR9lN/pRthTo2JVMSvnUG7tbLpCmQk7ht
7Yex4Xq5Gf4Hd7Oguw==
  "]]
}, Open  ]],

Cell["\<\
Added 19:35,  8/8/2014.
Binding with a vector is OK, regardless of the degree of tensor X,\
\>", "Text",
 CellChangeTimes->{{3.6164787189189787`*^9, 3.616478767623394*^9}, {
  3.616479257768302*^9, 3.6164792777363462`*^9}, {3.616479339160692*^9, 
  3.616479358296569*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"v_", "?", "deg1Q"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"X_", "/;", 
        RowBox[{
         RowBox[{"deg", "[", "X", "]"}], ">", "1"}]}], ",", "Y__"}], 
      "\[RightAngleBracket]"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v", ",", "X", ",", "Y"}], "\[RightAngleBracket]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.616478783054336*^9, 3.6164790267069902`*^9}, {
  3.6164954838927813`*^9, 3.6164954859183702`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "105", "]"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGAwB+JJHem5rz++cjRI8hMV+PTKcYHF1bm2QPpf0T/mSCAd
lmzsmwCkdY7+k1gNpGNOnHfZDKSNXC/bbQHSqwoPui/5/srxxcKahgM/Xzmq
+TsfPQ+izd7H/ALSK6o1Q/4D6c0cOffSfr1yZIrs2tUFpLv4l3EuB9J5MepT
XgHpNKYSU/PfQHO33528AEiLqF9r2A2kt3Pe8zoKpL3mLmN6DqTbGrZM/Qak
L+wuNJz655XjbVWTqqK/rxyXmSz8OBNI+812VJ0NpM/F7RSdA6S/Pg14uR9I
27q7l3T9e+VYY+HjrMD62tHGq/KYl+FrxxdyUS7BQDpF/NPLMCD9WvuRah6Q
ZprTYpkPpEsnfj1fBaSNrhz7sxlIH3odte00kM6dEx9+CUhvapzD9gVIa3x8
7AWip197ngiiN81ae/s3kF5ZdjLqD5Ce08ab+BdIG1x5lw6iT8VevMZg9Nqx
Z95DDkYgfTt3iiyIzmg7ZgyiO+br/3IF0hea0lP8gbROxJ93K4E034QLJS+B
NADJbPGi
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y__", ",", 
       RowBox[{"X_", "/;", 
        RowBox[{
         RowBox[{"deg", "[", "X", "]"}], ">", "1"}]}]}], 
      "\[RightAngleBracket]"}], ",", 
     RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y", ",", "X", ",", "v"}], "\[RightAngleBracket]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.616478783054336*^9, 3.616479106163988*^9}, {
  3.616479137040017*^9, 3.616479182029913*^9}, {3.616495499694326*^9, 
  3.6164955007183733`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "106", "]"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGAwB+JzThm5rz++clwUFCwq8OmVo9Di63NtgfTFNg6WSCB9
QdTUNwFI2/1mkFwNpM1sr7hsBtIHFl222wKkj0Qfdl/y/ZWj7oWGhgM/Xzn+
K3U9eh5Iuyx4H/MLSEvU6Yb8B9IB/AX30n69cvy6u29XF5BOS1/JuRxIO1Ro
TXkFpBkulZma/37lqLH73uQFQLpj6rWG3UDapeOh11EgvWjFSqbnQHrS+u1T
vwHpG59LDKf+AZrvbVZV9PeVY9PFRR9nAum4NBfV2UD62uOdonOA9ObfQS/3
A+lPNV4lXf9eOYYt83VWYH3tOLOh8piX4WtHVcNol2AgnRz8+WUYkP4e+Vg1
D0j/O9FqmQ+kT8z8dr4KSGv6n/izGUi/5Y/ZdhpI/+nODr8EpJsXz2P7AuJb
PPUC0erfXyaC6JAH627/BtL5x09F/QHSdbv4Ev8C6ZTHH9JB9IP0S9cYjF47
mk17xMEIpPfPmSILor/PP24MomOuGPxyBdJ99pkp/kD6TPDfdyuB9IbdF0pe
AmkAk7X4hQ==
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"v_", "?", "deg1Q"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"X_", "/;", 
        RowBox[{
         RowBox[{"deg", "[", "X", "]"}], ">", "1"}]}], ",", "Y__"}], 
      "\[RightAngleBracket]"}], ",", "Z__"}], "\[RightAngleBracket]"}], ":=", 
   
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"v", ",", "X", ",", "Y"}], "\[RightAngleBracket]"}], ",", "Z"}],
     "\[RightAngleBracket]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"rule", "[", "107", "]"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGAwB+LUkMzc1x9fOSqtDBYV+PTKUVPk1lxbIG10hoclEkjf
CDL3TQDSy0yZJVcDaaWjN1w2A+lrjNfstgDpv5OPui/5/srxbEZrw4GfrxwF
L7sfPQ+k450+xvwC0kXnDUL+A+k9EiX30n69clwQOGlXF5C+57mGczmQ7sjQ
nfIKSOeJVpma/37lWCD2YPICIG136lbDbiD9TfaR11EgfWjpWqbnQPrE3V1T
vwHpUysrDKf+eeWYk25RVfT3leOGsiUfZwJptjMuqrOB9LOMPaJzgPQ2n9CX
+4H0F3Xvkq5/rxx9m/2dFVhfO8bNrzrmZfjaUSchxiUYSFdVfXkZBqSb9z9R
zQPSRxnaLfOB9Kq9389XAekr10/+2QykmTljt50G0uVMueGXgPSNawvZvgDp
SwXPvED0fss3iSBavmnD7d9AOsPkTNQfIO3zkT/xL5A23fIpHUQrFFy+xmD0
2lFm1WMORiDd0TZVFkSrbT1hDKKvnTD85Qqks/9lpfgD6SiXf+9WAunZDJdK
XgJpAN5P8g8=
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Z__", ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y__", ",", 
       RowBox[{"X_", "/;", 
        RowBox[{
         RowBox[{"deg", "[", "X", "]"}], ">", "1"}]}]}], 
      "\[RightAngleBracket]"}], ",", 
     RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Z", ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y", ",", "X", ",", "v"}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"rule", "[", "108", "]"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJwVzWkow3EAxvE/IbwQokiuF4o3YgiL8csc/Qs5IkK25lqZo5XMm70QmlfO
YmghR44SKUemZiRJuV7MEUWz30TmnjHP/8XT593zDRU35Fc5MAwTj80kSevN
L5TkjJX6eloo4dUYRpOhVBPuVAL98hOzK6FLsLP/HAySXAmXoW7fIFiBqaK9
zMlPSmRGlXL7mxImgdUfQUvGa5kVPizEFNph7bj8utqKP23vugq+bsy7TUPl
WlQ/he1qRVz8DyXiyZs+DVx/vFVuwKzCe1YPFQGLjkY4lrE18AE3ea3RAzZK
ehr5iuZfSiKZqZchKOzMClPDxQit7wjc6S42aeGqV65c9UeJRpCXFuJsJn97
bbtstJkk9JcLCyA7824qgp4f92Ey2MHvSmyAhoevIwX0KDuwLUMf94rVA5jX
Iis+hnX2CZc32DRnZDm3Bc8izpSzpYsfONx5WGqDqUneol8Yq36r4dSOnp4z
PPR0d64OcHNwMJCz93o/hpPR86zp0NLRJMmFlyX2p1k4m30iN8F/tmbyPw==

  "]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"UnsetRule", "[", 
   RowBox[{"{", 
    RowBox[{
    "100", ",", "101", ",", "102", ",", "103", ",", "104", ",", "105", ",", 
     "106", ",", "107", ",", "108"}], "}"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.650573143194929*^9, 3.650573171141164*^9}, 
   3.65057348137617*^9}],

Cell["tpTensorVer4    ---  simple flatten", "Text",
 CellChangeTimes->{{3.650572448445751*^9, 3.6505724883331337`*^9}, {
  3.650573070917911*^9, 3.650573106483905*^9}, {3.650573539404572*^9, 
  3.65057358231529*^9}, {3.6505790696250896`*^9, 3.6505790755099783`*^9}}],

Cell["\<\
Final flattenings, where we have to remove the outermost  \[LeftAngleBracket] \
 \[RightAngleBracket] .
Case:  just one end,\
\>", "Text",
 CellChangeTimes->{{3.649464586073236*^9, 3.649464638985442*^9}, {
  3.649464875750132*^9, 3.649464885335393*^9}, {3.649726263079751*^9, 
  3.649726278727027*^9}, {3.650573527740059*^9, 3.650573530588592*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y1__", ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"X1_", "/;", 
        RowBox[{
         RowBox[{"deg", "[", "X1", "]"}], ">", "1"}]}], ",", "X2__"}], 
      "\[RightAngleBracket]"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y1", ",", "X1", ",", "X2"}], "\[RightAngleBracket]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X1__", ",", 
       RowBox[{"X2_", "/;", 
        RowBox[{
         RowBox[{"deg", "[", "X2", "]"}], ">", "1"}]}]}], 
      "\[RightAngleBracket]"}], ",", "Y2__"}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X1", ",", "X2", ",", "Y2"}], "\[RightAngleBracket]"}]}], 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614241362464374*^9, 3.614241413430987*^9}, {
   3.6142414473702707`*^9, 3.6142415647668037`*^9}, {3.614241783715252*^9, 
   3.614241808829526*^9}, {3.614251403117326*^9, 3.6142514221520243`*^9}, 
   3.614258873062808*^9, {3.614261750186638*^9, 3.614261751914625*^9}, {
   3.615956440942438*^9, 3.6159564699311247`*^9}, {3.616536249059018*^9, 
   3.6165362643435287`*^9}, {3.6494644399824*^9, 3.649464465071594*^9}, {
   3.6494646528948174`*^9, 3.649464684158101*^9}, {3.649465102550098*^9, 
   3.649465118679158*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "124", "]"}]], "Output"],

Cell[BoxData[
 RowBox[{"rule", "[", "125", "]"}]], "Output"]
}, Open  ]],

Cell["Case:  both ends,", "Text",
 CellChangeTimes->{{3.649464586073236*^9, 3.649464638985442*^9}, {
  3.649464875750132*^9, 3.649464885335393*^9}, {3.649726263079751*^9, 
  3.6497263074306602`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y1__", ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"X1_", "/;", 
        RowBox[{
         RowBox[{"deg", "[", "X1", "]"}], ">", "1"}]}], ",", "X2___", ",", 
       RowBox[{"X3_", "/;", 
        RowBox[{
         RowBox[{"deg", "[", "X3", "]"}], ">", "1"}]}]}], 
      "\[RightAngleBracket]"}], ",", "Y2__"}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y1", ",", "X1", ",", "X2", ",", "X3", ",", "Y2"}], 
    "\[RightAngleBracket]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.649465254540648*^9, {3.6494652868002987`*^9, 3.649465350084235*^9}, {
   3.649465493313922*^9, 3.649465493425962*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "126", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
Internal absorbtions, where no  \[LeftAngleBracket]  \[RightAngleBracket]  is \
removed because the internal  \[LeftAngleBracket]  \[RightAngleBracket]  is \
terminated with a vector,\
\>", "Text",
 CellChangeTimes->{{3.649464586073236*^9, 3.649464638985442*^9}, {
  3.649464701704617*^9, 3.6494647329517937`*^9}, {3.6494649032860537`*^9, 
  3.64946490717372*^9}, {3.649465517485937*^9, 3.649465552765233*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y1__", ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"X1_", "/;", 
        RowBox[{
         RowBox[{"deg", "[", "X1", "]"}], ">", "1"}]}], ",", "X2___", ",", 
       RowBox[{"X3_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", 
     "Y2__"}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1", ",", "X1", ",", "X2", ",", "X3"}], 
      "\[RightAngleBracket]"}], ",", "Y2"}], "\[RightAngleBracket]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y1__", ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"X1_", "?", "deg1Q"}], ",", "X2___", ",", 
       RowBox[{"X3_", "/;", 
        RowBox[{
         RowBox[{"deg", "[", "X3", "]"}], ">", "1"}]}]}], 
      "\[RightAngleBracket]"}], ",", "Y2__"}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y1", ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X1", ",", "X2", ",", "X3", ",", "Y2"}], 
      "\[RightAngleBracket]"}]}], "\[RightAngleBracket]"}]}], "]"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.614241362464374*^9, 3.614241413430987*^9}, {
   3.6142414473702707`*^9, 3.6142415647668037`*^9}, {3.614241783715252*^9, 
   3.614241808829526*^9}, {3.614251403117326*^9, 3.6142514221520243`*^9}, 
   3.614258873062808*^9, {3.614261750186638*^9, 3.614261751914625*^9}, {
   3.615956440942438*^9, 3.6159564699311247`*^9}, {3.616536249059018*^9, 
   3.6165362643435287`*^9}, {3.6494644399824*^9, 3.649464465071594*^9}, {
   3.6494646528948174`*^9, 3.649464684158101*^9}, {3.649464784105586*^9, 
   3.64946479884457*^9}, {3.649464834988542*^9, 3.649464841404499*^9}, {
   3.649464918327881*^9, 3.649464932636015*^9}, {3.649465602356367*^9, 
   3.649465707761774*^9}, {3.6494657633265667`*^9, 3.6494657665902843`*^9}, {
   3.649465841806775*^9, 3.649465873005039*^9}, {3.649739621275648*^9, 
   3.64973963070472*^9}, {3.649739695500225*^9, 3.6497396955733023`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "127", "]"}]], "Output"],

Cell[BoxData[
 RowBox[{"rule", "[", "128", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
tpTensorVer4    ---  flatten with use of  rev-parity of inner bracket\
\>", "Text",
 CellChangeTimes->{{3.650572448445751*^9, 3.6505724883331337`*^9}, {
  3.650573070917911*^9, 3.650573106483905*^9}, {3.650573539404572*^9, 
  3.65057358231529*^9}, {3.6505790696250896`*^9, 3.650579128004965*^9}, {
  3.6507426327641068`*^9, 3.650742641402953*^9}}],

Cell["\<\
This is for the case that the internal bracket is terminated by a vector, so \
would not usually flatten. But if the internal bracket is a 2-chain and each \
elt in the chain is revEven or revOdd, 
then the chain can be reversed and the expression flattened,\
\>", "Text",
 CellChangeTimes->{{3.649464586073236*^9, 3.649464638985442*^9}, {
  3.649464875750132*^9, 3.649464885335393*^9}, {3.649726263079751*^9, 
  3.649726278727027*^9}, {3.650573527740059*^9, 3.650573530588592*^9}, {
  3.650579159029127*^9, 3.6505792843709307`*^9}, {3.650579961287026*^9, 
  3.6505800136382847`*^9}, {3.6505802593945417`*^9, 3.6505803184652843`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"Y1__", "?", "deg2revParityQ"}], ",", 
       RowBox[{"z_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", 
     "Y2__"}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", 
     RowBox[{"rev", "[", "Y1", "]"}], ",", "Y2"}], "\[RightAngleBracket]"}]}],
   "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614241362464374*^9, 3.614241413430987*^9}, {
   3.6142414473702707`*^9, 3.6142415647668037`*^9}, {3.614241783715252*^9, 
   3.614241808829526*^9}, {3.614251403117326*^9, 3.6142514221520243`*^9}, 
   3.614258873062808*^9, {3.614261750186638*^9, 3.614261751914625*^9}, {
   3.615956440942438*^9, 3.6159564699311247`*^9}, {3.616536249059018*^9, 
   3.6165362643435287`*^9}, {3.6494644399824*^9, 3.649464465071594*^9}, {
   3.6494646528948174`*^9, 3.649464684158101*^9}, {3.649465102550098*^9, 
   3.649465118679158*^9}, {3.650579300263672*^9, 3.650579396934574*^9}, {
   3.650579590819356*^9, 3.650579684099259*^9}, {3.65057976339571*^9, 
   3.6505799148285503`*^9}, {3.65058002685043*^9, 3.6505800573559637`*^9}, {
   3.650580096099725*^9, 3.650580163434904*^9}, {3.650581399478849*^9, 
   3.650581411718129*^9}, {3.6506168205380707`*^9, 3.6506168230845118`*^9}, {
   3.650941739802908*^9, 3.650941744729018*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "129", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
Here slot 1 of Y2 is contracted with the 2nd last slot of  X, but X is \
symmetric,\
\>", "Text",
 CellChangeTimes->{{3.652340777640676*^9, 3.652340825432423*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"X_", "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"deg", "[", "X", "]"}], ">", "2"}], "&&", 
         RowBox[{"SymQ", "[", "X", "]"}]}]}], ",", 
       RowBox[{"Y1___", "?", "deg2revParityQ"}], ",", 
       RowBox[{"z_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", 
     "Y2__"}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", 
     RowBox[{"rev", "[", "Y1", "]"}], ",", "X", ",", "Y2"}], 
    "\[RightAngleBracket]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614241362464374*^9, 3.614241413430987*^9}, {
   3.6142414473702707`*^9, 3.6142415647668037`*^9}, {3.614241783715252*^9, 
   3.614241808829526*^9}, {3.614251403117326*^9, 3.6142514221520243`*^9}, 
   3.614258873062808*^9, {3.614261750186638*^9, 3.614261751914625*^9}, {
   3.615956440942438*^9, 3.6159564699311247`*^9}, {3.616536249059018*^9, 
   3.6165362643435287`*^9}, {3.6494644399824*^9, 3.649464465071594*^9}, {
   3.6494646528948174`*^9, 3.649464684158101*^9}, {3.649465102550098*^9, 
   3.649465118679158*^9}, {3.650579300263672*^9, 3.650579396934574*^9}, {
   3.650579590819356*^9, 3.650579684099259*^9}, {3.65057976339571*^9, 
   3.6505799148285503`*^9}, {3.65058002685043*^9, 3.6505800573559637`*^9}, {
   3.650580096099725*^9, 3.650580163434904*^9}, {3.650581399478849*^9, 
   3.650581411718129*^9}, {3.650616825646132*^9, 3.650616892493121*^9}, {
   3.6506169640199327`*^9, 3.650616965980288*^9}, {3.650617092378866*^9, 
   3.650617094762589*^9}, {3.650941752188456*^9, 3.650941755738558*^9}, {
   3.652340643632585*^9, 3.652340666191112*^9}, {3.652340711345076*^9, 
   3.6523407539979477`*^9}, {3.6523408581888657`*^9, 3.652340862475672*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "130", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
Here slot 1 of Y2 is contracted with the 2nd last slot of  X.  Thus 2 slots \
of  X  have been contracted, 
Corrected 27/09/2015.\
\>", "Text",
 CellChangeTimes->{{3.652340777640676*^9, 3.652340825432423*^9}, {
  3.652340991846282*^9, 3.652341012006117*^9}, {3.652341270243168*^9, 
  3.6523412865791073`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"X_", "/;", 
        RowBox[{
         RowBox[{
          RowBox[{"deg", "[", "X", "]"}], ">", "2"}], "&&", 
         RowBox[{"AntisymQ", "[", "X", "]"}]}]}], ",", 
       RowBox[{"Y1___", "?", "deg2revParityQ"}], ",", 
       RowBox[{"z_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", 
     "Y2__"}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{
    RowBox[{"revSignAntisym", "[", 
     RowBox[{
      RowBox[{"deg", "[", "X", "]"}], "-", "2"}], "]"}], 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"z", ",", 
      RowBox[{"rev", "[", 
       RowBox[{"X", ",", "Y1"}], "]"}], ",", "Y2"}], 
     "\[RightAngleBracket]"}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.650617122235104*^9, {3.650617165002038*^9, 3.650617185608942*^9}, {
   3.650941769500082*^9, 3.650941773798195*^9}, {3.6523409481097116`*^9, 
   3.652340948172391*^9}, {3.652341033834738*^9, 3.652341033866794*^9}, {
   3.6523410878992157`*^9, 3.652341127241838*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "131", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
This rule (and others like it) should not be needed because the inner bracket \
will already have re-ordered  ( by a rule in the section on  rev[ ] )  so \
that the vector is at the right hand end   (not initialized),\
\>", "Text",
 CellChangeTimes->{{3.6505814490239677`*^9, 3.650581589709968*^9}, {
  3.650617239061187*^9, 3.650617257969989*^9}}],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y2__", ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"X_", "?", "deg1Q"}], ",", 
       RowBox[{"Y1__", "?", "deg2revParityQ"}]}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y2", ",", 
     RowBox[{"rev", "[", "Y1", "]"}], ",", "X"}], "\[RightAngleBracket]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.650580187435391*^9, 3.65058023425534*^9}, {
  3.6505814214613733`*^9, 3.650581438132801*^9}, {3.65094178107901*^9, 
  3.6509417839201403`*^9}}],

Cell["\<\
.... more generally, one might want to do the same if the rev number does not \
increase, rather than for just chains with rev-parity.\
\>", "Text",
 CellChangeTimes->{{3.6505803498730793`*^9, 3.6505804165948772`*^9}}],

Cell["\<\
tpTensorVer4    ---  flatten with use of  rev-parity of  the factors outside \
the inner bracket\
\>", "Text",
 CellChangeTimes->{{3.650572448445751*^9, 3.6505724883331337`*^9}, {
  3.650573070917911*^9, 3.650573106483905*^9}, {3.650573539404572*^9, 
  3.65057358231529*^9}, {3.6505790696250896`*^9, 3.650579128004965*^9}, {
  3.6507426327641068`*^9, 3.650742695882203*^9}}],

Cell["\<\
This is for the case that the internal bracket is a  2-chain terminated by a \
vector (only free slot is the first) and its elements do not have rev-parity. \
But if the factor outside the inner bracket is a 2-chain and each 
elt in the chain is revEven or revOdd, then this chain can be reversed and \
the expression flattened.  The whole bracket is  deg0Q  so we have   \
\[LeftAngleBracket] \[RightAngleBracket]  = rev[rev[\[LeftAngleBracket] \
\[RightAngleBracket] ]] = rev[ \[LeftAngleBracket] rev[  ] \
\[RightAngleBracket] ] = \[LeftAngleBracket] rev[ ] \[RightAngleBracket].\
\>", "Text",
 CellChangeTimes->{{3.649464586073236*^9, 3.649464638985442*^9}, {
  3.649464875750132*^9, 3.649464885335393*^9}, {3.649726263079751*^9, 
  3.649726278727027*^9}, {3.650573527740059*^9, 3.650573530588592*^9}, {
  3.650579159029127*^9, 3.6505792843709307`*^9}, {3.650579961287026*^9, 
  3.6505800136382847`*^9}, {3.6505802593945417`*^9, 3.6505803184652843`*^9}, {
  3.650742723145858*^9, 3.6507427389856043`*^9}, {3.6507429275108147`*^9, 
  3.650742930792615*^9}, {3.650742971366302*^9, 3.650743040356902*^9}, {
  3.6507482329221697`*^9, 3.650748236186098*^9}, {3.6509425739954863`*^9, 
  3.6509426989535418`*^9}, {3.650942738297337*^9, 3.650942738921465*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ruleToTest", " ", "=", 
  RowBox[{"AddRule", "[", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
        RowBox[{"Y1__", "?", "deg2Q"}], ",", 
        RowBox[{"v1_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", 
      RowBox[{"Y2___", "?", "deg2revParityQ"}], ",", 
      RowBox[{"v2_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ":=", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"v2", ",", 
      RowBox[{"rev", "[", "Y2", "]"}], ",", "Y1", ",", "v1"}], 
     "\[RightAngleBracket]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614241362464374*^9, 3.614241413430987*^9}, {
   3.6142414473702707`*^9, 3.6142415647668037`*^9}, {3.614241783715252*^9, 
   3.614241808829526*^9}, {3.614251403117326*^9, 3.6142514221520243`*^9}, 
   3.614258873062808*^9, {3.614261750186638*^9, 3.614261751914625*^9}, {
   3.615956440942438*^9, 3.6159564699311247`*^9}, {3.616536249059018*^9, 
   3.6165362643435287`*^9}, {3.6494644399824*^9, 3.649464465071594*^9}, {
   3.6494646528948174`*^9, 3.649464684158101*^9}, {3.649465102550098*^9, 
   3.649465118679158*^9}, {3.650579300263672*^9, 3.650579396934574*^9}, {
   3.650579590819356*^9, 3.650579684099259*^9}, {3.65057976339571*^9, 
   3.6505799148285503`*^9}, {3.65058002685043*^9, 3.6505800573559637`*^9}, {
   3.650580096099725*^9, 3.650580163434904*^9}, {3.650581399478849*^9, 
   3.650581411718129*^9}, {3.6506168205380707`*^9, 3.6506168230845118`*^9}, 
   3.6507427954219646`*^9, {3.6507428446731987`*^9, 3.650742863660849*^9}, {
   3.650742895194268*^9, 3.650742915724885*^9}, {3.650742947626625*^9, 
   3.650742963859633*^9}, {3.65074391027145*^9, 3.6507439603793497`*^9}, {
   3.650746932512425*^9, 3.6507469377585783`*^9}, {3.65074697083025*^9, 
   3.650746970926607*^9}, {3.6507471163645687`*^9, 3.650747119724629*^9}, {
   3.650747214332555*^9, 3.65074721673448*^9}, {3.650747991953107*^9, 
   3.650747994241551*^9}, {3.650748079952509*^9, 3.6507480847369823`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "132", "]"}]], "Output"]
}, Open  ]],

Cell["11/09/2015   next 9 rules added,", "Text",
 CellChangeTimes->{{3.6509405560690823`*^9, 3.650940562357267*^9}, {
  3.650946893956057*^9, 3.6509469060680656`*^9}}],

Cell["The reverse of the above,", "Text",
 CellChangeTimes->{{3.6509427936086397`*^9, 3.65094280261674*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"v2_", "?", "deg1Q"}], ",", 
     RowBox[{"Y2___", "?", "deg2revParityQ"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"v1_", "?", "deg1Q"}], ",", 
       RowBox[{"Y1__", "?", "deg2Q"}]}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v1", ",", "Y1", ",", 
     RowBox[{"rev", "[", "Y2", "]"}], ",", "v2"}], "\[RightAngleBracket]"}]}],
   "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650940465384179*^9, 3.6509405221027946`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "133", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
The last 2 rules can be generalized to embed a  SymQ  or  AntisymQ  tensor \
into the 2-chain, provided we take into account the symmetry of the free slots.
The  AntisymQ  case uses the fact that     revSignAntisym[deg[X] - 2]  \
revSignAntisym[X] = -1 ,\
\>", "Text",
 CellChangeTimes->{{3.649464586073236*^9, 3.649464638985442*^9}, {
   3.649464875750132*^9, 3.649464885335393*^9}, {3.649726263079751*^9, 
   3.649726278727027*^9}, {3.650573527740059*^9, 3.650573530588592*^9}, {
   3.650579159029127*^9, 3.6505792843709307`*^9}, {3.650579961287026*^9, 
   3.6505800136382847`*^9}, {3.6505802593945417`*^9, 
   3.6505803184652843`*^9}, {3.650742723145858*^9, 3.6507427389856043`*^9}, {
   3.6507429275108147`*^9, 3.650742930792615*^9}, {3.650742971366302*^9, 
   3.650743040356902*^9}, {3.6507482329221697`*^9, 3.650748236186098*^9}, {
   3.650939298933649*^9, 3.6509394379239807`*^9}, 3.6509402672570744`*^9, {
   3.650941090110105*^9, 3.6509411746372423`*^9}, {3.6509428119609013`*^9, 
   3.650942822168371*^9}, {3.6509467191263313`*^9, 3.6509467193022413`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{"revSignAntisym", "[", 
        RowBox[{"n", "-", "2"}], "]"}], 
       RowBox[{"revSignAntisym", "[", "n", "]"}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "2", ",", "20"}], "}"}]}], "]"}], ";", 
  RowBox[{"Print", "[", "x", "]"}], ";", 
  RowBox[{"x", "=."}]}]], "Input",
 CellChangeTimes->{{3.650940947537178*^9, 3.65094104016004*^9}, {
  3.650941180865076*^9, 3.650941218496798*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Print",
 CellChangeTimes->{3.650941219181065*^9}]
}, Open  ]],

Cell["X_?AntisymQ ....", "Text",
 CellChangeTimes->{{3.6509463362481422`*^9, 3.65094633881111*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"Y1__", "?", "deg2Q"}], ",", 
       RowBox[{"v1_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", 
     RowBox[{"Y2___", "?", "deg2revParityQ"}], ",", 
     RowBox[{"X_", "?", "AntisymQ"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{
    RowBox[{"revSignAntisym", "[", 
     RowBox[{
      RowBox[{"deg", "[", "X", "]"}], "-", "1"}], "]"}], 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"rev", "[", 
       RowBox[{"Y2", ",", "X"}], "]"}], ",", "Y1", ",", "v1"}], 
     "\[RightAngleBracket]"}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650940096172756*^9, 3.65094011612468*^9}, {
  3.6509406161498623`*^9, 3.6509406777492027`*^9}, {3.6509408810901318`*^9, 
  3.650940884530011*^9}, {3.650941074944036*^9, 3.650941078655697*^9}, {
  3.650941300364794*^9, 3.650941310269093*^9}, {3.650941384747916*^9, 
  3.6509414205550613`*^9}, {3.6509428927795877`*^9, 3.650942895432457*^9}, {
  3.650942969608245*^9, 3.6509429982157297`*^9}, {3.650945346457947*^9, 
  3.650945357257648*^9}, {3.650946371247857*^9, 3.650946378606975*^9}, {
  3.650946429006445*^9, 3.650946456270273*^9}, {3.650946677768437*^9, 
  3.650946679067676*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "134", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"X_", "?", "AntisymQ"}], ",", 
     RowBox[{"Y2___", "?", "deg2revParityQ"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"v1_", "?", "deg1Q"}], ",", 
       RowBox[{"Y1__", "?", "deg2Q"}]}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}], ":=", 
   RowBox[{
    RowBox[{"revSignAntisym", "[", 
     RowBox[{
      RowBox[{"deg", "[", "X", "]"}], "-", "1"}], "]"}], 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"v1", ",", "Y1", ",", 
      RowBox[{"rev", "[", 
       RowBox[{"X", ",", "Y2"}], "]"}]}], "\[RightAngleBracket]"}]}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650940465384179*^9, 3.6509405221027946`*^9}, {
  3.650945202555835*^9, 3.650945245531661*^9}, {3.650945350457863*^9, 
  3.6509453581532288`*^9}, {3.650946510974362*^9, 3.650946547118677*^9}, {
  3.650946668808964*^9, 3.6509466710167*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "135", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
These use the fact that     revSignAntisym[deg[X] - 2]  revSignAntisym[X] = \
-1 .  Note that  X, not rev[X]  appears on the rhs,\
\>", "Text",
 CellChangeTimes->{{3.649464586073236*^9, 3.649464638985442*^9}, {
   3.649464875750132*^9, 3.649464885335393*^9}, {3.649726263079751*^9, 
   3.649726278727027*^9}, {3.650573527740059*^9, 3.650573530588592*^9}, {
   3.650579159029127*^9, 3.6505792843709307`*^9}, {3.650579961287026*^9, 
   3.6505800136382847`*^9}, {3.6505802593945417`*^9, 
   3.6505803184652843`*^9}, {3.650742723145858*^9, 3.6507427389856043`*^9}, {
   3.6507429275108147`*^9, 3.650742930792615*^9}, {3.650742971366302*^9, 
   3.650743040356902*^9}, {3.6507482329221697`*^9, 3.650748236186098*^9}, {
   3.650939298933649*^9, 3.6509394379239807`*^9}, 3.6509402672570744`*^9, {
   3.650941090110105*^9, 3.6509411746372423`*^9}, {3.6509428119609013`*^9, 
   3.650942822168371*^9}, {3.6509467191263313`*^9, 3.6509467193022413`*^9}, {
   3.6523416953100157`*^9, 3.652341748077467*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"Y1__", "?", "deg2Q"}], ",", 
       RowBox[{"v1_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", 
     RowBox[{"Y2___", "?", "deg2revParityQ"}], ",", 
     RowBox[{"X_", "?", "AntisymQ"}], ",", 
     RowBox[{"Y3___", "?", "deg2revParityQ"}], ",", 
     RowBox[{"v2_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"v2", ",", 
      RowBox[{"rev", "[", "Y3", "]"}], ",", "X", ",", 
      RowBox[{"rev", "[", "Y2", "]"}], ",", "Y1", ",", "v1"}], 
     "\[RightAngleBracket]"}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650940096172756*^9, 3.65094011612468*^9}, {
  3.6509406161498623`*^9, 3.6509406777492027`*^9}, {3.6509408810901318`*^9, 
  3.650940884530011*^9}, {3.650941074944036*^9, 3.650941078655697*^9}, {
  3.650941300364794*^9, 3.650941310269093*^9}, {3.650941384747916*^9, 
  3.6509414205550613`*^9}, {3.6509428927795877`*^9, 3.650942895432457*^9}, {
  3.650942969608245*^9, 3.6509429982157297`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "136", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"v2_", "?", "deg1Q"}], ",", 
     RowBox[{"Y3___", "?", "deg2revParityQ"}], ",", 
     RowBox[{"X_", "?", "AntisymQ"}], ",", 
     RowBox[{"Y2___", "?", "deg2revParityQ"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"v1_", "?", "deg1Q"}], ",", 
       RowBox[{"Y1__", "?", "deg2Q"}]}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"v1", ",", "Y1", ",", 
      RowBox[{"rev", "[", "Y2", "]"}], ",", "X", ",", 
      RowBox[{"rev", "[", "Y3", "]"}], ",", "v2"}], 
     "\[RightAngleBracket]"}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650940465384179*^9, 3.6509405221027946`*^9}, {
  3.650945202555835*^9, 3.650945245531661*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "137", "]"}]], "Output"]
}, Open  ]],

Cell["X_?SymQ ....", "Text",
 CellChangeTimes->{{3.6509463362481422`*^9, 3.650946345787162*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"Y1__", "?", "deg2Q"}], ",", 
       RowBox[{"v1_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", 
     RowBox[{"Y2___", "?", "deg2revParityQ"}], ",", 
     RowBox[{"X_", "?", "SymQ"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X", ",", 
     RowBox[{"rev", "[", "Y2", "]"}], ",", "Y1", ",", "v1"}], 
    "\[RightAngleBracket]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650940096172756*^9, 3.65094011612468*^9}, {
   3.6509406161498623`*^9, 3.6509406777492027`*^9}, {3.6509408810901318`*^9, 
   3.650940884530011*^9}, {3.650941074944036*^9, 3.650941078655697*^9}, {
   3.650941300364794*^9, 3.650941310269093*^9}, {3.650941384747916*^9, 
   3.6509414205550613`*^9}, {3.6509428927795877`*^9, 3.650942895432457*^9}, {
   3.650942969608245*^9, 3.6509429982157297`*^9}, {3.650945346457947*^9, 
   3.650945357257648*^9}, {3.650946371247857*^9, 3.650946378606975*^9}, {
   3.650946429006445*^9, 3.650946456270273*^9}, 3.6509466514681187`*^9, {
   3.6523418727845697`*^9, 3.652341875616096*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "138", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"X_", "?", "SymQ"}], ",", 
     RowBox[{"Y2___", "?", "deg2revParityQ"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"v1_", "?", "deg1Q"}], ",", 
       RowBox[{"Y1__", "?", "deg2Q"}]}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v1", ",", "Y1", ",", 
     RowBox[{"rev", "[", "Y2", "]"}], ",", "X"}], "\[RightAngleBracket]"}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650940465384179*^9, 3.6509405221027946`*^9}, {
   3.650945202555835*^9, 3.650945245531661*^9}, {3.650945350457863*^9, 
   3.6509453581532288`*^9}, {3.650946510974362*^9, 3.650946547118677*^9}, 
   3.6509466541231194`*^9, {3.652341918383629*^9, 3.652341920815683*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "139", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"Y1__", "?", "deg2Q"}], ",", 
       RowBox[{"v1_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", 
     RowBox[{"Y2___", "?", "deg2revParityQ"}], ",", 
     RowBox[{"X_", "?", "SymQ"}], ",", 
     RowBox[{"Y3___", "?", "deg2revParityQ"}], ",", 
     RowBox[{"v2_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v2", ",", 
     RowBox[{"rev", "[", "Y3", "]"}], ",", "X", ",", 
     RowBox[{"rev", "[", "Y2", "]"}], ",", "Y1", ",", "v1"}], 
    "\[RightAngleBracket]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650940096172756*^9, 3.65094011612468*^9}, {
  3.6509406161498623`*^9, 3.6509406777492027`*^9}, {3.6509408810901318`*^9, 
  3.650940884530011*^9}, {3.650941074944036*^9, 3.650941078655697*^9}, {
  3.650941300364794*^9, 3.650941310269093*^9}, {3.650941384747916*^9, 
  3.6509414205550613`*^9}, {3.6509428927795877`*^9, 3.650942895432457*^9}, {
  3.650942969608245*^9, 3.6509429982157297`*^9}, {3.650945346457947*^9, 
  3.650945357257648*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "140", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"v2_", "?", "deg1Q"}], ",", 
     RowBox[{"Y3___", "?", "deg2revParityQ"}], ",", 
     RowBox[{"X_", "?", "SymQ"}], ",", 
     RowBox[{"Y2___", "?", "deg2revParityQ"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"v1_", "?", "deg1Q"}], ",", 
       RowBox[{"Y1__", "?", "deg2Q"}]}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v1", ",", "Y1", ",", 
     RowBox[{"rev", "[", "Y2", "]"}], ",", "X", ",", 
     RowBox[{"rev", "[", "Y3", "]"}], ",", "v2"}], "\[RightAngleBracket]"}]}],
   "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650940465384179*^9, 3.6509405221027946`*^9}, {
  3.650945202555835*^9, 3.650945245531661*^9}, {3.650945350457863*^9, 
  3.6509453581532288`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "141", "]"}]], "Output"]
}, Open  ]],

Cell["Testing", "Text",
 CellChangeTimes->{{3.6500901908710423`*^9, 3.6500901925352297`*^9}, {
   3.6500905360503693`*^9, 3.650090540834115*^9}, 3.650938526943519*^9}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"M", ",", "X", ",", "v", ",", "w"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"v", ",", "w"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"2", ",", "M"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"4", ",", "X"}], "]"}]}], "Input",
 CellChangeTimes->{{3.650937554012788*^9, 3.65093765428366*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AssumeAntisymmetric", "[", "X", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6509376762638474`*^9, 3.650937689499522*^9}, {
  3.650937777946383*^9, 3.6509377806186247`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"M", ",", "w"}], "\[RightAngleBracket]"}], ",", "X"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"M", ",", "w"}], "\[RightAngleBracket]"}], ",", "X", ",", "v"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"X", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"w", ",", "M"}], "\[RightAngleBracket]"}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "X", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"w", ",", "M"}], "\[RightAngleBracket]"}]}], 
  "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.6509377001875362`*^9, 3.650937724477165*^9}, 
   3.6509378042991667`*^9, {3.650938443267721*^9, 3.650938479011139*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"X", ",", "M", ",", "w"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{
  3.650937749361974*^9, {3.6509378012451353`*^9, 3.650937805021831*^9}, 
   3.650938438321567*^9, 3.650938481402512*^9, 3.65094603530544*^9, 
   3.6509467657927837`*^9}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"v", ",", "X", ",", "M", ",", "w"}], 
   "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{
  3.650937749361974*^9, {3.6509378012451353`*^9, 3.650937805021831*^9}, 
   3.650938438321567*^9, 3.650938481402512*^9, 3.65094603530544*^9, 
   3.650946765797019*^9}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"w", ",", "M", ",", "X"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{
  3.650937749361974*^9, {3.6509378012451353`*^9, 3.650937805021831*^9}, 
   3.650938438321567*^9, 3.650938481402512*^9, 3.65094603530544*^9, 
   3.6509467658009233`*^9}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"w", ",", "M", ",", "X", ",", "v"}], 
   "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{
  3.650937749361974*^9, {3.6509378012451353`*^9, 3.650937805021831*^9}, 
   3.650938438321567*^9, 3.650938481402512*^9, 3.65094603530544*^9, 
   3.6509467658046*^9}]
}, Open  ]],

Cell["Testing", "Text",
 CellChangeTimes->{{3.650747299398423*^9, 3.6507473049986143`*^9}, 
   3.6507478590228252`*^9, {3.650748173084354*^9, 3.6507481905068293`*^9}, 
   3.650748279433423*^9}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"Y1", ",", "Y2", ",", "X1", ",", "X2", ",", "v1", ",", "v2"}], 
   "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"v1", ",", "v2"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"2", ",", 
   RowBox[{"{", 
    RowBox[{"Y1", ",", "Y2", ",", "X1", ",", "X2"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumeAntisymmetric", "[", 
   RowBox[{"{", "X1", "}"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumeSymmetric", "[", 
   RowBox[{"{", "X2", "}"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.650743145023921*^9, 3.650743233748724*^9}, {
  3.6507432758451643`*^9, 3.650743315864552*^9}, {3.6507435418836203`*^9, 
  3.650743554633032*^9}}],

Cell[BoxData[
 RowBox[{"StopDebug", "[", "]"}]], "Input",
 CellChangeTimes->{{3.6509403766357183`*^9, 3.650940380808402*^9}}],

Cell[BoxData[
 RowBox[{"UnsetRule", "[", "ruleToTest", "]"}]], "Input",
 CellChangeTimes->{{3.650747315564199*^9, 3.6507473269213552`*^9}, {
   3.6507474040801983`*^9, 3.650747405303112*^9}, 3.650747744930648*^9, {
   3.65074801402999*^9, 3.650748017293007*^9}, {3.650748092973175*^9, 
   3.650748095556106*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y1", ",", "Y2", ",", "v1"}], "\[RightAngleBracket]"}], ",", "X1",
    ",", "X2", ",", "v2"}], "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{{3.650743889626251*^9, 3.650743892339718*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"v2", ",", "X2", ",", "X1", ",", "Y1", ",", "Y2", ",", "v1"}], 
   "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{
  3.650743432198292*^9, {3.650743870629609*^9, 3.65074389306606*^9}, 
   3.650746912892996*^9, 3.650747778674281*^9, {3.650940355751955*^9, 
   3.65094038403157*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResetRule", "[", "ruleToTest", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.650747765842444*^9, 3.6507477864977713`*^9}, {
  3.650747914847989*^9, 3.650747915594697*^9}, {3.650747955631824*^9, 
  3.650747956095126*^9}, {3.650748020541705*^9, 3.6507480212125587`*^9}, {
  3.650748150380479*^9, 3.650748153044479*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y1", ",", "Y2", ",", "v1"}], "\[RightAngleBracket]"}], ",", "X1",
    ",", "X2", ",", "v2"}], "\[RightAngleBracket]"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"v2", ",", "X2", ",", "X1", ",", "Y1", ",", "Y2", ",", "v1"}], 
   "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{
  3.650747131963217*^9, 3.650747342973844*^9, {3.6507477831865807`*^9, 
   3.650747792274522*^9}, 3.650747925453796*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"V2", ",", "X2", ",", "X1", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v1", ",", "Y2", ",", "Y1"}], "\[RightAngleBracket]"}]}], 
  "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{{3.6509404215602493`*^9, 3.650940441944025*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"V2", ",", "X2", ",", "X1", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v1", ",", "Y2", ",", "Y1"}], "\[RightAngleBracket]"}]}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.650940442484013*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ruleToTest", "=."}]], "Input",
 CellChangeTimes->{{3.6507480252185802`*^9, 3.650748026334215*^9}, {
  3.65074815817197*^9, 3.650748160684229*^9}}],

Cell["\<\
------------------------------------------------------------------------------\
------------------------\
\>", "Text",
 CellChangeTimes->{{3.650747819087563*^9, 3.650747822646641*^9}, {
  3.650748178874786*^9, 3.650748182010768*^9}}],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------------------------\
\>", "Text",
 CellChangeTimes->{{3.6142918796899557`*^9, 3.614291886285962*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Shrinking  \[LeftAngleBracket] \[LeftAngleBracket] ,  ,  ,  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[RightAngleBracket]", " ", "\[RightAngleBracket]"}], "ab"], 
   TraditionalForm]]],
 "  \[Rule]  \[LeftAngleBracket] ,  , ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "   ", "\[RightAngleBracket]"}], "ab"], 
   TraditionalForm]]],
 " ,  , \[RightAngleBracket]          ---   code added 09/09/2015"
}], "Subsubsection",
 CellChangeTimes->{{3.614261645517123*^9, 3.6142616562363787`*^9}, {
   3.614261694220573*^9, 3.6142617430046787`*^9}, {3.6142920619764767`*^9, 
   3.614292096155726*^9}, 3.614292149725548*^9, 3.6143372882216997`*^9, {
   3.6159587916768713`*^9, 3.615958818125761*^9}, {3.615958850990827*^9, 
   3.615958870719182*^9}, {3.616533585046195*^9, 3.616533602179096*^9}, {
   3.61653370083517*^9, 3.61653371109122*^9}, 3.6507716385622787`*^9, {
   3.650771795024221*^9, 3.65077181452814*^9}, {3.650772336665063*^9, 
   3.6507724344890833`*^9}, 3.650836464832014*^9}],

Cell["\<\
Tensors X that are contracted on first or last slots with a vector  v  are OK \
as special brackets,  because  \[LeftAngleBracket] X, v \[RightAngleBracket]  \
and   \[LeftAngleBracket] v, X \[RightAngleBracket]  can be treated as \
elementary tensors 
of degree one less than X. We only need a few rules for such things,\
\>", "Text",
 CellChangeTimes->{{3.616278439474814*^9, 3.6162785232669773`*^9}, {
  3.616278577939118*^9, 3.616278659923112*^9}, {3.616279485682407*^9, 
  3.6162795285624447`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X_", ",", 
       RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], "ab__List"], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", "X", "\[RightAngleBracket]"}], "ab"], 
     ",", "v"}], "\[RightAngleBracket]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.616278679144822*^9, 3.616278810105867*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "142", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"v_", "?", "deg1Q"}], ",", "X_"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], "ab__List"], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v", ",", 
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", "X", "\[RightAngleBracket]"}], 
      RowBox[{"Apply", "[", 
       RowBox[{"Sequence", ",", 
        RowBox[{
         RowBox[{"{", "ab", "}"}], "+", "1"}]}], "]"}]]}], 
    "\[RightAngleBracket]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.616278821050359*^9, 3.616278860922851*^9}, {
  3.616279033243099*^9, 3.616279047146756*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "143", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
Added   09/09/2015   17:33
No ambiguity can be generated by the following because the resulting inner \
bracket is a vector,\
\>", "Text",
 CellChangeTimes->{{3.650772740722934*^9, 3.650772758211179*^9}, {
  3.6508283702424507`*^9, 3.650828387202196*^9}, {3.650828492592539*^9, 
  3.650828504288479*^9}, {3.650828601167027*^9, 3.650828685165803*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"M__", "?", "deg2Q"}], ",", 
       RowBox[{"F1_", "?", "deg3Q"}], ",", "X__"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"M", ",", "F1"}], "\[RightAngleBracket]"}], 
       "\[RightAngleBracket]"}], 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]], ",", "X"}], 
    "\[RightAngleBracket]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650770404228891*^9, 3.6507704511883907`*^9}, {
   3.650770513860482*^9, 3.650770537891634*^9}, {3.6507706105468817`*^9, 
   3.6507706168991203`*^9}, {3.650770648161949*^9, 3.650770684130191*^9}, 
   3.650770751856965*^9, {3.650770875039301*^9, 3.6507709274557447`*^9}, {
   3.650771006078548*^9, 3.6507710568467216`*^9}, {3.650828695298691*^9, 
   3.6508286973140593`*^9}, {3.650828734050396*^9, 3.650828743087799*^9}, {
   3.650829689939024*^9, 3.6508296987548723`*^9}, {3.650830747242487*^9, 
   3.65083075158811*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "144", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"X__", ",", 
        RowBox[{"F1_", "?", "deg3Q"}], ",", 
        RowBox[{"M__", "?", "deg2Q"}]}], "\[RightAngleBracket]"}], 
      "\[RightAngleBracket]"}], "ab_List"], "/;", 
    RowBox[{"ab", "===", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"degBracket", "[", "X", "]"}], ",", 
       RowBox[{"degBracket", "[", 
        RowBox[{"X", ",", "F1", ",", "M"}], "]"}]}], "}"}]}]}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X", ",", 
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"F1", ",", "M"}], "\[RightAngleBracket]"}], 
       "\[RightAngleBracket]"}], 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"degBracket", "[", 
         RowBox[{"F1", ",", "M"}], "]"}]}], "}"}]]}], 
    "\[RightAngleBracket]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650829813488948*^9, 3.650829830179616*^9}, 
   3.6508302621571827`*^9, {3.650830410858613*^9, 3.6508304531630907`*^9}, {
   3.6508304980262117`*^9, 3.650830505434332*^9}, {3.650830748725531*^9, 
   3.650830752917264*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "145", "]"}]], "Output"]
}, Open  ]],

Cell["11/09/2015,", "Text",
 CellChangeTimes->{{3.6509259734620857`*^9, 3.650925979654016*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"S_", "?", "deg2Q"}], ",", "\[CurlyEpsilon]4", ",", 
       RowBox[{"u_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"S", ",", "\[CurlyEpsilon]4"}], "\[RightAngleBracket]"}], 
       "\[RightAngleBracket]"}], 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]], ",", "u"}], 
    "\[RightAngleBracket]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650925982440502*^9, 3.650926014569273*^9}, {
  3.65092604847272*^9, 3.650926080217662*^9}, {3.6509261332075253`*^9, 
  3.650926138887044*^9}, {3.65092618808502*^9, 3.650926191093128*^9}, {
  3.6509263010915747`*^9, 3.65092630712335*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "146", "]"}]], "Output"]
}, Open  ]],

Cell["19/09/2015,", "Text",
 CellChangeTimes->{{3.651613725589861*^9, 3.6516138149360647`*^9}, {
  3.651614147040635*^9, 3.651614156690236*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{
         RowBox[{"X_", "?", "deg3Q"}], ",", 
         RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", 
       RowBox[{"Y_", "?", "deg2Q"}]}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"Y", ",", "X"}], "\[RightAngleBracket]"}], 
       "\[RightAngleBracket]"}], 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]], ",", "v"}], 
    "\[RightAngleBracket]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.651613825145697*^9, 3.6516139160211554`*^9}, {
  3.651614073860033*^9, 3.651614161345808*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "147", "]"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing", "Subsubsection",
 CellChangeTimes->{{3.615964848013156*^9, 3.615964853759129*^9}, 
   3.615968905921835*^9}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"M", ",", "F1", ",", "X", ",", "u", ",", "v", ",", "W"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{"1", ",", 
    RowBox[{"{", 
     RowBox[{"u", ",", "v"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{"2", ",", 
    RowBox[{"{", 
     RowBox[{"M", ",", "X"}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"3", ",", "F1"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{"4", ",", "W"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.615968415434499*^9, 3.615968480585637*^9}, {
  3.6508291130834827`*^9, 3.650829163545072*^9}, {3.650830612203409*^9, 
  3.650830631891656*^9}, {3.651615779804315*^9, 3.651615788237067*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"M", ",", "F1", ",", "X"}], "\[RightAngleBracket]"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"M", ",", "M", ",", "F1", ",", "X", ",", "v"}], 
    "\[RightAngleBracket]"}], "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}]]}], "Input",
 CellChangeTimes->{{3.615968485643558*^9, 3.6159684982775917`*^9}, {
  3.6159686227609797`*^9, 3.615968636533032*^9}, {3.6508291744249*^9, 
  3.65082921628039*^9}, {3.6508296326269217`*^9, 3.650829656610079*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"M", ",", "F1"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]], ",", "X"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.615968591796224*^9, 3.615968636901063*^9, 
  3.615968754881263*^9, 3.650829657900621*^9, 3.650829736307143*^9, 
  3.65082993575705*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"M", ",", "M", ",", "F1"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]], ",", "X", ",", "v"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.615968591796224*^9, 3.615968636901063*^9, 
  3.615968754881263*^9, 3.650829657900621*^9, 3.650829736307143*^9, 
  3.650829935759408*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X", ",", "F1", ",", "M"}], "\[RightAngleBracket]"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"2", ",", "3"}], "}"}]]], "Input",
 CellChangeTimes->{{3.615968485643558*^9, 3.6159684982775917`*^9}, {
  3.6159686227609797`*^9, 3.615968636533032*^9}, {3.6508291744249*^9, 
  3.65082921628039*^9}, {3.6508296326269217`*^9, 3.650829656610079*^9}, {
  3.650829999901945*^9, 3.650830026188683*^9}, {3.650830153851101*^9, 
  3.650830156538417*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"X", ",", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"F1", ",", "M"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}]]}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{
  3.65083002786766*^9, 3.6508300926046877`*^9, {3.650830127340024*^9, 
   3.650830157304702*^9}, 3.6508302683901997`*^9, 3.650830512520183*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"M", ",", "F1", ",", "W"}], "\[RightAngleBracket]"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}]]], "Input",
 CellChangeTimes->{{3.650830649555545*^9, 3.650830650371414*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"M", ",", "F1"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]], ",", "W"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.650830651700589*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"W", ",", "F1", ",", "M"}], "\[RightAngleBracket]"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"4", ",", "5"}], "}"}]]], "Input",
 CellChangeTimes->{{3.615968485643558*^9, 3.6159684982775917`*^9}, {
  3.6159686227609797`*^9, 3.615968636533032*^9}, {3.6508291744249*^9, 
  3.65082921628039*^9}, {3.6508296326269217`*^9, 3.650829656610079*^9}, {
  3.650829999901945*^9, 3.650830026188683*^9}, {3.650830153851101*^9, 
  3.650830156538417*^9}, {3.650830665620294*^9, 3.650830665971439*^9}, {
  3.6508307101003113`*^9, 3.650830712274414*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"W", ",", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"F1", ",", "M"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}]]}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.650830672132099*^9, 3.650830713749337*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"F1", ",", "v"}], "\[RightAngleBracket]"}], ",", "M"}], 
    "\[RightAngleBracket]"}], "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}]]], "Input",
 CellChangeTimes->{{3.65161444271553*^9, 3.6516144786861486`*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"M", ",", "F1"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]], ",", "v"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.651614479961487*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"degBracket", "[", 
  RowBox[{"X", ",", "F1", ",", "M"}], "]"}]], "Input",
 CellChangeTimes->{{3.6508302963446503`*^9, 3.650830298616302*^9}}],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{3.6508303003450813`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"degBracket", "[", "X", "]"}]], "Input",
 CellChangeTimes->{{3.6508301751298037`*^9, 3.650830231488696*^9}, {
  3.650830306680056*^9, 3.6508303068571463`*^9}}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.650830177402668*^9, 3.6508302060200787`*^9}, 
   3.65083030840219*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"M", ",", "F1", ",", "X", ",", "v", ",", "W"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6159688697367277`*^9, 3.615968871416716*^9}, {
  3.650836436418825*^9, 3.650836440878586*^9}}],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------------------------\
\>", "Text",
 CellChangeTimes->{{3.6142918796899557`*^9, 3.614291886285962*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "What to do with  \[LeftAngleBracket] ,  , ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "   ", "\[RightAngleBracket]"}], "ab"], 
   TraditionalForm]]],
 " ,  , \[RightAngleBracket]                          ---   are these wanted \
?  Try turning off"
}], "Subsubsection",
 CellChangeTimes->{{3.614261645517123*^9, 3.6142616562363787`*^9}, {
   3.614261694220573*^9, 3.6142617430046787`*^9}, {3.6142920619764767`*^9, 
   3.614292096155726*^9}, 3.614292149725548*^9, 3.6143372882216997`*^9, {
   3.6159587916768713`*^9, 3.615958818125761*^9}, {3.615958850990827*^9, 
   3.615958870719182*^9}, {3.616533585046195*^9, 3.616533602179096*^9}, {
   3.61653370083517*^9, 3.61653371109122*^9}, 3.6507716385622787`*^9, {
   3.650771795024221*^9, 3.65077181452814*^9}, {3.650772420807344*^9, 
   3.650772422263701*^9}, 3.650836466799704*^9}],

Cell[TextData[{
 "If   ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "   ", "\[RightAngleBracket]"}], "ab"], 
   TraditionalForm]]],
 "  is not deg 1 or 2  then we shall want to re-write the mixed  \
special/general  bracket expression in terms of a pure  general-bracket.\n\
Before doing so, the following rules can be used to simplify things by \
binding with any vector contracted on first or last slots, "
}], "Text",
 CellChangeTimes->{{3.6159589066844273`*^9, 3.615959047152379*^9}, {
  3.616278300547187*^9, 3.616278354163657*^9}, {3.616278957811062*^9, 
  3.616278992066999*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"v_", "?", "deg1Q"}], ",", 
      SubscriptBox[
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"X1_", "\[CircleTimes]", "X2___"}], "\[RightAngleBracket]"}], 
       "ab__List"], ",", "Y__"}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{"!", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", "1", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}]}], ":=", " ", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
        RowBox[{"\[LeftAngleBracket]", 
         RowBox[{"v", ",", "X1"}], "\[RightAngleBracket]"}], "\[CircleTimes]",
         "X2"}], "\[RightAngleBracket]"}], 
      RowBox[{"Apply", "[", 
       RowBox[{"Sequence", ",", 
        RowBox[{
         RowBox[{"{", "ab", "}"}], "-", "1"}]}], "]"}]], ",", "Y"}], 
    "\[RightAngleBracket]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615959058381543*^9, 3.615959160967228*^9}, {
   3.615959451513309*^9, 3.6159594544280367`*^9}, {3.6159596294158983`*^9, 
   3.6159596766433973`*^9}, {3.615959732613394*^9, 3.615959741053651*^9}, 
   3.615959774861411*^9, {3.6159606578901367`*^9, 3.615960663410019*^9}, {
   3.6162308350408163`*^9, 3.616230849564247*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "148", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"v_", "?", "deg1Q"}], ",", 
      SubscriptBox[
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"X1_", "\[CircleTimes]", "X2___"}], "\[RightAngleBracket]"}], 
       "ab__List"]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{"!", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", "1", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}]}], ":=", " ", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"v", ",", "X1"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
      "X2"}], "\[RightAngleBracket]"}], 
    RowBox[{"Apply", "[", 
     RowBox[{"Sequence", ",", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], "-", "1"}]}], "]"}]]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615959784780409*^9, 3.615959797164653*^9}, {
  3.615960667289777*^9, 3.6159606716325483`*^9}, {3.616230856493918*^9, 
  3.616230864720443*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "149", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y__", ",", 
      SubscriptBox[
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"X1___", "\[CircleTimes]", "X2_"}], "\[RightAngleBracket]"}], 
       "ab__List"], ",", 
      RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{"!", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", 
       RowBox[{
        RowBox[{"deg", "[", "X1", "]"}], "+", 
        RowBox[{"deg", "[", "X2", "]"}]}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}]}], ":=", " ", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y", ",", 
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"X1", "\[CircleTimes]", 
        RowBox[{"\[LeftAngleBracket]", 
         RowBox[{"X2", ",", "v"}], "\[RightAngleBracket]"}]}], 
       "\[RightAngleBracket]"}], "ab"]}], "\[RightAngleBracket]"}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615959058381543*^9, 3.615959160967228*^9}, {
   3.615959451513309*^9, 3.6159594544280367`*^9}, {3.6159596294158983`*^9, 
   3.6159596766433973`*^9}, {3.615959732613394*^9, 3.615959741053651*^9}, 
   3.615959774861411*^9, {3.615959849131909*^9, 3.6159598576486883`*^9}, {
   3.615959894250602*^9, 3.6159599670561533`*^9}, {3.615960135883276*^9, 
   3.615960185568192*^9}, {3.615960668299664*^9, 3.615960672595087*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "150", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      SubscriptBox[
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"X1___", "\[CircleTimes]", "X2_"}], "\[RightAngleBracket]"}], 
       "ab__List"], ",", 
      RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{"!", 
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"{", "ab", "}"}], ",", 
       RowBox[{
        RowBox[{"deg", "[", "X1", "]"}], "+", 
        RowBox[{"deg", "[", "X2", "]"}]}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}]}], ":=", " ", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X1", "\[CircleTimes]", 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"X2", ",", "v"}], "\[RightAngleBracket]"}]}], 
     "\[RightAngleBracket]"}], "ab"]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615959784780409*^9, 3.615959797164653*^9}, {
  3.61595986494075*^9, 3.615959900285201*^9}, {3.615960189613858*^9, 
  3.61596019417712*^9}, {3.61596026647659*^9, 3.615960297875197*^9}, {
  3.615960669019436*^9, 3.615960673408318*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "151", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
Checking membership is faster than Min/Max.
Giving a level spec is faster than Flatten (all are fast),\
\>", "Text",
 CellChangeTimes->{{3.615959362047925*^9, 3.615959375873827*^9}, {
  3.6159594250399323`*^9, 3.61595943401623*^9}, {3.615960036034865*^9, 
  3.615960053733347*^9}, {3.615960094692074*^9, 3.615960095461616*^9}, {
  3.615960224948284*^9, 3.615960230006194*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Min", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", "6"}], "}"}]}], "}"}], "]"}], ">", "1"}], ",", 
    RowBox[{"{", "100000", "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", "6"}], "}"}]}], "}"}], ",", "3", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], ",", 
    RowBox[{"{", "100000", "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "6"}], "}"}]}], "}"}], "]"}], ",", "3"}], "]"}], 
    ",", 
    RowBox[{"{", "100000", "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.615959275130199*^9, 3.615959301292141*^9}, {
   3.6159593475506907`*^9, 3.615959349182537*^9}, {3.615959398032324*^9, 
   3.615959418976307*^9}, {3.615959500911345*^9, 3.6159595058429203`*^9}, 
   3.615959597646591*^9, {3.615959990222248*^9, 3.615960012504497*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.16800999999999999268140982167096808553`5.245935045098165", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.6159592966784067`*^9, 3.615959302404475*^9}, {
   3.6159594046210117`*^9, 3.615959437823165*^9}, {3.6159595077702503`*^9, 
   3.615959518934094*^9}, 3.61595957090949*^9, 3.6159596046454697`*^9, 
   3.615960023275421*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.10000699999999999867394961938771302812`5.020630312829385", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.6159592966784067`*^9, 3.615959302404475*^9}, {
   3.6159594046210117`*^9, 3.615959437823165*^9}, {3.6159595077702503`*^9, 
   3.615959518934094*^9}, 3.61595957090949*^9, 3.6159596046454697`*^9, 
   3.615960023374456*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.16001000000000001333155807969887973741`5.224747038492471", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.6159592966784067`*^9, 3.615959302404475*^9}, {
   3.6159594046210117`*^9, 3.615959437823165*^9}, {3.6159595077702503`*^9, 
   3.615959518934094*^9}, 3.61595957090949*^9, 3.6159596046454697`*^9, 
   3.6159600235341663`*^9}]
}, Open  ]],

Cell["\<\
==============================================================================\
==============================================================================\

00:02  12/8/2014.  These all turned off because of the two that loop \
(commented).  Need to think about these.\
\>", "Text",
 CellChangeTimes->{{3.616754548345736*^9, 3.616754589354463*^9}, {
  3.6167546741547213`*^9, 3.616754708715125*^9}}],

Cell[TextData[{
 "Appart from the above special cases (delt with first),  if the  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "   ", "\[RightAngleBracket]"}], "ab"], 
   TraditionalForm]]],
 " is deg > 2 then we just want to re-write any mixed  special/general  \
bracket expressions in \nterms of a pure  general-bracket.  But this is just \
a special case of getting rid of special-brackets that have arguments with \
deg > 2.\nIgnore the cases where the deg>2 argument combines with a vector"
}], "Text",
 CellChangeTimes->{{3.615960702166273*^9, 3.615960800902545*^9}, {
  3.615961058665756*^9, 3.615961080392766*^9}, {3.615961146664186*^9, 
  3.615961153627111*^9}, {3.615962581765167*^9, 3.615962609635151*^9}, {
  3.61596364127098*^9, 3.615963644009205*^9}, {3.6159671014335423`*^9, 
  3.615967173881105*^9}}],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"X_", "/;", 
      RowBox[{
       RowBox[{"deg", "[", "X", "]"}], ">", "2"}]}], ",", 
     RowBox[{"Z_", "/;", 
      RowBox[{
       RowBox[{"deg", "[", "Z", "]"}], ">", "1"}]}]}], 
    "\[RightAngleBracket]"}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X", "\[CircleTimes]", "Z"}], "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "+", 
     RowBox[{"deg", "[", "X", "]"}]}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.615963826496376*^9, 3.615963830339031*^9}, {
   3.6159639241450233`*^9, 3.6159639560830917`*^9}, {3.6159639918701572`*^9, 
   3.615964027028328*^9}, {3.615964131075735*^9, 3.61596413399004*^9}, 
   3.615964450789646*^9, {3.615964703431362*^9, 3.615964737076207*^9}, {
   3.615964803160101*^9, 3.615964811717517*^9}, 3.6159666356746798`*^9, {
   3.615966795728149*^9, 3.615966799842668*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddRule", "[", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"X_", "/;", 
       RowBox[{
        RowBox[{"deg", "[", "X", "]"}], ">", "2"}]}], ",", 
      RowBox[{"Z__", "/;", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "Z", "}"}], "]"}], ">", "1"}]}]}], 
     "\[RightAngleBracket]"}], ":=", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X", "\[CircleTimes]", 
       RowBox[{"\[LeftAngleBracket]", "Z", "\[RightAngleBracket]"}]}], 
      "\[RightAngleBracket]"}], 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "+", 
      RowBox[{"deg", "[", "X", "]"}]}]]}], "]"}], "                     ", 
  RowBox[{"(*", " ", "loops", " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.615963826496376*^9, 3.615963830339031*^9}, {
   3.6159639241450233`*^9, 3.6159639560830917`*^9}, {3.6159639918701572`*^9, 
   3.615964027028328*^9}, {3.615964131075735*^9, 3.61596413399004*^9}, 
   3.615964450789646*^9, {3.615964564086936*^9, 3.615964585800164*^9}, {
   3.615964705383738*^9, 3.615964760680517*^9}, {3.615964804257401*^9, 
   3.615964812824088*^9}, {3.616754621413903*^9, 3.61675463806901*^9}}],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"Y_", "/;", 
      RowBox[{
       RowBox[{"deg", "[", "Y", "]"}], ">", "1"}]}], ",", 
     RowBox[{"X_", "/;", 
      RowBox[{
       RowBox[{"deg", "[", "X", "]"}], ">", "2"}]}]}], 
    "\[RightAngleBracket]"}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y", "\[CircleTimes]", "X"}], "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "+", 
     RowBox[{"deg", "[", "Y", "]"}]}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.615960822509354*^9, 3.615960889617461*^9}, {
  3.615961090941387*^9, 3.615961106978119*^9}, {3.615962613225219*^9, 
  3.615962632877181*^9}, {3.615963063196084*^9, 3.615963098222837*^9}, {
  3.615963179612706*^9, 3.615963225516993*^9}, {3.615963343503372*^9, 
  3.61596335878531*^9}, {3.615963388798848*^9, 3.6159634102267313`*^9}, {
  3.615963444465431*^9, 3.6159634952997637`*^9}, {3.615963677842415*^9, 
  3.615963682050352*^9}, {3.615963731904626*^9, 3.615963751551876*^9}, {
  3.6159641043224907`*^9, 3.6159641156838703`*^9}, {3.615964804934669*^9, 
  3.615964813605754*^9}, {3.61596684458545*^9, 3.6159668480008707`*^9}}],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"Y_", "/;", 
      RowBox[{
       RowBox[{"deg", "[", "Y", "]"}], ">", "1"}]}], ",", 
     RowBox[{"X_", "/;", 
      RowBox[{
       RowBox[{"deg", "[", "X", "]"}], ">", "2"}]}], ",", 
     RowBox[{"Z_", "/;", 
      RowBox[{
       RowBox[{"deg", "[", "Z", "]"}], ">", "1"}]}]}], 
    "\[RightAngleBracket]"}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y", "\[CircleTimes]", "X", "\[CircleTimes]", "Z"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "+", 
      RowBox[{"deg", "[", "Y", "]"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"deg", "[", "Y", "]"}], "+", 
        RowBox[{"deg", "[", "X", "]"}]}], ")"}]}]}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.615963826496376*^9, 3.615963830339031*^9}, {
   3.6159639241450233`*^9, 3.6159639560830917`*^9}, {3.6159639918701572`*^9, 
   3.615964027028328*^9}, {3.615964131075735*^9, 3.61596413399004*^9}, 
   3.615964450789646*^9, {3.615964805619608*^9, 3.6159648143119717`*^9}, {
   3.615966881703603*^9, 3.615966892423789*^9}}],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"Y_", "/;", 
      RowBox[{
       RowBox[{"deg", "[", "Y", "]"}], ">", "1"}]}], ",", 
     RowBox[{"X_", "/;", 
      RowBox[{
       RowBox[{"deg", "[", "X", "]"}], ">", "2"}]}], ",", 
     RowBox[{"Z__", "/;", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "Z", "}"}], "]"}], ">", "1"}]}]}], 
    "\[RightAngleBracket]"}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y", "\[CircleTimes]", "X", "\[CircleTimes]", 
      RowBox[{"\[LeftAngleBracket]", "Z", "\[RightAngleBracket]"}]}], 
     "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "+", 
      RowBox[{"deg", "[", "Y", "]"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"deg", "[", "Y", "]"}], "+", 
        RowBox[{"deg", "[", "X", "]"}]}], ")"}]}]}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.615963826496376*^9, 3.615963830339031*^9}, {
   3.6159639241450233`*^9, 3.6159639560830917`*^9}, {3.6159639918701572`*^9, 
   3.615964027028328*^9}, {3.615964131075735*^9, 3.61596413399004*^9}, 
   3.615964450789646*^9, {3.615964564086936*^9, 3.615964585800164*^9}, {
   3.615964806324111*^9, 3.615964815131778*^9}, 3.615967055263896*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddRule", "[", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"Y__", "/;", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "Y", "}"}], "]"}], ">", "1"}]}], ",", 
      RowBox[{"X_", "/;", 
       RowBox[{
        RowBox[{"deg", "[", "X", "]"}], ">", "2"}]}]}], 
     "\[RightAngleBracket]"}], ":=", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"\[LeftAngleBracket]", "Y", "\[RightAngleBracket]"}], 
       "\[CircleTimes]", "X"}], "\[RightAngleBracket]"}], 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "+", 
      RowBox[{"deg", "[", 
       RowBox[{"\[LeftAngleBracket]", "Y", "\[RightAngleBracket]"}], 
       "]"}]}]]}], "]"}], "                ", 
  RowBox[{"(*", " ", "loops", " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.615964807001033*^9, 3.6159648158985367`*^9}, {
  3.616754644444304*^9, 3.616754647173229*^9}, {3.616754712356668*^9, 
  3.6167547331568193`*^9}}],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"Y__", "/;", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "Y", "}"}], "]"}], ">", "1"}]}], ",", 
     RowBox[{"X_", "/;", 
      RowBox[{
       RowBox[{"deg", "[", "X", "]"}], ">", "2"}]}], ",", 
     RowBox[{"Z_", "/;", 
      RowBox[{
       RowBox[{"deg", "[", "Z", "]"}], ">", "1"}]}]}], 
    "\[RightAngleBracket]"}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"\[LeftAngleBracket]", "Y", "\[RightAngleBracket]"}], 
      "\[CircleTimes]", "X", "\[CircleTimes]", "Z"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "+", 
      RowBox[{"deg", "[", 
       RowBox[{"\[LeftAngleBracket]", "Y", "\[RightAngleBracket]"}], "]"}]}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"deg", "[", 
         RowBox[{"\[LeftAngleBracket]", "Y", "\[RightAngleBracket]"}], "]"}], 
        "+", 
        RowBox[{"deg", "[", "X", "]"}]}], ")"}]}]}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.615964195651599*^9, 3.6159641971123543`*^9}, {
   3.6159642388035517`*^9, 3.615964291719314*^9}, 3.6159644977994957`*^9, {
   3.6159648080499897`*^9, 3.615964816585311*^9}, {3.6159670638027887`*^9, 
   3.615967066503096*^9}}],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"Y__", "/;", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "Y", "}"}], "]"}], ">", "1"}]}], ",", 
     RowBox[{"X_", "/;", 
      RowBox[{
       RowBox[{"deg", "[", "X", "]"}], ">", "2"}]}], ",", 
     RowBox[{"Z__", "/;", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "Z", "}"}], "]"}], ">", "1"}]}]}], 
    "\[RightAngleBracket]"}], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"\[LeftAngleBracket]", "Y", "\[RightAngleBracket]"}], 
      "\[CircleTimes]", "X", "\[CircleTimes]", 
      RowBox[{"\[LeftAngleBracket]", "Z", "\[RightAngleBracket]"}]}], 
     "\[RightAngleBracket]"}], 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "+", 
      RowBox[{"deg", "[", 
       RowBox[{"\[LeftAngleBracket]", "Y", "\[RightAngleBracket]"}], "]"}]}], 
     ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"deg", "[", 
         RowBox[{"\[LeftAngleBracket]", "Y", "\[RightAngleBracket]"}], "]"}], 
        "+", 
        RowBox[{"deg", "[", "X", "]"}]}], ")"}]}]}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.615964195651599*^9, 3.6159641971123543`*^9}, {
   3.6159642388035517`*^9, 3.615964291719314*^9}, {3.6159644977994957`*^9, 
   3.615964522055838*^9}, {3.615964616873691*^9, 3.61596462052146*^9}, {
   3.61596480909829*^9, 3.615964817298698*^9}, 3.615968718216016*^9}],

Cell["\<\
==============================================================================\
==============================================================================\
\>", "Text",
 CellChangeTimes->{{3.616754548345736*^9, 3.616754554494288*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing", "Subsubsection",
 CellChangeTimes->{{3.615964848013156*^9, 3.615964853759129*^9}, 
   3.655319350105824*^9}],

Cell["One test for each of the 8 rules above,", "Text",
 CellChangeTimes->{{3.61596521286339*^9, 3.615965247855547*^9}}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{
   "Y1", ",", "Y2", ",", "X", ",", "Z1", ",", "Z2", ",", "Y", ",", "Z"}], 
   "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"2", ",", 
   RowBox[{"{", 
    RowBox[{"Y1", ",", "Y2", ",", "Z1", ",", "Z2", ",", "Y", ",", "Z"}], 
    "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"3", ",", "X"}], "]"}]}], "Input",
 CellChangeTimes->{{3.615964863679544*^9, 3.61596494354177*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"X", ",", "Z"}], "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"X", ",", "Z1", ",", "Z2"}], "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.615964954837512*^9, 3.615964967331086*^9}, {
  3.615965018819147*^9, 3.615965020819022*^9}}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"X", "\[CircleTimes]", "Z"}], "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"3", ",", "4"}], "}"}]]], "Output",
 CellChangeTimes->{3.615964974019755*^9, 3.615965027111157*^9}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"X", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Z1", ",", "Z2"}], "\[RightAngleBracket]"}]}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"3", ",", "4"}], "}"}]]], "Output",
 CellChangeTimes->{3.615964974019755*^9, 3.615965027123337*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"Y", ",", "X"}], "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"Y", ",", "X", ",", "Z"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"Y", ",", "X", ",", "Z1", ",", "Z2"}], 
  "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.615965002978311*^9, 3.615965049383432*^9}}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"Y", "\[CircleTimes]", "X"}], "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"2", ",", "3"}], "}"}]]], "Output",
 CellChangeTimes->{3.6159650128944902`*^9, 3.6159650519464684`*^9}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"Y", "\[CircleTimes]", "X", "\[CircleTimes]", "Z"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}]}]]], "Output",
 CellChangeTimes->{3.6159650128944902`*^9, 3.615965051958063*^9}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"Y", "\[CircleTimes]", "X", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Z1", ",", "Z2"}], "\[RightAngleBracket]"}]}], 
   "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}]}]]], "Output",
 CellChangeTimes->{3.6159650128944902`*^9, 3.615965051969883*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"Y1", ",", "Y2", ",", "X"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"Y1", ",", "Y2", ",", "X", ",", "Z"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"Y1", ",", "Y2", ",", "X", ",", "Z1", ",", "Z2"}], 
  "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.615965002978311*^9, 3.615965049383432*^9}, {
  3.615965133395688*^9, 3.615965145735291*^9}}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1", ",", "Y2"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
    "X"}], "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"2", ",", "3"}], "}"}]]], "Output",
 CellChangeTimes->{3.61596515317426*^9}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1", ",", "Y2"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
    "X", "\[CircleTimes]", "Z"}], "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}]}]]], "Output",
 CellChangeTimes->{3.61596515318349*^9}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1", ",", "Y2"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
    "X", "\[CircleTimes]", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Z1", ",", "Z2"}], "\[RightAngleBracket]"}]}], 
   "\[RightAngleBracket]"}], 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}]}]]], "Output",
 CellChangeTimes->{3.61596515319088*^9}]
}, Open  ]],

Cell["\<\
If user input gives a vector contracted with a tensor on its 1st or last \
slot, bind them together within  \[LeftAngleBracket]  ,  \[RightAngleBracket] \
so that it can behave as a tensor of degree 1 less.
The rules for the flatness of  \[LeftAngleBracket] , \[RightAngleBracket]  \
will not unbind them because they test for degree \[LessEqual] 2,\
\>", "Text",
 CellChangeTimes->{{3.615967734652619*^9, 3.6159678983497763`*^9}, {
  3.6159683669282637`*^9, 3.615968367360138*^9}}],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"v_", "?", "deg1Q"}], ",", 
     RowBox[{"X_", "/;", 
      RowBox[{
       RowBox[{"deg", "[", "X", "]"}], ">", "2"}]}], ",", "Y__"}], 
    "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"v", ",", "X"}], "\[RightAngleBracket]"}], ",", "Y"}], 
    "\[RightAngleBracket]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.615968181795239*^9, 3.615968312215456*^9}, {
  3.6159694727364607`*^9, 3.615969481118723*^9}}],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y__", ",", 
     RowBox[{"X_", "/;", 
      RowBox[{
       RowBox[{"deg", "[", "X", "]"}], ">", "2"}]}], ",", 
     RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y", ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X", ",", "v"}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.615968323464353*^9, 3.615968354295768*^9}, {
  3.615969485158599*^9, 3.615969487486745*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing", "Subsubsection",
 CellChangeTimes->{{3.615964848013156*^9, 3.615964853759129*^9}, 
   3.615968905921835*^9}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"v", ",", "X", ",", "Y1", ",", "Y2"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{"1", ",", "v"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"2", ",", 
    RowBox[{"{", 
     RowBox[{"Y1", ",", "Y2"}], "}"}]}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"3", ",", "X"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.615968415434499*^9, 3.615968480585637*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "X", ",", "Y1", ",", "Y2"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"Y1", ",", "Y2", ",", "X", ",", "v"}], 
  "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.615968485643558*^9, 3.6159684982775917`*^9}, {
  3.6159686227609797`*^9, 3.615968636533032*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v", ",", "X"}], "\[RightAngleBracket]"}], ",", "Y1", ",", "Y2"}],
   "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.615968591796224*^9, 3.615968636901063*^9, 
  3.615968754881263*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"Y1", ",", "Y2", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X", ",", "v"}], "\[RightAngleBracket]"}]}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.615968591796224*^9, 3.615968636901063*^9, 
  3.6159687548875523`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{
   "v", ",", "Y1", ",", "Y2", ",", "X", ",", "Z1", ",", "Z2", ",", "Y", ",", 
    "Z"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.6159688697367277`*^9, 3.615968871416716*^9}}],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------------------------\
\>", "Text",
 CellChangeTimes->{{3.6142918796899557`*^9, 3.614291886285962*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "rev[  \[LeftAngleBracket] ,  ,  ,  \[RightAngleBracket]  ]    and    rev[  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "   ", "\[RightAngleBracket]"}], "ab"], 
   TraditionalForm]], "None"],
 "  ]   "
}], "Subsubsection",
 CellChangeTimes->{{3.614336957915185*^9, 3.61433697346539*^9}, {
   3.6143370360915003`*^9, 3.614337080124157*^9}, {3.614728323898548*^9, 
   3.6147283291932707`*^9}, {3.6194966296171083`*^9, 3.619496629617293*^9}, {
   3.649725986922913*^9, 3.649726022826323*^9}, 3.6498330596984653`*^9, {
   3.649901221931573*^9, 3.649901256842812*^9}, {3.649901328570293*^9, 
   3.64990135052383*^9}, 3.6499895609845753`*^9}],

Cell["", "Text"],

Cell["\<\
If the bracket argument in  rev[ \[LeftAngleBracket] \[RightAngleBracket] ]  \
is  deg0or1Q  then it is invariant, so if  \[LeftAngleBracket]\
\[RightAngleBracket]+rev[\[LeftAngleBracket]\[RightAngleBracket]]=0 then \
\[LeftAngleBracket]\[RightAngleBracket]=0.  But this needs to be caught \
already, and if it is not caught then code needs to 
be written to do so.  So catching that in the definition of  rev[\
\[LeftAngleBracket]\[RightAngleBracket]]  would just hide a problem, not fix \
it. 

Similarly, we should assume that the \[LeftAngleBracket]\[RightAngleBracket] \
(which has already been fully evaluated) is already in its simplest possible \
form (including the possible application of  rev[rev[ ]] ), 
so if it has any rev-symmetry (revEvenQ or  revOddQ)   it should be left \
alone.  This is taken case of by a basic rev[ ] rule (in the main rev[ ] \
section).  This also means that  SymQ  
and  AntisymQ  should be defined for as many things as possible, including \
deduced symmetries of special angle bracket patterns.

Thus, the only thing that rev might have to do is check is that   \
a_AngleBracket  is not  revEvenQ or  revOddQ.  But those cases will already \
have been caught since rules are 
typically applied in definition order (and we shall check the rule order),\
\>", "Text",
 CellChangeTimes->{{3.64997332798873*^9, 3.649973387428166*^9}, {
  3.649980205733694*^9, 3.6499803915548487`*^9}, {3.649981618817964*^9, 
  3.6499817187373466`*^9}, {3.649981761552182*^9, 3.649982085915572*^9}, {
  3.649982719858816*^9, 3.649982844209269*^9}, {3.649983203420566*^9, 
  3.649983273035708*^9}, {3.649983854691634*^9, 3.6499838683074903`*^9}, {
  3.649983954290379*^9, 3.649984075089642*^9}, {3.649984528026617*^9, 
  3.6499845291623507`*^9}, {3.6499845597548437`*^9, 3.649984597433483*^9}, {
  3.6499849805487547`*^9, 3.649985015380232*^9}, {3.649985074851027*^9, 
  3.649985097490855*^9}, {3.6499853859032373`*^9, 3.6499853983344*^9}, {
  3.6499896747260857`*^9, 3.649989750773211*^9}, {3.649989797092473*^9, 
  3.649989881971245*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", " ", 
  RowBox[{
   RowBox[{"rev", "[", 
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", "X_", "\[RightAngleBracket]"}], 
     "ab__List"], "]"}], ":=", " ", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"rev", "[", "X", "]"}], "\[RightAngleBracket]"}], 
    RowBox[{"Apply", "[", 
     RowBox[{"Sequence", ",", 
      RowBox[{
       RowBox[{"deg", "[", "X", "]"}], "+", "1", "-", 
       RowBox[{"{", "ab", "}"}]}]}], "]"}]]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649985338658402*^9, 3.6499853481264544`*^9}, {
  3.649985478976488*^9, 3.6499854858105164`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "152", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", " ", 
  RowBox[{
   RowBox[{"rev", "[", 
    RowBox[{"a_AngleBracket", "/;", 
     RowBox[{
      RowBox[{"Length", "[", "a", "]"}], ">", "1"}]}], "]"}], ":=", " ", 
   RowBox[{"Apply", "[", 
    RowBox[{"AngleBracket", ",", 
     RowBox[{"rev", "[", 
      RowBox[{"Apply", "[", 
       RowBox[{"List", ",", "a"}], "]"}], "]"}]}], "]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.649729967560491*^9, 3.6497301490813513`*^9}, {
   3.6497302590019493`*^9, 3.64973035181632*^9}, {3.64973048309857*^9, 
   3.6497304965535517`*^9}, 3.649730590222224*^9, {3.649730673780899*^9, 
   3.649730704677067*^9}, {3.649730749558054*^9, 3.649730770828184*^9}, {
   3.649730877284828*^9, 3.649730880900138*^9}, {3.649730971772325*^9, 
   3.6497309883018103`*^9}, {3.649731018877644*^9, 3.64973103313824*^9}, {
   3.6497310841296597`*^9, 3.649731086418235*^9}, {3.649731119950337*^9, 
   3.649731217970676*^9}, {3.649731284865725*^9, 3.649731354446566*^9}, {
   3.6497371884929037`*^9, 3.64973719134866*^9}, 3.6497418897625837`*^9, {
   3.649843009028702*^9, 3.649843019571434*^9}, {3.649843095956946*^9, 
   3.649843145845536*^9}, {3.6498432308690453`*^9, 3.6498432422174673`*^9}, {
   3.649843354549893*^9, 3.649843390838004*^9}, {3.649843431477322*^9, 
   3.6498434446457443`*^9}, {3.649845693222549*^9, 3.6498458175743637`*^9}, {
   3.649845932146634*^9, 3.6498459505943813`*^9}, {3.6498460117778397`*^9, 
   3.649846086975649*^9}, {3.649846742621254*^9, 3.6498467819284267`*^9}, {
   3.649846822304845*^9, 3.64984683079298*^9}, {3.649846884392193*^9, 
   3.64984689825002*^9}, {3.6498469544901943`*^9, 3.649847079877936*^9}, {
   3.649847138468913*^9, 3.6498471420536737`*^9}, {3.649847258224684*^9, 
   3.649847274596534*^9}, {3.649847344546667*^9, 3.649847358818762*^9}, {
   3.649847539313579*^9, 3.649847540240192*^9}, {3.6498476499604387`*^9, 
   3.649847676045999*^9}, {3.649881570493*^9, 3.6498816245525017`*^9}, {
   3.6498816659145327`*^9, 3.649881691110197*^9}, {3.649881731766732*^9, 
   3.649881746393795*^9}, {3.6498817810516567`*^9, 3.649881868761935*^9}, 
   3.6498819498341923`*^9, {3.6498820411589737`*^9, 3.6498820485998373`*^9}, {
   3.6498877836024513`*^9, 3.649887838339449*^9}, {3.649887921829686*^9, 
   3.6498879364993563`*^9}, {3.6498885587629347`*^9, 3.649888615008322*^9}, {
   3.649888689960281*^9, 3.649888886067807*^9}, 3.649888964114028*^9, {
   3.649889476539193*^9, 3.6498895140129623`*^9}, {3.649889549357448*^9, 
   3.6498896819795303`*^9}, {3.649889903223939*^9, 3.649889949641246*^9}, {
   3.6498899924722757`*^9, 3.6498900305517073`*^9}, {3.649890063751313*^9, 
   3.6498902444417887`*^9}, {3.649890300497158*^9, 3.649890409209558*^9}, {
   3.649890489857368*^9, 3.6498904905930758`*^9}, {3.64989057486484*^9, 
   3.649890589056324*^9}, 3.6498906258076963`*^9, {3.64989066526438*^9, 
   3.6498907290776863`*^9}, {3.649892015934132*^9, 3.64989203290738*^9}, {
   3.649892112578867*^9, 3.6498921275439167`*^9}, {3.649892575748885*^9, 
   3.64989265808475*^9}, {3.649892707507086*^9, 3.6498927112815027`*^9}, {
   3.649893043340567*^9, 3.649893050253839*^9}, {3.649893295868519*^9, 
   3.649893302062372*^9}, {3.649937969091125*^9, 3.6499380189249067`*^9}, {
   3.6499383534482*^9, 3.649938377064877*^9}, {3.64993841701729*^9, 
   3.649938432311385*^9}, 3.649938539586685*^9, {3.649973397858232*^9, 
   3.6499734469456587`*^9}, {3.649980412240889*^9, 3.6499804491497383`*^9}, {
   3.6499846769004602`*^9, 3.649984717163331*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "153", "]"}]], "Output"]
}, Open  ]],

Cell["To check the current rule order,", "Text",
 CellChangeTimes->{{3.649985028819948*^9, 3.649985063554825*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Definition", "[", "rev", "]"}]], "Input",
 CellChangeTimes->{{3.649984728942552*^9, 3.649984736520904*^9}}],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {GridBox[{
       {
        RowBox[{
         RowBox[{"rev", "[", "x_List", "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "8", "]"}], ";", 
           RowBox[{"Snoopr", "[", 
            RowBox[{"rev", "/@", 
             RowBox[{"Reverse", "[", "x", "]"}]}], "]"}]}], ")"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"rev", "[", "expr_Plus", "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "9", "]"}], ";", 
           RowBox[{"Snoopr", "[", 
            RowBox[{"rev", "/@", "expr"}], "]"}]}], ")"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"rev", "[", "expr_Times", "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "10", "]"}], ";", 
           RowBox[{"Snoopr", "[", 
            RowBox[{"rev", "/@", "expr"}], "]"}]}], ")"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"rev", "[", "x_CircleTimes", "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "11", "]"}], ";", 
           RowBox[{"Snoopr", "[", 
            RowBox[{"CircleTimes", "@@", 
             RowBox[{"rev", "[", 
              RowBox[{"List", "@@", "x"}], "]"}]}], "]"}]}], ")"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"rev", "[", 
          RowBox[{"rev", "[", "X_", "]"}], "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "12", "]"}], ";", 
           RowBox[{"Snoopr", "[", "X", "]"}]}], ")"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"rev", "[", 
          RowBox[{"f_", "/;", 
           RowBox[{"NumericQ", "[", "f", "]"}]}], "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "13", "]"}], ";", 
           RowBox[{"Snoopr", "[", "f", "]"}]}], ")"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"rev", "[", 
          RowBox[{"f_", "/;", 
           RowBox[{"ConstantQ", "[", "f", "]"}]}], "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "14", "]"}], ";", 
           RowBox[{"Snoopr", "[", "f", "]"}]}], ")"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"rev", "[", 
          RowBox[{"f_", "?", "deg0or1Q"}], "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "15", "]"}], ";", 
           RowBox[{"Snoopr", "[", "f", "]"}]}], ")"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"rev", "[", 
          RowBox[{"f_", "?", "revEvenQ"}], "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "18", "]"}], ";", 
           RowBox[{"Snoopr", "[", "f", "]"}]}], ")"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"rev", "[", 
          RowBox[{"f_", "?", "revOddQ"}], "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "19", "]"}], ";", 
           RowBox[{"Snoopr", "[", 
            RowBox[{"-", "f"}], "]"}]}], ")"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"rev", "[", "X_SeriesData", "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "20", "]"}], ";", 
           RowBox[{"Snoopr", "[", 
            RowBox[{"MapAt", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"rev", "/@", "#1"}], "&"}], ",", "X", ",", "3"}], 
             "]"}], "]"}]}], ")"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"rev", "[", 
          RowBox[{
           RowBox[{"mv", "[", "n__", "]"}], "[", 
           RowBox[{"X_", "/;", 
            RowBox[{"IntegerQ", "[", 
             RowBox[{"deg", "[", "X", "]"}], "]"}]}], "]"}], "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "27", "]"}], ";", 
           RowBox[{"Snoopr", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"mv", "[", 
               RowBox[{"Reverse", "[", 
                RowBox[{"Range", "[", 
                 RowBox[{"deg", "[", "X", "]"}], "]"}], "]"}], "]"}], "[", 
              RowBox[{"mv", "[", "n", "]"}], "]"}], "[", "X", "]"}], "]"}]}], 
          ")"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"rev", "[", 
          RowBox[{"\<\"Subscript\"\>", "[", 
           RowBox[{
            RowBox[{"\[LeftAngleBracket]", "X_", "\[RightAngleBracket]"}], 
            ",", "ab__List"}], "]"}], "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "112", "]"}], ";", 
           RowBox[{"Snoopr", "[", 
            RowBox[{"\<\"Subscript\"\>", "[", 
             RowBox[{
              RowBox[{"\[LeftAngleBracket]", 
               RowBox[{"rev", "[", "X", "]"}], "\[RightAngleBracket]"}], ",", 
              
              RowBox[{"Sequence", "@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"deg", "[", "X", "]"}], "+", "1", "-", 
                 RowBox[{"{", "ab", "}"}]}], ")"}]}]}], "]"}], "]"}]}], 
          ")"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"rev", "[", 
          RowBox[{"a_AngleBracket", "/;", 
           RowBox[{
            RowBox[{"Length", "[", "a", "]"}], ">", "1"}]}], "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "113", "]"}], ";", 
           RowBox[{"Snoopr", "[", 
            RowBox[{"AngleBracket", "@@", 
             RowBox[{"rev", "[", 
              RowBox[{"List", "@@", "a"}], "]"}]}], "]"}]}], ")"}]}]}
      },
      BaselinePosition->{Baseline, {1, 1}},
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{"Columns" -> {{
           Scaled[0.999]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  Definition[$CellContext`rev],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.649984737739277*^9, 3.6499848745998898`*^9, {3.649984932768215*^9, 
   3.649984953165051*^9}, 3.649985519406474*^9, 3.6499862982439337`*^9, 
   3.649989893781476*^9, 3.650055925796155*^9}]
}, Open  ]],

Cell["Testing", "Text",
 CellChangeTimes->{{3.649846315168838*^9, 3.6498463171527042`*^9}}],

Cell[BoxData[
 RowBox[{"StartDebug", "[", "]"}]], "Input",
 CellChangeTimes->{{3.649986693013719*^9, 3.649986699406085*^9}}],

Cell[BoxData[
 RowBox[{"StopDebug", "[", "]"}]], "Input",
 CellChangeTimes->{{3.64998068648426*^9, 3.6499806909595537`*^9}}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"z", ",", "w", ",", "F2", ",", "F3", ",", "F4"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", "w"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"2", ",", "F2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"3", ",", "F3"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"4", ",", "F4"}], "]"}]}], "Input",
 CellChangeTimes->{{3.649849131981206*^9, 3.649849143004447*^9}, {
  3.649882195444221*^9, 3.649882239574108*^9}, {3.6498824822766743`*^9, 
  3.649882489279644*^9}, {3.649972646820098*^9, 3.649972647555298*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ForgetAssumeAntisymmetric", "[", 
   RowBox[{"{", 
    RowBox[{"F2", ",", "F3"}], "}"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.64997653373281*^9, 3.6499765633218184`*^9}, {
  3.649980756624173*^9, 3.649980757839176*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", "z", "]"}]], "Input",
 CellChangeTimes->{{3.649973684402034*^9, 3.649973686113309*^9}}],

Cell[BoxData["z"], "Output",
 CellChangeTimes->{3.649973686674266*^9, 3.649986478183874*^9, 
  3.650055936434538*^9, 3.650069686889078*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"z", ",", "z"}], "\[RightAngleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.649972672976033*^9, 3.649972679144721*^9}, 
   3.649973872399419*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "z"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.6499726681925898`*^9, 3.649972680847234*^9}, 
   3.649973311615416*^9, 3.649973518457817*^9, 3.649973576860621*^9, 
   3.649973875255978*^9, 3.6499739234936867`*^9, {3.649980666770383*^9, 
   3.649980694646199*^9}, 3.649986481155054*^9, 3.650055937253847*^9, 
   3.650069688327343*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"w", ",", "z"}], "\[RightAngleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.649972672976033*^9, 3.649972679144721*^9}, {
   3.649973614820279*^9, 3.6499736194419823`*^9}, 3.649973868447938*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"w", ",", "z"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.649973621123109*^9, 3.6499738817430153`*^9, 
  3.649973927040903*^9, 3.649980704787428*^9, 3.649986482994789*^9, 
  3.6500559382294273`*^9, 3.650069689495927*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"z", ",", "w"}], "\[RightAngleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.649972672976033*^9, 3.649972679144721*^9}, {
   3.649973614820279*^9, 3.649973646850198*^9}, 3.649973863552105*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"w", ",", "z"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.6499736479069853`*^9, 3.649973892986619*^9, 
  3.649973930756703*^9, 3.649980708223879*^9, 3.649986484790904*^9, 
  3.650055939021196*^9, 3.650069690653359*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"rev", "[", "F2", "]"}], ",", "F2"}], 
  "\[RightAngleBracket]"}]], "Input"],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"rev", "[", "F2", "]"}], ",", "F2"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.6499867028700037`*^9, 3.650055940484323*^9, 
  3.6500696984805317`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"rev", "[", "F2", "]"}], ",", "F2"}], "\[RightAngleBracket]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6499737026703672`*^9, 3.6499737364651318`*^9}, 
   3.649973898831975*^9, {3.6499741171482153`*^9, 3.649974143738936*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"rev", "[", "F2", "]"}], ",", "F2"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.6499741474401617`*^9, 3.649980726295369*^9, 
  3.649980777428371*^9, 3.649986632949678*^9, 3.649986727022881*^9, 
  3.649986945996937*^9, 3.64998706372264*^9, 3.650055941259145*^9, 
  3.650069700038604*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SymQ", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"rev", "[", "F2", "]"}], ",", "F2"}], "\[RightAngleBracket]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6499868869283533`*^9, 3.649986888332425*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.6499868895493793`*^9, 3.6500559422525387`*^9, 
  3.6500697013037663`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"rev", "[", "F2", "]"}], ",", "F2"}], "\[RightAngleBracket]"}], 
  "]"}]], "Input",
 CellChangeTimes->{3.649987032810297*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"rev", "[", "F2", "]"}], ",", "F2"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.6499870333712797`*^9, 3.6499870715576353`*^9}, 
   3.650056012458259*^9, 3.650069702439629*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"F2", ",", "F2"}], "\[RightAngleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6499737026703672`*^9, 3.6499737364651318`*^9}, 
   3.649973898831975*^9, {3.6499741171482153`*^9, 3.649974143738936*^9}, {
   3.649974372648204*^9, 3.6499743730641537`*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"rev", "[", "F2", "]"}], ",", 
   RowBox[{"rev", "[", "F2", "]"}]}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.6499743738363543`*^9, 3.6499807353496017`*^9, 
  3.6499807819652567`*^9, 3.649989933364352*^9, 3.6500560383773193`*^9, 
  3.650069703420945*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"w", ",", 
    RowBox[{"rev", "[", "F2", "]"}], ",", "w"}], "\[RightAngleBracket]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.649976342076858*^9, 3.649976359579433*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"w", ",", 
   RowBox[{"rev", "[", "F2", "]"}], ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.649976360337522*^9, 3.649980787935498*^9, 
  3.6499899348934317`*^9, 3.6500560410817537`*^9, 3.650069704504675*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"w", ",", 
    RowBox[{"rev", "[", "F2", "]"}], ",", "F2", ",", "w"}], 
   "\[RightAngleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.649976342076858*^9, 3.649976359579433*^9}, {
  3.649976426093461*^9, 3.6499764364430723`*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"w", ",", 
   RowBox[{"rev", "[", "F2", "]"}], ",", "F2", ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.649976438462154*^9, 3.6499807912174387`*^9, 
  3.649989938292926*^9, 3.6500560441377153`*^9, 3.6500697055757093`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"z", ",", 
    RowBox[{"rev", "[", "F2", "]"}], ",", "F2", ",", "w"}], 
   "\[RightAngleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.649976342076858*^9, 3.649976359579433*^9}, {
  3.649976426093461*^9, 3.6499764364430723`*^9}, {3.649976483131064*^9, 
  3.649976498074835*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"rev", "[", "F2", "]"}], ",", "F2", ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.649976484366963*^9, 3.649976502148819*^9}, 
   3.649980794615519*^9, 3.649989939718917*^9, 3.650056047579207*^9, 
   3.6500697073647757`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AssumeAntisymmetric", "[", 
   RowBox[{"{", 
    RowBox[{"F2", ",", "F3"}], "}"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.64997653373281*^9, 3.6499765633218184`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"z", ",", 
    RowBox[{"rev", "[", "F2", "]"}], ",", "F2", ",", "w"}], 
   "\[RightAngleBracket]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"z", ",", "F2", ",", "F2", ",", "w"}], 
   "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{3.649976576234717*^9, 3.649980824597382*^9, 
  3.649989942122569*^9, 3.650056057497328*^9, 3.65006971153771*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"z", ",", 
    RowBox[{"rev", "[", "F2", "]"}], ",", "F2", ",", "z"}], 
   "\[RightAngleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.649976599321203*^9, 3.649976602457615*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"z", ",", "F2", ",", "F2", ",", "z"}], 
   "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{3.6499766029996443`*^9, 3.64998083382259*^9, 
  3.649989943603929*^9, 3.6500560587860947`*^9, 3.6500697344598913`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"w", ",", 
    RowBox[{"rev", "[", "F2", "]"}], ",", "F2", ",", "z"}], 
   "\[RightAngleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.649976599321203*^9, 3.6499766194006863`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"w", ",", "F2", ",", "F2", ",", "z"}], 
   "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{3.649976619923345*^9, 3.6499808480898743`*^9, 
  3.649989944993293*^9, 3.650056060509673*^9, 3.650069737783525*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"w", ",", "F2", ",", "w"}], "\[RightAngleBracket]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6499736650187883`*^9, 3.649973673825138*^9}, {
  3.649976628610447*^9, 3.649976641751878*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6499766355428658`*^9, 3.6499766422947273`*^9}, 
   3.6499808504473057`*^9, 3.649989947268489*^9, 3.65005606324879*^9, 
   3.650069739865549*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"w", ",", "F2", ",", "F2", ",", "F2", ",", "w"}], 
  "\[RightAngleBracket]"}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.64998087806957*^9, 3.649989949972488*^9, 
  3.6500560662976627`*^9, 3.6500697431509047`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"w", ",", "F2", ",", "F2", ",", "F2", ",", "w"}], 
   "\[RightAngleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.649980864254348*^9, 3.6499808648018627`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.649980866547112*^9, 3.649989955633876*^9, 
  3.650056069626278*^9, 3.650069744383273*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"l", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"z", ",", "F2", ",", "z"}], "\[RightAngleBracket]"}], ",", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"w", ",", "F2", ",", "z"}], "\[RightAngleBracket]"}], ",", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"z", ",", "F2", ",", "w"}], "\[RightAngleBracket]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"rev", ",", "l"}], "]"}]}], "Input",
 CellChangeTimes->{{3.649882413338561*^9, 3.649882420974741*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{"-", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"z", ",", "F2", ",", "w"}], "\[RightAngleBracket]"}]}], ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F2", ",", "w"}], "\[RightAngleBracket]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.649882424097397*^9, 3.649990007774632*^9, 
  3.65005607907583*^9, 3.650069746050489*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{"-", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"z", ",", "F2", ",", "w"}], "\[RightAngleBracket]"}]}], ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F2", ",", "w"}], "\[RightAngleBracket]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.649882424097397*^9, 3.649990007774632*^9, 
  3.65005607907583*^9, 3.650069746054159*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"l", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"z", ",", "F3", ",", "z"}], "\[RightAngleBracket]"}], ",", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"w", ",", "F3", ",", "z"}], "\[RightAngleBracket]"}], ",", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"z", ",", "F3", ",", "w"}], "\[RightAngleBracket]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"rev", ",", "l"}], "]"}]}], "Input",
 CellChangeTimes->{{3.649882457169997*^9, 3.649882460465143*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{"-", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"z", ",", "F3", ",", "w"}], "\[RightAngleBracket]"}]}], ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F3", ",", "w"}], "\[RightAngleBracket]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.64988246150751*^9, 3.649990011859765*^9, 
  3.650056084419162*^9, 3.650069754239415*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{"-", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"z", ",", "F3", ",", "w"}], "\[RightAngleBracket]"}]}], ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F3", ",", "w"}], "\[RightAngleBracket]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.64988246150751*^9, 3.649990011859765*^9, 
  3.650056084419162*^9, 3.650069754244267*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"l", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"z", ",", "F4", ",", "z"}], "\[RightAngleBracket]"}], ",", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"w", ",", "F4", ",", "z"}], "\[RightAngleBracket]"}], ",", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"z", ",", "F4", ",", "w"}], "\[RightAngleBracket]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"rev", ",", "l"}], "]"}]}], "Input",
 CellChangeTimes->{{3.64988251129657*^9, 3.649882514545569*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F4", ",", "z"}], "\[RightAngleBracket]"}], ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"w", ",", "F4", ",", "z"}], "\[RightAngleBracket]"}], ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F4", ",", "w"}], "\[RightAngleBracket]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6498825155449343`*^9, 3.649990016021299*^9, 
  3.650056102228896*^9, 3.650069754437851*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", 
     RowBox[{"rev", "[", "F4", "]"}], ",", "z"}], "\[RightAngleBracket]"}], 
   ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", 
     RowBox[{"rev", "[", "F4", "]"}], ",", "w"}], "\[RightAngleBracket]"}], 
   ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"w", ",", 
     RowBox[{"rev", "[", "F4", "]"}], ",", "z"}], "\[RightAngleBracket]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6498825155449343`*^9, 3.649990016021299*^9, 
  3.650056102228896*^9, 3.6500697544423237`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"l", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"z", ",", "F2", ",", "F2", ",", "z"}], "\[RightAngleBracket]"}], 
    ",", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"w", ",", "F4", ",", "z"}], "\[RightAngleBracket]"}], ",", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"z", ",", "F4", ",", "w"}], "\[RightAngleBracket]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"Map", "[", 
  RowBox[{"rev", ",", "l"}], "]"}]}], "Input",
 CellChangeTimes->{{3.649882676096137*^9, 3.649882694988955*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F2", ",", "F2", ",", "z"}], "\[RightAngleBracket]"}], 
   ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"w", ",", "F4", ",", "z"}], "\[RightAngleBracket]"}], ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F4", ",", "w"}], "\[RightAngleBracket]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6498826970080547`*^9, 3.649990019955224*^9, 
  3.650056113890099*^9, 3.6500697545376377`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F2", ",", "F2", ",", "z"}], "\[RightAngleBracket]"}], 
   ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", 
     RowBox[{"rev", "[", "F4", "]"}], ",", "w"}], "\[RightAngleBracket]"}], 
   ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"w", ",", 
     RowBox[{"rev", "[", "F4", "]"}], ",", "z"}], "\[RightAngleBracket]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6498826970080547`*^9, 3.649990019955224*^9, 
  3.650056113890099*^9, 3.650069754540955*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AssumeAntisymmetric", "[", 
   RowBox[{"{", 
    RowBox[{"F2", ",", "F3", ",", "F4"}], "}"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.649849148650263*^9, 3.649849172042899*^9}, {
  3.649882253572056*^9, 3.6498822601318493`*^9}, {3.6498824923679523`*^9, 
  3.649882497983816*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "F4", ",", "z"}], "\[RightAngleBracket]"}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.649882587589919*^9, 3.649990029652281*^9, 
  3.65005612704149*^9, 3.650069760392469*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "F3", ",", "w"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"z", ",", "F3", ",", "w"}], "\[RightAngleBracket]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.649849177953208*^9, 3.649849191867255*^9}, {
  3.64988228410911*^9, 3.649882291512372*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "F3", ",", "w"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.6498491884908943`*^9, 3.6498491923883867`*^9}, 
   3.649849249993946*^9, 3.649882272059924*^9, 3.649990031268323*^9, 
   3.6500561326912107`*^9, 3.650069760476595*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "F3", ",", "w"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.6498491884908943`*^9, 3.6498491923883867`*^9}, 
   3.649849249993946*^9, 3.649882272059924*^9, 3.649990031268323*^9, 
   3.6500561326912107`*^9, 3.650069760479848*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"w", ",", "F3", ",", "F2", ",", "F2", ",", "w"}], 
  "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{{3.649849457046852*^9, 3.649849459334556*^9}, {
  3.649850337466804*^9, 3.6498503711186*^9}, {3.649850467203475*^9, 
  3.649850471587449*^9}, {3.649850523912706*^9, 3.649850547825996*^9}, {
  3.649850630470776*^9, 3.649850659367942*^9}, {3.649850713173812*^9, 
  3.649850725557454*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"w", ",", "F3", ",", "F2", ",", "F2", ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{
  3.649849459943609*^9, {3.649850340314859*^9, 3.649850372746004*^9}, {
   3.649850458944586*^9, 3.649850472264996*^9}, {3.649850528823019*^9, 
   3.649850553255475*^9}, {3.649850631171975*^9, 3.649850659860304*^9}, {
   3.649850702854065*^9, 3.6498507272066298`*^9}, {3.649880181858219*^9, 
   3.6498801956017437`*^9}, 3.649882273300048*^9, 3.649990037995598*^9, 
   3.6500561433288097`*^9, 3.650069760570055*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"{", 
   RowBox[{"w", ",", "F3", ",", "F2", ",", "F2", ",", "w"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.649850690581806*^9, 3.6498506942301064`*^9}, {
  3.649850755412969*^9, 3.649850767620525*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"w", ",", 
   RowBox[{"-", "F2"}], ",", 
   RowBox[{"-", "F2"}], ",", 
   RowBox[{"-", "F3"}], ",", "w"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6498506949344873`*^9, {3.6498507608362503`*^9, 3.649850768274193*^9}, 
   3.6498866989479218`*^9, 3.649990039371541*^9, 3.650056146736088*^9, 
   3.6500697606576557`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"w", ",", "F3", ",", "F2", ",", "F3", ",", "w"}], 
   "\[RightAngleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.649850690581806*^9, 3.6498506942301064`*^9}, {
   3.649850755412969*^9, 3.649850767620525*^9}, 3.649886711219193*^9, {
   3.6498867896510887`*^9, 3.649886812370274*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"w", ",", "F3", ",", "F2", ",", "F3", ",", "w"}], 
   "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{{3.649886795810169*^9, 3.649886813447008*^9}, 
   3.64999004088175*^9, 3.650056151896412*^9, 3.650069760737545*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"w", ",", "F2", ",", "F3", ",", "F2", ",", "w"}], 
   "\[RightAngleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6498869009931993`*^9, 3.649886910736762*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6498869047694883`*^9, 3.649886911219932*^9}, 
   3.649990042144185*^9, 3.650056154080604*^9, 3.6500697608169737`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"z", ",", "F2", ",", "F3", ",", "F2", ",", "w"}], 
   "\[RightAngleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.649887031566818*^9, 3.64988703195065*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "F2", ",", "F3", ",", "F2", ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.649887032514001*^9, 3.6499900446912622`*^9, 
  3.6500561587447042`*^9, 3.650069760823474*^9}]
}, Open  ]],

Cell["This should re-order,", "Text",
 CellChangeTimes->{{3.65005622322124*^9, 3.650056237780754*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"z", ",", "F2", ",", "F3", ",", "F2", ",", "w"}], 
   "\[RightAngleBracket]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"rev", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"w", ",", "F2", ",", "F3", ",", "F2", ",", "z"}], 
   "\[RightAngleBracket]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.649887056254814*^9, 3.6498870584627047`*^9}, {
  3.650056200139968*^9, 3.650056210664707*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "F2", ",", "F3", ",", "F2", ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{
  3.649990045794976*^9, 3.650056163505067*^9, {3.65005620410172*^9, 
   3.650056211247134*^9}, 3.650069760911181*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"w", ",", "F2", ",", "F3", ",", "F2", ",", "z"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{
  3.649990045794976*^9, 3.650056163505067*^9, {3.65005620410172*^9, 
   3.650056211247134*^9}, 3.6500697609143467`*^9}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------------------------\
\>", "Text",
 CellChangeTimes->{{3.6142918796899557`*^9, 3.614291886285962*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Standard forms for    \[LeftAngleBracket]  ,  \[RightAngleBracket]        --- \
   Aka[ ]  and  OrderedAkaQ[ ]                            ------   new in \
Ver4 \
\>", "Subsubsection",
 CellChangeTimes->{{3.650254965973453*^9, 3.6502549780071373`*^9}, {
  3.6502574822974243`*^9, 3.650257555684561*^9}}],

Cell["\<\

For brackets with  2  arguments, we use special rules to get nice output.

When sorting brackets between vectors and derivatives of vectors (\
\[GothicCapitalD] or pD), it is preferable to sort on the field name rather \
than considering the derivative symbol.
Derivatives are then sorted the same way as the  0th derivative,\
\>", "Text",
 CellChangeTimes->{{3.650250223843624*^9, 3.6502503742579737`*^9}, 
   3.650255688139717*^9, {3.650257585011557*^9, 3.650257600898118*^9}, {
   3.6502576312821083`*^9, 3.650257707409593*^9}, {3.650274352302842*^9, 
   3.650274397278565*^9}, 3.6502745371009912`*^9, {3.650274771529583*^9, 
   3.650274803400889*^9}, {3.6502751113168707`*^9, 3.650275152228283*^9}, {
   3.650316098051849*^9, 3.650316100437132*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"X_", "?", "deg1Q"}], ",", 
      RowBox[{"Y_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{"!", 
     RowBox[{"OrderedAkaQ", "[", 
      RowBox[{"X", ",", "Y"}], "]"}]}]}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y", ",", "X"}], "\[RightAngleBracket]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.61285660457312*^9, 3.6128566519532347`*^9}, {
  3.612856683108786*^9, 3.612856709191393*^9}, {3.613797396820446*^9, 
  3.613797432146249*^9}, {3.613882467093355*^9, 3.613882473781886*^9}, {
  3.6138827990646257`*^9, 3.613882801799062*^9}, {3.650250950285972*^9, 
  3.650250988381568*^9}, {3.6502528425032263`*^9, 3.6502528646600657`*^9}, {
  3.650254829450831*^9, 3.650254842586828*^9}, {3.650254876826606*^9, 
  3.6502548823629704`*^9}, {3.650274590048069*^9, 3.650274592830852*^9}, {
  3.6502747334050922`*^9, 3.650274744061352*^9}, {3.6502748179016247`*^9, 
  3.6502748202932177`*^9}, {3.650316126262371*^9, 3.650316135799279*^9}, {
  3.6505823494972363`*^9, 3.6505823813340063`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "154", "]"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"UnsetRule", "[", "286", "]"}]], "Input",
 CellChangeTimes->{{3.65027483509643*^9, 3.65027485176975*^9}, {
  3.650274925017374*^9, 3.650274926234042*^9}, {3.650316157188786*^9, 
  3.6503161572676287`*^9}}],

Cell["\<\
Aka  =  \[OpenCurlyDoubleQuote]Also known as\[CloseCurlyDoubleQuote]  (for \
the purpose of  OrderedQ and Sort),  returns a pair. The first element is the \
field name, being the main item that will be sorted on.
The second element is the actual expression (derivative) so that no sort \
information is lost,\
\>", "Text",
 CellChangeTimes->{{3.650250996345428*^9, 3.650251063352934*^9}, {
  3.65025172683224*^9, 3.6502517287523937`*^9}, {3.65025251694998*^9, 
  3.650252535637796*^9}, {3.650252605028611*^9, 3.650252675939609*^9}, {
  3.650252726738893*^9, 3.650252741938743*^9}, {3.6502531623336563`*^9, 
  3.650253166701008*^9}}],

Cell["Use  Hold[ ]   because it\[CloseCurlyQuote]s faster.", "Text",
 CellChangeTimes->{{3.650253773828857*^9, 3.650253816675907*^9}, 
   3.650253944435402*^9, {3.65025399931465*^9, 3.6502540013145638`*^9}, 
   3.650443835447591*^9}],

Cell["\<\
No rules are used to construct the value of any   Aka[ ],  but unless  Hold[ \
]  is used,  they are all pattern matched to check if any rules need to be \
applied.
About 7 time faster with Hold[ ],\
\>", "Text",
 CellChangeTimes->{{3.650253409388352*^9, 3.6502535302001753`*^9}, {
  3.65025356186399*^9, 3.6502535736556377`*^9}, {3.65025367159171*^9, 
  3.650253677862487*^9}, {3.6502538334922457`*^9, 3.650253841443944*^9}, {
  3.650253881348531*^9, 3.650253901203458*^9}, {3.650254300366485*^9, 
  3.650254313470615*^9}, {3.650254345933383*^9, 3.65025436201436*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Aka", "[", 
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"X_", ",", "n___"}], "]"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"X", ",", 
    RowBox[{"\[GothicCapitalD]", "[", 
     RowBox[{"X", ",", "n"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Aka", "[", 
     RowBox[{"\[GothicCapitalD]", "[", 
      RowBox[{"X", ",", "3"}], "]"}], "]"}], ",", 
    RowBox[{"{", "2000000", "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.650253284063601*^9, 3.650253310911766*^9}, 
   3.65025354572285*^9, {3.6502536992718563`*^9, 3.650253711114105*^9}, {
   3.650254264754704*^9, 3.65025426486646*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "15.9280000000000008242295734817162156105`7.222761160298977", ",", "Null"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.6502533149465723`*^9, 3.6502533466728153`*^9}, 
   3.650253554507659*^9, 3.650253737835553*^9, 3.6502542811890497`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Aka", "[", 
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"X_", ",", "n___"}], "]"}], "]"}], ":=", 
  RowBox[{"Hold", "[", 
   RowBox[{"X", ",", 
    RowBox[{"\[GothicCapitalD]", "[", 
     RowBox[{"X", ",", "n"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Aka", "[", 
     RowBox[{"\[GothicCapitalD]", "[", 
      RowBox[{"X", ",", "3"}], "]"}], "]"}], ",", 
    RowBox[{"{", "2000000", "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.650253284063601*^9, 3.650253310911766*^9}, 
   3.65025354572285*^9, {3.650253720745716*^9, 3.650253722312934*^9}, {
   3.650254258499445*^9, 3.650254258610546*^9}, {3.650254401521329*^9, 
   3.6502544029130373`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2.23600000000000020961010704922955483198`6.37007171249401", ",", "Null"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.650253606055222*^9, {3.650253741573587*^9, 3.6502537520477247`*^9}, 
   3.650254261357706*^9, {3.650254392784656*^9, 3.650254406392128*^9}}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
-------------\
\>", "Text",
 CellChangeTimes->{{3.650443806009345*^9, 3.6504438091999407`*^9}}],

Cell["Hold[ ]  can be used on Sequences,", "Text",
 CellChangeTimes->{{3.650254453676457*^9, 3.650254480283905*^9}, 
   3.6502545319789953`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Aka", "[", 
   RowBox[{"X_", "?", "FieldQ"}], "]"}], ":=", 
  RowBox[{"Hold", "[", 
   RowBox[{"X", ",", "X"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650250531407818*^9, 3.650250726543746*^9}, {
  3.6502508758689203`*^9, 3.650250876173073*^9}, {3.650251511064883*^9, 
  3.6502515126144133`*^9}, {3.650251610580202*^9, 3.650251611715657*^9}, {
  3.650251657410872*^9, 3.650251658011065*^9}, {3.65025214228608*^9, 
  3.650252183149478*^9}, {3.650252247596977*^9, 3.650252248141171*^9}, {
  3.650252338330627*^9, 3.650252338970093*^9}, {3.650252706501049*^9, 
  3.650252710165183*^9}, {3.650253640568954*^9, 3.650253645240609*^9}, {
  3.6502541746739492`*^9, 3.65025418113809*^9}, {3.65025442640313*^9, 
  3.6502544281420794`*^9}}],

Cell["For fields that have not been declared,", "Text",
 CellChangeTimes->{{3.6502522255295467`*^9, 3.650252241609818*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Aka", "[", "X_Symbol", "]"}], ":=", 
  RowBox[{"Hold", "[", 
   RowBox[{"X", ",", "X"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650253652664719*^9, 3.650253656184855*^9}, {
  3.6502544295345287`*^9, 3.6502544307656097`*^9}}],

Cell["For field derivatives,", "Text",
 CellChangeTimes->{{3.6502522255295467`*^9, 3.650252241609818*^9}, {
  3.6502531912448606`*^9, 3.650253195164534*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Aka", "[", 
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"X_", ",", "n___"}], "]"}], "]"}], ":=", 
  RowBox[{"Hold", "[", 
   RowBox[{"X", ",", 
    RowBox[{"\[GothicCapitalD]", "[", 
     RowBox[{"X", ",", "n"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6502507467671022`*^9, 3.650250828494223*^9}, {
  3.6502508885255404`*^9, 3.650250894477901*^9}, {3.650253337854097*^9, 
  3.650253341757649*^9}, {3.6502544373744698`*^9, 3.650254438640398*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Aka", "[", 
   RowBox[{"pD", "[", 
    RowBox[{"X_", ",", "n___"}], "]"}], "]"}], ":=", 
  RowBox[{"Hold", "[", 
   RowBox[{"X", ",", 
    RowBox[{"pD", "[", 
     RowBox[{"X", ",", "n"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650251754658147*^9, 3.650251760097838*^9}, {
  3.650253958114439*^9, 3.650253960229125*^9}, {3.65025444238236*^9, 
  3.650254444078335*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Aka", "[", "X_List", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{"Aka", ",", "X"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650582533971463*^9, 3.650582552883582*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"OrderedAkaQ", "[", 
   RowBox[{"X_", ",", "Y_"}], "]"}], ":=", " ", 
  RowBox[{"OrderedQ", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Aka", "[", "X", "]"}], ",", 
     RowBox[{"Aka", "[", " ", "Y", "]"}]}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OrderedAkaQ", "[", "X_List", "]"}], ":=", 
  RowBox[{"OrderedQ", "[", 
   RowBox[{"Map", "[", 
    RowBox[{"Aka", ",", "X"}], "]"}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650251181196907*^9, 3.650251402584736*^9}}],

Cell["Testing   ---   examples", "Text",
 CellChangeTimes->{{3.650253773828857*^9, 3.650253816675907*^9}, 
   3.650253944435402*^9, {3.65025399931465*^9, 3.650254037794153*^9}, {
   3.6504436397063932`*^9, 3.650443641705624*^9}, 3.650443859799211*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Aka", "[", 
  RowBox[{"\[GothicCapitalD]", "[", 
   RowBox[{"X", ",", "3"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Aka", "[", "Y", "]"}]}], "Input",
 CellChangeTimes->{{3.6502515283879232`*^9, 3.650251554052341*^9}}],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{"X", ",", 
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"X", ",", "3"}], "]"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.6502515367092133`*^9, 3.65025155478334*^9}, 
   3.6502516821158657`*^9, 3.650252462648608*^9, 3.650254049299856*^9, 
   3.650254595916972*^9, 3.6502557103633537`*^9}],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{"Y", ",", "Y"}], "]"}]], "Output",
 CellChangeTimes->{{3.6502515367092133`*^9, 3.65025155478334*^9}, 
   3.6502516821158657`*^9, 3.650252462648608*^9, 3.650254049299856*^9, 
   3.650254595916972*^9, 3.650255710366435*^9}]
}, Open  ]],

Cell["This is why   OrderedAkaQ   is nicer than   OrderedQ,", "Text",
 CellChangeTimes->{{3.650252762130645*^9, 3.650252796450338*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"OrderedAkaQ", "[", 
  RowBox[{
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"X", ",", "3"}], "]"}], ",", "Y"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OrderedQ", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[GothicCapitalD]", "[", 
     RowBox[{"X", ",", "3"}], "]"}], ",", "Y"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.650251444708982*^9, 3.6502514537653*^9}, {
  3.650251494197991*^9, 3.650251494790716*^9}, {3.65025169568824*^9, 
  3.650251711930028*^9}, {3.650252419259451*^9, 3.650252420521563*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.650251454294161*^9, {3.650251495486445*^9, 3.650251517845191*^9}, {
   3.650251687827188*^9, 3.650251713299904*^9}, 3.6502524221697397`*^9, 
   3.65025460342621*^9, 3.650255712084365*^9}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.650251454294161*^9, {3.650251495486445*^9, 3.650251517845191*^9}, {
   3.650251687827188*^9, 3.650251713299904*^9}, 3.6502524221697397`*^9, 
   3.65025460342621*^9, 3.650255712086852*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"X", ",", "Y"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.650255953907449*^9, 3.650255975490101*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"X", ",", "3"}], "]"}], ",", "X"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"X", ",", 
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"X", ",", "3"}], "]"}]}], "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.6502750406657667`*^9, 3.65027505615176*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"X", ",", "3"}], "]"}], ",", "X"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.650275046231801*^9, 3.650275057150711*^9}, 
   3.650443680645637*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"X", ",", 
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"X", ",", "3"}], "]"}]}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.650275046231801*^9, 3.650275057150711*^9}, 
   3.650443680649514*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"X", ",", "3"}], "]"}], ",", "Y"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"Y", ",", "3"}], "]"}], ",", "X"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"Y", ",", 
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"X", ",", "3"}], "]"}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"X", ",", 
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"Y", ",", "3"}], "]"}]}], "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.65025514946274*^9, 3.650255153476287*^9}, {
  3.6502552414621353`*^9, 3.6502552849154797`*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"X", ",", "3"}], "]"}], ",", "Y"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.650255155716959*^9, 3.650255252297604*^9, 
  3.650255286873398*^9, 3.650255713563858*^9, 3.6502559805409727`*^9, 
  3.6502561660983686`*^9, 3.650443749055475*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"Y", ",", "3"}], "]"}], ",", "X"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.650255155716959*^9, 3.650255252297604*^9, 
  3.650255286873398*^9, 3.650255713563858*^9, 3.6502559805409727`*^9, 
  3.6502561660983686`*^9, 3.650443749059382*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"Y", ",", 
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"X", ",", "3"}], "]"}]}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.650255155716959*^9, 3.650255252297604*^9, 
  3.650255286873398*^9, 3.650255713563858*^9, 3.6502559805409727`*^9, 
  3.6502561660983686`*^9, 3.650443749062633*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"X", ",", 
   RowBox[{"\[GothicCapitalD]", "[", 
    RowBox[{"Y", ",", "3"}], "]"}]}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.650255155716959*^9, 3.650255252297604*^9, 
  3.650255286873398*^9, 3.650255713563858*^9, 3.6502559805409727`*^9, 
  3.6502561660983686`*^9, 3.650443749065825*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"OrderedQ", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[GothicCapitalD]", "[", 
     RowBox[{"X", ",", "3"}], "]"}], ",", "Y"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OrderedQ", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[GothicCapitalD]", "[", 
     RowBox[{"Y", ",", "3"}], "]"}], ",", "X"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OrderedQ", "[", 
  RowBox[{"{", 
   RowBox[{"Y", ",", 
    RowBox[{"\[GothicCapitalD]", "[", 
     RowBox[{"X", ",", "3"}], "]"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"OrderedQ", "[", 
  RowBox[{"{", 
   RowBox[{"X", ",", 
    RowBox[{"\[GothicCapitalD]", "[", 
     RowBox[{"Y", ",", "3"}], "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.65025514946274*^9, 3.650255153476287*^9}, {
  3.6502552414621353`*^9, 3.6502552849154797`*^9}, {3.650255315938057*^9, 
  3.650255354562359*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.650255356226432*^9, 3.650443721323298*^9}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.650255356226432*^9, 3.650443721327363*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.650255356226432*^9, 3.650443721330626*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.650255356226432*^9, 3.650443721333757*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"OrderedAkaQ", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[GothicCapitalD]", "[", 
     RowBox[{"X", ",", "3"}], "]"}], ",", "Y"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OrderedAkaQ", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[GothicCapitalD]", "[", 
     RowBox[{"Y", ",", "3"}], "]"}], ",", "X"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OrderedAkaQ", "[", 
  RowBox[{"{", 
   RowBox[{"Y", ",", 
    RowBox[{"\[GothicCapitalD]", "[", 
     RowBox[{"X", ",", "3"}], "]"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"OrderedAkaQ", "[", 
  RowBox[{"{", 
   RowBox[{"X", ",", 
    RowBox[{"\[GothicCapitalD]", "[", 
     RowBox[{"Y", ",", "3"}], "]"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.65025514946274*^9, 3.650255153476287*^9}, {
  3.6502552414621353`*^9, 3.6502552849154797`*^9}, {3.650255315938057*^9, 
  3.6502553808632402`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6502553828186197`*^9, 3.650443724315309*^9}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.6502553828186197`*^9, 3.6504437243192997`*^9}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.6502553828186197`*^9, 3.650443724322719*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6502553828186197`*^9, 3.650443724325848*^9}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------------------------\
\>", "Text",
 CellChangeTimes->{{3.6142918796899557`*^9, 3.614291886285962*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Standard forms for    \[LeftAngleBracket]  ,  ,  ,  \[RightAngleBracket]   \
and  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "   ", "\[RightAngleBracket]"}], "ab"], 
   TraditionalForm]]],
 "    that involve arguments with  rev[ ]    ------   new in Ver4 "
}], "Subsubsection",
 CellChangeTimes->{{3.614336957915185*^9, 3.61433697346539*^9}, {
   3.6143370360915003`*^9, 3.614337080124157*^9}, {3.614728323898548*^9, 
   3.6147283291932707`*^9}, {3.6194966296171083`*^9, 3.619496629617293*^9}, {
   3.649725986922913*^9, 3.649726022826323*^9}, 3.6498330596984653`*^9, {
   3.649901221931573*^9, 3.649901256842812*^9}, {3.649901328570293*^9, 
   3.64990135052383*^9}, {3.6499895609845753`*^9, 3.649989593191065*^9}, {
   3.649990245870071*^9, 3.6499902576780643`*^9}}],

Cell["\<\

If the bracket is   revEvenQ   or  revOddQ   then it is by definition in \
simplest form w.r.t. possible simplifications using  rev[rev[ ]].  So the \
rule here can only apply 
if the bracket is not   revEvenQ   or   revOddQ.  We can use  rev[ ]  to \
simplify only if  \[LeftAngleBracket]  \[RightAngleBracket]  is invariant, \
therefore of deg 0 or 1.  If it is invariant it is zero if  revOddQ.
Thus, the rule applies only to  deg 0 or 1 that are not  revEvenQ.\
\>", "Text",
 CellChangeTimes->{{3.649991072338871*^9, 3.6499911238902073`*^9}, {
   3.649991177889306*^9, 3.64999121507323*^9}, {3.6499912864001207`*^9, 
   3.649991290239821*^9}, {3.649991345103324*^9, 3.64999150054158*^9}, {
   3.649991791755522*^9, 3.649991813304858*^9}, {3.649991856472879*^9, 
   3.649991956839685*^9}, {3.6499920358779793`*^9, 3.6499920984368258`*^9}, {
   3.6499921844038563`*^9, 3.6499922115400343`*^9}, {3.649992417121801*^9, 
   3.649992419472445*^9}, {3.649999791229369*^9, 3.649999978859048*^9}, {
   3.650000046378161*^9, 3.6500000493564663`*^9}, 3.650002100801786*^9, 
   3.6500699596100063`*^9, 3.650089701454032*^9, {3.650090002122704*^9, 
   3.65009014266077*^9}, 3.650135851685916*^9, {3.650142081420661*^9, 
   3.65014208857203*^9}}],

Cell["\<\
Shorter lists  (fewer rev)  are ordered before longer lists  (more rev),  \
then lists of equal length are ordered by symbol order.
Sorting them means that the decision to rev or not is independent of any \
other ordering rules that do not involve use of rev to re-order,\
\>", "Text",
 CellChangeTimes->{{3.6500725009852753`*^9, 3.650072659783594*^9}, 
   3.6509351984591703`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"ListOfrevs", "[", "f_", "]"}], ":=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"Reap", "[", 
      RowBox[{
       RowBox[{"f", "/.", 
        RowBox[{
         RowBox[{"rev", "[", "x_", "]"}], "\[RuleDelayed]", 
         RowBox[{"Sow", "[", 
          RowBox[{"rev", "[", "x", "]"}], "]"}]}]}], ";"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650071768773533*^9, 3.6500717986434097`*^9}, {
  3.6500726799017572`*^9, 3.6500726830507927`*^9}, {3.650073301225747*^9, 
  3.650073301393854*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "155", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"revOrderedQ", "[", "f_", "]"}], ":=", 
   RowBox[{"OrderedQ", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ListOfrevs", "[", "f", "]"}], ",", 
      RowBox[{"ListOfrevs", "[", 
       RowBox[{"rev", "[", "f", "]"}], "]"}]}], "}"}], "]"}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.65007185678784*^9, 3.6500719342120047`*^9}, {
  3.650072678367944*^9, 3.650072684025999*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "156", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X__", "/;", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "X", "}"}], "]"}], ">", "1"}], "&&", 
      RowBox[{"DependsQ", "[", 
       RowBox[{
        RowBox[{"{", "X", "}"}], ",", "rev"}], "]"}], "&&", 
      RowBox[{"Same0or1Q", "[", 
       RowBox[{"degBracket", "[", "X", "]"}], "]"}], "&&", 
      RowBox[{"!", 
       RowBox[{"revEvenQ", "[", "X", "]"}]}], "&&", 
      RowBox[{"!", 
       RowBox[{"revOrderedQ", "[", 
        RowBox[{"{", "X", "}"}], "]"}]}]}]}], "\[RightAngleBracket]"}], ":=", 
   
   RowBox[{"Apply", "[", 
    RowBox[{"AngleBracket", ",", " ", 
     RowBox[{"rev", "[", 
      RowBox[{"{", "X", "}"}], "]"}]}], "]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6500052803453217`*^9, 3.650005326680686*^9}, {
   3.650022369192418*^9, 3.6500224098487253`*^9}, {3.6500254329177113`*^9, 
   3.650025434623452*^9}, {3.650072098257722*^9, 3.650072125201869*^9}, {
   3.650072162593832*^9, 3.650072187570459*^9}, {3.6500722484660473`*^9, 
   3.650072300004562*^9}, {3.6500899411684313`*^9, 3.650089968261231*^9}, 
   3.6501362883848047`*^9, 3.65013679641768*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "157", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
These additional rules were found to be required as a result of the following \
testing,\
\>", "Text",
 CellChangeTimes->{{3.650148362421207*^9, 3.6501483978468924`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"z_", "?", "deg1Q"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"_", "?", "deg1Q"}], ",", 
       RowBox[{"___", "?", "deg2Q"}], ",", 
       RowBox[{"_", "?", "AntisymQ"}], ",", "z_"}], 
      "\[RightAngleBracket]"}]}], "\[RightAngleBracket]"}], ":=", "0"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"z_", "?", "deg1Q"}], ",", 
       RowBox[{"_", "?", "AntisymQ"}], ",", 
       RowBox[{"___", "?", "deg2Q"}], ",", 
       RowBox[{"_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", "z_"}], 
    "\[RightAngleBracket]"}], ":=", "0"}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6499119921831083`*^9, 3.6499120899124737`*^9}, {
  3.6499121207173357`*^9, 3.6499121325995607`*^9}, {3.649912168023748*^9, 
  3.6499121963431683`*^9}, {3.64991223230908*^9, 3.649912255620801*^9}, {
  3.649913710658935*^9, 3.649913717057396*^9}, {3.649914059693519*^9, 
  3.649914080254327*^9}, {3.649914771514072*^9, 3.649914832356165*^9}, {
  3.650075038570393*^9, 3.650075042475128*^9}, {3.650090623924329*^9, 
  3.650090635860044*^9}, {3.650091493192287*^9, 3.650091578551803*^9}, {
  3.65009210299262*^9, 3.650092218225219*^9}, {3.650092296160418*^9, 
  3.650092297647143*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "158", "]"}]], "Output"],

Cell[BoxData[
 RowBox[{"rule", "[", "159", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"___", ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"___", ",", 
       RowBox[{
        RowBox[{"F_", "?", "AntisymQ"}], "/;", 
        RowBox[{
         RowBox[{"deg", "[", "F", "]"}], ">", "2"}]}], ",", 
       RowBox[{"z_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", "z_"}], 
    "\[RightAngleBracket]"}], ":=", "0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"z_", "?", "deg1Q"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"z_", ",", 
       RowBox[{
        RowBox[{"F_", "?", "AntisymQ"}], "/;", 
        RowBox[{
         RowBox[{"deg", "[", "F", "]"}], ">", "2"}]}], ",", "___"}], 
      "\[RightAngleBracket]"}], ",", "___"}], "\[RightAngleBracket]"}], ":=", 
   "0"}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6499119921831083`*^9, 3.6499120899124737`*^9}, {
  3.6499121207173357`*^9, 3.6499121325995607`*^9}, {3.649912168023748*^9, 
  3.6499121963431683`*^9}, {3.64991223230908*^9, 3.649912255620801*^9}, {
  3.649913710658935*^9, 3.649913717057396*^9}, {3.649914059693519*^9, 
  3.649914080254327*^9}, {3.649914771514072*^9, 3.649914832356165*^9}, {
  3.650075038570393*^9, 3.650075042475128*^9}, {3.650090623924329*^9, 
  3.650090635860044*^9}, {3.650091493192287*^9, 3.650091578551803*^9}, {
  3.65009210299262*^9, 3.650092218225219*^9}, {3.650092304159823*^9, 
  3.6500924172787952`*^9}, {3.65009244823773*^9, 3.650092487616603*^9}, {
  3.650093171939763*^9, 3.650093179098073*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "160", "]"}]], "Output"],

Cell[BoxData[
 RowBox[{"rule", "[", "161", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
.... instead of   z_?deg1Q   in the above formulas, we could use   \
z__/;degBracket[z]===1 .\
\>", "Text",
 CellChangeTimes->{{3.650093598999814*^9, 3.650093678918489*^9}, {
  3.65014849246902*^9, 3.65014849293237*^9}}],

Cell["\<\
These rules were needed to get Ver4 working with  dipole_electron_model_v7.nb,\
\>", "Text",
 CellChangeTimes->{{3.650148761856387*^9, 3.650148801983226*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"M__", "?", "deg2Q"}], ",", 
       RowBox[{"w_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", 
     RowBox[{"z_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "M", ",", "w"}], "\[RightAngleBracket]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"z_", "?", "deg1Q"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"w_", "?", "deg1Q"}], ",", 
       RowBox[{"M__", "?", "deg2Q"}]}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"w", ",", "M", ",", "z"}], "\[RightAngleBracket]"}]}], 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650148821346245*^9, 3.6501489474248247`*^9}, {
  3.650149143390788*^9, 3.650149187312359*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "162", "]"}]], "Output"],

Cell[BoxData[
 RowBox[{"rule", "[", "163", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
11/09/2015   The above 2 rules generalized.   Not initialized,\
\>", "Text",
 CellChangeTimes->{{3.650938392769205*^9, 3.6509384151529493`*^9}, {
  3.6509459350564938`*^9, 3.650945946752149*^9}}],

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"M__", "?", "deg2Q"}], ",", 
       RowBox[{"w_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", 
     RowBox[{"X__", "?", "revEvenQ"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"rev", "[", "X", "]"}], ",", "M", ",", "w"}], 
    "\[RightAngleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"M__", "?", "deg2Q"}], ",", 
       RowBox[{"w_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", 
     RowBox[{"X__", "?", "revOddQ"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"rev", "[", "X", "]"}], ",", "M", ",", "w"}], 
     "\[RightAngleBracket]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6509355307757263`*^9, 3.650935549799384*^9}, {
  3.650935599767138*^9, 3.650935632278316*^9}, {3.6509359606287727`*^9, 
  3.650935963154365*^9}, {3.650936617865707*^9, 3.650936619705122*^9}, {
  3.650936679528901*^9, 3.650936709800253*^9}, {3.650936756631805*^9, 
  3.650936780839201*^9}, {3.650937218881974*^9, 3.6509372385771112`*^9}, {
  3.650938366948872*^9, 3.6509383676286573`*^9}}],

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"M__", "?", "deg2Q"}], ",", 
       RowBox[{"w_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", 
     RowBox[{"X__", "?", "revEvenQ"}], ",", 
     RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v", ",", 
     RowBox[{"rev", "[", "X", "]"}], ",", "M", ",", "w"}], 
    "\[RightAngleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"M__", "?", "deg2Q"}], ",", 
       RowBox[{"w_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", 
     RowBox[{"X__", "?", "revOddQ"}], ",", 
     RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"v", ",", 
      RowBox[{"rev", "[", "X", "]"}], ",", "M", ",", "w"}], 
     "\[RightAngleBracket]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6509355307757263`*^9, 3.650935549799384*^9}, {
  3.650935599767138*^9, 3.650935632278316*^9}, {3.6509359606287727`*^9, 
  3.650935963154365*^9}, {3.650936617865707*^9, 3.650936619705122*^9}, {
  3.650936679528901*^9, 3.650936709800253*^9}, {3.650936756631805*^9, 
  3.650936780839201*^9}, {3.650937218881974*^9, 3.65093727080107*^9}, {
  3.6509374426065483`*^9, 3.6509374584463367`*^9}, {3.650938373750269*^9, 
  3.6509383744146013`*^9}}],

Cell["The reverse of above,", "Text",
 CellChangeTimes->{{3.6509379737825212`*^9, 3.650937982214723*^9}}],

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"X__", "?", "revEvenQ"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"w_", "?", "deg1Q"}], ",", 
       RowBox[{"M__", "?", "deg2Q"}]}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"w", ",", "M", ",", 
     RowBox[{"rev", "[", "X", "]"}]}], "\[RightAngleBracket]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"X__", "?", "revOddQ"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"w_", "?", "deg1Q"}], ",", 
       RowBox[{"M__", "?", "deg2Q"}]}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"w", ",", "M", ",", 
      RowBox[{"rev", "[", "X", "]"}]}], "\[RightAngleBracket]"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6509355307757263`*^9, 3.650935549799384*^9}, {
  3.650935599767138*^9, 3.650935632278316*^9}, {3.6509359606287727`*^9, 
  3.650935963154365*^9}, {3.650936617865707*^9, 3.650936619705122*^9}, {
  3.650936679528901*^9, 3.650936709800253*^9}, {3.650936756631805*^9, 
  3.650936780839201*^9}, {3.650937218881974*^9, 3.6509372385771112`*^9}, {
  3.650937992872137*^9, 3.650938015735722*^9}, {3.650938334885613*^9, 
  3.650938335596491*^9}}],

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"v_", "?", "deg1Q"}], ",", 
     RowBox[{"X__", "?", "revEvenQ"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"w_", "?", "deg1Q"}], ",", 
       RowBox[{"M__", "?", "deg2Q"}]}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"w", ",", "M", ",", 
     RowBox[{"rev", "[", "X", "]"}], ",", "v"}], "\[RightAngleBracket]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"v_", "?", "deg1Q"}], ",", 
     RowBox[{"X__", "?", "revOddQ"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"w_", "?", "deg1Q"}], ",", 
       RowBox[{"M__", "?", "deg2Q"}]}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}], ":=", 
   RowBox[{"-", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"w", ",", "M", ",", 
      RowBox[{"rev", "[", "X", "]"}], ",", "v"}], 
     "\[RightAngleBracket]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6509355307757263`*^9, 3.650935549799384*^9}, {
  3.650935599767138*^9, 3.650935632278316*^9}, {3.6509359606287727`*^9, 
  3.650935963154365*^9}, {3.650936617865707*^9, 3.650936619705122*^9}, {
  3.650936679528901*^9, 3.650936709800253*^9}, {3.650936756631805*^9, 
  3.650936780839201*^9}, {3.650937218881974*^9, 3.6509372385771112`*^9}, {
  3.650937992872137*^9, 3.650938042167347*^9}, {3.650938208340982*^9, 
  3.650938208420676*^9}, {3.650938342758786*^9, 3.650938343686619*^9}}],

Cell["Testing  --  Sow", "Text",
 CellChangeTimes->{{3.6500901908710423`*^9, 3.6500901925352297`*^9}, {
  3.6500905360503693`*^9, 3.650090540834115*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Definition", "[", "revEvenQ", "]"}]], "Input",
 CellChangeTimes->{{3.650089782653936*^9, 3.650089791182097*^9}}],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {GridBox[{
       {
        RowBox[{
         RowBox[{"revEvenQ", "[", 
          RowBox[{"x_", "/;", 
           RowBox[{
            RowBox[{"SymQ", "[", "x", "]"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"AntisymQ", "[", "x", "]"}], "&&", 
              RowBox[{"EvenQ", "[", 
               RowBox[{"Floor", "[", 
                FractionBox[
                 RowBox[{"deg", "[", "x", "]"}], "2"], "]"}], "]"}]}], 
             ")"}]}]}], "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "16", "]"}], ";", 
           RowBox[{"Snoopr", "[", "True", "]"}]}], ")"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"revEvenQ", "[", 
          RowBox[{"\[LeftAngleBracket]", 
           RowBox[{"X__", "/;", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"{", "X", "}"}], "]"}], ">", "1"}]}], 
           "\[RightAngleBracket]"}], "]"}], ":=", 
         RowBox[{"revEvenQ", "[", "X", "]"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"revEvenQ", "[", "_", "]"}], ":=", "False"}]},
       {" "},
       {
        RowBox[{
         RowBox[{"revEvenQ", "[", 
          RowBox[{"X__", "/;", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"{", "X", "}"}], "]"}], ">", "1"}], "&&", 
            RowBox[{"And", "@@", 
             RowBox[{"ParityQ", "[", 
              RowBox[{
               RowBox[{"{", "X", "}"}], ",", 
               RowBox[{"rev", "[", 
                RowBox[{"{", "X", "}"}], "]"}]}], "]"}]}], "&&", 
            RowBox[{
             RowBox[{"Times", "@@", 
              RowBox[{"Parity", "[", 
               RowBox[{
                RowBox[{"{", "X", "}"}], ",", 
                RowBox[{"rev", "[", 
                 RowBox[{"{", "X", "}"}], "]"}]}], "]"}]}], "===", "1"}]}]}], 
          "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"LogAsUsed", "[", "22", "]"}], ";", 
           RowBox[{"Snoopr", "[", "True", "]"}]}], ")"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"revEvenQ", "[", "__", "]"}], ":=", "False"}]}
      },
      BaselinePosition->{Baseline, {1, 1}},
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{"Columns" -> {{
           Scaled[0.999]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  Definition[$CellContext`revEvenQ],
  Editable->False]], "Output",
 CellChangeTimes->{3.650089791648425*^9}]
}, Open  ]],

Cell["\<\
ListOfrevs[ ]   returns an empty list or nested list. That is ok because the \
empty list is ordered first, \
\>", "Text",
 CellChangeTimes->{{3.6500902109024477`*^9, 3.650090227718594*^9}, {
  3.650136071214715*^9, 3.650136163389065*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ListOfrevs", "[", "x", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListOfrevs", "[", 
  RowBox[{"rev", "[", "x", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.650135888274663*^9, 3.650135898577999*^9}, {
  3.650136055161089*^9, 3.650136062272011*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.650135890449182*^9, 3.650135899151314*^9}, 
   3.650136062880389*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"rev", "[", "x", "]"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.650135890449182*^9, 3.650135899151314*^9}, 
   3.6501360628833523`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"OrderedQ", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", "}"}], "}"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"OrderedQ", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", "}"}], "}"}], ",", 
    RowBox[{"{", "}"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.650135964622652*^9, 3.650136004322426*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.650135983044958*^9, 3.6501360078776417`*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.650135983044958*^9, 3.650136007880618*^9}}]
}, Open  ]],

Cell["Short lists are ordered before long lists,", "Text",
 CellChangeTimes->{{3.6500902109024477`*^9, 3.650090227718594*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"OrderedQ", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rev", "[", "a", "]"}], ",", 
      RowBox[{"rev", "[", "a", "]"}], ",", 
      RowBox[{"rev", "[", "a", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"rev", "[", "b", "]"}], ",", 
      RowBox[{"rev", "[", "b", "]"}]}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.6500714726202993`*^9, 3.65007159939916*^9}, {
  3.6500716482796717`*^9, 3.6500716759307413`*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.6500715066803083`*^9, 3.6500716024118032`*^9}, {
  3.650071650503909*^9, 3.650071679304847*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rev", "[", "z", "]"}], ",", 
     RowBox[{"rev", "[", "z", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rev", "[", "a", "]"}], ",", 
     RowBox[{"rev", "[", "a", "]"}]}], "}"}]}], "}"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"z", ",", "z"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rev", "[", "a", "]"}], ",", 
     RowBox[{"rev", "[", "a", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6500716357356586`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"z", ",", "a1", ",", "a2", ",", "a3", ",", "a4", ",", "a5"}], 
   "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"2", ",", 
   RowBox[{"{", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4", ",", "a5"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"1", ",", "z"}], "]"}]}], "Input",
 CellChangeTimes->{{3.650090286918391*^9, 3.650090315003026*^9}, {
  3.650090399721138*^9, 3.650090421264715*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"f", "=", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"rev", "[", "a1", "]"}], ",", "a2", ",", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"z", ",", 
      RowBox[{"rev", "[", "a4", "]"}], ",", "a5"}], 
     "\[RightAngleBracket]"}]}], "\[RightAngleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.6500902608726387`*^9, 3.650090261672056*^9}, {
  3.6500903375435038`*^9, 3.65009033826318*^9}, {3.6500903716279716`*^9, 
  3.650090395286643*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"rev", "[", "a1", "]"}], ",", "a2", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", 
     RowBox[{"rev", "[", "a4", "]"}], ",", "a5"}], "\[RightAngleBracket]"}]}],
   "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{
  3.650090263026555*^9, {3.650090319335743*^9, 3.6500903388058863`*^9}, 
   3.6500903792381887`*^9, 3.650090426017857*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sort", "[", 
  RowBox[{"Reap", "[", 
   RowBox[{"f", "/.", 
    RowBox[{
     RowBox[{"rev", "[", "x_", "]"}], "\[RuleDelayed]", 
     RowBox[{"Sow", "[", "x", "]"}]}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.650070545318795*^9, 3.65007055061182*^9}, {
  3.650070668644107*^9, 3.650070669486307*^9}, {3.650070789154182*^9, 
  3.650070815170364*^9}, {3.650070901120813*^9, 3.650070949216185*^9}, {
  3.650070979761623*^9, 3.650070982351379*^9}, {3.650071017663271*^9, 
  3.650071098526332*^9}, {3.650071131181427*^9, 3.650071154333187*^9}, {
  3.650071229870511*^9, 3.6500712337882957`*^9}, {3.650071352686356*^9, 
  3.650071353721868*^9}, {3.65009045605405*^9, 3.650090462009039*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a1", ",", "a2", ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"z", ",", "a4", ",", "a5"}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"a1", ",", "a4"}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.650090459674823*^9, 3.650090462664899*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sort", "[", 
  RowBox[{
   RowBox[{"Reap", "[", 
    RowBox[{
     RowBox[{"f", "/.", 
      RowBox[{
       RowBox[{"rev", "[", "x_", "]"}], "\[RuleDelayed]", 
       RowBox[{"Sow", "[", "x", "]"}]}]}], ";"}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.650070545318795*^9, 3.65007055061182*^9}, {
   3.650070668644107*^9, 3.650070669486307*^9}, {3.650070789154182*^9, 
   3.650070815170364*^9}, {3.650070901120813*^9, 3.650070949216185*^9}, {
   3.650070979761623*^9, 3.650070982351379*^9}, {3.650071017663271*^9, 
   3.650071098526332*^9}, {3.650071131181427*^9, 3.650071154333187*^9}, {
   3.650071229870511*^9, 3.6500712337882957`*^9}, {3.650071352686356*^9, 
   3.650071353721868*^9}, 3.650090468919064*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"a1", ",", "a4"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.6500713558340807`*^9, 3.650071450329319*^9, 
  3.6500904697282743`*^9}]
}, Open  ]],

Cell["--------Testing  ----------", "Text",
 CellChangeTimes->{{3.6142918796899557`*^9, 3.614291886285962*^9}, 
   3.649656874905471*^9, {3.6498874701347313`*^9, 3.6498875043581038`*^9}}],

Cell["\<\
27/08/2015   This example did not simplify to zero but does now,   \
\>", "Text",
 CellChangeTimes->{{3.649654985345683*^9, 3.649655067632169*^9}, {
   3.6496554016787043`*^9, 3.64965540352319*^9}, {3.649656848663911*^9, 
   3.649656850089429*^9}, 3.649656885420195*^9, {3.649725655103642*^9, 
   3.649725671310998*^9}, {3.6497257456302843`*^9, 3.649725755056713*^9}}],

Cell[BoxData[
 RowBox[{"StartDebug", "[", "]"}]], "Input",
 CellChangeTimes->{{3.649737946047688*^9, 3.649738002383974*^9}}],

Cell[BoxData[
 RowBox[{"StopDebug", "[", "]"}]], "Input",
 CellChangeTimes->{{3.649738037055038*^9, 3.649738037246833*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"w", ",", "X", ",", "Y"}], "\[RightAngleBracket]"}]}], 
  "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{{3.650149086519195*^9, 3.650149105933384*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"w", ",", "X", ",", "Y"}], "\[RightAngleBracket]"}]}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.6501491066861963`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X", ",", "Y", ",", "w"}], "\[RightAngleBracket]"}], ",", "z"}], 
  "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{{3.6501491185294657`*^9, 3.650149128477942*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "X", ",", "Y", ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.6501491291177807`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{
   "y", ",", "z", ",", "w", ",", "F0", ",", "F1", ",", "X", ",", "Y"}], "}"}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{"1", ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", "w", ",", "y"}], "}"}]}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"2", ",", 
    RowBox[{"{", 
     RowBox[{"F0", ",", "X", ",", "Y"}], "}"}]}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"3", ",", "F1"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumeAntisymmetric", "[", "F0", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.649654831914798*^9, 3.649654972356238*^9}, {
  3.649724703109148*^9, 3.649724703807802*^9}, {3.649745474888424*^9, 
  3.6497455299001617`*^9}, {3.649746098203186*^9, 3.649746115223024*^9}, {
  3.649914147133712*^9, 3.6499141472304697`*^9}, {3.649914216818535*^9, 
  3.649914217296711*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AntisymQ", "[", "F1", "]"}]], "Input",
 CellChangeTimes->{{3.649914230909773*^9, 3.64991423412117*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.64991423463402*^9, 3.649937410253907*^9, 3.6500729912531977`*^9, 
   3.650089304654166*^9, 3.650090553341063*^9, {3.650091421412281*^9, 
   3.650091438843718*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"z", ",", "F0", ",", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"F1", ",", "z"}], "\[RightAngleBracket]"}], ",", "z"}], 
   "\[RightAngleBracket]"}], "+", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"z", ",", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"z", ",", 
      RowBox[{"rev", "[", "F1", "]"}]}], "\[RightAngleBracket]"}], ",", "F0", 
    ",", "z"}], "\[RightAngleBracket]"}]}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.649745533105925*^9, {3.649746886775754*^9, 3.649746897455697*^9}, 
   3.6497469454309893`*^9, 3.6497951010229053`*^9, 3.649795192441021*^9, 
   3.64979658257075*^9, 3.649846357699767*^9, 3.649847704264552*^9, 
   3.6498872309398117`*^9, 3.649890763571218*^9, 3.649896169278969*^9, {
   3.6498975247896223`*^9, 3.6498975305957003`*^9}, 3.6499082110502567`*^9, 
   3.6499087233726997`*^9, {3.6499088857125673`*^9, 3.649908890561804*^9}, 
   3.649909881540515*^9, {3.649910300765996*^9, 3.649910321613347*^9}, 
   3.649913389518791*^9, 3.6499374143395243`*^9, 3.650072993678265*^9, 
   3.6500733458391953`*^9, {3.650089284423038*^9, 3.650089305989917*^9}, 
   3.6500893422938557`*^9, 3.650090554745124*^9, {3.650091341554316*^9, 
   3.650091358996072*^9}, 3.6500914411552143`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", "F0", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"F1", ",", "z"}], "\[RightAngleBracket]"}], ",", "z"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", 
     RowBox[{"rev", "[", "F1", "]"}]}], "\[RightAngleBracket]"}], ",", "F0", 
   ",", "z"}], "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.6499134001001368`*^9, 3.6499134034644423`*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F0", ",", "F1", ",", "z"}], "\[RightAngleBracket]"}]}],
   "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.649913405076417*^9, 3.649937417074272*^9, 
  3.6500733540668488`*^9, 3.650089345618876*^9, 3.650090557077681*^9, 
  3.650091380981606*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.649913405076417*^9, 3.649937417074272*^9, 
  3.6500733540668488`*^9, 3.650089345618876*^9, 3.650090557077681*^9, 
  3.6500913809849358`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AssumeAntisymmetric", "[", "F1", "]"}]], "Input",
 CellChangeTimes->{{3.649908917759844*^9, 3.6499089179257383`*^9}, 
   3.649909961507742*^9}],

Cell[BoxData["\<\"Tensor field \\!\\(F1\\) with degree\[VeryThinSpace] 3 is \
now assumed to be fully antisymmetric.\"\>"], "Output",
 CellChangeTimes->{3.6499134229963923`*^9, 3.649937425633403*^9, 
  3.650073369145073*^9, 3.650090562499999*^9}]
}, Open  ]],

Cell["\<\
When  F1  is antisymmetric these should all simplify to zero, but they not \
yet,\
\>", "Text",
 CellChangeTimes->{{3.649937497598228*^9, 3.6499375233900223`*^9}, {
  3.650073476587804*^9, 3.6500734804591503`*^9}, {3.650073563354342*^9, 
  3.650073567546332*^9}, {3.6500905769139223`*^9, 3.650090586961216*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"w", ",", "F0", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"F1", ",", "z"}], "\[RightAngleBracket]"}], ",", "z"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", 
     RowBox[{"rev", "[", "F1", "]"}]}], "\[RightAngleBracket]"}], ",", "F0", 
   ",", "w"}], "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "F0", ",", "w"}], "\[RightAngleBracket]"}]}],
   "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.6499134001001368`*^9, 3.6499134034644423`*^9}, {
  3.6500735006550198`*^9, 3.650073501613146*^9}, {3.650073539646653*^9, 
  3.650073550587817*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"w", ",", "F0", ",", "F1", ",", "z"}], "\[RightAngleBracket]"}]}],
   "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{
  3.649913427956842*^9, 3.649937428289826*^9, {3.65007336252919*^9, 
   3.6500733710555277`*^9}, {3.650073513461113*^9, 3.6500735687803392`*^9}, 
   3.650090568068746*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.649913427956842*^9, 3.649937428289826*^9, {3.65007336252919*^9, 
   3.6500733710555277`*^9}, {3.650073513461113*^9, 3.6500735687803392`*^9}, 
   3.650090568072015*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "F0", ",", "w"}], "\[RightAngleBracket]"}]}],
   "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{
  3.649913427956842*^9, 3.649937428289826*^9, {3.65007336252919*^9, 
   3.6500733710555277`*^9}, {3.650073513461113*^9, 3.6500735687803392`*^9}, 
   3.6500905680748863`*^9}]
}, Open  ]],

Cell["\<\
It is implicit that the   _AntisymQ   argument is  deg  \[GreaterEqual] 3  \
(else such a bracket could not exist),\
\>", "Text",
 CellChangeTimes->{{3.650090658768414*^9, 3.650090664960719*^9}, {
  3.65009090630392*^9, 3.650090983756406*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"z_", "?", "deg1Q"}], ",", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"_", "?", "deg1Q"}], ",", 
      RowBox[{"___", "?", "deg2Q"}], ",", "_AntisymQ", ",", "z_"}], 
     "\[RightAngleBracket]"}]}], "\[RightAngleBracket]"}], "=."}]], "Input",
 CellChangeTimes->{{3.650091187164071*^9, 3.650091188844223*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"z_", "?", "deg1Q"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"_", "?", "deg1Q"}], ",", 
       RowBox[{"___", "?", "deg2Q"}], ",", 
       RowBox[{"_", "?", "AntisymQ"}], ",", "z_"}], 
      "\[RightAngleBracket]"}]}], "\[RightAngleBracket]"}], ":=", "0"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"z_", "?", "deg1Q"}], ",", 
       RowBox[{"_", "?", "AntisymQ"}], ",", 
       RowBox[{"___", "?", "deg2Q"}], ",", 
       RowBox[{"_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", "z_"}], 
    "\[RightAngleBracket]"}], ":=", "0"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6499119921831083`*^9, 3.6499120899124737`*^9}, {
  3.6499121207173357`*^9, 3.6499121325995607`*^9}, {3.649912168023748*^9, 
  3.6499121963431683`*^9}, {3.64991223230908*^9, 3.649912255620801*^9}, {
  3.649913710658935*^9, 3.649913717057396*^9}, {3.649914059693519*^9, 
  3.649914080254327*^9}, {3.649914771514072*^9, 3.649914832356165*^9}, {
  3.650075038570393*^9, 3.650075042475128*^9}, {3.650090623924329*^9, 
  3.650090635860044*^9}, {3.650091493192287*^9, 3.650091578551803*^9}, {
  3.65009210299262*^9, 3.650092218225219*^9}, {3.650092296160418*^9, 
  3.650092297647143*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "282", "]"}]], "Output",
 CellChangeTimes->{
  3.650074934490128*^9, 3.650090990702764*^9, 3.650091114904538*^9, {
   3.650091192060382*^9, 3.650091197559206*^9}, 3.650091295551691*^9, 
   3.650091518412858*^9, 3.650091582109027*^9, 3.6500922444905453`*^9, 
   3.650092309903392*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "283", "]"}]], "Output",
 CellChangeTimes->{
  3.650074934490128*^9, 3.650090990702764*^9, 3.650091114904538*^9, {
   3.650091192060382*^9, 3.650091197559206*^9}, 3.650091295551691*^9, 
   3.650091518412858*^9, 3.650091582109027*^9, 3.6500922444905453`*^9, 
   3.650092309907134*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"w", ",", "F0", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"F1", ",", "z"}], "\[RightAngleBracket]"}], ",", "z"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", 
     RowBox[{"rev", "[", "F1", "]"}]}], "\[RightAngleBracket]"}], ",", "F0", 
   ",", "w"}], "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "F0", ",", "w"}], "\[RightAngleBracket]"}]}],
   "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.6499134001001368`*^9, 3.6499134034644423`*^9}, {
  3.6500735006550198`*^9, 3.650073501613146*^9}, {3.650073539646653*^9, 
  3.650073550587817*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.6500922565427628`*^9, 3.650092312102291*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.6500922565427628`*^9, 3.650092312108018*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "F0", ",", "w"}], "\[RightAngleBracket]"}]}],
   "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.6500922565427628`*^9, 3.650092312111188*^9}]
}, Open  ]],

Cell["\<\
When  F1  is antisymmetric these should all simplify to zero, but they do not \
yet,\
\>", "Text",
 CellChangeTimes->{{3.649937497598228*^9, 3.6499375233900223`*^9}, {
  3.650073476587804*^9, 3.6500734804591503`*^9}, {3.650073563354342*^9, 
  3.650073567546332*^9}, {3.6500905769139223`*^9, 3.650090586961216*^9}, {
  3.650092884994619*^9, 3.650092885249922*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "F0", ",", "F0"}], 
    "\[RightAngleBracket]"}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "F0", ",", "F0", ",", "w"}], 
    "\[RightAngleBracket]"}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "F1", ",", "F0"}], 
    "\[RightAngleBracket]"}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "F1", ",", "F0", ",", "w"}], 
    "\[RightAngleBracket]"}], ",", "w"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "F0", ",", "w"}], "\[RightAngleBracket]"}], 
   ",", "F0", ",", "w"}], "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.650092626456211*^9, 3.6500927598144093`*^9}, {
  3.6500928011744003`*^9, 3.6500928255262957`*^9}, {3.6500929166771107`*^9, 
  3.650092917844467*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "F0", ",", "F0"}], 
    "\[RightAngleBracket]"}]}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.6500926234477777`*^9, 3.6500926519150953`*^9}, {
   3.6500926835420237`*^9, 3.650092727677848*^9}, 3.650092760950611*^9, 
   3.650092847089267*^9, 3.650092919485564*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "F0", ",", "F0", ",", "w"}], 
    "\[RightAngleBracket]"}]}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.6500926234477777`*^9, 3.6500926519150953`*^9}, {
   3.6500926835420237`*^9, 3.650092727677848*^9}, 3.650092760950611*^9, 
   3.650092847089267*^9, 3.650092919490652*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "F1", ",", "F0"}], 
    "\[RightAngleBracket]"}]}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.6500926234477777`*^9, 3.6500926519150953`*^9}, {
   3.6500926835420237`*^9, 3.650092727677848*^9}, 3.650092760950611*^9, 
   3.650092847089267*^9, 3.650092919493804*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "F1", ",", "F0", ",", "w"}], 
    "\[RightAngleBracket]"}], ",", "w"}], "\[RightAngleBracket]"}]], "Output",\

 CellChangeTimes->{{3.6500926234477777`*^9, 3.6500926519150953`*^9}, {
   3.6500926835420237`*^9, 3.650092727677848*^9}, 3.650092760950611*^9, 
   3.650092847089267*^9, 3.6500929194968977`*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "F0", ",", "w"}], "\[RightAngleBracket]"}], 
   ",", "F0", ",", "w"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.6500926234477777`*^9, 3.6500926519150953`*^9}, {
   3.6500926835420237`*^9, 3.650092727677848*^9}, 3.650092760950611*^9, 
   3.650092847089267*^9, 3.650092919500024*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"___", ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"___", ",", 
       RowBox[{
        RowBox[{"F_", "?", "AntisymQ"}], "/;", 
        RowBox[{
         RowBox[{"deg", "[", "F", "]"}], ">", "2"}]}], ",", 
       RowBox[{"z_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", "z_"}], 
    "\[RightAngleBracket]"}], ":=", "0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"z_", "?", "deg1Q"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"z_", ",", 
       RowBox[{
        RowBox[{"F_", "?", "AntisymQ"}], "/;", 
        RowBox[{
         RowBox[{"deg", "[", "F", "]"}], ">", "2"}]}], ",", "___"}], 
      "\[RightAngleBracket]"}], ",", "___"}], "\[RightAngleBracket]"}], ":=", 
   "0"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6499119921831083`*^9, 3.6499120899124737`*^9}, {
  3.6499121207173357`*^9, 3.6499121325995607`*^9}, {3.649912168023748*^9, 
  3.6499121963431683`*^9}, {3.64991223230908*^9, 3.649912255620801*^9}, {
  3.649913710658935*^9, 3.649913717057396*^9}, {3.649914059693519*^9, 
  3.649914080254327*^9}, {3.649914771514072*^9, 3.649914832356165*^9}, {
  3.650075038570393*^9, 3.650075042475128*^9}, {3.650090623924329*^9, 
  3.650090635860044*^9}, {3.650091493192287*^9, 3.650091578551803*^9}, {
  3.65009210299262*^9, 3.650092218225219*^9}, {3.650092304159823*^9, 
  3.6500924172787952`*^9}, {3.65009244823773*^9, 3.650092487616603*^9}, {
  3.650093171939763*^9, 3.650093179098073*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "284", "]"}]], "Output",
 CellChangeTimes->{3.650093199089806*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "285", "]"}]], "Output",
 CellChangeTimes->{3.650093199094543*^9}]
}, Open  ]],

Cell["\<\
When  F1  is antisymmetric these should all simplify to zero, but they do not \
yet,\
\>", "Text",
 CellChangeTimes->{{3.649937497598228*^9, 3.6499375233900223`*^9}, {
  3.650073476587804*^9, 3.6500734804591503`*^9}, {3.650073563354342*^9, 
  3.650073567546332*^9}, {3.6500905769139223`*^9, 3.650090586961216*^9}, {
  3.650092884994619*^9, 3.650092885249922*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "F0", ",", "F0"}], 
    "\[RightAngleBracket]"}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "F0", ",", "F0", ",", "w"}], 
    "\[RightAngleBracket]"}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "F1", ",", "F0"}], 
    "\[RightAngleBracket]"}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"z", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "F1", ",", "F0", ",", "w"}], 
    "\[RightAngleBracket]"}], ",", "w"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "F0", ",", "w"}], "\[RightAngleBracket]"}], 
   ",", "F0", ",", "w"}], "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.650092626456211*^9, 3.6500927598144093`*^9}, {
  3.6500928011744003`*^9, 3.6500928255262957`*^9}, {3.6500929166771107`*^9, 
  3.650092917844467*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.6500932092920237`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.650093209295726*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.650093209299212*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.650093209302449*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"z", ",", "F1", ",", "F0", ",", "w"}], "\[RightAngleBracket]"}], 
   ",", "F0", ",", "w"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.6500932093062353`*^9}]
}, Open  ]],

Cell["\<\
This is zero because the vector  \[LeftAngleBracket]F0, w\[RightAngleBracket] \
 is contracted with 2 slots of   F1.   \
\>", "Text",
 CellChangeTimes->{{3.650093275613106*^9, 3.650093281916423*^9}, {
  3.650093331643662*^9, 3.650093384234591*^9}, {3.650093447929811*^9, 
  3.6500934582977324`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"F1", ",", "F0", ",", "w"}], "\[RightAngleBracket]"}], ",", "F0", 
   ",", "w"}], "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{3.650093240025387*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"F1", ",", "F0", ",", "w"}], "\[RightAngleBracket]"}], ",", "F0", 
   ",", "w"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.65009324084753*^9}]
}, Open  ]],

Cell["\<\
.... instead of   z_?deg1Q   in the above formulas, we could use   \
z__/;degBracket[z]===1\
\>", "Text",
 CellChangeTimes->{{3.650093598999814*^9, 3.650093678918489*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"X", ",", 
   RowBox[{"rev", "[", "Y", "]"}], ",", "w"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"Y", ",", 
   RowBox[{"rev", "[", "X", "]"}], ",", "w"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"rev", "[", "X", "]"}], ",", "Y", ",", "w"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"rev", "[", "Y", "]"}], ",", "X", ",", "w"}], 
  "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.6497461201829367`*^9, 3.6497461455073137`*^9}, {
  3.649746196137047*^9, 3.6497461982743893`*^9}, {3.649746314560684*^9, 
  3.64974632094037*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"w", ",", "Y", ",", 
   RowBox[{"rev", "[", "X", "]"}]}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.649746130984186*^9, 3.649746145884288*^9}, 
   3.64974620216996*^9, 3.6497463231543417`*^9, 3.6497469471750193`*^9, 
   3.6497966184078417`*^9, 3.649846387074523*^9, 3.649890772186282*^9, 
   3.6498983986467543`*^9, 3.650074463215925*^9, 3.6500943156244926`*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"Y", ",", 
   RowBox[{"rev", "[", "X", "]"}], ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.649746130984186*^9, 3.649746145884288*^9}, 
   3.64974620216996*^9, 3.6497463231543417`*^9, 3.6497469471750193`*^9, 
   3.6497966184078417`*^9, 3.649846387074523*^9, 3.649890772186282*^9, 
   3.6498983986467543`*^9, 3.650074463215925*^9, 3.650094315630168*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"rev", "[", "X", "]"}], ",", "Y", ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.649746130984186*^9, 3.649746145884288*^9}, 
   3.64974620216996*^9, 3.6497463231543417`*^9, 3.6497469471750193`*^9, 
   3.6497966184078417`*^9, 3.649846387074523*^9, 3.649890772186282*^9, 
   3.6498983986467543`*^9, 3.650074463215925*^9, 3.6500943156332397`*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"w", ",", 
   RowBox[{"rev", "[", "X", "]"}], ",", "Y"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.649746130984186*^9, 3.649746145884288*^9}, 
   3.64974620216996*^9, 3.6497463231543417`*^9, 3.6497469471750193`*^9, 
   3.6497966184078417`*^9, 3.649846387074523*^9, 3.649890772186282*^9, 
   3.6498983986467543`*^9, 3.650074463215925*^9, 3.650094315636293*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"w", ",", "X", ",", 
   RowBox[{"rev", "[", "Y", "]"}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"w", ",", "Y", ",", 
   RowBox[{"rev", "[", "X", "]"}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"w", ",", 
   RowBox[{"rev", "[", "X", "]"}], ",", "Y"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"w", ",", 
   RowBox[{"rev", "[", "Y", "]"}], ",", "X"}], 
  "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.6497463484807367`*^9, 3.649746360105062*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"Y", ",", 
   RowBox[{"rev", "[", "X", "]"}], ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.649746362031911*^9, 3.649796620657357*^9, 
  3.6498463885232*^9, 3.649887389080102*^9, 3.64989077423009*^9, 
  3.649898400780843*^9, 3.650074511501576*^9, 3.6500943173884783`*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"w", ",", "Y", ",", 
   RowBox[{"rev", "[", "X", "]"}]}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.649746362031911*^9, 3.649796620657357*^9, 
  3.6498463885232*^9, 3.649887389080102*^9, 3.64989077423009*^9, 
  3.649898400780843*^9, 3.650074511501576*^9, 3.6500943173943443`*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"w", ",", 
   RowBox[{"rev", "[", "X", "]"}], ",", "Y"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.649746362031911*^9, 3.649796620657357*^9, 
  3.6498463885232*^9, 3.649887389080102*^9, 3.64989077423009*^9, 
  3.649898400780843*^9, 3.650074511501576*^9, 3.650094317398683*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"rev", "[", "X", "]"}], ",", "Y", ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.649746362031911*^9, 3.649796620657357*^9, 
  3.6498463885232*^9, 3.649887389080102*^9, 3.64989077423009*^9, 
  3.649898400780843*^9, 3.650074511501576*^9, 3.65009431740292*^9}]
}, Open  ]],

Cell["29/09/2015,", "Text",
 CellChangeTimes->{{3.6524907579723883`*^9, 3.652490765652356*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"M1__", "?", "deg2revParityQ"}], ",", 
       RowBox[{"rev", "[", 
        RowBox[{"X_", "?", "deg2Q"}], "]"}], ",", 
       RowBox[{"M2__", "?", "deg2revParityQ"}]}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"rev", "[", "M2", "]"}], ",", "X", ",", 
       RowBox[{"rev", "[", "M1", "]"}]}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.652490771151648*^9, 3.6524907943895607`*^9}, {
  3.65249086383272*^9, 3.652490997922947*^9}, {3.65249108620962*^9, 
  3.652491161760845*^9}, {3.65249121030949*^9, 3.652491214320202*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "164", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"rev", "[", 
        RowBox[{"X_", "?", "deg2Q"}], "]"}], ",", 
       RowBox[{"M___", "?", "deg2revParityQ"}]}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"rev", "[", "M", "]"}], ",", "X"}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.652490989458559*^9, 3.6524910141789017`*^9}, 
   3.652491062753974*^9, {3.652491171782139*^9, 3.652491178960471*^9}, {
   3.652491211050803*^9, 3.652491215407793*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "165", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"M___", "?", "deg2revParityQ"}], ",", 
       RowBox[{"rev", "[", 
        RowBox[{"X_", "?", "deg2Q"}], "]"}]}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]], ":=", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"X", ",", 
       RowBox[{"rev", "[", "M", "]"}]}], "\[RightAngleBracket]"}], 
     "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.652490989458559*^9, 3.6524910141789017`*^9}, {
  3.652491062753974*^9, 3.652491079766904*^9}, {3.65249118982058*^9, 
  3.6524912160344267`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "166", "]"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Old junk, nothing initialized   ------   deleteable", "Subsubsection",
 CellChangeTimes->{{3.614336957915185*^9, 3.61433697346539*^9}, {
   3.6143370360915003`*^9, 3.614337080124157*^9}, {3.614728323898548*^9, 
   3.6147283291932707`*^9}, {3.6194966296171083`*^9, 3.619496629617293*^9}, {
   3.649725986922913*^9, 3.649726022826323*^9}, 3.6498330596984653`*^9, {
   3.649901221931573*^9, 3.649901256842812*^9}, {3.649901328570293*^9, 
   3.64990135052383*^9}, {3.6499895609845753`*^9, 3.649989593191065*^9}, {
   3.649990245870071*^9, 3.6499902576780643`*^9}, {3.650089394210026*^9, 
   3.6500894105816517`*^9}, {3.650089478321203*^9, 3.6500894837286367`*^9}, 
   3.650089552144709*^9}],

Cell["", "Text"],

Cell["\<\
Since we are aiming for lowest number of  rev[ ]  in the expression, the \
expression is stable w.r.t. the rules in this section if there is no \
dependence on rev[ ]. 
Therefore, these rules only apply for  \[LeftAngleBracket] X__ \
\[RightAngleBracket]   such that  X  involves  rev[ ],   ie.,   \
\[LeftAngleBracket] X_/;DependsQ[X, rev] \[RightAngleBracket] .
If the bracket is   revEvenQ   or  revOddQ   then it is by definition in \
simplest form w.r.t. possible simplifications using  rev[rev[ ]].  So the \
rules here can only apply 
if the bracket is not   revEvenQ   or   revOddQ. \
\>", "Text",
 CellChangeTimes->{{3.649991072338871*^9, 3.6499911238902073`*^9}, {
   3.649991177889306*^9, 3.64999121507323*^9}, {3.6499912864001207`*^9, 
   3.649991290239821*^9}, {3.649991345103324*^9, 3.64999150054158*^9}, {
   3.649991791755522*^9, 3.649991813304858*^9}, {3.649991856472879*^9, 
   3.649991956839685*^9}, {3.6499920358779793`*^9, 3.6499920984368258`*^9}, {
   3.6499921844038563`*^9, 3.6499922115400343`*^9}, {3.649992417121801*^9, 
   3.649992419472445*^9}, {3.649999791229369*^9, 3.649999978859048*^9}, {
   3.650000046378161*^9, 3.6500000493564663`*^9}, 3.650002100801786*^9, 
   3.6500699596100063`*^9}],

Cell[BoxData[
 RowBox[{"StopDebug", "[", "]"}]], "Input",
 CellChangeTimes->{{3.650070468351368*^9, 3.650070473300281*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"revNumber", "[", "x_", "]"}], ":=", 
  RowBox[{"Count", "[", 
   RowBox[{"x", ",", "rev", ",", "Infinity", ",", 
    RowBox[{"Heads", "\[Rule]", "True"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"revChoice", "[", "a__", "]"}], ":=", " ", 
  RowBox[{"Sign", "[", 
   RowBox[{
    RowBox[{"revNumber", "[", 
     RowBox[{"{", "a", "}"}], "]"}], "-", 
    RowBox[{"revNumber", "[", 
     RowBox[{"rev", "[", 
      RowBox[{"{", "a", "}"}], "]"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.649655552869659*^9, 3.649655552870302*^9}, {
  3.649739761510621*^9, 3.649739764089984*^9}, {3.649896926664536*^9, 
  3.649896927512882*^9}, {3.650024881495158*^9, 3.6500248912782707`*^9}}],

Cell["\<\
OrderedQ  does not work to compare a list and its reverse because of minus \
signs introduced by rev.  This will make a reversed list look like the \
arguments of a bracket,\
\>", "Text",
 CellChangeTimes->{{3.649748905611168*^9, 3.6497489484428453`*^9}, {
  3.649794172107642*^9, 3.649794181915678*^9}, {3.649896020034851*^9, 
  3.649896113630122*^9}, {3.6500251367369127`*^9, 3.650025157760507*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "AngleBracketArgList", "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"AngleBracketArgList", "[", 
    RowBox[{"{", 
     RowBox[{"Y1___", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a_", "?", "deg0Q"}], ")"}], " ", "X_"}], ",", "Y2___"}], 
     "}"}], "]"}], ":=", 
   RowBox[{"AngleBracketArgList", "[", 
    RowBox[{"{", 
     RowBox[{"Y1", ",", " ", "X", ",", "Y2"}], "}"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.649895585766507*^9, 3.649895696966834*^9}, {
   3.64989574158213*^9, 3.649895748563092*^9}, 3.649896953686262*^9, {
   3.649897300625193*^9, 3.649897318800811*^9}, {3.649897372401024*^9, 
   3.649897396274804*^9}}],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X__", "?", "revIsBetterQ"}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"Apply", "[", 
    RowBox[{"AngleBracket", ",", " ", 
     RowBox[{"rev", "[", 
      RowBox[{"{", "X", "}"}], "]"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6500052803453217`*^9, 3.650005326680686*^9}, {
  3.650022369192418*^9, 3.6500224098487253`*^9}, {3.6500254329177113`*^9, 
  3.650025434623452*^9}}],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"revIsBetterQ", "[", "X__", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"{", "X", "}"}], "]"}], ">", "1"}], "&&", 
    RowBox[{"DependsQ", "[", 
     RowBox[{
      RowBox[{"{", "X", "}"}], ",", "rev"}], "]"}], "&&", 
    RowBox[{"Same0or1Q", "[", 
     RowBox[{"degBracket", "[", "X", "]"}], "]"}], "&&", 
    RowBox[{"!", 
     RowBox[{"revParityQ", "[", "X", "]"}]}], "&&", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"revChoice", "[", "X", "]"}], "===", "1"}], "||", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"revChoice", "[", "X", "]"}], "===", "0"}], " ", "&&", " ", 
        RowBox[{"!", 
         RowBox[{"OrderedQ", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"AngleBracketArgList", "[", 
             RowBox[{"{", "X", "}"}], "]"}], ",", 
            RowBox[{"AngleBracketArgList", "[", 
             RowBox[{"rev", "[", 
              RowBox[{"{", "X", "}"}], "]"}], "]"}]}], "}"}], "]"}]}]}], 
       ")"}]}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6500224211582527`*^9, 3.650022476025483*^9}, {
  3.650023583845665*^9, 3.650023589408778*^9}, {3.650024567652686*^9, 
  3.6500245705415287`*^9}, {3.650024606444738*^9, 3.650024607021599*^9}, {
  3.650024685258569*^9, 3.6500247865756273`*^9}, {3.650025427946067*^9, 
  3.650025430660512*^9}}],

Cell["\<\
....in no other section is  rev[ ]  introduced to simplify an expression. \
Therefore, we have to use OrderedQ to decide the case  revChoice === 0.\
\>", "Text",
 CellChangeTimes->{{3.650024421354472*^9, 3.650024478473373*^9}, {
  3.6500245270973883`*^9, 3.650024561528582*^9}, {3.65002481331789*^9, 
  3.650024819557032*^9}}],

Cell["This rule results in zero, so had better be correct,", "Text",
 CellChangeTimes->{{3.6499093074970093`*^9, 3.6499093453370237`*^9}}],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"X__", "?", "zeroByrevParityQ"}], "\[RightAngleBracket]"}], ":=", 
   "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.650025451216425*^9, 3.6500254847673073`*^9}}],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"zeroByrevParityQ", "[", "X__", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"{", "X", "}"}], "]"}], ">", "1"}], "&&", 
    RowBox[{"DependsQ", "[", 
     RowBox[{
      RowBox[{"{", "X", "}"}], ",", "rev"}], "]"}], "&&", 
    RowBox[{"Same0or1Q", "[", 
     RowBox[{"degBracket", "[", "X", "]"}], "]"}], "&&", 
    RowBox[{"revParityQ", "[", "X", "]"}], "&&", 
    RowBox[{
     RowBox[{"revParity", "[", "X", "]"}], "===", 
     RowBox[{"-", "1"}]}], "&&", 
    RowBox[{
     RowBox[{"AngleBracketArgList", "[", 
      RowBox[{"{", "X", "}"}], "]"}], "===", 
     RowBox[{"AngleBracketArgList", "[", 
      RowBox[{"rev", "[", 
       RowBox[{"{", "X", "}"}], "]"}], "]"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6498943625095863`*^9, 3.649894366493458*^9}, {
  3.6498946460492067`*^9, 3.649894646758957*^9}, {3.649895905035885*^9, 
  3.649895910646652*^9}, {3.649895987395158*^9, 3.649895989765522*^9}, {
  3.649897465945026*^9, 3.649897474375433*^9}, {3.649908477658656*^9, 
  3.64990850455302*^9}, {3.649908862371825*^9, 3.6499088632679853`*^9}, {
  3.649908984517905*^9, 3.649908999666321*^9}, {3.650025504237771*^9, 
  3.650025599360983*^9}}],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------------------------\
\>", "Text",
 CellChangeTimes->{{3.6142918796899557`*^9, 3.614291886285962*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "List arguments for   \[LeftAngleBracket]  ,  \[RightAngleBracket]  and  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "   ", "\[RightAngleBracket]"}], "ab"], 
   TraditionalForm]]],
 " "
}], "Subsubsection",
 CellChangeTimes->{{3.614336873355857*^9, 3.614336902888986*^9}, {
  3.619496589209794*^9, 3.6194966359715776`*^9}, {3.6194967379640427`*^9, 
  3.619496747322419*^9}}],

Cell["\<\
The order of these two statements determines how the list outer-product \
expands.
The following order is such that the 1st list is for rows and the 2nd list \
for columns, \
\>", "Text",
 CellChangeTimes->{{3.478521348524732*^9, 3.478521367997245*^9}, {
   3.478521995402616*^9, 3.478522005330361*^9}, {3.478522082794157*^9, 
   3.478522380056022*^9}, 3.478522415777293*^9, {3.478522542569283*^9, 
   3.478522547072749*^9}, {3.478522672464452*^9, 3.47852282811114*^9}, {
   3.478522866720887*^9, 3.478522910998042*^9}, {3.478523013006232*^9, 
   3.478523063845325*^9}, {3.478523294797873*^9, 3.478523315180198*^9}, {
   3.478523421036623*^9, 3.478523455373287*^9}, {3.478523509195832*^9, 
   3.478523578355614*^9}, {3.478523821778841*^9, 3.478524070826569*^9}, {
   3.478524122176394*^9, 3.478524185184386*^9}, {3.478524340830039*^9, 
   3.478524400607762*^9}, {3.478524843318779*^9, 3.478525228555697*^9}, {
   3.478525654133307*^9, 3.47852582850393*^9}, {3.47852588911241*^9, 
   3.47852622600454*^9}, {3.478526429295789*^9, 3.478526440324654*^9}, {
   3.478526480332812*^9, 3.478526571756737*^9}, {3.478526603068721*^9, 
   3.478526606652022*^9}, {3.478795267077744*^9, 3.478795352817927*^9}, {
   3.479915940759345*^9, 3.479915950755815*^9}, {3.480322494553655*^9, 
   3.480322601346304*^9}, {3.480322877064838*^9, 3.480322903358676*^9}, {
   3.480857980168771*^9, 3.48085799640305*^9}, {3.480859302074985*^9, 
   3.480859326189325*^9}, {3.543712497261763*^9, 3.543712646125978*^9}, 
   3.614291159194181*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v1_List", ",", "v2_"}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AngleBracket", "[", 
       RowBox[{"#", ",", "v2"}], "]"}], "&"}], ",", "v1"}], "]"}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614896327417018*^9, 3.6148963334487057`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "167", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v1_", ",", "v2_List"}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"AngleBracket", "[", 
       RowBox[{"v1", ",", "#"}], "]"}], "&"}], ",", "v2"}], "]"}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614896337956691*^9, 3.614896340216752*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "168", "]"}]], "Output"]
}, Open  ]],

Cell["Matrix examples", "Text",
 CellChangeTimes->{{3.61949710487502*^9, 3.619497106891062*^9}, {
  3.619497150571216*^9, 3.619497153851245*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "d"}], "}"}]}], "\[RightAngleBracket]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.480857649392055*^9, 3.480857651735867*^9}, {
  3.480859169764571*^9, 3.480859173393893*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"a", ",", "c"}], "\[RightAngleBracket]"}], 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"a", ",", "d"}], "\[RightAngleBracket]"}]},
     {
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"b", ",", "c"}], "\[RightAngleBracket]"}], 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"b", ",", "d"}], "\[RightAngleBracket]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.480859174162361*^9, 3.518081132152623*^9, 
  3.543712441645733*^9, 3.613716841046042*^9, 3.613718541316772*^9, 
  3.619496970366686*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"e", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "d"}], "}"}]}], "}"}]}], "\[RightAngleBracket]"}], "//",
   "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.61949697908845*^9, 3.619496984448906*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"e", ",", "a"}], "\[RightAngleBracket]"}], 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"e", ",", "b"}], "\[RightAngleBracket]"}]},
     {
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"e", ",", "c"}], "\[RightAngleBracket]"}], 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"e", ",", "d"}], "\[RightAngleBracket]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619496985167264*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "d"}], "}"}]}], "}"}], ",", "f"}], 
   "\[RightAngleBracket]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.619496998577075*^9, 3.6194969986892233`*^9}, 
   3.6194970765123987`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"a", ",", "f"}], "\[RightAngleBracket]"}], 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"b", ",", "f"}], "\[RightAngleBracket]"}]},
     {
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"c", ",", "f"}], "\[RightAngleBracket]"}], 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"d", ",", "f"}], "\[RightAngleBracket]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.619497077115675*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"e", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", "d"}], "}"}]}], "}"}]}], "\[RightAngleBracket]"}],
      ",", "f"}], "\[RightAngleBracket]"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.61949701775482*^9, 3.619497052282823*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
        RowBox[{"\[LeftAngleBracket]", 
         RowBox[{"e", ",", "a"}], "\[RightAngleBracket]"}], ",", "f"}], 
       "\[RightAngleBracket]"}], 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
        RowBox[{"\[LeftAngleBracket]", 
         RowBox[{"e", ",", "b"}], "\[RightAngleBracket]"}], ",", "f"}], 
       "\[RightAngleBracket]"}]},
     {
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
        RowBox[{"\[LeftAngleBracket]", 
         RowBox[{"e", ",", "c"}], "\[RightAngleBracket]"}], ",", "f"}], 
       "\[RightAngleBracket]"}], 
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{
        RowBox[{"\[LeftAngleBracket]", 
         RowBox[{"e", ",", "d"}], "\[RightAngleBracket]"}], ",", "f"}], 
       "\[RightAngleBracket]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6194970232132*^9, 3.619497054232335*^9}]
}, Open  ]],

Cell["\<\
To get these right, see the linear algebra for  \[LeftAngleBracket] ___, 0 , \
____\[RightAngleBracket],  need to check for List,\
\>", "Text",
 CellChangeTimes->{{3.622310445415152*^9, 3.622310507352665*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AngleBracket", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}], ",", "0"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AngleBracket", "[", 
  RowBox[{"0", ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", "d"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AngleBracket", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.622309967569179*^9, 3.622309978766707*^9}, 
   3.622310368818325*^9, 3.622310539520401*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.622309980653627*^9, 3.622310297738035*^9, 
  3.622310337075715*^9, 3.6223103837635098`*^9, 3.622310557413497*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.622309980653627*^9, 3.622310297738035*^9, 
  3.622310337075715*^9, 3.6223103837635098`*^9, 3.622310557425253*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.622309980653627*^9, 3.622310297738035*^9, 
  3.622310337075715*^9, 3.6223103837635098`*^9, 3.6223105574355583`*^9}]
}, Open  ]],

Cell["For the single argument form...", "Text",
 CellChangeTimes->{{3.478521348524732*^9, 3.478521367997245*^9}, {
   3.478521995402616*^9, 3.478522005330361*^9}, {3.478522082794157*^9, 
   3.478522380056022*^9}, 3.478522415777293*^9, {3.478522542569283*^9, 
   3.478522547072749*^9}, {3.478522672464452*^9, 3.47852282811114*^9}, {
   3.478522866720887*^9, 3.478522910998042*^9}, {3.478523013006232*^9, 
   3.478523063845325*^9}, {3.478523294797873*^9, 3.478523315180198*^9}, {
   3.478523421036623*^9, 3.478523455373287*^9}, {3.478523509195832*^9, 
   3.478523578355614*^9}, {3.478523821778841*^9, 3.478524070826569*^9}, {
   3.478524122176394*^9, 3.478524185184386*^9}, {3.478524340830039*^9, 
   3.478524400607762*^9}, {3.478524843318779*^9, 3.478525228555697*^9}, {
   3.478525654133307*^9, 3.47852582850393*^9}, {3.47852588911241*^9, 
   3.47852622600454*^9}, {3.478526429295789*^9, 3.478526440324654*^9}, {
   3.478526480332812*^9, 3.478526571756737*^9}, {3.478526603068721*^9, 
   3.478526606652022*^9}, {3.478795267077744*^9, 3.478795352817927*^9}, {
   3.479915940759345*^9, 3.479915950755815*^9}, {3.480322494553655*^9, 
   3.480322601346304*^9}, {3.480322877064838*^9, 3.480322903358676*^9}, {
   3.480857980168771*^9, 3.48085799640305*^9}, {3.4808583145465*^9, 
   3.480858336737571*^9}, {3.5437127003825283`*^9, 3.543712708302246*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "x_List", "\[RightAngleBracket]"}], 
    "ab__"], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox[
       RowBox[{"\[LeftAngleBracket]", "#", "\[RightAngleBracket]"}], "ab"], 
      "&"}], ",", "x"}], "]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5437126829547462`*^9, 3.543712682955906*^9}, {
  3.543712716999544*^9, 3.54371274338148*^9}, {3.614896346090036*^9, 
  3.614896348376997*^9}, {3.619496661108107*^9, 3.619496672630069*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "169", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------------------------\
\>", "Text",
 CellChangeTimes->{{3.6142918796899557`*^9, 3.614291886285962*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\[CircleTimes]    for   \[LeftAngleBracket]  ,  ,  ,  \
\[RightAngleBracket]  ", "Subsubsection",
 CellChangeTimes->{{3.6142975261838493`*^9, 3.6142975286619167`*^9}, {
   3.614298506233*^9, 3.614298515672933*^9}, {3.615369429048561*^9, 
   3.6153694509035473`*^9}, 3.61568651513774*^9, {3.649901364953199*^9, 
   3.649901368057889*^9}}],

Cell["\<\
 The following code makes use of the relation  \[CircleTimes]v_ = v ,   so \
that   Rest[ x \[CircleTimes] y ] = y,\
\>", "Text",
 CellChangeTimes->{{3.614298296699026*^9, 3.6142983354473677`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[CircleTimes]", "v"}], "\[IndentingNewLine]", 
 RowBox[{"Rest", "[", 
  RowBox[{"x", "\[CircleTimes]", "y"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6143982692973127`*^9, 3.614398300980999*^9}}],

Cell[BoxData["v"], "Output",
 CellChangeTimes->{{3.614398277762394*^9, 3.614398303492126*^9}, 
   3.615686496473464*^9}],

Cell[BoxData["y"], "Output",
 CellChangeTimes->{{3.614398277762394*^9, 3.614398303492126*^9}, 
   3.615686496482353*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X_CircleTimes", ",", "Y__"}], "\[RightAngleBracket]"}], ":=", 
    RowBox[{
     RowBox[{"Most", "[", "X", "]"}], "\[CircleTimes]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"Last", "[", "X", "]"}], ",", "Y"}], 
      "\[RightAngleBracket]"}]}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y__", ",", "X_CircleTimes"}], "\[RightAngleBracket]"}], ":=", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y", ",", 
       RowBox[{"First", "[", "X", "]"}]}], "\[RightAngleBracket]"}], 
     "\[CircleTimes]", 
     RowBox[{"Rest", "[", "X", "]"}]}]}]}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6142969394276333`*^9, 3.614296950847198*^9}, {
  3.614297271234415*^9, 3.614297276848029*^9}, {3.614297842069991*^9, 
  3.614297843746839*^9}, {3.6167412982127237`*^9, 3.616741301794485*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "170", "]"}]], "Output"],

Cell[BoxData[
 RowBox[{"rule", "[", "171", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1__", ",", 
      RowBox[{"X_CircleTimes", "/;", 
       RowBox[{
        RowBox[{"Length", "[", "X", "]"}], "===", "2"}]}], ",", "Y2__"}], 
     "\[RightAngleBracket]"}], ":=", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1", ",", 
       RowBox[{"First", "[", "X", "]"}]}], "\[RightAngleBracket]"}], 
     "\[CircleTimes]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"Last", "[", "X", "]"}], ",", "Y2"}], 
      "\[RightAngleBracket]"}]}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6149371029573402`*^9, 3.61493712182152*^9}, {
   3.614937169389352*^9, 3.614937198126298*^9}, 3.61674130445647*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "172", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1__", ",", 
      RowBox[{"X_CircleTimes", "/;", 
       RowBox[{
        RowBox[{"Length", "[", "X", "]"}], ">", "2"}]}], ",", "Y2__"}], 
     "\[RightAngleBracket]"}], ":=", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1", ",", 
       RowBox[{"First", "[", "X", "]"}]}], "\[RightAngleBracket]"}], 
     "\[CircleTimes]", 
     RowBox[{"Most", "[", 
      RowBox[{"Rest", "[", "X", "]"}], "]"}], "\[CircleTimes]", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"Last", "[", "X", "]"}], ",", "Y2"}], 
      "\[RightAngleBracket]"}]}]}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.478704460992132*^9, 3.478704492432724*^9}, {
   3.47870453327036*^9, 3.478704558528715*^9}, {3.478704982886998*^9, 
   3.478705044486556*^9}, {3.478705801007725*^9, 3.478705832049161*^9}, {
   3.478778520211509*^9, 3.478778532827303*^9}, {3.47877858817301*^9, 
   3.478778630550568*^9}, {3.478778724191949*^9, 3.478778784321296*^9}, {
   3.47904451726398*^9, 3.479044524607761*^9}, {3.480325405777084*^9, 
   3.480325428500062*^9}, {3.6141141898901587`*^9, 3.6141141919189587`*^9}, {
   3.614296364818009*^9, 3.614296390768313*^9}, {3.6142965311383743`*^9, 
   3.6142965772174253`*^9}, 3.614296884179043*^9, {3.614297565733588*^9, 
   3.614297628470591*^9}, {3.614297710644168*^9, 3.614297722567953*^9}, {
   3.6142981216592484`*^9, 3.614298122553537*^9}, 3.614936862845553*^9, {
   3.6149372315509863`*^9, 3.614937234863752*^9}, 3.616741305521783*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "173", "]"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing", "Subsubsection",
 CellChangeTimes->{{3.6149375254136066`*^9, 3.614937526773828*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"a", ",", "b", ",", 
   RowBox[{"x", "\[CircleTimes]", "y", "\[CircleTimes]", "z"}], ",", "c", ",",
    "d"}], "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{{3.61429676457268*^9, 3.614296799020096*^9}, {
  3.614298147020124*^9, 3.614298149072546*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a", ",", "b", ",", "x"}], "\[RightAngleBracket]"}], 
  "\[CircleTimes]", "y", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"z", ",", "c", ",", "d"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{3.614296800518941*^9, 3.614297861679348*^9, 
  3.6142980230394173`*^9, 3.614298090554139*^9, 3.614298139690495*^9, 
  3.614398224711472*^9, 3.614936981413991*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"x", "\[CircleTimes]", "y", "\[CircleTimes]", "z"}], ",", "c", ",",
    "d"}], "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{{3.6142981553757143`*^9, 3.614298161519919*^9}}],

Cell[BoxData[
 RowBox[{"x", "\[CircleTimes]", "y", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"z", ",", "c", ",", "d"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{{3.614298156138666*^9, 3.61429816231774*^9}, 
   3.6143982262621193`*^9, 3.6149369966795483`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[CircleTimes]", "y"}], ",", "c"}], 
  "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{3.614937326504518*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"y", ",", "c"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.614937328055032*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"x", "\[CircleTimes]", "y"}], ",", "c"}], 
  "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{3.6149373089526854`*^9}],

Cell[BoxData[
 RowBox[{"x", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"y", ",", "c"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{3.614937309799265*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"x", "\[CircleTimes]", "y"}], ",", "c", ",", "d"}], 
  "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{3.614298174078589*^9}],

Cell[BoxData[
 RowBox[{"x", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"y", ",", "c", ",", "d"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{3.614298174730275*^9, 3.614398227332634*^9, 
  3.614936999541626*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"a", ",", "b", ",", 
   RowBox[{"x", "\[CircleTimes]", "y"}], ",", "c", ",", "d"}], 
  "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{3.6142981937280197`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a", ",", "b", ",", "x"}], "\[RightAngleBracket]"}], 
  "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"y", ",", "c", ",", "d"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{3.614298194567205*^9, 3.61439822984295*^9, 
  3.614937005938611*^9, 3.6149373457514753`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"a", ",", "b", ",", 
   RowBox[{"x", "\[CircleTimes]", "y", "\[CircleTimes]", "w"}], ",", "c", ",",
    "d"}], "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{{3.614937372109963*^9, 3.614937374138157*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a", ",", "b", ",", "x"}], "\[RightAngleBracket]"}], 
  "\[CircleTimes]", "y", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"w", ",", "c", ",", "d"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{3.6149373764873133`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"a", ",", "b", ",", 
   RowBox[{"x", "\[CircleTimes]", "y"}]}], "\[RightAngleBracket]"}]], "Input",\

 CellChangeTimes->{3.614298203119487*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a", ",", "b", ",", "x"}], "\[RightAngleBracket]"}], 
  "\[CircleTimes]", "y"}]], "Output",
 CellChangeTimes->{3.614298203738737*^9, 3.6143982308684053`*^9, 
  3.614937355702997*^9}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------------------------\
\>", "Text",
 CellChangeTimes->{{3.6142918796899557`*^9, 3.614291886285962*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Standard forms for    \[LeftAngleBracket]  ,  ,  ,  \[RightAngleBracket]    \
involving   rev[ ]                ------   28/08/2015  Nothing here is being \
used --- deleteable.\
\>", "Subsubsection",
 CellChangeTimes->{{3.6143371096912317`*^9, 3.6143371469545116`*^9}, {
  3.615371430733045*^9, 3.615371432606051*^9}, {3.615372288671595*^9, 
  3.615372292767764*^9}, {3.615535741736669*^9, 3.615535743528719*^9}, {
  3.649654606774205*^9, 3.6496546292858877`*^9}, {3.649898795605179*^9, 
  3.649898818313806*^9}, {3.650936266892668*^9, 3.650936267473774*^9}}],

Cell["\<\
00:17  11/08/2014.  It is OK to treat a terminated (degree 1) 2-chain as a \
vector, and bind it to the end-slot of a tensor, because it can\
\[CloseCurlyQuote]t go anywhere else,\
\>", "Text",
 CellChangeTimes->{{3.616668639315674*^9, 3.616668726869392*^9}, {
  3.6166688279571323`*^9, 3.6166688529814653`*^9}, {3.616669031749938*^9, 
  3.616669046245782*^9}}],

Cell["\<\
28/08/2015  Uninitialized   (this is probably/ought to be, covered in section \
 \[OpenCurlyDoubleQuote] \[LeftAngleBracket] ,  ,  , \[RightAngleBracket]   \
is almost flat\[CloseCurlyDoubleQuote] )\
\>", "Text",
 CellChangeTimes->{{3.649721037903037*^9, 3.649721053886795*^9}, {
  3.649726097161558*^9, 3.6497261787445717`*^9}}],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y__", ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"X__", "?", "deg2Q"}], ",", 
       RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y", ",", "X", ",", "v"}], "\[RightAngleBracket]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.616668747163782*^9, 3.6166688244267*^9}, {
  3.616668883851115*^9, 3.616668957275627*^9}, {3.616668990795679*^9, 
  3.616669013628477*^9}, {3.6166696790436773`*^9, 3.6166696824465733`*^9}}],

Cell["\<\
28/08/2015  Uninitialized   (this is probably/ought to be, covered in section \
 \[OpenCurlyDoubleQuote] \[LeftAngleBracket] ,  ,  , \[RightAngleBracket]   \
is almost flat\[CloseCurlyDoubleQuote] )\
\>", "Text",
 CellChangeTimes->{{3.649721037903037*^9, 3.649721053886795*^9}, {
  3.649726097161558*^9, 3.6497261787445717`*^9}}],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"v_", "?", "deg1Q"}], ",", 
       RowBox[{"X__", "?", "deg2Q"}]}], "\[RightAngleBracket]"}], ",", 
     "Y__"}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v", ",", "X", ",", "Y"}], "\[RightAngleBracket]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.616669093003543*^9, 3.6166691335406713`*^9}, {
  3.6166696799665937`*^9, 3.616669683340472*^9}}],

Cell["\<\

Standard forms for   \[LeftAngleBracket] Y,  \[LeftAngleBracket] v,  X \
\[RightAngleBracket]\[RightAngleBracket]   and   \[LeftAngleBracket]\
\[LeftAngleBracket] Y, v \[RightAngleBracket],  X \[RightAngleBracket]    \
where we can make a  2-chain:     \[LeftAngleBracket] Y,  rev[ X ] ,  v \
\[RightAngleBracket]    and    \[LeftAngleBracket] v,  rev[ X ],  Y \
\[RightAngleBracket] .
11:26  9/8/2014.  Old defns in terms of  a_Anglebracket replaced.  Y now \
restricted to deg1or2Q,
00:17  11/08/2014.  It is OK to treat a terminated (degree 1) 2-chain as a \
vector, and bind it to the end-slot of a tensor, because it can\
\[CloseCurlyQuote]t go anywhere else. Y no longer restricted to deg1or2Q,\
\>", "Text",
 CellChangeTimes->{{3.614292227098361*^9, 3.61429232997751*^9}, {
  3.614295364402347*^9, 3.61429536662431*^9}, {3.615081611220503*^9, 
  3.6150816782549543`*^9}, {3.615081749007496*^9, 3.615081854784734*^9}, {
  3.6165339488197737`*^9, 3.61653398576432*^9}, {3.6165364006632547`*^9, 
  3.6165364569832697`*^9}, {3.616536550759584*^9, 3.6165365844555483`*^9}, {
  3.616669262182933*^9, 3.61666928129183*^9}}],

Cell["28/08/2015  Uninitialized,", "Text",
 CellChangeTimes->{{3.649721037903037*^9, 3.649721053886795*^9}}],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"X__", "?", "deg2Q"}], ",", 
       RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", "Y__"}],
     "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v", ",", 
     RowBox[{"Apply", "[", 
      RowBox[{"Sequence", ",", 
       RowBox[{"rev", "[", 
        RowBox[{"{", "X", "}"}], "]"}]}], "]"}], ",", "Y"}], 
    "\[RightAngleBracket]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.615079392745199*^9, 3.6150794072890053`*^9}, {
   3.6150795728120813`*^9, 3.6150795902986937`*^9}, {3.615079627530795*^9, 
   3.615079765006318*^9}, 3.61508018219169*^9, {3.615080580722906*^9, 
   3.615080612146357*^9}, {3.615080661185872*^9, 3.615080665457984*^9}, {
   3.615086147039546*^9, 3.615086158754148*^9}, {3.615086212191975*^9, 
   3.615086216207514*^9}, {3.615154150825933*^9, 3.615154159546021*^9}, 
   3.615154201433523*^9, {3.615155147197757*^9, 3.6151551707163258`*^9}, {
   3.615155210316268*^9, 3.615155239612672*^9}, {3.615155270780793*^9, 
   3.615155285677039*^9}, {3.616533806173932*^9, 3.616533853902425*^9}, 
   3.616534021379436*^9, {3.616535229745461*^9, 3.616535230556892*^9}, {
   3.616535282782949*^9, 3.616535365838141*^9}, 3.616669297074196*^9}],

Cell["28/08/2015  Uninitialized,", "Text",
 CellChangeTimes->{{3.649721037903037*^9, 3.649721053886795*^9}}],

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y__", ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"v_", "?", "deg1Q"}], ",", 
       RowBox[{"X__", "?", "deg2Q"}]}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y", ",", 
     RowBox[{"Apply", "[", 
      RowBox[{"Sequence", ",", 
       RowBox[{"rev", "[", 
        RowBox[{"{", "X", "}"}], "]"}]}], "]"}], ",", "v"}], 
    "\[RightAngleBracket]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.61653539624331*^9, 3.6165353979987097`*^9}, {
   3.616535451757372*^9, 3.616535515790305*^9}, 3.61666930123283*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing", "Subsubsection",
 CellChangeTimes->{{3.61508093186756*^9, 3.615080933259645*^9}, 
   3.616708140254285*^9, 3.6553193626175537`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearField", "[", 
   RowBox[{"{", 
    RowBox[{"a1", ",", "a2", ",", "a3"}], "}"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"2", ",", 
    RowBox[{"{", 
     RowBox[{"a1", ",", "a2", ",", "a3"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearField", "[", "b", "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"3", ",", "b"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.615080841930994*^9, 3.615080901489645*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"deg2Q", "[", 
  RowBox[{"Apply", "[", 
   RowBox[{"Sequence", ",", 
    RowBox[{"\[LeftAngleBracket]", "\[RightAngleBracket]"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"deg2Q", "[", 
  RowBox[{"Apply", "[", 
   RowBox[{"Sequence", ",", 
    RowBox[{"\[LeftAngleBracket]", "a1", "\[RightAngleBracket]"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"deg2Q", "[", 
  RowBox[{"Apply", "[", 
   RowBox[{"Sequence", ",", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"a1", ",", "a2"}], "\[RightAngleBracket]"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"deg2Q", "[", 
  RowBox[{"Apply", "[", 
   RowBox[{"Sequence", ",", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"a1", ",", "a2", ",", "a3"}], "\[RightAngleBracket]"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"deg2Q", "[", 
  RowBox[{"Apply", "[", 
   RowBox[{"Sequence", ",", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"a1", ",", "b", ",", "a2", ",", "a3"}], 
     "\[RightAngleBracket]"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.61508629778979*^9, 3.615086350511965*^9}}],

Cell[BoxData[
 RowBox[{"deg2Q", "[", "]"}]], "Output",
 CellChangeTimes->{3.6150862670973988`*^9, 3.615086346041177*^9, 
  3.615087347256216*^9, 3.6150876257923*^9, 3.615090856198304*^9, 
  3.6150984381468678`*^9, 3.615153925160078*^9, 3.615154216438692*^9, 
  3.6151691084070253`*^9, 3.615535399056775*^9, 3.649890817264955*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6150862670973988`*^9, 3.615086346041177*^9, 
  3.615087347256216*^9, 3.6150876257923*^9, 3.615090856198304*^9, 
  3.6150984381468678`*^9, 3.615153925160078*^9, 3.615154216438692*^9, 
  3.6151691084070253`*^9, 3.615535399056775*^9, 3.649890817267907*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6150862670973988`*^9, 3.615086346041177*^9, 
  3.615087347256216*^9, 3.6150876257923*^9, 3.615090856198304*^9, 
  3.6150984381468678`*^9, 3.615153925160078*^9, 3.615154216438692*^9, 
  3.6151691084070253`*^9, 3.615535399056775*^9, 3.649890817270527*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6150862670973988`*^9, 3.615086346041177*^9, 
  3.615087347256216*^9, 3.6150876257923*^9, 3.615090856198304*^9, 
  3.6150984381468678`*^9, 3.615153925160078*^9, 3.615154216438692*^9, 
  3.6151691084070253`*^9, 3.615535399056775*^9, 3.649890817273469*^9}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.6150862670973988`*^9, 3.615086346041177*^9, 
  3.615087347256216*^9, 3.6150876257923*^9, 3.615090856198304*^9, 
  3.6150984381468678`*^9, 3.615153925160078*^9, 3.615154216438692*^9, 
  3.6151691084070253`*^9, 3.615535399056775*^9, 3.649890817276114*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearField", "[", "v", "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"1", ",", "v"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearField", "[", 
   RowBox[{"{", 
    RowBox[{"Y1", ",", "Y2"}], "}"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"3", ",", 
    RowBox[{"{", 
     RowBox[{"Y1", ",", "Y2"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.615081296369153*^9, 3.61508134800329*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "v"}], "\[RightAngleBracket]"}], 
   ",", "Y1", ",", "Y2"}], "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"Y1", ",", "Y2", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v", ",", "a1", ",", "a2", ",", "a3"}], 
    "\[RightAngleBracket]"}]}], "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.6150813527442427`*^9, 3.615081405172509*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "v"}], "\[RightAngleBracket]"}], 
   ",", "Y1", ",", "Y2"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.6150813793572903`*^9, 3.615081408644754*^9}, 
   3.6150864247940893`*^9, 3.615087349887615*^9, 3.6150875171973743`*^9, 
   3.6150908614709578`*^9, 3.61509844872544*^9, 3.615099085988027*^9, 
   3.615153940063034*^9, 3.6151542184145203`*^9, 3.615154357831966*^9, 
   3.615155499999496*^9, 3.615169113999372*^9, 3.615535415912549*^9, 
   3.6498908217850723`*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"Y1", ",", "Y2", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v", ",", "a1", ",", "a2", ",", "a3"}], 
    "\[RightAngleBracket]"}]}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.6150813793572903`*^9, 3.615081408644754*^9}, 
   3.6150864247940893`*^9, 3.615087349887615*^9, 3.6150875171973743`*^9, 
   3.6150908614709578`*^9, 3.61509844872544*^9, 3.615099085988027*^9, 
   3.615153940063034*^9, 3.6151542184145203`*^9, 3.615154357831966*^9, 
   3.615155499999496*^9, 3.615169113999372*^9, 3.615535415912549*^9, 
   3.64989082178795*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a1", ",", "v"}], "\[RightAngleBracket]"}], ",", "Y1"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"Y1", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v", ",", "a1"}], "\[RightAngleBracket]"}]}], 
  "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.615081437090488*^9, 3.6150814494013042`*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a1", ",", "v"}], "\[RightAngleBracket]"}], ",", "Y1"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.6150814515841217`*^9, 3.615086426379592*^9, 
  3.615098530890547*^9, 3.615098805006155*^9, 3.615099123000263*^9, 
  3.615154443586637*^9, 3.6151691193616133`*^9, 3.615535420998748*^9, 
  3.6498908630003157`*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"Y1", ",", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v", ",", "a1"}], "\[RightAngleBracket]"}]}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.6150814515841217`*^9, 3.615086426379592*^9, 
  3.615098530890547*^9, 3.615098805006155*^9, 3.615099123000263*^9, 
  3.615154443586637*^9, 3.6151691193616133`*^9, 3.615535420998748*^9, 
  3.6498908630105543`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"StartDebug", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a1", ",", "v"}], "\[RightAngleBracket]"}], ",", "Y1"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"StopDebug", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.61515445238111*^9, 3.615154456599308*^9}, {
  3.615169171096403*^9, 3.615169180478932*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a1", ",", "v"}], "\[RightAngleBracket]"}], ",", "Y1"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.615169183172668*^9, 3.615535425794057*^9, 
  3.649890888906659*^9}]
}, Open  ]],

Cell["\<\
This converts any expression to a list of terms, as they appear in the \
expression (a list with repeats, not a set).  Subscript pairs are dropped,\
\>", "Text",
 CellChangeTimes->{{3.6167080844140797`*^9, 3.61670826995059*^9}, {
  3.6167084349903927`*^9, 3.61670845311854*^9}}],

Cell["28/08/2015  Uninitialized,", "Text",
 CellChangeTimes->{{3.649721037903037*^9, 3.649721053886795*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToList", "[", "x_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "h", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"h", "=", 
      RowBox[{"Hold", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"h", "=", 
      RowBox[{"h", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Plus", "\[Rule]", "List"}], ",", 
         RowBox[{"Times", "\[Rule]", "List"}], ",", 
         RowBox[{"CircleTimes", "\[Rule]", "List"}], ",", 
         RowBox[{
          SubscriptBox[
           RowBox[{"\[LeftAngleBracket]", "X_", "\[RightAngleBracket]"}], 
           "__"], "\[RuleDelayed]", "X"}], ",", 
         RowBox[{"AngleBracket", "\[Rule]", "List"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{"ReleaseHold", "[", "h", "]"}], "}"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6167072082976913`*^9, 3.61670728326919*^9}, {
  3.616707338997611*^9, 3.6167074988395557`*^9}, {3.616707733000351*^9, 
  3.616707744424149*^9}, {3.616723536548133*^9, 3.6167235393894033`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"2", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a1", ",", 
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"a2", "\[CircleTimes]", "a3"}], "\[RightAngleBracket]"}], 
      "ab"], ",", "a4"}], "\[RightAngleBracket]"}]}], "+", 
  RowBox[{"3", "x", " ", "a5"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"2", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"a1", ",", 
      SubscriptBox[
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"a2", "\[CircleTimes]", "a3"}], "\[RightAngleBracket]"}], 
       "ab"], ",", "a4"}], "\[RightAngleBracket]"}]}], "+", 
   RowBox[{"3", "x", " ", "a5"}]}], "//", "ToList"}], "\[IndentingNewLine]", 
 RowBox[{"a1", "//", "ToList"}], "\[IndentingNewLine]", 
 RowBox[{"ToList", "[", 
  RowBox[{"rev", "[", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a1", ",", 
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"a2", "\[CircleTimes]", "a3"}], "\[RightAngleBracket]"}], 
      "ab"], ",", "a4"}], "\[RightAngleBracket]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.616708302187182*^9, 3.616708414436702*^9}, {
  3.6167235882039957`*^9, 3.6167236450986032`*^9}, {3.6167489316961193`*^9, 
  3.616748944704496*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"3", " ", "a5", " ", "x"}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a1", ",", 
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"a2", "\[CircleTimes]", "a3"}], "\[RightAngleBracket]"}], 
      "ab"], ",", "a4"}], "\[RightAngleBracket]"}]}]}]], "Output",
 CellChangeTimes->{{3.61670839317632*^9, 3.616708416884872*^9}, 
   3.616723556612583*^9, 3.61672360262995*^9, {3.616723634572279*^9, 
   3.61672364705926*^9}, 3.6167489457803583`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3", ",", "a5", ",", "x", ",", "2", ",", "a1", ",", "a2", ",", "a3", ",", 
   "a4"}], "}"}]], "Output",
 CellChangeTimes->{{3.61670839317632*^9, 3.616708416884872*^9}, 
   3.616723556612583*^9, 3.61672360262995*^9, {3.616723634572279*^9, 
   3.61672364705926*^9}, 3.616748945786996*^9}],

Cell[BoxData[
 RowBox[{"{", "a1", "}"}]], "Output",
 CellChangeTimes->{{3.61670839317632*^9, 3.616708416884872*^9}, 
   3.616723556612583*^9, 3.61672360262995*^9, {3.616723634572279*^9, 
   3.61672364705926*^9}, 3.6167489457929497`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"rev", "[", "a4", "]"}], ",", 
   RowBox[{"rev", "[", "a3", "]"}], ",", 
   RowBox[{"rev", "[", "a2", "]"}], ",", 
   RowBox[{"rev", "[", "a1", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.61670839317632*^9, 3.616708416884872*^9}, 
   3.616723556612583*^9, 3.61672360262995*^9, {3.616723634572279*^9, 
   3.61672364705926*^9}, 3.6167489457988033`*^9}]
}, Open  ]],

Cell["\<\
A terminated 2-chain is deg 1, and therefore can be reversed. Whether it \
should be reversed depends on how many rev[ ]  will be 
introduced by doing so. We choose to minimizes the rev[ ] count.\
\>", "Text",
 CellChangeTimes->{{3.614292227098361*^9, 3.61429232997751*^9}, {
   3.6142927112760572`*^9, 3.6142927565225*^9}, {3.614292973644516*^9, 
   3.614292980464569*^9}, {3.615078545983123*^9, 3.6150785469911757`*^9}, 
   3.615081481982589*^9, {3.615081978240728*^9, 3.615082004833119*^9}, {
   3.615149143624217*^9, 3.6151492283925*^9}, 3.615150751530272*^9, {
   3.616708698127276*^9, 3.616708830879318*^9}, 3.616709615983963*^9}],

Cell[TextData[{
 "This counts how many of the  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Y", "i"], TraditionalForm]]],
 "  are  rev[ ]  expressions,"
}], "Text",
 CellChangeTimes->{{3.615082270273925*^9, 3.615082311810822*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"revCount", "[", "Y__", "]"}], ":=", 
  RowBox[{"Count", "[", 
   RowBox[{
    RowBox[{"ToList", "[", 
     RowBox[{"{", "Y", "}"}], "]"}], ",", "_rev"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.616708509343645*^9, 3.6167085616702967`*^9}, {
  3.6167096672565517`*^9, 3.616709669654258*^9}}],

Cell["\<\
This returns True if taking  rev[ ]  is going to reduce the rev count of the \
sequence of  Y,  and False otherwise,\
\>", "Text",
 CellChangeTimes->{{3.615082270273925*^9, 3.615082311810822*^9}, {
   3.6167089463189497`*^9, 3.616708990367107*^9}, 3.6167090221751013`*^9, {
   3.616709053551207*^9, 3.6167090605753527`*^9}, {3.616709106255031*^9, 
   3.616709115103058*^9}, 3.616709643215617*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"revQ", "[", "Y__", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "Ylist", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Ylist", "=", 
      RowBox[{"ToList", "[", 
       RowBox[{"{", "Y", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{"Ylist", ",", "_rev"}], "]"}], ">", 
      RowBox[{"Count", "[", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{"rev", ",", "Ylist"}], "]"}], ",", "_rev"}], "]"}]}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6167090111715384`*^9, 3.616709014194293*^9}, {
   3.616709065122265*^9, 3.6167090758110113`*^9}, {3.6167091345150623`*^9, 
   3.616709300552702*^9}, 3.6167093441363688`*^9, {3.616749162068696*^9, 
   3.6167491637167263`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"revQ", "[", "Y__", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Ylist", ",", "revYlist"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Ylist", "=", 
      RowBox[{"ToList", "[", 
       RowBox[{"{", "Y", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"revYlist", "=", 
      RowBox[{"ToList", "[", 
       RowBox[{"rev", "[", 
        RowBox[{"{", "Y", "}"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{"Ylist", ",", "_rev"}], "]"}], ">", 
      RowBox[{"Count", "[", 
       RowBox[{"revYlist", ",", "_rev"}], "]"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6167090111715384`*^9, 3.616709014194293*^9}, {
   3.616709065122265*^9, 3.6167090758110113`*^9}, {3.6167091345150623`*^9, 
   3.616709300552702*^9}, 3.6167093441363688`*^9, {3.616748886115028*^9, 
   3.616748904067854*^9}, {3.616749012708593*^9, 3.6167490212356358`*^9}, {
   3.616749176692198*^9, 3.616749201545467*^9}}],

Cell["\<\
This returns True if taking  rev[ ]  is going to reduce or not change the rev \
count of the sequence of  Y,  and False otherwise,\
\>", "Text",
 CellChangeTimes->{{3.615082270273925*^9, 3.615082311810822*^9}, {
   3.6167089463189497`*^9, 3.616708990367107*^9}, 3.6167090221751013`*^9, {
   3.616709053551207*^9, 3.6167090605753527`*^9}, {3.616709106255031*^9, 
   3.616709115103058*^9}, 3.616709643215617*^9, {3.616757120179779*^9, 
   3.616757126771764*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"revEQ", "[", "Y__", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Ylist", ",", "revYlist"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Ylist", "=", 
      RowBox[{"ToList", "[", 
       RowBox[{"{", "Y", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"revYlist", "=", 
      RowBox[{"ToList", "[", 
       RowBox[{"rev", "[", 
        RowBox[{"{", "Y", "}"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{"Ylist", ",", "_rev"}], "]"}], "\[GreaterEqual]", 
      RowBox[{"Count", "[", 
       RowBox[{"revYlist", ",", "_rev"}], "]"}]}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6167090111715384`*^9, 3.616709014194293*^9}, {
   3.616709065122265*^9, 3.6167090758110113`*^9}, {3.6167091345150623`*^9, 
   3.616709300552702*^9}, 3.6167093441363688`*^9, {3.616748886115028*^9, 
   3.616748904067854*^9}, {3.616749012708593*^9, 3.6167490212356358`*^9}, {
   3.616749176692198*^9, 3.616749201545467*^9}, {3.616757138830221*^9, 
   3.616757159933872*^9}}],

Cell["Old defn,", "Text",
 CellChangeTimes->{{3.616709593791623*^9, 3.616709596511755*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"revCount", "[", "Y__", "]"}], ":=", " ", 
  RowBox[{"Apply", "[", 
   RowBox[{"Plus", ",", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "#", "]"}], "===", "rev"}], ",", "1", ",", 
         "0"}], "]"}], "&"}], ",", 
      RowBox[{"{", "Y", "}"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.615082040256686*^9, 3.615082043878167*^9}, {
  3.615082243333911*^9, 3.6150822541814613`*^9}, {3.6150823737980757`*^9, 
  3.615082429867992*^9}, {3.615082462425523*^9, 3.615082479178907*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"revCount", "[", 
    RowBox[{"rev", "[", "a1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"revCount", "[", 
    RowBox[{"a1", ",", "a3"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"revCount", "[", 
    RowBox[{"a1", ",", 
     RowBox[{"rev", "[", "a2", "]"}], ",", "a3"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"revCount", "[", 
    RowBox[{
     RowBox[{"rev", "[", "a1", "]"}], ",", 
     RowBox[{"rev", "[", "a2", "]"}], ",", "a3"}], "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.61508249556758*^9, 3.6150826116917257`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", "1", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{{3.615082520748003*^9, 3.615082612830283*^9}, 
   3.615147785897382*^9, 3.615535502041224*^9, 3.616709684355151*^9}]
}, Open  ]],

Cell[TextData[{
 "This counts how many of the  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Y", "i"], TraditionalForm]]],
 "  are  fields that are not  SymQ  or  AntisymQ,"
}], "Text",
 CellChangeTimes->{{3.615082270273925*^9, 3.615082311810822*^9}, {
  3.6151502356735067`*^9, 3.6151502394488773`*^9}, {3.615172202311709*^9, 
  3.615172250327878*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldWithoutSymQ", "[", "x_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"FieldQ", "[", "x", "]"}], "&&", 
   RowBox[{"!", 
    RowBox[{"HasSymQ", "[", "x", "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615172298517791*^9, 3.6151723437388906`*^9}, {
  3.6151723756746798`*^9, 3.615172420028495*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FieldWithoutSymCount", "[", "Y__", "]"}], ":=", " ", 
  RowBox[{"Apply", "[", 
   RowBox[{"Plus", ",", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FieldWithoutSymQ", "[", "#", "]"}], ",", "1", ",", "0"}], 
        "]"}], "&"}], ",", 
      RowBox[{"{", "Y", "}"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.615149591991826*^9, 3.6151496272473183`*^9}, {
   3.615149799648814*^9, 3.6151498024485703`*^9}, {3.615172463776085*^9, 
   3.61517247083165*^9}, 3.615172642328814*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearField", "[", 
   RowBox[{"{", 
    RowBox[{"a1", ",", "a2", ",", "a3", ",", "M"}], "}"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"2", ",", 
    RowBox[{"{", 
     RowBox[{"a1", ",", "a2", ",", "a3", ",", "M"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumeAntisymmetric", "[", "M", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FieldWithoutSymCount", "[", 
  RowBox[{"a1", ",", 
   RowBox[{"rev", "[", "a2", "]"}], ",", "M", ",", 
   RowBox[{"rev", "[", "a3", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FieldWithoutSymCount", "[", 
  RowBox[{"a1", ",", "M", ",", "a2", ",", 
   RowBox[{"rev", "[", "a3", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.615149769308282*^9, 3.615149776445434*^9}, {
  3.615149826575623*^9, 3.615149837823306*^9}, {3.61517268498849*^9, 
  3.615172766832406*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.6151497771095457`*^9, {3.615149821046114*^9, 3.615149839459991*^9}, 
   3.615169252907152*^9, 3.615172484108371*^9, 3.615172602925479*^9, 
   3.615172695460896*^9, 3.615172768342907*^9, 3.6155355114648867`*^9}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.6151497771095457`*^9, {3.615149821046114*^9, 3.615149839459991*^9}, 
   3.615169252907152*^9, 3.615172484108371*^9, 3.615172602925479*^9, 
   3.615172695460896*^9, 3.615172768342907*^9, 3.615535511467959*^9}]
}, Open  ]],

Cell["\<\
When  rev[ ]  count after swap is going to be the same, choose to put  v  on \
the right.
It is not safe to use eg.,    Append[ rev[ \[LeftAngleBracket]Y\
\[RightAngleBracket] ],  v ]    for the rhs expression (which might be a bit \
quicker because it doesn\[CloseCurlyQuote]t have to reverse v) because if 
the rev[ ]  does not get evaluated because it has been UnsetRule[ ],  then \
the Append would put   v  into  rev[ ]  rather than into  \[LeftAngleBracket] \
 \[RightAngleBracket] .
List is used on the rhs because putting   \[LeftAngleBracket]v, Y\
\[RightAngleBracket]  on the rhs makes it loop,\
\>", "Text",
 CellChangeTimes->{{3.61517303396165*^9, 3.615173117081946*^9}, {
  3.615748786226103*^9, 3.615749004968952*^9}, {3.615749695015748*^9, 
  3.615749736935895*^9}, {3.615750156985952*^9, 3.615750209897847*^9}, {
  3.615750275226575*^9, 3.615750445771338*^9}, {3.615751991587707*^9, 
  3.615752060020214*^9}}],

Cell["11:35  11/8/2014  Replaced. These no longer initialized,", "Text",
 CellChangeTimes->{{3.6167097493598413`*^9, 3.61670976766413*^9}, {
  3.6167226711362762`*^9, 3.616722679104433*^9}, {3.616722983187437*^9, 
  3.616722983888729*^9}}],

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"v_", "?", "deg1Q"}], ",", 
      RowBox[{"Y__", "?", "deg2Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{
     RowBox[{"revCount", "[", "Y", "]"}], "\[GreaterEqual]", 
     RowBox[{"FieldWithoutSymCount", "[", "Y", "]"}]}]}], ":=", 
   RowBox[{"Apply", "[", 
    RowBox[{"AngleBracket", ",", 
     RowBox[{"rev", "[", 
      RowBox[{"{", 
       RowBox[{"v", ",", "Y"}], "}"}], "]"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"Y__", "?", "deg2Q"}], ",", 
      RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{
     RowBox[{"revCount", "[", "Y", "]"}], ">", 
     RowBox[{"FieldWithoutSymCount", "[", "Y", "]"}]}]}], ":=", 
   RowBox[{"Apply", "[", 
    RowBox[{"AngleBracket", ",", 
     RowBox[{"rev", "[", 
      RowBox[{"{", 
       RowBox[{"Y", ",", "v"}], "}"}], "]"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.615082672042248*^9, 3.615082680251027*^9}, {
   3.6151478040767813`*^9, 3.615147814413332*^9}, {3.615147865085595*^9, 
   3.615147881278125*^9}, {3.615147951009069*^9, 3.615147955039996*^9}, {
   3.615148072175589*^9, 3.6151480833442698`*^9}, {3.6151482984959087`*^9, 
   3.615148302671708*^9}, 3.615148351775791*^9, {3.615148523824463*^9, 
   3.615148524599761*^9}, {3.615149246805737*^9, 3.615149301173196*^9}, {
   3.615149665335711*^9, 3.61514972407093*^9}, {3.6151498765822697`*^9, 
   3.6151499436034946`*^9}, {3.615149995525381*^9, 3.6151500131733313`*^9}, {
   3.6151500456693*^9, 3.61515010277287*^9}, {3.615154265212619*^9, 
   3.615154270609127*^9}, {3.615172785100754*^9, 3.615172786357094*^9}, {
   3.615173021302692*^9, 3.615173024119203*^9}, {3.61574968483889*^9, 
   3.615749689173451*^9}, {3.615749986741477*^9, 3.615749992104146*^9}, {
   3.615750226164646*^9, 3.6157502502319183`*^9}, {3.615752069616147*^9, 
   3.615752116207736*^9}}],

Cell["\<\
15:16  11/8/2014  These now replace above,
00:47  12/8/2014   Introduced  revEQ,\
\>", "Text",
 CellChangeTimes->{{3.6167097493598413`*^9, 3.61670976766413*^9}, {
  3.6167226711362762`*^9, 3.616722679104433*^9}, {3.616722983187437*^9, 
  3.6167230151367683`*^9}, {3.6167572453159237`*^9, 3.6167572737800303`*^9}}],

Cell["28/08/2015  Uninitialized,", "Text",
 CellChangeTimes->{{3.649721037903037*^9, 3.649721053886795*^9}}],

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"v_", "?", "deg1Q"}], ",", 
      RowBox[{"Y__", "?", "deg2Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{"revEQ", "[", "Y", "]"}]}], ":=", 
   RowBox[{"Apply", "[", 
    RowBox[{"AngleBracket", ",", 
     RowBox[{"rev", "[", 
      RowBox[{"{", 
       RowBox[{"v", ",", "Y"}], "}"}], "]"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"Y__", "?", "deg2Q"}], ",", 
      RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{"revQ", "[", "Y", "]"}]}], ":=", 
   RowBox[{"Apply", "[", 
    RowBox[{"AngleBracket", ",", 
     RowBox[{"rev", "[", 
      RowBox[{"{", 
       RowBox[{"Y", ",", "v"}], "}"}], "]"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.615082672042248*^9, 3.615082680251027*^9}, {
   3.6151478040767813`*^9, 3.615147814413332*^9}, {3.615147865085595*^9, 
   3.615147881278125*^9}, {3.615147951009069*^9, 3.615147955039996*^9}, {
   3.615148072175589*^9, 3.6151480833442698`*^9}, {3.6151482984959087`*^9, 
   3.615148302671708*^9}, 3.615148351775791*^9, {3.615148523824463*^9, 
   3.615148524599761*^9}, {3.615149246805737*^9, 3.615149301173196*^9}, {
   3.615149665335711*^9, 3.61514972407093*^9}, {3.6151498765822697`*^9, 
   3.6151499436034946`*^9}, {3.615149995525381*^9, 3.6151500131733313`*^9}, {
   3.6151500456693*^9, 3.61515010277287*^9}, {3.615154265212619*^9, 
   3.615154270609127*^9}, {3.615172785100754*^9, 3.615172786357094*^9}, {
   3.615173021302692*^9, 3.615173024119203*^9}, {3.61574968483889*^9, 
   3.615749689173451*^9}, {3.615749986741477*^9, 3.615749992104146*^9}, {
   3.615750226164646*^9, 3.6157502502319183`*^9}, {3.615752069616147*^9, 
   3.615752116207736*^9}, {3.616709920844637*^9, 3.61670993562768*^9}, 
   3.616757193890442*^9}],

Cell["\<\
.... the rhs can not be evaluated more simply as   Append[ rev[ \
\[LeftAngleBracket] Y \[RightAngleBracket] ], v ]]    (eg, for the 1st of the \
above rules)  because it is not always true that  rev[ \[LeftAngleBracket] Y \
\[RightAngleBracket] ]  will evaluate to 
an angle bracket expression to which  v  can be appended.  For example,   \
rev[ \[LeftAngleBracket] Y \[RightAngleBracket] ]   might simplify further \
than  \[LeftAngleBracket]  , ,  \[RightAngleBracket]  if it is possible to \
pull out tensor 
factors from the first or last argument in  \[LeftAngleBracket]  , ,  \
\[RightAngleBracket].  One then gets something like  k\[CircleTimes]\
\[LeftAngleBracket] , , \[RightAngleBracket] ,  in which case the Append will \
append  v  as a factor in the tensor product instead 
of appending  v  as an argument in  \[LeftAngleBracket] , , \
\[RightAngleBracket]. \
\>", "Text",
 CellChangeTimes->{{3.6157628322552433`*^9, 3.615763380020362*^9}, 
   3.615766809159143*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing", "Subsubsection",
 CellChangeTimes->{{3.615150299257174*^9, 3.615150300665608*^9}}],

Cell[BoxData[{
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{"v", ",", "a1", ",", "a2", ",", "a3"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewField", "[", 
   RowBox[{"2", ",", 
    RowBox[{"{", 
     RowBox[{"a1", ",", "a2", ",", "a3"}], "}"}]}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"1", ",", "v"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6157667060582743`*^9, 3.615766707021141*^9}}],

Cell[BoxData[
 RowBox[{"StopDebug", "[", "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"deg", "[", 
  RowBox[{"{", 
   RowBox[{"v", ",", "a1", ",", "a2", ",", "a3"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "a1", ",", "a2", ",", "a3"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", 
   RowBox[{"rev", "[", "a2", "]"}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "a1", ",", 
   RowBox[{"rev", "[", "a2", "]"}], ",", "a3"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "a1", ",", 
   RowBox[{"rev", "[", "a2", "]"}], ",", 
   RowBox[{"rev", "[", "a3", "]"}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", 
   RowBox[{"rev", "[", "a1", "]"}], ",", 
   RowBox[{"rev", "[", "a2", "]"}], ",", 
   RowBox[{"rev", "[", "a3", "]"}]}], "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.6151493528708143`*^9, 3.615149400690845*^9}, {
  3.615150141426977*^9, 3.6151501507570667`*^9}, {3.615169345456703*^9, 
  3.615169354519085*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "2", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.649726638164392*^9, 3.649746501807292*^9, 
  3.6498909401835117`*^9, 3.649898451328651*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "a1", ",", "a2", ",", "a3"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.649726638164392*^9, 3.649746501807292*^9, 
  3.6498909401835117`*^9, 3.6498984513317327`*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"a2", ",", "v"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.649726638164392*^9, 3.649746501807292*^9, 
  3.6498909401835117`*^9, 3.649898451334317*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "a1", ",", 
   RowBox[{"rev", "[", "a2", "]"}], ",", "a3"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.649726638164392*^9, 3.649746501807292*^9, 
  3.6498909401835117`*^9, 3.6498984513368998`*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"a3", ",", "a2", ",", 
   RowBox[{"rev", "[", "a1", "]"}], ",", "v"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.649726638164392*^9, 3.649746501807292*^9, 
  3.6498909401835117`*^9, 3.6498984513394814`*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"a3", ",", "a2", ",", "a1", ",", "v"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.649726638164392*^9, 3.649746501807292*^9, 
  3.6498909401835117`*^9, 3.6498984513422728`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"StartDebug", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", 
   RowBox[{"rev", "[", "a2", "]"}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"StopDebug", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.615169369011443*^9, 3.615169379287264*^9}, {
  3.61516968519188*^9, 3.615169689915256*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]8\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", "x_List", "]"}], ":=", 
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", "x", "]"}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]8\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      Pattern[$CellContext`x, 
       Blank[List]]] := Map[$CellContext`rev, 
      Reverse[$CellContext`x]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.649898478513648*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", 
      RowBox[{"{", 
       RowBox[{"v", ",", 
        RowBox[{"rev", "[", "a2", "]"}]}], "}"}], "]"}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Map[$CellContext`rev, 
     Reverse[{$CellContext`v, 
       $CellContext`rev[$CellContext`a2]}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.649898478586735*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]9\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"rev", "[", "X_", "]"}], "]"}], ":=", "X"}]}],
  SequenceForm["rule[\[VeryThinSpace]9\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      $CellContext`rev[
       Pattern[$CellContext`X, 
        Blank[]]]] := $CellContext`X]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.649898478591626*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["a2",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`a2]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.649898478715827*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]236\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"f_", "/;", 
      RowBox[{
       RowBox[{"NumberQ", "[", "f", "]"}], "||", 
       RowBox[{"ConstantQ", "[", "f", "]"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FieldLikeQ", "[", "f", "]"}], "&&", 
         RowBox[{"deg0or1Q", "[", "f", "]"}]}], ")"}]}]}], "]"}], ":=", 
    "f"}]}],
  SequenceForm["rule[\[VeryThinSpace]236\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      Condition[
       Pattern[$CellContext`f, 
        Blank[]], 
       Or[
        NumberQ[$CellContext`f], 
        $CellContext`ConstantQ[$CellContext`f], 
        And[
         $CellContext`FieldLikeQ[$CellContext`f], 
         $CellContext`deg0or1Q[$CellContext`f]]]]] := $CellContext`f]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.649898478719095*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["v",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`v]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.649898478866619*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]262\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"a__", "/;", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "a", "}"}], "]"}], ">", "1"}], "&&", 
       RowBox[{"Same0or1Q", "[", 
        RowBox[{"degBracket", "[", "a", "]"}], "]"}], "&&", 
       RowBox[{
        RowBox[{"revChoice", "[", "a", "]"}], "===", "1"}]}]}], 
     "\[RightAngleBracket]"}], ":=", 
    RowBox[{"AngleBracket", "@@", 
     RowBox[{"rev", "[", 
      RowBox[{"{", "a", "}"}], "]"}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]262\[VeryThinSpace]]:", "  ", 
   Defer[AngleBracket[
      Condition[
       Pattern[$CellContext`a, 
        BlankSequence[]], 
       And[Length[{$CellContext`a}] > 1, 
        $CellContext`Same0or1Q[
         $CellContext`degBracket[$CellContext`a]], \
$CellContext`revChoice[$CellContext`a] === 1]]] := Apply[AngleBracket, 
      $CellContext`rev[{$CellContext`a}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.649898478941585*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"AngleBracket", "@@", 
     RowBox[{"rev", "[", 
      RowBox[{"{", 
       RowBox[{"v", ",", 
        RowBox[{"rev", "[", "a2", "]"}]}], "}"}], "]"}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Apply[AngleBracket, 
     $CellContext`rev[{$CellContext`v, 
       $CellContext`rev[$CellContext`a2]}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.649898479035754*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]8\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", "x_List", "]"}], ":=", 
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", "x", "]"}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]8\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      Pattern[$CellContext`x, 
       Blank[List]]] := Map[$CellContext`rev, 
      Reverse[$CellContext`x]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.649898479038693*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", 
      RowBox[{"{", 
       RowBox[{"v", ",", 
        RowBox[{"rev", "[", "a2", "]"}]}], "}"}], "]"}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Map[$CellContext`rev, 
     Reverse[{$CellContext`v, 
       $CellContext`rev[$CellContext`a2]}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.6498984791682177`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]9\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"rev", "[", "X_", "]"}], "]"}], ":=", "X"}]}],
  SequenceForm["rule[\[VeryThinSpace]9\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      $CellContext`rev[
       Pattern[$CellContext`X, 
        Blank[]]]] := $CellContext`X]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.649898479257358*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["a2",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`a2]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.64989847934365*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]236\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"f_", "/;", 
      RowBox[{
       RowBox[{"NumberQ", "[", "f", "]"}], "||", 
       RowBox[{"ConstantQ", "[", "f", "]"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FieldLikeQ", "[", "f", "]"}], "&&", 
         RowBox[{"deg0or1Q", "[", "f", "]"}]}], ")"}]}]}], "]"}], ":=", 
    "f"}]}],
  SequenceForm["rule[\[VeryThinSpace]236\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      Condition[
       Pattern[$CellContext`f, 
        Blank[]], 
       Or[
        NumberQ[$CellContext`f], 
        $CellContext`ConstantQ[$CellContext`f], 
        And[
         $CellContext`FieldLikeQ[$CellContext`f], 
         $CellContext`deg0or1Q[$CellContext`f]]]]] := $CellContext`f]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.649898479349325*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["v",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`v]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.649898479469783*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]8\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", "x_List", "]"}], ":=", 
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", "x", "]"}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]8\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      Pattern[$CellContext`x, 
       Blank[List]]] := Map[$CellContext`rev, 
      Reverse[$CellContext`x]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.649898479574814*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", 
      RowBox[{"{", 
       RowBox[{"a2", ",", "v"}], "}"}], "]"}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Map[$CellContext`rev, 
     Reverse[{$CellContext`a2, $CellContext`v}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.6498984796704683`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]236\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"f_", "/;", 
      RowBox[{
       RowBox[{"NumberQ", "[", "f", "]"}], "||", 
       RowBox[{"ConstantQ", "[", "f", "]"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FieldLikeQ", "[", "f", "]"}], "&&", 
         RowBox[{"deg0or1Q", "[", "f", "]"}]}], ")"}]}]}], "]"}], ":=", 
    "f"}]}],
  SequenceForm["rule[\[VeryThinSpace]236\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      Condition[
       Pattern[$CellContext`f, 
        Blank[]], 
       Or[
        NumberQ[$CellContext`f], 
        $CellContext`ConstantQ[$CellContext`f], 
        And[
         $CellContext`FieldLikeQ[$CellContext`f], 
         $CellContext`deg0or1Q[$CellContext`f]]]]] := $CellContext`f]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.649898479673575*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["v",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`v]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.6498984798576803`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]8\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", "x_List", "]"}], ":=", 
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", "x", "]"}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]8\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      Pattern[$CellContext`x, 
       Blank[List]]] := Map[$CellContext`rev, 
      Reverse[$CellContext`x]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.649898480052239*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", 
      RowBox[{"{", 
       RowBox[{"a2", ",", "v"}], "}"}], "]"}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Map[$CellContext`rev, 
     Reverse[{$CellContext`a2, $CellContext`v}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.6498984800564327`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]236\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"f_", "/;", 
      RowBox[{
       RowBox[{"NumberQ", "[", "f", "]"}], "||", 
       RowBox[{"ConstantQ", "[", "f", "]"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FieldLikeQ", "[", "f", "]"}], "&&", 
         RowBox[{"deg0or1Q", "[", "f", "]"}]}], ")"}]}]}], "]"}], ":=", 
    "f"}]}],
  SequenceForm["rule[\[VeryThinSpace]236\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      Condition[
       Pattern[$CellContext`f, 
        Blank[]], 
       Or[
        NumberQ[$CellContext`f], 
        $CellContext`ConstantQ[$CellContext`f], 
        And[
         $CellContext`FieldLikeQ[$CellContext`f], 
         $CellContext`deg0or1Q[$CellContext`f]]]]] := $CellContext`f]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.6498984800591793`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["v",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`v]],
  Editable->False]], "Print",
 CellChangeTimes->{3.649726679419909*^9, 3.649746508987464*^9, 
  3.649898480159069*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"a2", ",", "v"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.6497266801915007`*^9, 3.649746512206028*^9, 
  3.649898480161827*^9}]
}, Open  ]],

Cell["Old code...", "Text",
 CellChangeTimes->{{3.649726754944838*^9, 3.649726758992732*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"StartDebug", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", 
   RowBox[{"rev", "[", "a2", "]"}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"StopDebug", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.615169369011443*^9, 3.615169379287264*^9}, {
  3.61516968519188*^9, 3.615169689915256*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]215\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"v_", "?", "deg1Q"}], ",", 
       RowBox[{"Y__", "?", "deg2Q"}]}], "\[RightAngleBracket]"}], "/;", 
     RowBox[{
      RowBox[{"revCount", "[", "Y", "]"}], "\[GreaterEqual]", 
      RowBox[{"FieldWithoutSymCount", "[", "Y", "]"}]}]}], ":=", 
    RowBox[{"AngleBracket", "@@", 
     RowBox[{"rev", "[", 
      RowBox[{"{", 
       RowBox[{"v", ",", "Y"}], "}"}], "]"}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]215\[VeryThinSpace]]:", "  ", 
   Defer[Condition[
      AngleBracket[
       PatternTest[
        Pattern[$CellContext`v, 
         Blank[]], $CellContext`deg1Q], 
       PatternTest[
        Pattern[$CellContext`Y, 
         BlankSequence[]], $CellContext`deg2Q]], \
$CellContext`revCount[$CellContext`Y] >= \
$CellContext`FieldWithoutSymCount[$CellContext`Y]] := Apply[AngleBracket, 
      $CellContext`rev[{$CellContext`v, $CellContext`Y}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6151696913245564`*^9, 3.615535540271158*^9, 
  3.615766726329269*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"AngleBracket", "@@", 
     RowBox[{"rev", "[", 
      RowBox[{"{", 
       RowBox[{"v", ",", 
        RowBox[{"rev", "[", "a2", "]"}]}], "}"}], "]"}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Apply[AngleBracket, 
     $CellContext`rev[{$CellContext`v, 
       $CellContext`rev[$CellContext`a2]}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6151696913245564`*^9, 3.615535540271158*^9, 
  3.615766726440455*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]12\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", "x_List", "]"}], ":=", 
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", "x", "]"}]}]}]}],
  SequenceForm["rule[\[VeryThinSpace]12\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      Pattern[$CellContext`x, 
       Blank[List]]] := Map[$CellContext`rev, 
      Reverse[$CellContext`x]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6151696913245564`*^9, 3.615535540271158*^9, 
  3.615766726446476*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"rev", "/@", 
     RowBox[{"Reverse", "[", 
      RowBox[{"{", 
       RowBox[{"v", ",", 
        RowBox[{"rev", "[", "a2", "]"}]}], "}"}], "]"}]}],
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[
    Map[$CellContext`rev, 
     Reverse[{$CellContext`v, 
       $CellContext`rev[$CellContext`a2]}]]]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6151696913245564`*^9, 3.615535540271158*^9, 
  3.6157667266117363`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]11\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{"rev", "[", 
     RowBox[{"rev", "[", "X_", "]"}], "]"}], ":=", "X"}]}],
  SequenceForm["rule[\[VeryThinSpace]11\[VeryThinSpace]]:", "  ", 
   Defer[$CellContext`rev[
      $CellContext`rev[
       Pattern[$CellContext`X, 
        Blank[]]]] := $CellContext`X]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6151696913245564`*^9, 3.615535540271158*^9, 
  3.615766726617401*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["a2",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`a2]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6151696913245564`*^9, 3.615535540271158*^9, 
  3.615766726752554*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]10\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"  \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     RowBox[{"rev", "[", "v_", "]"}], "/;", 
     RowBox[{
      RowBox[{"deg", "[", "v", "]"}], "\[LessEqual]", "1"}]}], ":=", "v"}]}],
  SequenceForm["rule[\[VeryThinSpace]10\[VeryThinSpace]]:", "  ", 
   Defer[Condition[
      $CellContext`rev[
       Pattern[$CellContext`v, 
        Blank[]]], $CellContext`deg[$CellContext`v] <= 1] := $CellContext`v]],
  
  Editable->False]], "Print",
 CellChangeTimes->{3.6151696913245564`*^9, 3.615535540271158*^9, 
  3.61576672675863*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"    rhs =   \"\>", "\[InvisibleSpace]", 
   TagBox["v",
    HoldForm]}],
  SequenceForm["    rhs =   ", 
   HoldForm[$CellContext`v]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6151696913245564`*^9, 3.615535540271158*^9, 
  3.615766726931547*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"a2", ",", "v"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.6151693807068977`*^9, 3.615169692257143*^9, 
  3.615535540944994*^9, 3.6157667269395943`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearField", "[", 
   RowBox[{"{", 
    RowBox[{"v", ",", "a1", ",", "a2", ",", "a3"}], "}"}], "]"}], 
  "\[IndentingNewLine]"}]], "Input"],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
---------------------------------------------------------------------------
Standard form for   \[LeftAngleBracket] v,   Y,   w \[RightAngleBracket] .   \
\
\>", "Text",
 CellChangeTimes->{{3.615152430727364*^9, 3.615152447672166*^9}, {
  3.615152488291046*^9, 3.615152512172907*^9}, {3.615152859069364*^9, 
  3.6151528955650387`*^9}, {3.616465205908478*^9, 3.616465267315352*^9}}],

Cell["20:45  9/8/2014.   deg3 case addded  (was just deg2),", "Text",
 CellChangeTimes->{{3.616569942041194*^9, 3.6165700239093943`*^9}}],

Cell["28/08/2015  Uninitialized,", "Text",
 CellChangeTimes->{{3.649721037903037*^9, 3.649721053886795*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"v_", "?", "deg1Q"}], ",", 
     RowBox[{"rev", "[", 
      RowBox[{"Y_", "/;", 
       RowBox[{
        RowBox[{"deg", "[", "Y", "]"}], "\[LessEqual]", "3"}]}], "]"}], ",", 
     RowBox[{"w_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"w", ",", "Y", ",", "v"}], "\[RightAngleBracket]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.615152920053934*^9, 3.61515292624496*^9}, {
  3.616570033902508*^9, 3.616570055310679*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "116", "]"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGCwBOJZcfOsxT68cmRZGMBtDqQ9lh0XsgTSBrWzpWOBdKD9
q7cgummlcGscmN/4FUQrPS50igfSX45zCicB6SMml86D6HPq59xSgLSVrd6F
VCBds4d1dy2QTpz5irsVSNdd3JDVBqSvnRJb+wJIC+8wXfoSSG9+kCv3CiQu
s2e2/sdXjiIHvM4YAOkD51guGgPpWdx+z4OBtFC8yfsUIL2lf0dkM5D+w6Dy
+DqQ3nNzheBNIP3PuTX3NZD+9E5JTODTK8eq37zzbIH0ie2dLJFAesnVEt8E
IG0RXSm5GkgrXbNx3QykeXsV7LcA6RW/37gv+f7KcRHb7YYDP185OkycdfQ8
kC5aUhj7C0iXMhWE/AfSHzh23kv7BXRf061dXUA6Z89rzuVAekpO5pRXQPqF
z1lT89+vHNMa/0xeAKSd1ns37gbSPn1G3keBdGfAW6bnQNrk+P+p34D00XnH
DKf+eeXIU5JaVfT3leOZayc/zgTSt0VrVWcD6bAIVbE5QNovoevlfiD9grW3
pOvfK0c+1U5nBdbXjgCVbAhx
  "]]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
---------------------------------------------------------------------------
Standard form for   \[LeftAngleBracket] v,  Y1,  Y2,  w \[RightAngleBracket] \
.   \
\>", "Text",
 CellChangeTimes->{{3.615152430727364*^9, 3.615152447672166*^9}, {
  3.615152488291046*^9, 3.615152512172907*^9}, {3.615152859069364*^9, 
  3.615152863101972*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["The logic", "Subsubsection",
 CellChangeTimes->{{3.615072838112514*^9, 3.6150728398088627`*^9}, {
  3.61507292736098*^9, 3.615072929921544*^9}}],

Cell["\<\

If a chain of  deg 2  factors is contracted with  2  copies of the same \
vector,  can we use rev[ ]  to order the factors?   
This is tricky because of  loops.  The transformation we would want is \
something like

               \[LeftAngleBracket] v ,  X,  Y,  v \[RightAngleBracket]     \
\[Rule]       \[LeftAngleBracket] v ,  rev[ Y ],  rev[ X ],  v \
\[RightAngleBracket] 

Do not initialize this,\
\>", "Text",
 CellChangeTimes->{{3.614292227098361*^9, 3.61429232997751*^9}, {
  3.6142927112760572`*^9, 3.6142927565225*^9}, {3.6142928303959007`*^9, 
  3.614292853434758*^9}, {3.6142928971957827`*^9, 3.6142929683817377`*^9}, {
  3.614293021964278*^9, 3.614293069963216*^9}, {3.614293337229141*^9, 
  3.6142934298677588`*^9}, {3.614294119790959*^9, 3.6142941352614927`*^9}, {
  3.615023505811878*^9, 3.615023550803751*^9}, {3.6150235873158827`*^9, 
  3.6150236173719378`*^9}, {3.615070284180333*^9, 3.615070322228574*^9}, {
  3.615070353934104*^9, 3.615070479990878*^9}, {3.615070559190206*^9, 
  3.615070600646359*^9}, {3.6150711568247147`*^9, 3.615071200617133*^9}, {
  3.61507261867171*^9, 3.6150726480484457`*^9}, {3.615072756352357*^9, 
  3.615072769088827*^9}, {3.615072845441136*^9, 3.61507286571329*^9}, {
  3.6150730353295794`*^9, 3.615073072417911*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"v_", "?", "deg1Q"}], ",", 
     RowBox[{"Y1_", "?", "deg2Q"}], ",", 
     RowBox[{"Y2_", "?", "deg2Q"}], ",", 
     RowBox[{"w_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "/;", 
   RowBox[{
    RowBox[{"v", "===", "w"}], "&&", 
    RowBox[{"!", 
     RowBox[{"OrderedQ", "[", 
      RowBox[{"{", 
       RowBox[{"Y1", ",", "Y2"}], "}"}], "]"}]}]}]}], ":=", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"v", ",", 
    RowBox[{"rev", "[", "Y2", "]"}], ",", 
    RowBox[{"rev", "[", "Y1", "]"}], ",", "v"}], 
   "\[RightAngleBracket]"}]}]], "Input"],

Cell["However, this has 3 potential loops....  ", "Text",
 CellChangeTimes->{{3.615071212664927*^9, 3.615071317001445*^9}, {
  3.615071448298401*^9, 3.615071457450362*^9}, {3.6150720890378017`*^9, 
  3.615072090755336*^9}, {3.615072665595745*^9, 3.6150726850409184`*^9}, {
  3.615072745200716*^9, 3.615072749216507*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearField", "[", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y", ",", "M"}], "}"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"2", ",", 
    RowBox[{"{", 
     RowBox[{"X", ",", "Y", ",", "M"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearField", "[", "v", "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"1", ",", "v"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumeAntisymmetric", "[", "M", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.615065783082053*^9, 3.615065818178329*^9}, {
   3.615066414248138*^9, 3.615066462919948*^9}, 3.615066515835396*^9, {
   3.615066573048376*^9, 3.6150665778484983`*^9}, {3.6150667432096024`*^9, 
   3.615066789334609*^9}, {3.615066855693314*^9, 3.6150668590156918`*^9}, 
   3.615070629131667*^9}],

Cell["\<\
The 1st loop.
\[LeftAngleBracket] v, M, -M, v \[RightAngleBracket]   will loop if  M is \
antisymmetric and if the rule for taking out the  -1 factor is not used \
because it comes later than the above rule, \
\>", "Text",
 CellChangeTimes->{{3.615071366073326*^9, 3.615071369001628*^9}, {
   3.615071515546373*^9, 3.615071516330372*^9}, {3.615071713899539*^9, 
   3.615071738043777*^9}, 3.6150722943501577`*^9, {3.615072712496125*^9, 
   3.6150727224643803`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"!", 
  RowBox[{"OrderedQ", "[", 
   RowBox[{"{", 
    RowBox[{"M", ",", 
     RowBox[{"-", "M"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"rev", "[", 
  RowBox[{"{", 
   RowBox[{"M", ",", 
    RowBox[{"-", "M"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.615066662071224*^9, 3.6150666929984694`*^9}, {
  3.615066748217596*^9, 3.61506675119271*^9}, {3.615066859930429*^9, 
  3.615066862232914*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.615066668964713*^9, 3.6150666941659937`*^9}, 
   3.615066799949767*^9, 3.615070642364238*^9, 3.6150709564411182`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"M", ",", 
   RowBox[{"-", "M"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.615066668964713*^9, 3.6150666941659937`*^9}, 
   3.615066799949767*^9, 3.615070642364238*^9, 3.615070956445648*^9}]
}, Open  ]],

Cell["Not a loop if the -1 comes out,", "Text",
 CellChangeTimes->{{3.615071366073326*^9, 3.615071369001628*^9}, {
  3.615071515546373*^9, 3.615071516330372*^9}, {3.615071713899539*^9, 
  3.615071738043777*^9}, {3.6150722748942966`*^9, 3.615072289469904*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "M", ",", 
   RowBox[{"-", "M"}], ",", "v"}], "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{{3.6150721934728107`*^9, 3.615072196497184*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"v", ",", "M", ",", "M", ",", "v"}], 
   "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{3.615072200786633*^9}]
}, Open  ]],

Cell["The 2nd loop,", "Text",
 CellChangeTimes->{{3.615071366073326*^9, 3.615071369001628*^9}, {
  3.6150714833217487`*^9, 3.615071484634186*^9}, {3.6150715205861273`*^9, 
  3.6150715272744513`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"!", 
  RowBox[{"OrderedQ", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rev", "[", "X", "]"}], ",", "X"}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"rev", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"rev", "[", "X", "]"}], ",", "X"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.615066543604682*^9, 3.615066553302841*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.61506655621109*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"rev", "[", "X", "]"}], ",", "X"}], "}"}]], "Output",
 CellChangeTimes->{3.6150665562153873`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", 
   RowBox[{"rev", "[", "X", "]"}], ",", "X", ",", "v"}], 
  "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{{3.615072238576701*^9, 3.615072249364449*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"$IterationLimit", "::", "itlim"}], "MessageName"], ":", 
  " ", "\<\"Iteration limit of \[NoBreak]\\!\\(4096\\)\[NoBreak] exceeded. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/$IterationLimit/itlim\\\
\", ButtonNote -> \\\"$IterationLimit::itlim\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.615072251476193*^9}],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"v", ",", 
    RowBox[{"rev", "[", "X", "]"}], ",", 
    RowBox[{"rev", "[", 
     RowBox[{"rev", "[", "X", "]"}], "]"}], ",", "v"}], 
   "\[RightAngleBracket]"}], "]"}]], "Output",
 CellChangeTimes->{{3.6150722403041067`*^9, 3.6150722514805098`*^9}}]
}, Open  ]],

Cell["The 3rd (2 step) loop,", "Text",
 CellChangeTimes->{{3.615071366073326*^9, 3.615071369001628*^9}, {
  3.6150714833217487`*^9, 3.615071484634186*^9}, {3.6150715205861273`*^9, 
  3.61507153815476*^9}, {3.615072314221817*^9, 3.615072317486227*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"!", 
  RowBox[{"OrderedQ", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rev", "[", "X", "]"}], ",", "Y"}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"rev", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"rev", "[", "X", "]"}], ",", "Y"}], "}"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"!", 
  RowBox[{"OrderedQ", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rev", "[", "Y", "]"}], ",", "X"}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"rev", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"rev", "[", "Y", "]"}], ",", "X"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.61506658743165*^9, 3.615066639624453*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.615066609187213*^9, 3.6150666421091213`*^9}, 
   3.615072327117433*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"rev", "[", "Y", "]"}], ",", "X"}], "}"}]], "Output",
 CellChangeTimes->{{3.615066609187213*^9, 3.6150666421091213`*^9}, 
   3.615072327122302*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.615066609187213*^9, 3.6150666421091213`*^9}, 
   3.6150723271260967`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"rev", "[", "X", "]"}], ",", "Y"}], "}"}]], "Output",
 CellChangeTimes->{{3.615066609187213*^9, 3.6150666421091213`*^9}, 
   3.6150723271296587`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", 
   RowBox[{"rev", "[", "X", "]"}], ",", "Y", ",", "v"}], 
  "\[RightAngleBracket]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"$IterationLimit", "::", "itlim"}], "MessageName"], ":", 
  " ", "\<\"Iteration limit of \[NoBreak]\\!\\(4096\\)\[NoBreak] exceeded. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/$IterationLimit/itlim\\\
\", ButtonNote -> \\\"$IterationLimit::itlim\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6150723390458927`*^9}],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"v", ",", 
    RowBox[{"rev", "[", "X", "]"}], ",", 
    RowBox[{"rev", "[", 
     RowBox[{"rev", "[", "Y", "]"}], "]"}], ",", "v"}], 
   "\[RightAngleBracket]"}], "]"}]], "Output",
 CellChangeTimes->{3.615072339050511*^9}]
}, Open  ]],

Cell["This is ordered, so does not loop,", "Text",
 CellChangeTimes->{{3.615072384798312*^9, 3.615072408062394*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "Y", ",", 
   RowBox[{"rev", "[", "X", "]"}], ",", "v"}], 
  "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{{3.6150723753139153`*^9, 3.615072379427123*^9}}],

Cell["\<\
Conclusion:   If one of the  X, Y  args has a  rev[ ]  then reordering leaves \
the rev in the same place but swaps the symbols inside the rev. They should \
be ordered if they have no symmetries.
                         If  both args have a  rev[ ]  then we can get rid of \
 both  rev[ ].
Unset the above looping rule,\
\>", "Text",
 CellChangeTimes->{{3.615072422254799*^9, 3.615072597215907*^9}, {
  3.615072888161121*^9, 3.615072910992959*^9}, {3.615073008145484*^9, 
  3.615073026145616*^9}, {3.6150734506131268`*^9, 3.6150735838921623`*^9}, {
  3.615073708293598*^9, 3.615073727045636*^9}}],

Cell["\<\

If there are two  rev[ ],\
\>", "Text",
 CellChangeTimes->{{3.615077714041741*^9, 3.615077724330662*^9}, 
   3.6151528449250517`*^9}],

Cell["28/08/2015  Uninitialized,", "Text",
 CellChangeTimes->{{3.649721037903037*^9, 3.649721053886795*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"v_", "?", "deg1Q"}], ",", 
     RowBox[{"rev", "[", 
      RowBox[{"Y1_", "?", "deg2Q"}], "]"}], ",", 
     RowBox[{"rev", "[", 
      RowBox[{"Y2_", "?", "deg2Q"}], "]"}], ",", 
     RowBox[{"w_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"w", ",", "Y2", ",", "Y1", ",", "v"}], "\[RightAngleBracket]"}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.615073791247862*^9, 3.615073836621058*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "117", "]"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGCwBOKWgg2uYh9eOd7fHMVtDqTXBZ8RsgTSJnPXS8cC6fQd
H9+C6FuLpFrjgDT/w0lfQfSysBqneCC9KkBCOAlI8928fB5En8q/6ZYCpMNK
zC+kAum0u7y7a4H0jt1/uFuB9O/nu7PagLRUpOzaF0C65pHV0pdAWuhLkdwr
IP2A5cBs/Y+vHC2Oh54xANKvL/NcNAbSzx/NfR4MpM0czN6nAOldX/dHNgPp
T8t1H18H0rcebhK8CaS/MrXlvgbSbIXKYgKfXjke1xaYZwukT63oY4kE0t/U
yn0TgPRmrhrJ1UB6S4Sz62YgfVpI2X4LiM/+3n3J91eOdTr3Gw78fOV4MWvu
0fNAesmd0thfQDqhqSDkP5B+un3PvbRfrxw3it3b1QWkr1m+4VwOpAWYs6a8
AtITGi+Ymv9+5bjC+N/kBUC6oy6gcTeQtpGw8D4KpDUmfWJ6DqSfsDNP+wak
OW6eNJz655XjvVXpVUV/XzluEj77cSaQ/rC0XnU2kJ7aqCE2B0gXlfe93A+k
E7mnlHT9e+W4zbLLWYH1tSMANA0Lhg==
  "]]
}, Open  ]],

Cell["If there is one  rev[ ],", "Text",
 CellChangeTimes->{{3.615077714041741*^9, 3.615077742266781*^9}}],

Cell["28/08/2015  Uninitialized,", "Text",
 CellChangeTimes->{{3.649721037903037*^9, 3.649721053886795*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"v_", "?", "deg1Q"}], ",", 
      RowBox[{"rev", "[", 
       RowBox[{"Y1_", "?", "deg2Q"}], "]"}], ",", 
      RowBox[{"Y2_", "?", "deg2Q"}], ",", 
      RowBox[{"w_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{
     RowBox[{"FieldQ", "[", "Y2", "]"}], "&&", 
     RowBox[{"!", 
      RowBox[{"OrderedQ", "[", 
       RowBox[{"{", 
        RowBox[{"Y1", ",", "Y2"}], "}"}], "]"}]}]}]}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"w", ",", 
     RowBox[{"rev", "[", "Y2", "]"}], ",", "Y1", ",", "v"}], 
    "\[RightAngleBracket]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"v_", "?", "deg1Q"}], ",", 
      RowBox[{"Y1_", "?", "deg2Q"}], ",", 
      RowBox[{"rev", "[", 
       RowBox[{"Y2_", "?", "deg2Q"}], "]"}], ",", 
      RowBox[{"w_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{
     RowBox[{"FieldQ", "[", "Y1", "]"}], "&&", 
     RowBox[{"!", 
      RowBox[{"OrderedQ", "[", 
       RowBox[{"{", 
        RowBox[{"Y1", ",", "Y2"}], "}"}], "]"}]}]}]}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"w", ",", "Y2", ",", 
     RowBox[{"rev", "[", "Y1", "]"}], ",", "v"}], "\[RightAngleBracket]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.615073863023451*^9, 3.6150739061581793`*^9}, {
  3.615073940383662*^9, 3.615073969170372*^9}, {3.615074166786879*^9, 
  3.6150741723115253`*^9}, {3.615074203952989*^9, 3.615074221588389*^9}, {
  3.6150742928815937`*^9, 3.615074309284585*^9}, {3.615074580163496*^9, 
  3.615074618197035*^9}, {3.6151520694643927`*^9, 3.615152080535817*^9}, {
  3.615170055488496*^9, 3.615170064756339*^9}, {3.615170119525449*^9, 
  3.615170125959367*^9}, {3.615170216322641*^9, 3.6151702598418922`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "118", "]"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGCwBOISUU43sQ+vHLXvxXObA+m58ueELIG0SclW6VggLRf7
5S2IVsiSa40D0ovqJn8F0WucJjjFA+n4LhnhJCAtsvnKeRAd9/ymWwqQfvLM
/EIqkN71mX93LZBekP+XuxVIH7p1IKsNSJ+fLL/2BZDuULRd+hJIf+AulXsF
pN1mHpyt//GVo87HiDMGQDouhveiMZA+tmjB82Ag3eRu/j4FSH87cDCyGUjH
KBk+vg6kw0o2C94E0nNutuW+BtKzNqqLCXx65Vh6S2ieLZBe92IySySQvruk
0jcBSG86Uie5GkjfW+XhuhlIf1upbL8FSPM++OC+5PsrR63iZw0Hfr5y/Hd3
/tHzQDrAsiL2F5BOYy4O+Q+kO+YduJf265VjxsmHu7qA9I2u95zLgfSGotwp
r4B0SMRlU/PfrxzZQv9PXgCkp2oGNu4G0rGm1t5HgfSuO1+ZngPpN1/Zpn0D
0o7XzhpO/fPKUflFZlXR31eODq/PfZwJpONSmlRnA2nebm2xOUA67fSEl/uB
dIf8tJKuf68cNRd3OyuwvnYEAKTBC2A=
  "]],

Cell[BoxData[
 RowBox[{"rule", "[", "119", "]"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJwVxW0oI2AAB/A5brXWchwr0TYkeSkWWkvioZurSx3nZGXbpW2hpJhCkZdo
zZfVjnJ2uyXXddxd58aX+WCuo8SZ64QtFpHNM7Jxm3DMfx9+/ZLrW6pUEQwG
QwyaeJaE66Mky6Vgi/B7/nqsGOdr5hJlmCf7dxZe0MQblOOJHkMg/JdSfakC
K3RJT+txnGXTHl7udkiU+OhYtKHC1svo+W5sbrljD+KfTlvTELYb+F89WJtc
9PEE+9jtPIolY4vjOX5Ksv21a7lYXsf5k4eXJ8zuV7i/XHSuxEHbonQA16UI
D7dxjcYS48BGx1CzF7+bSec+uaCk3RlrKsLfPIYoKd6b7Kx4g3/86kmYxq6p
588sOPg5tXgWc/Z95ZNXlGS2Hffarim53/uwZMcvxR2yG6yObKsOYa3J5lLf
UNKwcmDV4R3dOesT/t7a/Jbi6tq/BaJbSpivQwYzHsmo7JvHsoLCF0vYuht4
5ManAeZoEJOt38KR/5Skehq7Wu8oKfGu+8ewXNmfNo45w1lcI1av6k8WsJY/
qtHdUxLaHS4TPPaSB60ADG8=
  "]]
}, Open  ]],

Cell["28/08/2015  Uninitialized,", "Text",
 CellChangeTimes->{{3.649721037903037*^9, 3.649721053886795*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"v_", "?", "deg1Q"}], ",", 
      RowBox[{"rev", "[", 
       RowBox[{"Y1_", "?", "deg2Q"}], "]"}], ",", 
      RowBox[{"Y2_", "?", "deg2Q"}], ",", 
      RowBox[{"w_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{
     RowBox[{"FieldQ", "[", "Y2", "]"}], "&&", 
     RowBox[{"SymQ", "[", "Y2", "]"}]}]}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"w", ",", "Y2", ",", "Y1", ",", "v"}], "\[RightAngleBracket]"}]}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"v_", "?", "deg1Q"}], ",", 
      RowBox[{"Y1_", "?", "deg2Q"}], ",", 
      RowBox[{"rev", "[", 
       RowBox[{"Y2_", "?", "deg2Q"}], "]"}], ",", 
      RowBox[{"w_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{
     RowBox[{"FieldQ", "[", "Y1", "]"}], "&&", 
     RowBox[{"SymQ", "[", "Y1", "]"}]}]}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"w", ",", "Y2", ",", "Y1", ",", "v"}], "\[RightAngleBracket]"}]}],
   "]"}]}], "Input",
 CellChangeTimes->{{3.615073863023451*^9, 3.6150739061581793`*^9}, {
  3.615073940383662*^9, 3.615073969170372*^9}, {3.615074166786879*^9, 
  3.6150741723115253`*^9}, {3.615074203952989*^9, 3.615074221588389*^9}, {
  3.6150742928815937`*^9, 3.615074309284585*^9}, {3.615074580163496*^9, 
  3.615074618197035*^9}, {3.6151520694643927`*^9, 3.615152080535817*^9}, {
  3.615170055488496*^9, 3.615170064756339*^9}, {3.615170119525449*^9, 
  3.615170125959367*^9}, {3.61517033019578*^9, 3.615170335921582*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "120", "]"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGCwBGLGKdZuYh9eOXI/SOU2B9JHgi4IWQLp/w67pGOBdMSG
729B9Pe9iq1xQHrlzxlfQfSiRzOc4oF0bq+ScBKQXu149TyI3vfnrlsKkN5R
b3MhFUgfeCa4uxZIC9Uw8rQC6cBXR7LagDTHAsW1L4C0xErbpS+B9G3OcrlX
QPrBhiOz9T++ctz1Le6MAZBuOMx/0RhIB/AufB4MpNksbN6nAOmTaw5HNgNp
3/mGj68D6RmvtgneBNIZpe25r4F0uKqOmMCnV44Xo4Tn2QLpM72zWSKBdI9P
lW8CkLbMa5JcDaT/LvZ13QykxU6p2m8B0o3sn92XfH/laDT1VcOBn68cT33c
ffQ8kD6SXR37C0g/0isL+Q+k+84euZf265Vj+pynu7qAtCrrZ87lQPrlqoIp
r4D0syU3TM1/v3K88OH/5AVA+uG70MbdQPrGdWvvoyB6/jem50BasZRr2jcg
raZx0XDqn1eOZWo5VUV/gfa1n/84E0j/MGxVnQ2kdzTqic0B0ipHJr7cD6Rn
nJtV0vUPqC6ix1mB9bUjAJ9PDqQ=
  "]],

Cell[BoxData[
 RowBox[{"rule", "[", "121", "]"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGCwBGLGKdZuYh9eOXI/SOU2B9JHgi4IWQLp/w67pGOBdMSG
729B9Pe9iq1xQHrlzxlfQfSiRzOc4oF0bq+ScBKQXu149TyI3vfnrlsKkN5R
b3MhFUgfeCa4uxZIC9Uw8rQC6cBXR7LagDTHAsW1L4C0xErbpS+B9G3OcrlX
QPrBhiOz9T++ctz1Le6MAZBuOMx/0RhIB/AufB4MpNksbN6nAOmTaw5HNgNp
3/mGj68D6RmvtgneBNIZpe25r4F0uKqOmMCnV44Xo4Tn2QLpM72zWSKBdI9P
lW8CkLbMa5JcDaT/LvZ13QykxU6p2m8B0o3sn92XfH/laDT1VcOBn68cT33c
ffQ8kD6SXR37C0g/0isL+Q+k+84euZf265Vj+pynu7qAtCrrZ87lQPrlqoIp
r4D0syU3TM1/v3K88OH/5AVA+uG70MbdQPrGdWvvoyB6/jem50BasZRr2jcg
raZx0XDqn1eOZWo5VUV/gfa1n/84E0j/MGxVnQ2kdzTqic0B0ipHJr7cD6Rn
nJtV0vXvlePx5h5nBdbXjgCglA7S
  "]]
}, Open  ]],

Cell["28/08/2015  Uninitialized,", "Text",
 CellChangeTimes->{{3.649721037903037*^9, 3.649721053886795*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"v_", "?", "deg1Q"}], ",", 
      RowBox[{"rev", "[", 
       RowBox[{"Y1_", "?", "deg2Q"}], "]"}], ",", 
      RowBox[{"Y2_", "?", "deg2Q"}], ",", 
      RowBox[{"w_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{
     RowBox[{"FieldQ", "[", "Y2", "]"}], "&&", 
     RowBox[{"AntisymQ", "[", "Y2", "]"}]}]}], ":=", 
   RowBox[{"-", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"w", ",", "Y2", ",", "Y1", ",", "v"}], 
     "\[RightAngleBracket]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"v_", "?", "deg1Q"}], ",", 
      RowBox[{"Y1_", "?", "deg2Q"}], ",", 
      RowBox[{"rev", "[", 
       RowBox[{"Y2_", "?", "deg2Q"}], "]"}], ",", 
      RowBox[{"w_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{
     RowBox[{"FieldQ", "[", "Y1", "]"}], "&&", 
     RowBox[{"AntisymQ", "[", "Y1", "]"}]}]}], ":=", 
   RowBox[{"-", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"w", ",", "Y2", ",", "Y1", ",", "v"}], 
     "\[RightAngleBracket]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.615073863023451*^9, 3.6150739061581793`*^9}, {
  3.615073940383662*^9, 3.615073969170372*^9}, {3.615074166786879*^9, 
  3.6150741723115253`*^9}, {3.615074203952989*^9, 3.615074221588389*^9}, {
  3.6150742928815937`*^9, 3.615074309284585*^9}, {3.615074580163496*^9, 
  3.615074618197035*^9}, {3.6151520694643927`*^9, 3.615152080535817*^9}, {
  3.615170055488496*^9, 3.615170064756339*^9}, {3.615170119525449*^9, 
  3.615170195888074*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "122", "]"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJwVxVkoA2AAB/ARD86YDClGNCS2nHtgPmeuF7yIjYSinLnbRIxZojSTpuVM
YUn2oK1Q2kTKkZzlRTk+iZFr5vjv4dcvoKwur8KGwWDwIdG/M531TMkyr9Ip
DpcWHTH5WNas9xViDu/z0XqWKFAqwq1T6jfrXpnjySU4sp/rUYavXE/2rd8s
XaeXY24EOajAfhYPvQRbFuydpbhRaqjuwy+pgZo73CsRzN3jwZlWP4pjG4yq
SBMlF6aqPS4WhzIPo/BgzsxtPj4ZEzyV4/pjQ2EPHtqOvj7Fxhad+zlm82U1
D5iTyGW5vVASpvJUJ+Do4Wm7QiyfFeeW4kyN1GcRF+/kpa1iVm6IQIvZC68Z
sx+UrAWYuja/KFnpWDfs485didCMHd/bCv7wVsbuVaWZEm3YjU6OOSuvDvOY
2d6koDh++DIm7puS7iIbxSSWaYTdeqxkCrIN+Kzny/YWq79dlO9Y13fMG7VQ
Up1U29H4Q4l36KFpHIePDASrsLiLx5rAygTF/QYOMqua5L+UTCeNpLDtH8g/
EbIEBQ==
  "]],

Cell[BoxData[
 RowBox[{"rule", "[", "123", "]"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJwVxVkoA2AAB/ARD86YDClGNCS2nHtgPmeuF7yIIaEoZ+42EWOWKM2kaTlT
WJI9aCuURpYakrO8KMcnMXLNHP89/PoFlNfnVdowGAw+JPp3pbOeKVnhVTnF
4bKiIyYfS1t0vkLM4X0+Ws8qCZSU4LZp1Zt1r8yJ5FIcOcD1KMdXridG6zfL
1+kVmBtBDiqxn8VDJ8aWRXtnCW6S6Gv68UtqoPoO94kF8/d4aLbNj+LYxh1l
pImSC1P1PheLQpmHUXgoZ/Y2H5+MC54qcMOxvrAXD+9GX5/inVat+zlm86W1
D5iTyGW5vVASpvRUJeDokRm7QiybE+WW4Uy1xGcJF+/lpa1hVm6IQIPZi68Z
cx+UrAeYure+KFnt3NAbcZdBLDRjx/f2gj+8nWG4qjJTogm70cowZ/XVYQEz
O5rlFMePXMbEfVPSU2Qjn8JStbBHhxVMQbYen/V+2d5i1beL4h1r+495YxZK
apLqOpt+KPEOPTRN4PDRwWAlFnXzWJNYkSC/38RBZmWz7JcSJ9FoCtv+gfwD
Dp4Dqg==
  "]]
}, Open  ]],

Cell["If   Y1  and  Y2  both have symmetries,", "Text",
 CellChangeTimes->{{3.615077714041741*^9, 3.615077814922922*^9}}],

Cell["28/08/2015  Uninitialized,", "Text",
 CellChangeTimes->{{3.649721037903037*^9, 3.649721053886795*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"v_", "?", "deg1Q"}], ",", 
      RowBox[{"Y1_", "?", "deg2Q"}], ",", 
      RowBox[{"Y2_", "?", "deg2Q"}], ",", 
      RowBox[{"w_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{
     RowBox[{"HasSymQ", "[", "Y1", "]"}], "&&", 
     RowBox[{"HasSymQ", "[", "Y2", "]"}], "&&", 
     RowBox[{"!", 
      RowBox[{"OrderedQ", "[", 
       RowBox[{"{", 
        RowBox[{"Y1", ",", "Y2"}], "}"}], "]"}]}]}]}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"w", ",", 
     RowBox[{"rev", "[", "Y2", "]"}], ",", 
     RowBox[{"rev", "[", "Y1", "]"}], ",", "v"}], "\[RightAngleBracket]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6150766243501453`*^9, 3.615076708284666*^9}, {
  3.615076753840128*^9, 3.615076784061946*^9}, {3.615076948257842*^9, 
  3.61507699509717*^9}, {3.615077045074258*^9, 3.615077082801002*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "124", "]"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJwVy2kow2EAx/E5lhbK0B+RKJSjkGOUsWcayvFilLyYK/ZCRK4XQ03aypVi
/ixnucpRwisrxwtCwhytSV7wYjwzV0bm/O3Ft8+rb3B5rbTSgcPhJKP5JksG
80yJv6HKVQCXNy88k+Fp35a/DE4rbRa7G9uhqmIoDpuw2l0xjIlLoIZN8SqH
z1zDsd2jBlNGBVTNkpNKeDLM6NqgUc1zU8F+/X6VGiamhizdwagOMnMPf2WK
QAoXv3dHol8oqT6sPoyBBfve+jjYq50x5cPHN9FTBXRy2SvqgNrApFsDlPvq
+EYYzeusMUOxWwLj8UrJqNlnXAjzJFPORXAgsi23FAolar8FeNmaL1mFe6qI
tDXIDlkzpz8ocZZalVuflAy5b+8cw4UNpcwGJ5dbCv5gDnN0LbdRYvkzr3fB
/s933hzsLm3SUCjSXycIvig5KONqJqGNlbfr4NV5WvYOrGd+HE0w4JTPvsMH
nTF28JuS+ME6Rf0PJXPCsxctlBb2hI7ALFEiMwoFN+z9JmwOX2ns+sXvO5Ae
xDWTf6o9CtQ=
  "]]
}, Open  ]],

Cell["\<\
If   Y1 = Y2 = Y ,  and  Y  has symmetry,
( There are two factors of Y,  so this is OK for AntisymQ[Y]  ---  rev[Y]  \
changes sign for  AntisymQ[Y]  if  deg[Y] = 2)\
\>", "Text",
 CellChangeTimes->{{3.615077714041741*^9, 3.6150778711312637`*^9}, {
  3.615078123837142*^9, 3.615078138588708*^9}, {3.61507828916514*^9, 
  3.615078384547227*^9}, {3.6150788397440567`*^9, 3.615078847952689*^9}, {
  3.616738481569826*^9, 3.6167385183387203`*^9}, {3.616738563109406*^9, 
  3.6167386040668364`*^9}}],

Cell["28/08/2015  Uninitialized,", "Text",
 CellChangeTimes->{{3.649721037903037*^9, 3.649721053886795*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
      RowBox[{"v_", "?", "deg1Q"}], ",", 
      RowBox[{"Y_", "?", "deg2Q"}], ",", 
      RowBox[{"Y_", "?", "HasSymQ"}], ",", 
      RowBox[{"w_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], "/;", 
    RowBox[{"!", 
     RowBox[{"OrderedQ", "[", 
      RowBox[{"{", 
       RowBox[{"v", ",", "w"}], "}"}], "]"}]}]}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"w", ",", "Y", ",", "Y", ",", "v"}], "\[RightAngleBracket]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6150779247408037`*^9, 3.615077972403391*^9}, 
   3.61507811040488*^9, {3.6150782109042053`*^9, 3.615078281349803*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "125", "]"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGCwBOI9/PnuYh9eOZpNy+c2B9IPjK4JWQLplJiD0rFAep7Z
37cgepefdmsckL6Qt+QriA55s8gpHkif+usgnASk32y4fh5EH5Z94ZYCpGdF
uV1IBdJFyRK7a4H0lk88PK1A+gbrhaw2IL1indraF0CaX8p16UsgLVdTI/cK
SOtvOTFb/+MrRw2L3DMGQPqbsfhFYyAddGL582AgPcnR6X0KkP4lfiqyGUgv
n2L9+DqQPlK7T/AmkJY415n7Gkivm2UtJvDplWOSiNQ8WyBt0riSJRJIn3Gs
900A0lV3OyRXA+m+6xGum4H0rkYd+y1A+kj2d/cl3185Ni752XDg5ytHr/Yj
R88D6Y/8zbG/gPS06LqQ/0Da8MHFe2m/XjnGb36zqwtIO0z4xbkcSO9YWDHl
FZBOT7pvav4baN437ikLgPSy1VmNu4H0hH5n76NAOsKKgfk5kF7lJDrtG5CW
9bhlOPXPK8fdBUVVRX+B6gKufpwJpNc96lGdDaRZ9pqJzQHSmwxmvtwPEi85
WtL1D6hu1xRnBdbXjgBbWAoi
  "]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Testing", "Subsubsection",
 CellChangeTimes->{{3.6150754196458693`*^9, 3.615075421038228*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearField", "[", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y", ",", "M", ",", "M1", ",", "M2"}], "}"}], "]"}], 
  ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"2", ",", 
    RowBox[{"{", 
     RowBox[{"X", ",", "Y", ",", "M", ",", "M1", ",", "M2"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearField", "[", 
   RowBox[{"{", 
    RowBox[{"v", ",", "w"}], "}"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"1", ",", 
    RowBox[{"{", 
     RowBox[{"v", ",", "w"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AssumeAntisymmetric", "[", "M", "]"}], ";", 
  RowBox[{"AssumeAntisymmetric", "[", "M1", "]"}], ";", 
  RowBox[{"AssumeSymmetric", "[", "M2", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.615065783082053*^9, 3.615065818178329*^9}, {
   3.615066414248138*^9, 3.615066462919948*^9}, 3.615066515835396*^9, {
   3.615066573048376*^9, 3.6150665778484983`*^9}, {3.6150667432096024`*^9, 
   3.615066789334609*^9}, {3.615066855693314*^9, 3.6150668590156918`*^9}, 
   3.615070629131667*^9, {3.615074946354529*^9, 3.61507495515522*^9}, {
   3.615076834910075*^9, 3.61507685557896*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", 
   RowBox[{"rev", "[", "X", "]"}], ",", "Y", ",", "w"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "X", ",", 
   RowBox[{"rev", "[", "Y", "]"}], ",", "w"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", 
   RowBox[{"rev", "[", "Y", "]"}], ",", "X", ",", "w"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "Y", ",", 
   RowBox[{"rev", "[", "X", "]"}], ",", "w"}], 
  "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.615074941257903*^9, 3.615075020656781*^9}, {
  3.615075309722622*^9, 3.61507531838804*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", 
   RowBox[{"rev", "[", "X", "]"}], ",", "Y", ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.615074981166409*^9, 3.615075021908358*^9}, 
   3.6150752864169397`*^9, 3.615152162817256*^9, 3.615169799476746*^9, 
   3.615535686699203*^9, 3.649890999047021*^9, 3.649898537930717*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "X", ",", 
   RowBox[{"rev", "[", "Y", "]"}], ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.615074981166409*^9, 3.615075021908358*^9}, 
   3.6150752864169397`*^9, 3.615152162817256*^9, 3.615169799476746*^9, 
   3.615535686699203*^9, 3.649890999047021*^9, 3.6498985379342318`*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", 
   RowBox[{"rev", "[", "Y", "]"}], ",", "X", ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.615074981166409*^9, 3.615075021908358*^9}, 
   3.6150752864169397`*^9, 3.615152162817256*^9, 3.615169799476746*^9, 
   3.615535686699203*^9, 3.649890999047021*^9, 3.649898537936764*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "Y", ",", 
   RowBox[{"rev", "[", "X", "]"}], ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.615074981166409*^9, 3.615075021908358*^9}, 
   3.6150752864169397`*^9, 3.615152162817256*^9, 3.615169799476746*^9, 
   3.615535686699203*^9, 3.649890999047021*^9, 3.649898537939453*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "M", ",", 
   RowBox[{"rev", "[", "Y", "]"}], ",", "w"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", 
   RowBox[{"rev", "[", "Y", "]"}], ",", "M", ",", "w"}], 
  "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.615075326898315*^9, 3.6150753703717527`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"w", ",", "Y", ",", "M", ",", "v"}], 
   "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{3.6150753389436274`*^9, 3.615075372126432*^9, 
  3.6151521656754436`*^9, 3.615169803648327*^9, 3.61553569896957*^9, 
  3.6497326611259317`*^9, 3.649732706781149*^9, 3.64989100859226*^9, 
  3.649898549458974*^9}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"w", ",", "M", ",", "Y", ",", "v"}], 
   "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{3.6150753389436274`*^9, 3.615075372126432*^9, 
  3.6151521656754436`*^9, 3.615169803648327*^9, 3.61553569896957*^9, 
  3.6497326611259317`*^9, 3.649732706781149*^9, 3.64989100859226*^9, 
  3.649898549462088*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "M1", ",", "M2", ",", "w"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "M2", ",", "M1", ",", "w"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "M", ",", "M", ",", "w"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"w", ",", "M", ",", "M", ",", "v"}], 
  "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.6150755220509872`*^9, 3.615075522756225*^9}, {
  3.61507660518394*^9, 3.615076615401742*^9}, {3.6150768617887497`*^9, 
  3.615076876394578*^9}, {3.615077216377532*^9, 3.615077256509015*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "M1", ",", "M2", ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.649732711684793*^9, 3.649891015478087*^9, 
  3.649898621975993*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "M2", ",", "M1", ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.649732711684793*^9, 3.649891015478087*^9, 
  3.6498986219795*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "M", ",", "M", ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.649732711684793*^9, 3.649891015478087*^9, 
  3.6498986219830914`*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "M", ",", "M", ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.649732711684793*^9, 3.649891015478087*^9, 
  3.649898621985841*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "M1", ",", "M2", ",", "w"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "M2", ",", "M1", ",", "w"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "M", ",", "M", ",", "w"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"w", ",", "M", ",", "M", ",", "v"}], 
  "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.6150755220509872`*^9, 3.615075522756225*^9}, {
  3.61507660518394*^9, 3.615076615401742*^9}, {3.6150768617887497`*^9, 
  3.615076876394578*^9}, {3.615077216377532*^9, 3.615077256509015*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "M1", ",", "M2", ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{
  3.615075523920125*^9, 3.615076615897295*^9, 3.6150767182761908`*^9, 
   3.615076792094685*^9, 3.615076910072935*^9, {3.615077211965736*^9, 
   3.6150772578693438`*^9}, 3.615152168525972*^9, {3.615152343184132*^9, 
   3.615152396319174*^9}, 3.6151698063076887`*^9, 3.615535708505047*^9, 
   3.649891022245862*^9, 3.649898629320373*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "M2", ",", "M1", ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{
  3.615075523920125*^9, 3.615076615897295*^9, 3.6150767182761908`*^9, 
   3.615076792094685*^9, 3.615076910072935*^9, {3.615077211965736*^9, 
   3.6150772578693438`*^9}, 3.615152168525972*^9, {3.615152343184132*^9, 
   3.615152396319174*^9}, 3.6151698063076887`*^9, 3.615535708505047*^9, 
   3.649891022245862*^9, 3.649898629323701*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "M", ",", "M", ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{
  3.615075523920125*^9, 3.615076615897295*^9, 3.6150767182761908`*^9, 
   3.615076792094685*^9, 3.615076910072935*^9, {3.615077211965736*^9, 
   3.6150772578693438`*^9}, 3.615152168525972*^9, {3.615152343184132*^9, 
   3.615152396319174*^9}, 3.6151698063076887`*^9, 3.615535708505047*^9, 
   3.649891022245862*^9, 3.6498986293267393`*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v", ",", "M", ",", "M", ",", "w"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{
  3.615075523920125*^9, 3.615076615897295*^9, 3.6150767182761908`*^9, 
   3.615076792094685*^9, 3.615076910072935*^9, {3.615077211965736*^9, 
   3.6150772578693438`*^9}, 3.615152168525972*^9, {3.615152343184132*^9, 
   3.615152396319174*^9}, 3.6151698063076887`*^9, 3.615535708505047*^9, 
   3.649891022245862*^9, 3.6498986293293343`*^9}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------------------------\
\>", "Text",
 CellChangeTimes->{{3.6142918796899557`*^9, 3.614291886285962*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Standard forms for    \[LeftAngleBracket]  ,  ,  ,  \[RightAngleBracket]     \
involving  tensors with symmetry\
\>", "Subsubsection",
 CellChangeTimes->{{3.6143371096912317`*^9, 3.614337221850617*^9}}],

Cell["\<\
Push a vector to the bracket-end through a tensor with symmetry, 
12:25 9/8/2014.  Only do this if we can form a 2 chain.  Now required that  Y \
 be  deg1or2Q.  Previously no constraints on Y in the following 4 rules.
Note that M is not reversed, so can be any degree. We just contract on a \
different slot of M,\
\>", "Text",
 CellChangeTimes->{{3.614292227098361*^9, 3.614292264873371*^9}, {
  3.614307340157219*^9, 3.6143073405122547`*^9}, {3.6165398993897743`*^9, 
  3.61653996638186*^9}, {3.61654003865387*^9, 3.616540062718137*^9}, {
  3.616540325310667*^9, 3.616540325822774*^9}, {3.6167408895757437`*^9, 
  3.6167409471920033`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"M_", "?", "AntisymQ"}], ",", 
       RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", 
     RowBox[{"Y__", "?", "deg1or2Q"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], 
     RowBox[{
      RowBox[{"deg", "[", "M", "]"}], "-", "1"}]], 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"v", ",", "M", ",", "Y"}], "\[RightAngleBracket]"}]}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6142550538596354`*^9, 3.614255130388063*^9}, {
  3.614255166619789*^9, 3.614255263540422*^9}, {3.616539971656129*^9, 
  3.616539976018607*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "174", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"M_", "?", "SymQ"}], ",", 
       RowBox[{"v_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], ",", 
     RowBox[{"Y__", "?", "deg1or2Q"}]}], "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v", ",", "M", ",", "Y"}], "\[RightAngleBracket]"}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614261973835805*^9, 3.614261976986072*^9}, {
  3.616540013585421*^9, 3.616540019001068*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "175", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"Y__", "?", "deg1or2Q"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"v_", "?", "deg1Q"}], ",", 
       RowBox[{"M_", "?", "AntisymQ"}]}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}], ":=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"-", "1"}], ")"}], 
     RowBox[{
      RowBox[{"deg", "[", "M", "]"}], "-", "1"}]], 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y", ",", "M", ",", "v"}], "\[RightAngleBracket]"}]}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614255325396215*^9, 3.614255394308195*^9}, 
   3.616540027202456*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "176", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"Y__", "?", "deg1or2Q"}], ",", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"v_", "?", "deg1Q"}], ",", 
       RowBox[{"M_", "?", "SymQ"}]}], "\[RightAngleBracket]"}]}], 
    "\[RightAngleBracket]"}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y", ",", "M", ",", "v"}], "\[RightAngleBracket]"}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6142552736683693`*^9, 3.614255291809106*^9}, {
   3.614255334785166*^9, 3.614255369457111*^9}, {3.61425543991719*^9, 
   3.6142554428167133`*^9}, 3.616540030951792*^9}],

Cell[BoxData[
 RowBox[{"rule", "[", "177", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------------------------\
\>", "Text",
 CellChangeTimes->{{3.6142918796899557`*^9, 3.614291886285962*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Splitting   ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "   ", "\[RightAngleBracket]"}], 
    RowBox[{"a", ",", " ", 
     RowBox[{"a", "+", "1"}]}]], TraditionalForm]]],
 "  \[Rule]   \[LeftAngleBracket]  ,  \[RightAngleBracket]         \
------------    turned off        ------   28/08/2015  why/when was this \
turned off ?  "
}], "Subsubsection",
 CellChangeTimes->{{3.6142986318976517`*^9, 3.614298653320006*^9}, {
   3.6142987418532543`*^9, 3.614298794605609*^9}, {3.614654508448112*^9, 
   3.6146545187683153`*^9}, {3.6153654599075937`*^9, 3.615365462393991*^9}, {
   3.6499007481775*^9, 3.649900791791953*^9}, {3.649900848849311*^9, 
   3.649900858815827*^9}, {3.6499062863562098`*^9, 3.649906292356516*^9}, 
   3.649906426818227*^9}],

Cell[TextData[{
 "This was probably turned off when I introduced  ab_List  subscripts. ... \
Yes, see code in section,\n\n             The general contraction bracket  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "  ", "X", "  ", "\[RightAngleBracket]"}], 
    
    RowBox[{" ", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        SubscriptBox["a", "1"], 
        SubscriptBox["b", "1"]}], "}"}], ",", " ", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{
         SubscriptBox["a", "2"], 
         SubscriptBox["b", "2"]}], "}"}], " ", "..."}]}]}]], 
   TraditionalForm]], "None"],
 "      --->         The general contraction bracket  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "  ", "X", "  ", "\[RightAngleBracket]"}], 
    
    RowBox[{" ", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        SubscriptBox["a", "1"], 
        SubscriptBox["b", "1"]}], "}"}], ",", " ", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{
         SubscriptBox["a", "2"], 
         SubscriptBox["b", "2"]}], "}"}], " ", "..."}]}]}]], 
   TraditionalForm]], "None"],
 "     \n"
}], "Text",
 CellChangeTimes->{{3.649901009565897*^9, 3.649901069997786*^9}, {
  3.649906302628188*^9, 3.649906314707844*^9}, {3.649906379858912*^9, 
  3.64990641512319*^9}}],

Cell["\<\
We can assume that slots  a,b   are in first and last factors (others factor \
will have been pulled out), which means that if it is going to split then \
there are only 2 factors,\
\>", "Text",
 CellChangeTimes->{{3.614403257325745*^9, 3.6144033009577017`*^9}, {
  3.6144033470225554`*^9, 3.614403358430419*^9}, {3.6144034681264963`*^9, 
  3.614403492414706*^9}, {3.649900982302408*^9, 3.649900983806676*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"Y1_", "\[CircleTimes]", "Y2_"}], "\[RightAngleBracket]"}], 
     RowBox[{"a_", ",", "b_"}]], "/;", 
    RowBox[{
     RowBox[{"b", "===", 
      RowBox[{"a", "+", "1"}]}], "&&", 
     RowBox[{"a", "===", 
      RowBox[{"deg", "[", "Y1", "]"}]}]}]}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"Y1", ",", "Y2"}], "\[RightAngleBracket]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.478775192038839*^9, 3.478775260472377*^9}, 
   3.478795577725784*^9, {3.479721988973251*^9, 3.479721988977504*^9}, {
   3.480324790447099*^9, 3.480324829722252*^9}, {3.480662121297979*^9, 
   3.480662140396789*^9}, {3.6128313910523863`*^9, 3.612831392446218*^9}, {
   3.61283146994355*^9, 3.612831523989547*^9}, {3.6128316024561853`*^9, 
   3.6128316039440393`*^9}, 3.612834628186369*^9, 3.61283543457262*^9, 
   3.6141139061605167`*^9, {3.6141141060422277`*^9, 3.614114108321553*^9}, {
   3.614402970504609*^9, 3.614402973804578*^9}, {3.6144033055010223`*^9, 
   3.614403333516552*^9}, 3.614403421201062*^9, {3.6144035259513283`*^9, 
   3.6144035326866493`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "178", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearField", "[", 
   RowBox[{"{", 
    RowBox[{"Y1", ",", "Y2"}], "}"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"3", ",", 
    RowBox[{"{", "Y1", "}"}]}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"4", ",", 
    RowBox[{"{", "Y2", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"Y1", "\[CircleTimes]", "Y2"}], "\[RightAngleBracket]"}], 
  RowBox[{"3", ",", "4"}]]}], "Input",
 CellChangeTimes->{{3.6142991457286167`*^9, 3.6142991775158987`*^9}, {
  3.614299214962863*^9, 3.614299217288148*^9}, {3.614403080658287*^9, 
  3.614403092802743*^9}, {3.6144036334278173`*^9, 3.614403724434732*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"rule[\[VeryThinSpace]39\[VeryThinSpace]]:\"\>", 
   "\[InvisibleSpace]", "\<\"    \"\>", "\[InvisibleSpace]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       RowBox[{"Y1_", "\[CircleTimes]", "Y2_"}], "\[RightAngleBracket]"}], 
      RowBox[{"a_", ",", "b_"}]], "/;", 
     RowBox[{
      RowBox[{"b", "===", 
       RowBox[{"a", "+", "1"}]}], "&&", 
      RowBox[{"a", "===", 
       RowBox[{"deg", "[", "Y1", "]"}]}]}]}], ":=", 
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"Y1", ",", "Y2"}], "\[RightAngleBracket]"}]}]}],
  SequenceForm["rule[\[VeryThinSpace]39\[VeryThinSpace]]:", "    ", 
   Defer[Condition[
      Subscript[
       AngleBracket[
        CircleTimes[
         Pattern[$CellContext`Y1, 
          Blank[]], 
         Pattern[$CellContext`Y2, 
          Blank[]]]], 
       Pattern[$CellContext`a, 
        Blank[]], 
       Pattern[$CellContext`b, 
        Blank[]]], 
      And[$CellContext`b === $CellContext`a + 
        1, $CellContext`a === $CellContext`deg[$CellContext`Y1]]] := 
    AngleBracket[$CellContext`Y1, $CellContext`Y2]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.614403095502202*^9, 3.614403600796329*^9, {3.614403694725134*^9, 
   3.614403725611215*^9}, 3.614405990722261*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"Y1", ",", "Y2"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.614299180458712*^9, 3.614299190892438*^9}, 
   3.614299221532672*^9, 3.614403096035945*^9, 3.614403601318699*^9, {
   3.614403694774248*^9, 3.614403725734366*^9}, 3.614405990845649*^9}]
}, Open  ]],

Cell["\<\
When v1  or  v2  is a vector,  and the contraction slot of the other tensor \
is on the other side,  we can also split.  
This is a special case of a general rule for movable factors,\
\>", "Text",
 CellChangeTimes->{{3.478521348524732*^9, 3.478521367997245*^9}, {
   3.478521995402616*^9, 3.478522005330361*^9}, {3.478522082794157*^9, 
   3.478522380056022*^9}, 3.478522415777293*^9, {3.478522542569283*^9, 
   3.478522547072749*^9}, {3.478522672464452*^9, 3.47852282811114*^9}, {
   3.478522866720887*^9, 3.478522910998042*^9}, {3.478523013006232*^9, 
   3.478523063845325*^9}, {3.478523294797873*^9, 3.478523315180198*^9}, {
   3.478523421036623*^9, 3.478523455373287*^9}, {3.478523509195832*^9, 
   3.478523578355614*^9}, {3.478523821778841*^9, 3.478524070826569*^9}, {
   3.478524122176394*^9, 3.478524185184386*^9}, {3.478524340830039*^9, 
   3.478524400607762*^9}, {3.478524843318779*^9, 3.478525228555697*^9}, {
   3.478525654133307*^9, 3.47852582850393*^9}, {3.47852588911241*^9, 
   3.47852622600454*^9}, {3.478526677795962*^9, 3.478526776484335*^9}, {
   3.478526889750424*^9, 3.478526949794981*^9}, {3.47852727452154*^9, 
   3.4785272751774*^9}, {3.478527306713869*^9, 3.47852733310468*^9}, {
   3.478527406985081*^9, 3.478527413939544*^9}, {3.478528120382391*^9, 
   3.47852812958848*^9}, {3.478528192756685*^9, 3.478528220109628*^9}, {
   3.478529193768579*^9, 3.478529219839461*^9}, {3.478529292912798*^9, 
   3.478529294543033*^9}, {3.478529493455744*^9, 3.47852950568608*^9}, {
   3.478532420268942*^9, 3.478532480480057*^9}, 3.478703460819037*^9, {
   3.478703667748659*^9, 3.4787036791852*^9}, {3.478703842688146*^9, 
   3.478703858827889*^9}, {3.478704637672439*^9, 3.478704863019877*^9}, {
   3.478704899735583*^9, 3.478704924252704*^9}, {3.478705143616218*^9, 
   3.478705179720568*^9}, {3.47877440798062*^9, 3.478774411074206*^9}, {
   3.478774469115074*^9, 3.478774563410726*^9}, {3.47877459743639*^9, 
   3.478774692612002*^9}, {3.478774754302787*^9, 3.47877476481211*^9}, {
   3.478774917100629*^9, 3.47877516066617*^9}, {3.478800151156698*^9, 
   3.478800228738099*^9}, {3.478800458264803*^9, 3.478800479965136*^9}, {
   3.478800532754101*^9, 3.478800538321036*^9}, {3.614299278828226*^9, 
   3.6142993827457743`*^9}, {3.6142999633589087`*^9, 3.614299984523067*^9}, 
   3.6143766992212753`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       RowBox[{"v1_", "?", "deg1Q"}], "\[CircleTimes]", "v2__"}], 
      "\[RightAngleBracket]"}], 
     RowBox[{"1", ",", "b_"}]], "/;", " ", 
    RowBox[{"b", "===", 
     RowBox[{"1", "+", 
      RowBox[{"deg", "[", "v2", "]"}]}]}]}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"CircleTimes", "[", "v2", "]"}], ",", "v1"}], 
    "\[RightAngleBracket]"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614403824261889*^9, 3.6144038477781754`*^9}, {
   3.6144038843714037`*^9, 3.614403889968842*^9}, {3.614403930099099*^9, 
   3.6144039474430656`*^9}, 3.614404004402567*^9, {3.614405657833838*^9, 
   3.614405659517456*^9}, {3.6144612055158157`*^9, 3.6144612190912647`*^9}, {
   3.614461281571463*^9, 3.614461290502136*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "179", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AddRule", "[", 
  RowBox[{
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"v1__", "\[CircleTimes]", 
       RowBox[{"v2_", "?", "deg1Q"}]}], "\[RightAngleBracket]"}], 
     RowBox[{"1", ",", "b_"}]], "/;", " ", 
    RowBox[{"b", "===", 
     RowBox[{"1", "+", 
      RowBox[{"deg", "[", "v1", "]"}]}]}]}], ":=", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v2", ",", 
     RowBox[{"CircleTimes", "[", "v1", "]"}]}], "\[RightAngleBracket]"}]}], 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614403970179512*^9, 3.6144040199729643`*^9}, 
   3.614405672675383*^9, {3.6144612931565638`*^9, 3.614461299476489*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "180", "]"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"StartDebug", "[", "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearField", "[", 
   RowBox[{"{", 
    RowBox[{"Y1", ",", "Y2", ",", "Y3", ",", "Y4"}], "}"}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"1", ",", 
    RowBox[{"{", "Y1", "}"}]}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"2", ",", 
    RowBox[{"{", "Y2", "}"}]}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"3", ",", 
    RowBox[{"{", "Y3", "}"}]}], "]"}], ";", 
  RowBox[{"NewField", "[", 
   RowBox[{"4", ",", 
    RowBox[{"{", "Y4", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"Y1", "\[CircleTimes]", "Y2", "\[CircleTimes]", "Y3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "6"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"Y3", "\[CircleTimes]", "Y2", "\[CircleTimes]", "Y1"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "6"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "Y1", "\[CircleTimes]", "Y2", "\[CircleTimes]", "Y3", "\[CircleTimes]", 
    "Y4"}], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "10"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "Y2", "\[CircleTimes]", "Y4", "\[CircleTimes]", "Y3", "\[CircleTimes]", 
    "Y1"}], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "10"}]], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.614404072848235*^9, 3.614404143678788*^9}, {
  3.6144059183447733`*^9, 3.614405924777151*^9}, {3.614460938251593*^9, 
  3.614460953683523*^9}, {3.614460992708305*^9, 3.6144610192320623`*^9}, {
  3.614461083919054*^9, 3.6144611453385477`*^9}}],

Cell[BoxData[
 RowBox[{"Y2", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"Y3", ",", "Y1"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{3.614404111764965*^9, 3.614404145761326*^9, 
  3.614405441761683*^9, 3.614405685558887*^9, 3.614405926146023*^9, 
  3.614461020598123*^9, 3.614461102893261*^9, 3.6144611473373213`*^9, 
  3.614461309093787*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"Y1", ",", "Y3"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
  "Y2"}]], "Output",
 CellChangeTimes->{3.614404111764965*^9, 3.614404145761326*^9, 
  3.614405441761683*^9, 3.614405685558887*^9, 3.614405926146023*^9, 
  3.614461020598123*^9, 3.614461102893261*^9, 3.6144611473373213`*^9, 
  3.6144613091030893`*^9}],

Cell[BoxData[
 RowBox[{"Y2", "\[CircleTimes]", "Y3", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"Y4", ",", "Y1"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{3.614404111764965*^9, 3.614404145761326*^9, 
  3.614405441761683*^9, 3.614405685558887*^9, 3.614405926146023*^9, 
  3.614461020598123*^9, 3.614461102893261*^9, 3.6144611473373213`*^9, 
  3.614461309113418*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"rev", "[", "Y2", "]"}], ",", "Y1"}], "\[RightAngleBracket]"}], 
  "\[CircleTimes]", "Y4", "\[CircleTimes]", "Y3"}]], "Output",
 CellChangeTimes->{3.614404111764965*^9, 3.614404145761326*^9, 
  3.614405441761683*^9, 3.614405685558887*^9, 3.614405926146023*^9, 
  3.614461020598123*^9, 3.614461102893261*^9, 3.6144611473373213`*^9, 
  3.614461309123458*^9}]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------------------------\
\>", "Text",
 CellChangeTimes->{{3.6142918796899557`*^9, 3.614291886285962*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Error messages for  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "   ", "\[RightAngleBracket]"}], 
    RowBox[{"a", ",", "b"}]], TraditionalForm]]],
 "   and    \[LeftAngleBracket]  ,  ,  ,  \[RightAngleBracket]    "
}], "Subsubsection",
 CellChangeTimes->{{3.614294526479456*^9, 3.614294544190144*^9}, {
   3.6142948858402443`*^9, 3.6142948861269817`*^9}, {3.614336804762692*^9, 
   3.614336819160651*^9}, {3.6146544835671873`*^9, 3.6146544882019863`*^9}, {
   3.614654526239357*^9, 3.614654526239409*^9}, {3.614654579561997*^9, 
   3.614654592330141*^9}, {3.615687634665221*^9, 3.6156876407127333`*^9}, 
   3.650082905292748*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrintRulesUsedList", " ", "=", " ", "False"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.650083780161756*^9, 3.650083846256916*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArgumentCheck", "[", 
  RowBox[{"AddRule", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", "v_", "\[RightAngleBracket]"}], 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}]], "/;", 
     RowBox[{"a", "===", "b"}]}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"HoldForm", "[", 
         SubscriptBox[
          RowBox[{"\[LeftAngleBracket]", "v", "\[RightAngleBracket]"}], 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}]], "]"}], ",", 
        "\"\<  \[LongLeftArrow] Contraction slots must differ.\>\""}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"PrintRulesUsedList", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<RulesUsedList = \>\"", ",", "RulesUsedList"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.48031363539812*^9, {3.48031369775825*^9, 3.480313698285813*^9}, {
   3.480313752613991*^9, 3.480313772157354*^9}, {3.480313815557247*^9, 
   3.480313819352112*^9}, {3.480313910416182*^9, 3.480313940594884*^9}, {
   3.480313978649685*^9, 3.480314082387009*^9}, {3.480314237450899*^9, 
   3.480314345857551*^9}, {3.480314381350414*^9, 3.480314426497131*^9}, {
   3.480314457336818*^9, 3.480314461192765*^9}, {3.480314646121899*^9, 
   3.480314820561613*^9}, {3.48031499233212*^9, 3.48031500102515*^9}, {
   3.48031527675163*^9, 3.480315276918948*^9}, 3.480323174299791*^9, {
   3.48032384009407*^9, 3.480323843712929*^9}, {3.6128353447329903`*^9, 
   3.6128353493287897`*^9}, 3.6141131125454903`*^9, {3.614294563846897*^9, 
   3.614294568273884*^9}, 3.61429482869066*^9, {3.6144516176939583`*^9, 
   3.6144516215679817`*^9}, {3.614453169858881*^9, 3.614453179243051*^9}, 
   3.614893349045067*^9, {3.614896441426791*^9, 3.614896446797367*^9}, {
   3.614981266992322*^9, 3.61498128767896*^9}, {3.650082487097505*^9, 
   3.650082508999724*^9}, {3.65008256778265*^9, 3.650082570152503*^9}, {
   3.6500827042943773`*^9, 3.650082706133788*^9}, {3.650083857975686*^9, 
   3.650083868201161*^9}, {3.650083901846794*^9, 3.650083905110022*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "181", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArgumentCheck", "[", 
  RowBox[{"AddRule", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", "v_", "\[RightAngleBracket]"}], 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}]], "/;", " ", 
     RowBox[{
      RowBox[{"a", "<", "1"}], "||", " ", 
      RowBox[{"b", "<", "1"}], "||", 
      RowBox[{"a", ">", 
       RowBox[{"deg", "[", "v", "]"}]}], "||", 
      RowBox[{"b", ">", 
       RowBox[{"deg", "[", "v", "]"}]}]}]}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"HoldForm", "[", 
         SubscriptBox[
          RowBox[{"\[LeftAngleBracket]", "v", "\[RightAngleBracket]"}], 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}]], "]"}], ",", 
        "\"\<  \[LongLeftArrow] Contraction slots are out of range.\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"PrintRulesUsedList", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<RulesUsedList = \>\"", ",", "RulesUsedList"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.478788598275662*^9, 3.478788750387805*^9}, {
   3.478788788658495*^9, 3.478788896774285*^9}, {3.478789358350779*^9, 
   3.478789361148861*^9}, {3.478795096426341*^9, 3.478795099117179*^9}, {
   3.478796394562624*^9, 3.478796473943743*^9}, 3.478796531658407*^9, {
   3.479721988660348*^9, 3.479721988665562*^9}, {3.48031336294111*^9, 
   3.48031346614165*^9}, {3.480313525944726*^9, 3.480313573322323*^9}, {
   3.480314895738708*^9, 3.48031500225186*^9}, {3.480315279467789*^9, 
   3.480315279569061*^9}, 3.480323181453894*^9, {3.480323873920074*^9, 
   3.480323877730241*^9}, {3.612835345801156*^9, 3.612835350544395*^9}, 
   3.6141131145570097`*^9, {3.6142948001450987`*^9, 3.614294834903569*^9}, {
   3.614451607093011*^9, 3.6144516384019423`*^9}, {3.614453151771757*^9, 
   3.61445316408678*^9}, {3.614453284387936*^9, 3.6144532899611807`*^9}, {
   3.61445332731078*^9, 3.614453407549736*^9}, 3.614893352236258*^9, {
   3.6148963874709263`*^9, 3.614896393294976*^9}, {3.614981292114544*^9, 
   3.614981304417428*^9}, {3.650082517945457*^9, 3.650082522825549*^9}, {
   3.650082721447781*^9, 3.65008272336644*^9}, {3.650083873577942*^9, 
   3.650083900248068*^9}, {3.650084848797132*^9, 3.650084851370048*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "182", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArgumentCheck", "[", 
  RowBox[{"AddRule", "[", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"v_", "?", "deg1Q"}], "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}]], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"HoldForm", "[", 
         SubscriptBox[
          RowBox[{"\[LeftAngleBracket]", "v", "\[RightAngleBracket]"}], 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}]], "]"}], ",", 
        "\"\<  \[LongLeftArrow] Contraction is not defined for single vectors \
(arguments of degree 1).\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"PrintRulesUsedList", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<RulesUsedList = \>\"", ",", "RulesUsedList"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.480315142015942*^9, 3.480315150641195*^9}, {
   3.480315240631755*^9, 3.480315243759803*^9}, {3.480315282144489*^9, 
   3.480315282304164*^9}, 3.48032318304186*^9, {3.480323884206446*^9, 
   3.480323887041311*^9}, {3.480334930110102*^9, 3.480334932266773*^9}, {
   3.612835346830267*^9, 3.612835351311268*^9}, 3.614113116709674*^9, {
   3.614294860033559*^9, 3.6142948643242397`*^9}, {3.614294909797731*^9, 
   3.614294917156818*^9}, {3.6144515866244926`*^9, 3.6144515970946217`*^9}, {
   3.614451721440913*^9, 3.614451775779017*^9}, {3.614453828913343*^9, 
   3.614453876868054*^9}, 3.614893355252722*^9, {3.614896400077146*^9, 
   3.614896408844954*^9}, {3.6149813098855457`*^9, 3.614981320320155*^9}, {
   3.6500827600223827`*^9, 3.650082787609067*^9}, {3.650082824309054*^9, 
   3.650082833445055*^9}, {3.650083336622595*^9, 3.650083338893395*^9}, {
   3.6500838751771183`*^9, 3.6500838979118643`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "183", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArgumentCheck", "[", 
  RowBox[{"AddRule", "[", "\[IndentingNewLine]", 
   RowBox[{
    SubscriptBox[
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"v_", "?", "deg0Q"}], "\[RightAngleBracket]"}], 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}]], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"HoldForm", "[", 
         SubscriptBox[
          RowBox[{"\[LeftAngleBracket]", "v", "\[RightAngleBracket]"}], 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}]], "]"}], ",", 
        "\"\<  \[LongLeftArrow] Contraction is not defined for scalars \
(arguments of degree 0).\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"PrintRulesUsedList", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<RulesUsedList = \>\"", ",", "RulesUsedList"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614449449393458*^9, 3.614449467369896*^9}, {
   3.614449595034066*^9, 3.6144498536405277`*^9}, {3.614449889066229*^9, 
   3.6144500891643047`*^9}, {3.614450125067388*^9, 3.6144501318208447`*^9}, {
   3.614450209501792*^9, 3.6144502107969913`*^9}, {3.6144502649712133`*^9, 
   3.614450266636223*^9}, {3.614450313162943*^9, 3.614450344956069*^9}, {
   3.614450444445916*^9, 3.6144504535177526`*^9}, {3.61445094375746*^9, 
   3.614451030719697*^9}, {3.61445135627322*^9, 3.6144514702246513`*^9}, {
   3.614451649555031*^9, 3.614451669728587*^9}, {3.614453233756283*^9, 
   3.614453236350059*^9}, {3.614453888398095*^9, 3.614453891778591*^9}, 
   3.6148933575410147`*^9, {3.614896415021161*^9, 3.614896427720682*^9}, {
   3.614981311463366*^9, 3.6149813215387173`*^9}, {3.650082793092593*^9, 
   3.650082834483677*^9}, {3.650083877334629*^9, 3.6500838954138107`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "184", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArgumentCheck", "[", 
  RowBox[{"AddRule", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", "v__", "\[RightAngleBracket]"}], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "v", "}"}], "]"}], ">", "2"}], "&&", 
      RowBox[{"Apply", "[", 
       RowBox[{"Or", ",", 
        RowBox[{"deg0Q", "[", 
         RowBox[{"{", "v", "}"}], "]"}]}], "]"}]}]}], ":=", " ", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"HoldForm", "[", 
         RowBox[{"\[LeftAngleBracket]", "v", "\[RightAngleBracket]"}], "]"}], 
        ",", "\"\<  \[LongLeftArrow] Contraction is not defined for scalars \
(arguments of degree 0).\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"PrintRulesUsedList", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<RulesUsedList = \>\"", ",", "RulesUsedList"}], "]"}]}], 
       "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614654789785122*^9, 3.6146548320632687`*^9}, {
   3.614654865183485*^9, 3.61465495093123*^9}, {3.6146549935737553`*^9, 
   3.614654993892106*^9}, {3.6146550382934837`*^9, 3.6146551005164948`*^9}, {
   3.6146551336526318`*^9, 3.6146552026776457`*^9}, 3.6146560404971323`*^9, {
   3.6146587075482597`*^9, 3.6146587510167*^9}, 3.6148933600533257`*^9, {
   3.6148964180773983`*^9, 3.614896429413041*^9}, {3.614981313304563*^9, 
   3.6149813227371883`*^9}, {3.650075159147941*^9, 3.650075181005394*^9}, {
   3.6500752511155233`*^9, 3.650075262507188*^9}, {3.650075299069704*^9, 
   3.6500753033690557`*^9}, {3.6500754063922663`*^9, 3.650075467031205*^9}, {
   3.650075679364221*^9, 3.6500757110449743`*^9}, {3.650082893571767*^9, 
   3.650082895780408*^9}, {3.65008301291444*^9, 3.650083031858588*^9}, {
   3.650083879483618*^9, 3.650083893782729*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "185", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArgumentCheck", "[", 
  RowBox[{"AddRule", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"X1__", ",", 
      RowBox[{"v_", "?", "deg1Q"}], ",", "X2__"}], "\[RightAngleBracket]"}], ":=",
     " ", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"HoldForm", "[", 
         RowBox[{"\[LeftAngleBracket]", "v", "\[RightAngleBracket]"}], "]"}], 
        ",", "\"\<  \[LongLeftArrow] Vectors can only appear as the first \
and/or last argument in the conraction bracket.\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"PrintRulesUsedList", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<RulesUsedList = \>\"", ",", "RulesUsedList"}], "]"}]}], 
       "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614654789785122*^9, 3.6146548320632687`*^9}, {
   3.614654865183485*^9, 3.61465495093123*^9}, {3.6146549935737553`*^9, 
   3.614654993892106*^9}, {3.6146550382934837`*^9, 3.6146551005164948`*^9}, {
   3.6146551336526318`*^9, 3.6146552026776457`*^9}, 3.6146560404971323`*^9, {
   3.6146587075482597`*^9, 3.6146587510167*^9}, 3.6148933600533257`*^9, {
   3.6148964180773983`*^9, 3.614896429413041*^9}, {3.614981313304563*^9, 
   3.6149813227371883`*^9}, {3.650075159147941*^9, 3.650075181005394*^9}, {
   3.6500752511155233`*^9, 3.650075262507188*^9}, {3.650075299069704*^9, 
   3.6500753033690557`*^9}, {3.6500754063922663`*^9, 3.650075467031205*^9}, {
   3.650083183729369*^9, 3.650083310285125*^9}, {3.650083382204496*^9, 
   3.6500834023501263`*^9}, {3.650083881353169*^9, 3.650083891893972*^9}, {
   3.6500842167050734`*^9, 3.6500842187850533`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "186", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArgumentCheck", "[", 
  RowBox[{"AddRule", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"v__", "/;", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "v", "}"}], "]"}], ">", "1"}], "&&", 
       RowBox[{
        RowBox[{"degBracket", "[", "v", "]"}], "<", "0"}]}]}], 
     "\[RightAngleBracket]"}], ":=", " ", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"HoldForm", "[", 
         RowBox[{"\[LeftAngleBracket]", "v", "\[RightAngleBracket]"}], "]"}], 
        ",", "\"\<  \[LongLeftArrow] Calculated bracket degree is < 0 ??. Try \
using degCheck[ ].\>\""}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"PrintRulesUsedList", ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<RulesUsedList = \>\"", ",", "RulesUsedList"}], "]"}]}], 
       "]"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.614654789785122*^9, 3.6146548320632687`*^9}, {
   3.614654865183485*^9, 3.61465495093123*^9}, {3.6146549935737553`*^9, 
   3.614654993892106*^9}, {3.6146550382934837`*^9, 3.6146551005164948`*^9}, {
   3.6146551336526318`*^9, 3.6146552026776457`*^9}, 3.6146560404971323`*^9, {
   3.6146587075482597`*^9, 3.6146587510167*^9}, 3.6148933600533257`*^9, {
   3.6148964180773983`*^9, 3.614896429413041*^9}, {3.614981313304563*^9, 
   3.6149813227371883`*^9}, {3.650075159147941*^9, 3.650075181005394*^9}, {
   3.6500752511155233`*^9, 3.650075262507188*^9}, {3.650075299069704*^9, 
   3.6500753033690557`*^9}, 3.650075565445189*^9, {3.650083448026277*^9, 
   3.65008346471422*^9}, {3.650083515977789*^9, 3.6500836117062674`*^9}, {
   3.6500838824246473`*^9, 3.650083890550708*^9}, 3.650083994900712*^9, {
   3.6500842211699657`*^9, 3.650084226339426*^9}, {3.650084500736965*^9, 
   3.6500845053585567`*^9}, {3.650085448593514*^9, 3.6500855281600943`*^9}}],

Cell[BoxData[
 RowBox[{"rule", "[", "187", "]"}]], "Output"]
}, Open  ]],

Cell["\<\
------------------------------------------------------------------------------\
------------------------------------------------------------------------------\
-------------------------------------\
\>", "Text",
 CellChangeTimes->{{3.6142918796899557`*^9, 3.614291886285962*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Code tests", "Subsubsection",
 CellChangeTimes->{{3.478784599907823*^9, 3.478784644560371*^9}, {
  3.47879586709443*^9, 3.478795867413355*^9}, {3.480396747732327*^9, 
  3.480396751587948*^9}}],

Cell[BoxData[
 RowBox[{"StopDebug", "[", "]"}]], "Input",
 CellChangeTimes->{{3.6143028900534782`*^9, 3.614302893641161*^9}}],

Cell[BoxData[
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{
   "a0", ",", "a1", ",", "a2", ",", "a3", ",", "b0", ",", "b1", ",", "b2", 
    ",", "b3", ",", "c0", ",", "c1", ",", "c2", ",", "c3"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6143000646395063`*^9, 3.614300095176509*^9}}],

Cell[BoxData[{
 RowBox[{"NewField", "[", 
  RowBox[{"0", ",", 
   RowBox[{"{", 
    RowBox[{"a0", ",", "b0", ",", "c0"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"a1", ",", "b1", ",", "c1"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"2", ",", 
   RowBox[{"{", 
    RowBox[{"a2", ",", "b2", ",", "c2"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"NewField", "[", 
  RowBox[{"3", ",", 
   RowBox[{"{", 
    RowBox[{"a3", ",", "b3", ",", "c3"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.614300057566527*^9, 3.614300059790579*^9}, {
  3.614300101632615*^9, 3.614300158226883*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "a1", "\[CircleTimes]", "b2", "\[CircleTimes]", "c2", "\[CircleTimes]", 
    "b1"}], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "6"}]]], "Input",
 CellChangeTimes->{{3.480329581452703*^9, 3.480329616862804*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", ",", "b1"}], "\[RightAngleBracket]"}], " ", 
  RowBox[{"b2", "\[CircleTimes]", "c2"}]}]], "Output",
 CellChangeTimes->{3.649898977257106*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", "\[CircleTimes]", "b2"}], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "2"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", "\[CircleTimes]", "b2"}], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "3"}]]}], "Input",
 CellChangeTimes->{{3.48033519082218*^9, 3.480335214541589*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"a1", ",", "b2"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.649898989186625*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"b2", ",", "a1"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.649898989190763*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", "\[CircleTimes]", "b2"}], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "2"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", "\[CircleTimes]", "b2"}], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "3"}]]}], "Input",
 CellChangeTimes->{{3.48033519082218*^9, 3.480335214541589*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"rev", "[", "b2", "]"}], ",", "a1"}], 
  "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.480335194725671*^9, 3.480335215205443*^9}, 
   3.480661313085507*^9, 3.480661697844039*^9, 3.480662411908858*^9, 
   3.518081132606636*^9, 3.613716841921755*^9, 3.613718547906454*^9, 
   3.614300037222396*^9, 3.614300167315308*^9, 3.614302453924938*^9, 
   3.614302907030776*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"b2", ",", "a1"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.480335194725671*^9, 3.480335215205443*^9}, 
   3.480661313085507*^9, 3.480661697844039*^9, 3.480662411908858*^9, 
   3.518081132606636*^9, 3.613716841921755*^9, 3.613718547906454*^9, 
   3.614300037222396*^9, 3.614300167315308*^9, 3.614302453924938*^9, 
   3.6143029070355167`*^9}]
}, Open  ]],

Cell["\<\
(0)   Distribute over + and take out scalars, so that all other rules can be \
done with  v_CircleTimes ...\
\>", "Text",
 CellChangeTimes->{{3.478521348524732*^9, 3.478521367997245*^9}, {
   3.478521995402616*^9, 3.478522005330361*^9}, {3.478522082794157*^9, 
   3.478522380056022*^9}, 3.478522415777293*^9, {3.478522542569283*^9, 
   3.478522547072749*^9}, {3.478522672464452*^9, 3.47852282811114*^9}, {
   3.478522866720887*^9, 3.478522910998042*^9}, {3.478523013006232*^9, 
   3.478523063845325*^9}, {3.478523294797873*^9, 3.478523315180198*^9}, {
   3.478523421036623*^9, 3.478523455373287*^9}, {3.478523509195832*^9, 
   3.478523578355614*^9}, {3.478523821778841*^9, 3.478524070826569*^9}, {
   3.478524122176394*^9, 3.478524185184386*^9}, {3.478524340830039*^9, 
   3.478524400607762*^9}, {3.478524843318779*^9, 3.478525228555697*^9}, {
   3.478525654133307*^9, 3.47852582850393*^9}, {3.47852588911241*^9, 
   3.47852622600454*^9}, {3.478526677795962*^9, 3.478526776484335*^9}, {
   3.478526889750424*^9, 3.478526949794981*^9}, {3.47852727452154*^9, 
   3.4785272751774*^9}, {3.478527306713869*^9, 3.47852733310468*^9}, {
   3.478527406985081*^9, 3.478527413939544*^9}, {3.478528120382391*^9, 
   3.47852812958848*^9}, {3.478528192756685*^9, 3.478528220109628*^9}, {
   3.478529193768579*^9, 3.478529219839461*^9}, {3.478529292912798*^9, 
   3.478529294543033*^9}, {3.478529493455744*^9, 3.47852950568608*^9}, {
   3.478532420268942*^9, 3.478532480480057*^9}, 3.478703460819037*^9, {
   3.478703667748659*^9, 3.4787036791852*^9}, {3.478703842688146*^9, 
   3.478703858827889*^9}, {3.478704637672439*^9, 3.478704863019877*^9}, {
   3.478704899735583*^9, 3.478704924252704*^9}, {3.478705143616218*^9, 
   3.478705179720568*^9}, {3.47877489559973*^9, 3.478774907484824*^9}, {
   3.478781148750663*^9, 3.478781217983201*^9}, 3.478782148012889*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", "+", "b1"}], "\[RightAngleBracket]"}], 
  RowBox[{"a", ",", "b"}]]], "Input",
 CellChangeTimes->{{3.478787143364298*^9, 3.478787149027112*^9}, 
   3.478795894481562*^9, {3.478796336847998*^9, 3.478796348150629*^9}, {
   3.480325646198164*^9, 3.4803256592162*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", "a1", "\[RightAngleBracket]"}], 
   RowBox[{"a", ",", "b"}]], "+", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", "b1", "\[RightAngleBracket]"}], 
   RowBox[{"a", ",", "b"}]]}]], "Output",
 CellChangeTimes->{3.649899143479107*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", "+", "b1"}], "\[RightAngleBracket]"}], 
  RowBox[{"a", ",", "b"}]]], "Input",
 CellChangeTimes->{{3.478787143364298*^9, 3.478787149027112*^9}, 
   3.478795894481562*^9, {3.478796336847998*^9, 3.478796348150629*^9}, {
   3.480325646198164*^9, 3.4803256592162*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[LeftAngleBracket]\"\>", "\[InvisibleSpace]", 
   RowBox[{"a1", "+", "b1"}], "\[InvisibleSpace]", 
   SubscriptBox["\<\"\[RightAngleBracket]\"\>", 
    RowBox[{"a", ",", "b"}]], 
   "\[InvisibleSpace]", "\<\"  \[LongLeftArrow] Contraction is not defined \
for vectors.\"\>"}],
  SequenceForm["\[LeftAngleBracket]", $CellContext`a1 + $CellContext`b1, 
   Subscript["\[RightAngleBracket]", $CellContext`a, $CellContext`b], 
   "  \[LongLeftArrow] Contraction is not defined for vectors."],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.480328342502493*^9, 3.480333481766694*^9, 3.48033397889482*^9, 
   3.480334704383863*^9, {3.480334877950694*^9, 3.480334884483098*^9}, 
   3.480334951658835*^9, 3.480661313102545*^9, 3.480661697858541*^9, 
   3.480662411928727*^9, 3.518081133513814*^9, 3.613716841962598*^9, 
   3.613718547917472*^9, 3.614302467837393*^9, 3.614302912477448*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.478787149892573*^9, 3.478796251797803*^9, 3.47879630987218*^9, {
   3.478796341640713*^9, 3.478796349587692*^9}, 3.478796612919486*^9, 
   3.478798892818112*^9, 3.478799247689307*^9, 3.478801428954388*^9, 
   3.478805095866799*^9, 3.478806942386093*^9, 3.478860372611384*^9, 
   3.478865748145007*^9, 3.478877243962821*^9, 3.478931076999388*^9, 
   3.478973090412531*^9, 3.47902008935048*^9, 3.479024523177847*^9, 
   3.479046990245663*^9, 3.479054581817631*^9, 3.479103672385375*^9, 
   3.479112700417124*^9, 3.47914890924541*^9, 3.47918960914977*^9, 
   3.479201563866965*^9, 3.479225800360585*^9, 3.479299432004449*^9, 
   3.479324881841665*^9, 3.479326919976122*^9, 3.479358951080365*^9, 
   3.479454099671778*^9, 3.479919163437032*^9, {3.480325632800389*^9, 
   3.480325661159738*^9}, 3.4803283425035*^9, 3.480333481770475*^9, 
   3.480333978898145*^9, 3.480334704387775*^9, {3.480334878014035*^9, 
   3.480334884522798*^9}, 3.480334951663877*^9, 3.480661313104024*^9, 
   3.480661697859742*^9, 3.48066241193043*^9, 3.518081133515441*^9, 
   3.613716841965246*^9, 3.613718547920401*^9, 3.614302467876903*^9, 
   3.614302912521056*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"a1", "+", "b1"}], ",", "c1"}], "\[RightAngleBracket]"}]], "Input",\

 CellChangeTimes->{{3.478787168735273*^9, 3.478787170158456*^9}, {
  3.480325950410823*^9, 3.480325954830466*^9}, {3.480334980441988*^9, 
  3.480334989254818*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", ",", "c1"}], "\[RightAngleBracket]"}], "+", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"b1", ",", "c1"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQA+Izv/b3OL1+6fiRP5/BHUhH1Plqg+hv01+7egDp/LCg
IhC9J4K/2RNI72Ly9vUG0idPnjX2AdKWAVO80oB0wpd7rzKANDtXc3sekC5O
XnKhA0jPux8YMhdIW/nrum8B0umX0wu3AenJZucyD4LEz+6SOwqk924XEL8L
pLsPTqh/CKQd563U/QykWWS1eNnfvHTcsLLhMQ+QnqDIu1MCSP9+wbjWBkjr
ZthLeQLpLlZGSS8gfSL/+Z5IIG1/tcqoA0hPTc53z3770jHz8LoXhu9eOr71
qngHoqViLggZA+kcR8uppkA6wiP2Moju5OLVMwPS6hkLfEH01L9nAkG0kprq
iqtAOvWB3Q0Qzfy63vAakL65eQOvqdkrx0msbrrz3rxy3LOljmk+kF46pV5x
z9tXjueyzSPA9Lw/oQsNXzsCAApeyYQ=
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"a2", ",", 
   RowBox[{"b2", "+", "c2"}]}], "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{{3.478787270151457*^9, 3.478787272777437*^9}, {
  3.480326011322404*^9, 3.480326017182011*^9}, {3.480334994049959*^9, 
  3.480335002494639*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a2", ",", "b2"}], "\[RightAngleBracket]"}], "+", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a2", ",", "c2"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQAeIDb5xmOr1+6XjRUZ7RHUjH/mvQBtGaURxuHkC617+s
CETbqhs1ewLpu9W9vt5AehfrJWMfIN2YM80rDUhP/BDwOgNIR6U2t+cBaeei
pRc6gDTvx6CQuUD6wmZd9y1A2sY2o3AbkBbdfjHzIJC+arNb7iiQtlgrKX4X
SHcITKx/CKSXzFmr+xlkzhcdXvY3Lx1nvVJ5wgOkFzjx7ZQA0kUSbGttgPST
szVSnkB6sz2rpBeQfrntxZ5IIH0nqsaoA0hPTSt2z34LdOersA+G7146Pr10
ScgYSC+9ZTnVFEhzX469DKLLVvLqmQHp0ojUYBBdEqS64iqQNhG2vwGir8k0
GF4D0hMfb+A1NXvlyLLOQ3feGyD9r45pPpD+o71Scc/bV44V1YERIHpOR0vY
QsPXjgByNMAq
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"a1", "+", "b1"}], ",", 
   RowBox[{"a2", "+", "b2"}]}], "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{{3.478787282088035*^9, 3.478787288789852*^9}, {
  3.480326025505504*^9, 3.480326031910216*^9}, {3.480335007665895*^9, 
  3.480335019310692*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", ",", "a2"}], "\[RightAngleBracket]"}], "+", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", ",", "b2"}], "\[RightAngleBracket]"}], "+", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"b1", ",", "a2"}], "\[RightAngleBracket]"}], "+", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"b1", ",", "b2"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{3.649899199830469*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"a1", "+", "b1"}], ",", 
   RowBox[{"a2", "+", "b2"}]}], "\[RightAngleBracket]"}]], "Input",
 CellChangeTimes->{{3.478787282088035*^9, 3.478787288789852*^9}, {
  3.480326025505504*^9, 3.480326031910216*^9}, {3.480335007665895*^9, 
  3.480335019310692*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"rev", "[", "a2", "]"}], ",", "a1"}], "\[RightAngleBracket]"}], 
  "+", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"rev", "[", "a2", "]"}], ",", "b1"}], "\[RightAngleBracket]"}], 
  "+", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"rev", "[", "b2", "]"}], ",", "a1"}], "\[RightAngleBracket]"}], 
  "+", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"rev", "[", "b2", "]"}], ",", "b1"}], 
   "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBmI+Ha3ZTq9fOio+DWR0B9KezzZog2jWA2puHkD62fVZ
RSC6d2Z4syeQtrizydcbSHcJXzb2AdKBp6d5pQFpM4+e1xlAesve5vY8IH28
ftmFDiAt7xEeMhdIvxPXc98CpFn6Mwq3AelP+XczDwLpmZ575Y4Caa5dUuJ3
gbR61sT6h0Da+8Z63c9AekWvCS/7m5eORX9snvAA6eZLwjslgPR5L/a1NkDa
x7xVyhNI3yphk/QC0p1/Xu6JBNKr1BuNOoB0YHmJe/ZboPuuaXwyfPfSsUf4
spAxkFZ7bzPVFEj/9oy7DKKf1wromQFp69VTQkF0R5PqiqtA2tTc/gaI5vNr
MLwGpK+ybeI1NXvl2MPirTvvzSvHG5H1TPOB9CT9e4p73r5ylPLPjQDRAE1X
uf8=
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"a0", " ", "v1"}], ",", "v2"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v1", ",", 
   RowBox[{"a0", " ", "v2"}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"a0", " ", 
    RowBox[{"v1", "\[CircleTimes]", "v2"}]}], ",", "v3"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v1", ",", 
   RowBox[{"a0", " ", 
    RowBox[{"v3", "\[CircleTimes]", "v2"}]}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"a0", " ", 
    RowBox[{"v1", "\[CircleTimes]", "v2"}]}], ",", "v3"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"v1", "\[CircleTimes]", "v4"}], ",", 
   RowBox[{"a0", " ", 
    RowBox[{"v3", "\[CircleTimes]", "v2"}]}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"a0", " ", 
    RowBox[{"v1", "\[CircleTimes]", "v4"}]}], ",", 
   RowBox[{"v3", "\[CircleTimes]", "v2"}]}], 
  "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.478788003269859*^9, 3.478788133145658*^9}, {
  3.480326060059823*^9, 3.48032609705924*^9}}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"v1", ",", "v2"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{3.649899246869152*^9}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"v1", ",", "v2"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{3.649899246871908*^9}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{"v1", "\[CircleTimes]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v2", ",", "v3"}], "\[RightAngleBracket]"}]}]}]], "Output",
 CellChangeTimes->{3.6498992468744793`*^9}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v1", ",", "v3"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
   "v2"}]}]], "Output",
 CellChangeTimes->{3.649899246877013*^9}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{"v1", "\[CircleTimes]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v2", ",", "v3"}], "\[RightAngleBracket]"}]}]}]], "Output",
 CellChangeTimes->{3.649899246879669*^9}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{"v1", "\[CircleTimes]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v4", ",", "v3"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
   "v2"}]}]], "Output",
 CellChangeTimes->{3.649899246882246*^9}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{"v1", "\[CircleTimes]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v4", ",", "v3"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
   "v2"}]}]], "Output",
 CellChangeTimes->{3.649899246884873*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"a0", " ", "v1"}], ",", "v2"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v1", ",", 
   RowBox[{"a0", " ", "v2"}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"a0", " ", 
    RowBox[{"v1", "\[CircleTimes]", "v2"}]}], ",", "v3"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"v1", ",", 
   RowBox[{"a0", " ", 
    RowBox[{"v3", "\[CircleTimes]", "v2"}]}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"a0", " ", 
    RowBox[{"v1", "\[CircleTimes]", "v2"}]}], ",", "v3"}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"v1", "\[CircleTimes]", "v4"}], ",", 
   RowBox[{"a0", " ", 
    RowBox[{"v3", "\[CircleTimes]", "v2"}]}]}], 
  "\[RightAngleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{
   RowBox[{"a0", " ", 
    RowBox[{"v1", "\[CircleTimes]", "v4"}]}], ",", 
   RowBox[{"v3", "\[CircleTimes]", "v2"}]}], 
  "\[RightAngleBracket]"}]}], "Input",
 CellChangeTimes->{{3.478788003269859*^9, 3.478788133145658*^9}, {
  3.480326060059823*^9, 3.48032609705924*^9}}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"v1", ",", "v2"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{{3.478787997797038*^9, 3.478788005055794*^9}, {
   3.478788111515046*^9, 3.478788134577316*^9}, 3.478796650506847*^9, 
   3.478798898900377*^9, 3.478799254650327*^9, 3.478801436831856*^9, 
   3.478805103272424*^9, 3.478805142102656*^9, 3.478805219809736*^9, 
   3.47880694261648*^9, 3.478860372720857*^9, 3.478865759099825*^9, 
   3.478877244126097*^9, 3.478931077222779*^9, 3.478973090747406*^9, 
   3.479020089447833*^9, 3.479024523272999*^9, 3.479046991332926*^9, 
   3.479054581923174*^9, 3.47910367285468*^9, 3.479112700550766*^9, 
   3.479148909602967*^9, 3.47918960993348*^9, 3.479201570052187*^9, 
   3.479225800709276*^9, 3.479299432372005*^9, 3.479324884190022*^9, 
   3.479326920221892*^9, 3.47935895142421*^9, 3.479454100187132*^9, 
   3.479919163658039*^9, 3.480326099609099*^9, 3.480328342602608*^9, 
   3.480333481989378*^9, 3.480333979018462*^9, 3.480334704639871*^9, 
   3.480335024917196*^9, 3.480661313180453*^9, 3.480661697981293*^9, 
   3.480662412016159*^9, 3.518081133570651*^9, 3.613716842430031*^9, 
   3.6137185479913883`*^9, 3.614302508578834*^9, 3.614302917701869*^9}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"v1", ",", "v2"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{{3.478787997797038*^9, 3.478788005055794*^9}, {
   3.478788111515046*^9, 3.478788134577316*^9}, 3.478796650506847*^9, 
   3.478798898900377*^9, 3.478799254650327*^9, 3.478801436831856*^9, 
   3.478805103272424*^9, 3.478805142102656*^9, 3.478805219809736*^9, 
   3.47880694261648*^9, 3.478860372720857*^9, 3.478865759099825*^9, 
   3.478877244126097*^9, 3.478931077222779*^9, 3.478973090747406*^9, 
   3.479020089447833*^9, 3.479024523272999*^9, 3.479046991332926*^9, 
   3.479054581923174*^9, 3.47910367285468*^9, 3.479112700550766*^9, 
   3.479148909602967*^9, 3.47918960993348*^9, 3.479201570052187*^9, 
   3.479225800709276*^9, 3.479299432372005*^9, 3.479324884190022*^9, 
   3.479326920221892*^9, 3.47935895142421*^9, 3.479454100187132*^9, 
   3.479919163658039*^9, 3.480326099609099*^9, 3.480328342602608*^9, 
   3.480333481989378*^9, 3.480333979018462*^9, 3.480334704639871*^9, 
   3.480335024917196*^9, 3.480661313180453*^9, 3.480661697981293*^9, 
   3.480662412016159*^9, 3.518081133570651*^9, 3.613716842430031*^9, 
   3.6137185479913883`*^9, 3.614302508578834*^9, 3.614302917706336*^9}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{"v1", "\[CircleTimes]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v2", ",", "v3"}], "\[RightAngleBracket]"}]}]}]], "Output",
 CellChangeTimes->{{3.478787997797038*^9, 3.478788005055794*^9}, {
   3.478788111515046*^9, 3.478788134577316*^9}, 3.478796650506847*^9, 
   3.478798898900377*^9, 3.478799254650327*^9, 3.478801436831856*^9, 
   3.478805103272424*^9, 3.478805142102656*^9, 3.478805219809736*^9, 
   3.47880694261648*^9, 3.478860372720857*^9, 3.478865759099825*^9, 
   3.478877244126097*^9, 3.478931077222779*^9, 3.478973090747406*^9, 
   3.479020089447833*^9, 3.479024523272999*^9, 3.479046991332926*^9, 
   3.479054581923174*^9, 3.47910367285468*^9, 3.479112700550766*^9, 
   3.479148909602967*^9, 3.47918960993348*^9, 3.479201570052187*^9, 
   3.479225800709276*^9, 3.479299432372005*^9, 3.479324884190022*^9, 
   3.479326920221892*^9, 3.47935895142421*^9, 3.479454100187132*^9, 
   3.479919163658039*^9, 3.480326099609099*^9, 3.480328342602608*^9, 
   3.480333481989378*^9, 3.480333979018462*^9, 3.480334704639871*^9, 
   3.480335024917196*^9, 3.480661313180453*^9, 3.480661697981293*^9, 
   3.480662412016159*^9, 3.518081133570651*^9, 3.613716842430031*^9, 
   3.6137185479913883`*^9, 3.614302508578834*^9, 3.614302917710005*^9}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v1", ",", "v3"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
   "v2"}]}]], "Output",
 CellChangeTimes->{{3.478787997797038*^9, 3.478788005055794*^9}, {
   3.478788111515046*^9, 3.478788134577316*^9}, 3.478796650506847*^9, 
   3.478798898900377*^9, 3.478799254650327*^9, 3.478801436831856*^9, 
   3.478805103272424*^9, 3.478805142102656*^9, 3.478805219809736*^9, 
   3.47880694261648*^9, 3.478860372720857*^9, 3.478865759099825*^9, 
   3.478877244126097*^9, 3.478931077222779*^9, 3.478973090747406*^9, 
   3.479020089447833*^9, 3.479024523272999*^9, 3.479046991332926*^9, 
   3.479054581923174*^9, 3.47910367285468*^9, 3.479112700550766*^9, 
   3.479148909602967*^9, 3.47918960993348*^9, 3.479201570052187*^9, 
   3.479225800709276*^9, 3.479299432372005*^9, 3.479324884190022*^9, 
   3.479326920221892*^9, 3.47935895142421*^9, 3.479454100187132*^9, 
   3.479919163658039*^9, 3.480326099609099*^9, 3.480328342602608*^9, 
   3.480333481989378*^9, 3.480333979018462*^9, 3.480334704639871*^9, 
   3.480335024917196*^9, 3.480661313180453*^9, 3.480661697981293*^9, 
   3.480662412016159*^9, 3.518081133570651*^9, 3.613716842430031*^9, 
   3.6137185479913883`*^9, 3.614302508578834*^9, 3.614302917714176*^9}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{"v1", "\[CircleTimes]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v2", ",", "v3"}], "\[RightAngleBracket]"}]}]}]], "Output",
 CellChangeTimes->{{3.478787997797038*^9, 3.478788005055794*^9}, {
   3.478788111515046*^9, 3.478788134577316*^9}, 3.478796650506847*^9, 
   3.478798898900377*^9, 3.478799254650327*^9, 3.478801436831856*^9, 
   3.478805103272424*^9, 3.478805142102656*^9, 3.478805219809736*^9, 
   3.47880694261648*^9, 3.478860372720857*^9, 3.478865759099825*^9, 
   3.478877244126097*^9, 3.478931077222779*^9, 3.478973090747406*^9, 
   3.479020089447833*^9, 3.479024523272999*^9, 3.479046991332926*^9, 
   3.479054581923174*^9, 3.47910367285468*^9, 3.479112700550766*^9, 
   3.479148909602967*^9, 3.47918960993348*^9, 3.479201570052187*^9, 
   3.479225800709276*^9, 3.479299432372005*^9, 3.479324884190022*^9, 
   3.479326920221892*^9, 3.47935895142421*^9, 3.479454100187132*^9, 
   3.479919163658039*^9, 3.480326099609099*^9, 3.480328342602608*^9, 
   3.480333481989378*^9, 3.480333979018462*^9, 3.480334704639871*^9, 
   3.480335024917196*^9, 3.480661313180453*^9, 3.480661697981293*^9, 
   3.480662412016159*^9, 3.518081133570651*^9, 3.613716842430031*^9, 
   3.6137185479913883`*^9, 3.614302508578834*^9, 3.61430291771789*^9}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{"v1", "\[CircleTimes]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v4", ",", "v3"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
   "v2"}]}]], "Output",
 CellChangeTimes->{{3.478787997797038*^9, 3.478788005055794*^9}, {
   3.478788111515046*^9, 3.478788134577316*^9}, 3.478796650506847*^9, 
   3.478798898900377*^9, 3.478799254650327*^9, 3.478801436831856*^9, 
   3.478805103272424*^9, 3.478805142102656*^9, 3.478805219809736*^9, 
   3.47880694261648*^9, 3.478860372720857*^9, 3.478865759099825*^9, 
   3.478877244126097*^9, 3.478931077222779*^9, 3.478973090747406*^9, 
   3.479020089447833*^9, 3.479024523272999*^9, 3.479046991332926*^9, 
   3.479054581923174*^9, 3.47910367285468*^9, 3.479112700550766*^9, 
   3.479148909602967*^9, 3.47918960993348*^9, 3.479201570052187*^9, 
   3.479225800709276*^9, 3.479299432372005*^9, 3.479324884190022*^9, 
   3.479326920221892*^9, 3.47935895142421*^9, 3.479454100187132*^9, 
   3.479919163658039*^9, 3.480326099609099*^9, 3.480328342602608*^9, 
   3.480333481989378*^9, 3.480333979018462*^9, 3.480334704639871*^9, 
   3.480335024917196*^9, 3.480661313180453*^9, 3.480661697981293*^9, 
   3.480662412016159*^9, 3.518081133570651*^9, 3.613716842430031*^9, 
   3.6137185479913883`*^9, 3.614302508578834*^9, 3.6143029177214527`*^9}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{"v1", "\[CircleTimes]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"v4", ",", "v3"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
   "v2"}]}]], "Output",
 CellChangeTimes->{{3.478787997797038*^9, 3.478788005055794*^9}, {
   3.478788111515046*^9, 3.478788134577316*^9}, 3.478796650506847*^9, 
   3.478798898900377*^9, 3.478799254650327*^9, 3.478801436831856*^9, 
   3.478805103272424*^9, 3.478805142102656*^9, 3.478805219809736*^9, 
   3.47880694261648*^9, 3.478860372720857*^9, 3.478865759099825*^9, 
   3.478877244126097*^9, 3.478931077222779*^9, 3.478973090747406*^9, 
   3.479020089447833*^9, 3.479024523272999*^9, 3.479046991332926*^9, 
   3.479054581923174*^9, 3.47910367285468*^9, 3.479112700550766*^9, 
   3.479148909602967*^9, 3.47918960993348*^9, 3.479201570052187*^9, 
   3.479225800709276*^9, 3.479299432372005*^9, 3.479324884190022*^9, 
   3.479326920221892*^9, 3.47935895142421*^9, 3.479454100187132*^9, 
   3.479919163658039*^9, 3.480326099609099*^9, 3.480328342602608*^9, 
   3.480333481989378*^9, 3.480333979018462*^9, 3.480334704639871*^9, 
   3.480335024917196*^9, 3.480661313180453*^9, 3.480661697981293*^9, 
   3.480662412016159*^9, 3.518081133570651*^9, 3.613716842430031*^9, 
   3.6137185479913883`*^9, 3.614302508578834*^9, 3.61430291772497*^9}]
}, Open  ]],

Cell["\<\
(1)   If  neither of the slot positions {a,b} occurs in the first argument of \
\[CircleTimes], then pull out that tensor factor...\
\>", "Text",
 CellChangeTimes->{{3.478521348524732*^9, 3.478521367997245*^9}, {
   3.478521995402616*^9, 3.478522005330361*^9}, {3.478522082794157*^9, 
   3.478522380056022*^9}, 3.478522415777293*^9, {3.478522542569283*^9, 
   3.478522547072749*^9}, {3.478522672464452*^9, 3.47852282811114*^9}, {
   3.478522866720887*^9, 3.478522910998042*^9}, {3.478523013006232*^9, 
   3.478523063845325*^9}, {3.478523294797873*^9, 3.478523315180198*^9}, {
   3.478523421036623*^9, 3.478523455373287*^9}, {3.478523509195832*^9, 
   3.478523578355614*^9}, {3.478523821778841*^9, 3.478524070826569*^9}, {
   3.478524122176394*^9, 3.478524185184386*^9}, {3.478524340830039*^9, 
   3.478524400607762*^9}, {3.478524843318779*^9, 3.478525228555697*^9}, {
   3.478525654133307*^9, 3.47852582850393*^9}, {3.47852588911241*^9, 
   3.47852622600454*^9}, {3.478526677795962*^9, 3.478526776484335*^9}, {
   3.478526889750424*^9, 3.478526949794981*^9}, {3.47852727452154*^9, 
   3.4785272751774*^9}, {3.478527306713869*^9, 3.47852733310468*^9}, {
   3.478527406985081*^9, 3.478527413939544*^9}, {3.478528120382391*^9, 
   3.47852812958848*^9}, {3.478528192756685*^9, 3.478528220109628*^9}, {
   3.478529193768579*^9, 3.478529219839461*^9}, {3.478529292912798*^9, 
   3.478529294543033*^9}, {3.478529493455744*^9, 3.47852950568608*^9}, {
   3.478532420268942*^9, 3.478532480480057*^9}, 3.478703460819037*^9, {
   3.478703667748659*^9, 3.4787036791852*^9}, {3.478703842688146*^9, 
   3.478703858827889*^9}, {3.478704637672439*^9, 3.478704863019877*^9}, {
   3.478704899735583*^9, 3.478704924252704*^9}, {3.478705143616218*^9, 
   3.478705179720568*^9}, {3.47877489559973*^9, 3.478774907484824*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "a0", "\[CircleTimes]", "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", 
    "a3"}], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "2"}]]], "Input",
 CellChangeTimes->{{3.478788409323446*^9, 3.478788450673493*^9}, 
   3.478795942499298*^9, 3.480327106057862*^9, 3.480327204553882*^9, {
   3.480327243143209*^9, 3.480327248286315*^9}, 3.480327372176492*^9, {
   3.480327423491998*^9, 3.480327427892808*^9}}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a1", ",", "a2"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
   "a3"}]}]], "Output",
 CellChangeTimes->{3.649899267574133*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "a0", "\[CircleTimes]", "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", 
    "a3"}], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "2"}]]], "Input",
 CellChangeTimes->{{3.478788409323446*^9, 3.478788450673493*^9}, 
   3.478795942499298*^9, 3.480327106057862*^9, 3.480327204553882*^9, {
   3.480327243143209*^9, 3.480327248286315*^9}, 3.480327372176492*^9, {
   3.480327423491998*^9, 3.480327427892808*^9}}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"rev", "[", "a2", "]"}], ",", "a1"}], "\[RightAngleBracket]"}], 
   "\[CircleTimes]", "a3"}]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQAWLunh4d59cvHZdciDEF0XeDr+i7g2iTTW4eQLqyVb0Y
RIt+ft7sCaQnVC4O9gbS8pausSBa2u2qsQ+QLl413SsNSJuu8n+TAaTlOlva
84D0pVkrLnQA6d/pkSFzgXTDEz33LUDaVTezcBuQNkl/l3kQpF5tn9xRIN01
T178LpBmkZ1U/xBI64pv1f0Msp8piJf9zUtHnnb3JzxAet9kiZ0SQDphCu9a
GyC96Eq7lCeQ/szMKekFpLfXvt8TCaRfOHYYdQDpgP4q9+y3Lx1jHXYtMHr3
0nH1wstCxkDadrfTVFMgXVuafBlEL/WX1DMD0hHb74eB6H9aaiuuAunL7Y43
QPQfzkbDa0B6w95NvKZmrxxZTQJ157155dhQ38g0H0jnxR5T2/P2lePhk4aR
IBoA63a+jg==
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "2"}]]], "Input",
 CellChangeTimes->{{3.478788544830618*^9, 3.478788563289732*^9}, 
   3.478795944745799*^9, 3.480327113340219*^9, 3.480327222355818*^9, 
   3.480327263184445*^9, 3.480327372712867*^9, {3.480327435757349*^9, 
   3.480327439508702*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a1", "\[CircleTimes]", "a3"}], " ", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", "a2", "\[RightAngleBracket]"}], 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]]}]], "Output",
 CellChangeTimes->{3.649899298628737*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "2"}]]], "Input",
 CellChangeTimes->{{3.478788544830618*^9, 3.478788563289732*^9}, 
   3.478795944745799*^9, 3.480327113340219*^9, 3.480327222355818*^9, 
   3.480327263184445*^9, 3.480327372712867*^9, {3.480327435757349*^9, 
   3.480327439508702*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[LeftAngleBracket]\"\>", "\[InvisibleSpace]", 
   RowBox[{"a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[InvisibleSpace]", 
   SubscriptBox["\<\"\[RightAngleBracket]\"\>", 
    RowBox[{"2", ",", "2"}]], 
   "\[InvisibleSpace]", "\<\"  \[LongLeftArrow] Contraction slots must \
differ.\"\>"}],
  SequenceForm["\[LeftAngleBracket]", 
   CircleTimes[$CellContext`a1, $CellContext`a2, $CellContext`a3], 
   Subscript["\[RightAngleBracket]", 2, 2], 
   "  \[LongLeftArrow] Contraction slots must differ."],
  Editable->False]], "Print",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBmKf1yuDnV+/dJxnXpwGold6Jxu6A2m2SbfdPID062Sf
YhD9ZCFniyeQXqBxN9YbSKvvu2rsA6TXPZzulQakf+XWvMkA0uKpHe15QJr/
4eoLHUD67+3IkLkg/ZMN3LcAabu2rMJtQFpa62PmQSD9M2qf3FEgnS6tIH4X
SB/ePrn+IZC2n7BV9zOQVjseysv+5qWjVLb/Ex4g3SwmuVMCSF8W4ltrA6Rv
L++S8gTS52p4JL2A9LTvn/ZEAum/Yj1GHUD6pVS1e/bbl45Vy4QXGb176Xjk
/GUhYyAtyuA81RRI5+9NvQyii3fL6JkB6aS1HOEg+ouf2oqrQNp7l+MNEM2m
02x4DST+eDOvqdkrx0erg3XnvXnleGdvI9N8IH0ljVtjz9tXju93J0WCaACM
R7/f
  "]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.478788554765645*^9, 3.478788564302491*^9}, 
   3.478788765470906*^9, 3.478788915682175*^9, 3.478796683216383*^9, 
   3.478798902890935*^9, 3.478799258528224*^9, 3.47880144033135*^9, 
   3.478805231001197*^9, 3.478806942784425*^9, 3.478860372748668*^9, 
   3.478865763947936*^9, 3.478877244263769*^9, 3.478931077376369*^9, 
   3.478973090813106*^9, 3.479020089521574*^9, 3.47902452333032*^9, 
   3.47904699153752*^9, 3.479054581950676*^9, 3.47910367300837*^9, 
   3.479112700617823*^9, 3.479148909679537*^9, 3.479189610761856*^9, 
   3.479201570487443*^9, 3.479225800865448*^9, 3.479299432445904*^9, 
   3.47932488434335*^9, 3.479326920396716*^9, 3.479358951599236*^9, 
   3.479454100386314*^9, 3.4799191638517*^9, 3.480327440646497*^9, 
   3.480328342620538*^9, 3.480333482096358*^9, 3.480333979182061*^9, 
   3.480334704900664*^9, 3.48033503236364*^9, 3.480661313198353*^9, 
   3.480661698055495*^9, 3.480662412100874*^9, 3.518081133623239*^9, 
   3.613716842619166*^9, 3.613718548057201*^9, 3.614302528392572*^9, 
   3.6143029231299067`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a0", " ", 
    RowBox[{"a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}]}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"4", ",", "5"}]]], "Input",
 CellChangeTimes->{{3.478789302143657*^9, 3.478789333704191*^9}, 
   3.478795957607527*^9, 3.480327123964244*^9, 3.480327290551949*^9, 
   3.480327382368112*^9, {3.48032749444558*^9, 3.480327501445*^9}}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{"a1", "\[CircleTimes]", "a2", "\[CircleTimes]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "a3", "\[RightAngleBracket]"}], 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]]}]}]], "Output",
 CellChangeTimes->{3.649899314283443*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a0", " ", 
    RowBox[{"a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}]}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"4", ",", "5"}]]], "Input",
 CellChangeTimes->{{3.478789302143657*^9, 3.478789333704191*^9}, 
   3.478795957607527*^9, 3.480327123964244*^9, 3.480327290551949*^9, 
   3.480327382368112*^9, {3.48032749444558*^9, 3.480327501445*^9}}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{"a1", "\[CircleTimes]", "a2", "\[CircleTimes]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", "a3", "\[RightAngleBracket]"}], 
    RowBox[{"1", ",", "2"}]]}]}]], "Output",
 CellChangeTimes->{{3.478789305648331*^9, 3.478789334970837*^9}, 
   3.478796695556585*^9, 3.478799272555756*^9, 3.478799440295765*^9, 
   3.478801653849742*^9, 3.4788052389331*^9, 3.478805323794083*^9, 
   3.478806943060215*^9, 3.478860372832514*^9, 3.478865768842173*^9, 
   3.478877244284343*^9, 3.478931077553852*^9, 3.47897309096333*^9, 
   3.479020089544421*^9, 3.479024523350798*^9, 3.479046991847428*^9, 
   3.479054582024212*^9, 3.479103673150562*^9, 3.479112700635953*^9, 
   3.479148909828426*^9, 3.479189611124627*^9, 3.479201570867032*^9, 
   3.479225801219556*^9, 3.479299432691411*^9, 3.479324884515969*^9, 
   3.479326920670891*^9, 3.47935895174612*^9, 3.479454100559271*^9, 
   3.4799191640053*^9, 3.480327503636015*^9, 3.480328342737505*^9, 
   3.480333482117897*^9, 3.480333979269038*^9, 3.480334705001779*^9, 
   3.480335039743224*^9, 3.480661313261399*^9, 3.480661698138747*^9, 
   3.480662412120522*^9, 3.518081133673238*^9, 3.613716842910928*^9, 
   3.61371854814618*^9, 3.614302552783105*^9, 3.614302935155438*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a0", " ", 
    RowBox[{"a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "b2"}]}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"4", ",", "5"}]]], "Input",
 CellChangeTimes->{{3.478801666795502*^9, 3.478801667753598*^9}, 
   3.480327124668371*^9, 3.480327304064196*^9, 3.48032738320795*^9, {
   3.480327507503574*^9, 3.480327511661321*^9}}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{"a1", "\[CircleTimes]", "a2"}], " ", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", "b2", "\[RightAngleBracket]"}], 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]]}]], "Output",
 CellChangeTimes->{3.649899328474732*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a0", " ", 
    RowBox[{"a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "b2"}]}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"4", ",", "5"}]]], "Input",
 CellChangeTimes->{{3.478801666795502*^9, 3.478801667753598*^9}, 
   3.480327124668371*^9, 3.480327304064196*^9, 3.48032738320795*^9, {
   3.480327507503574*^9, 3.480327511661321*^9}}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{"a1", "\[CircleTimes]", "a2"}], " ", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", "b2", "\[RightAngleBracket]"}], 
   RowBox[{"1", ",", "2"}]]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGBQB+KXclMXeL5+6ZhpoRDvDaQPM/1MA9E6hY+MfUD8Z7O8
0oD0gznZbzOA9A6/zvY8IK33f8uFDiCdl5kUMhdIRy41dN8CpO/nZxduA9Kv
zv/NPAik7zEflDsKpI85q4rfBdKFrVPqHwJp7Tt7dT8D6c9CObzsb1466nfE
PeEB0jI9+jslgLTSMrG1NkB6Yv1kKU8gPeGLqKQXkDau/bEnEkjzH51q1AGk
N65ocM9++9IxY2rwaqN3Lx2vad0SMgbSWsFuU01B9PWMyyA62FtBzwxIfz4p
HgGiX7VrrLgKpM8vcrkBos9wtBleA9Jhe7fympq9cvy+MF533ptXjmV/W5jm
A2mOYhGdPW9fOYqpC0eDaAA53K2g
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"deg", "[", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", "b2", "\[RightAngleBracket]"}], 
   RowBox[{"1", ",", "2"}]], "]"}]], "Input",
 CellChangeTimes->{{3.478801679421059*^9, 3.478801687438264*^9}, 
   3.479721989905671*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQAGKVpYyLPV+/dJTKepLoDaQPTXXPANG3nj8y9gHSwQqz
vdKAdPGGGW8zgHSsam97HpAWLNh6oQNIX72bFDIXSH/1NnbfAqT3Lcku3Aak
s92Ysw4C6Ywzh+SOAukHTRrid4H0QuVp9Q+B9HX/fbqfgfSP16W87G9eOt52
THzCA6S/XjPeKQGklTTF19qA+CJTpDyBtE6BmKQXkH7w+feeSCBd2jLTqANI
bxFpcc9++9LRmfnzWqN3Lx2dgm4JGQPpsh63qaZA+rdA5mUQvatNQc8MSLNE
xESA6NNWWiuuAmnnyy43QHSbdZvhNSDN/GYrr6nZK0eG0jTdeW9eOW6MbWWa
D6SfyKrq7nn7ytG7rD0aRIeYH8hcaPjaEQC1xK/y
  "]]
}, Open  ]],

Cell["\<\
(2)    If  neither of the slot positions {a,b} occurs in the last argument of \
\[CircleTimes], then pull out that tensor factor...\
\>", "Text",
 CellChangeTimes->{{3.478521348524732*^9, 3.478521367997245*^9}, {
   3.478521995402616*^9, 3.478522005330361*^9}, {3.478522082794157*^9, 
   3.478522380056022*^9}, 3.478522415777293*^9, {3.478522542569283*^9, 
   3.478522547072749*^9}, {3.478522672464452*^9, 3.47852282811114*^9}, {
   3.478522866720887*^9, 3.478522910998042*^9}, {3.478523013006232*^9, 
   3.478523063845325*^9}, {3.478523294797873*^9, 3.478523315180198*^9}, {
   3.478523421036623*^9, 3.478523455373287*^9}, {3.478523509195832*^9, 
   3.478523578355614*^9}, {3.478523821778841*^9, 3.478524070826569*^9}, {
   3.478524122176394*^9, 3.478524185184386*^9}, {3.478524340830039*^9, 
   3.478524400607762*^9}, {3.478524843318779*^9, 3.478525228555697*^9}, {
   3.478525654133307*^9, 3.47852582850393*^9}, {3.47852588911241*^9, 
   3.47852622600454*^9}, {3.478526677795962*^9, 3.478526776484335*^9}, {
   3.478526889750424*^9, 3.478526949794981*^9}, {3.47852727452154*^9, 
   3.4785272751774*^9}, {3.478527306713869*^9, 3.47852733310468*^9}, {
   3.478527406985081*^9, 3.478527413939544*^9}, {3.478528120382391*^9, 
   3.47852812958848*^9}, {3.478528192756685*^9, 3.478528220109628*^9}, {
   3.478529193768579*^9, 3.478529219839461*^9}, {3.478529292912798*^9, 
   3.478529294543033*^9}, {3.478529493455744*^9, 3.47852950568608*^9}, {
   3.478532420268942*^9, 3.478532480480057*^9}, 3.478703460819037*^9, {
   3.478703667748659*^9, 3.4787036791852*^9}, {3.478703842688146*^9, 
   3.478703858827889*^9}, {3.478704637672439*^9, 3.478704863019877*^9}, {
   3.478704899735583*^9, 3.478704924252704*^9}, {3.478705143616218*^9, 
   3.478705195253281*^9}, {3.478774901949986*^9, 3.478774903565379*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a0", " ", 
    RowBox[{"a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}]}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "2"}]]], "Input",
 CellChangeTimes->{{3.478789573019917*^9, 3.478789575190253*^9}, 
   3.478795959455678*^9, 3.480327125580483*^9, 3.480327310272049*^9, 
   3.480327386104044*^9, {3.480327542439481*^9, 3.480327545020722*^9}}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a1", ",", "a2"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
   "a3"}]}]], "Output",
 CellChangeTimes->{3.649899354525052*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a0", " ", 
    RowBox[{"a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}]}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "2"}]]], "Input",
 CellChangeTimes->{{3.478789573019917*^9, 3.478789575190253*^9}, 
   3.478795959455678*^9, 3.480327125580483*^9, 3.480327310272049*^9, 
   3.480327386104044*^9, {3.480327542439481*^9, 3.480327545020722*^9}}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{
     RowBox[{"rev", "[", "a2", "]"}], ",", "a1"}], "\[RightAngleBracket]"}], 
   "\[CircleTimes]", "a3"}]}]], "Output",
 CellChangeTimes->{{3.478789567017203*^9, 3.478789600412553*^9}, 
   3.478789730590826*^9, 3.478789952680249*^9, 3.47879030008149*^9, 
   3.478796700830507*^9, 3.47879927892474*^9, 3.478799441852199*^9, 
   3.478801447556574*^9, 3.478801792618709*^9, 3.478805326151485*^9, 
   3.478806943106661*^9, 3.47886037290855*^9, 3.478865774842388*^9, 
   3.478877244420857*^9, 3.478931077683727*^9, 3.478973091107496*^9, 
   3.479020089610329*^9, 3.479024523415998*^9, 3.479046992180656*^9, 
   3.479054582152446*^9, 3.479103673280373*^9, 3.479112700698209*^9, 
   3.479148909961837*^9, 3.479189611976375*^9, 3.479201571125744*^9, 
   3.479225801708052*^9, 3.479299432833827*^9, 3.479324884757892*^9, 
   3.47932692081063*^9, 3.479358952008541*^9, 3.479454100918543*^9, 
   3.479919164146576*^9, 3.480327546675687*^9, 3.480328342827502*^9, 
   3.480333482212236*^9, 3.480333979291013*^9, 3.480334705024273*^9, 
   3.480335113182633*^9, 3.4806613133244*^9, 3.480661698213815*^9, 
   3.480662412201576*^9, 3.5180811337302523`*^9, 3.6137168432398453`*^9, 
   3.613718548217153*^9, 3.614302583557035*^9, 3.614302946864025*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a0", " ", 
    RowBox[{
    "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", "\[CircleTimes]", 
     "b2"}]}], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "4"}]]], "Input",
 CellChangeTimes->{{3.47878989088358*^9, 3.478789911694356*^9}, {
   3.478789957003477*^9, 3.478789976704783*^9}, 3.478795960566917*^9, 
   3.480327126092493*^9, 3.480327312000355*^9, 3.480327387480248*^9, {
   3.480327550303743*^9, 3.480327553260912*^9}}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{"a2", "\[CircleTimes]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a1", ",", "a3"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
   "b2"}]}]], "Output",
 CellChangeTimes->{3.649899369755014*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a0", " ", 
    RowBox[{
    "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", "\[CircleTimes]", 
     "b2"}]}], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "4"}]]], "Input",
 CellChangeTimes->{{3.47878989088358*^9, 3.478789911694356*^9}, {
   3.478789957003477*^9, 3.478789976704783*^9}, 3.478795960566917*^9, 
   3.480327126092493*^9, 3.480327312000355*^9, 3.480327387480248*^9, {
   3.480327550303743*^9, 3.480327553260912*^9}}],

Cell[BoxData[
 RowBox[{"a0", " ", 
  RowBox[{"a2", "\[CircleTimes]", 
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a1", ",", "a3"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
   "b2"}]}]], "Output",
 CellChangeTimes->{
  3.478789912635406*^9, {3.478789957899725*^9, 3.478789977455532*^9}, 
   3.478790298297014*^9, 3.47879672076837*^9, 3.478796830875501*^9, 
   3.478799280485838*^9, 3.47879944275154*^9, 3.478801448691172*^9, 
   3.478801794410129*^9, 3.478805327756271*^9, 3.4788069432193*^9, 
   3.478860372978915*^9, 3.478865775764621*^9, 3.478877244427357*^9, 
   3.478931077787517*^9, 3.478973091223734*^9, 3.479020089618928*^9, 
   3.479024523469747*^9, 3.479046992259439*^9, 3.47905458225481*^9, 
   3.479103673295574*^9, 3.47911270070592*^9, 3.479148910067906*^9, 
   3.479189612274659*^9, 3.479201571215371*^9, 3.479225801723956*^9, 
   3.479299432853791*^9, 3.479324884852862*^9, 3.479326920838896*^9, 
   3.479358952028319*^9, 3.479454101105289*^9, 3.479919164160936*^9, 
   3.480327553987656*^9, 3.48032834283356*^9, 3.480333482296212*^9, 
   3.480333979364583*^9, 3.480334705172871*^9, 3.480335116478244*^9, 
   3.480661313329474*^9, 3.480661698276819*^9, 3.480662412210015*^9, 
   3.518081133767269*^9, 3.613716843293272*^9, 3.613718548381598*^9, 
   3.6143025852724533`*^9, 3.61430294850032*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", "\[CircleTimes]", 
    "b2"}], "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "4"}]]], "Input",
 CellChangeTimes->{{3.478789987759094*^9, 3.47879002754902*^9}, 
   3.478790310128988*^9, {3.478790341514578*^9, 3.478790341667666*^9}, 
   3.478795961646913*^9, 3.480327126588518*^9, 3.480327312863959*^9, 
   3.480327387967933*^9, {3.480327557911521*^9, 3.480327560348794*^9}}],

Cell[BoxData[
 RowBox[{"a1", "\[CircleTimes]", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a2", "\[CircleTimes]", "a3"}], "\[RightAngleBracket]"}], 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]], "\[CircleTimes]", "b2"}]], "Output",
 CellChangeTimes->{3.649899382780033*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", "\[CircleTimes]", 
    "b2"}], "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "4"}]]], "Input",
 CellChangeTimes->{{3.478789987759094*^9, 3.47879002754902*^9}, 
   3.478790310128988*^9, {3.478790341514578*^9, 3.478790341667666*^9}, 
   3.478795961646913*^9, 3.480327126588518*^9, 3.480327312863959*^9, 
   3.480327387967933*^9, {3.480327557911521*^9, 3.480327560348794*^9}}],

Cell[BoxData[
 RowBox[{"a1", "\[CircleTimes]", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a2", "\[CircleTimes]", "a3"}], "\[RightAngleBracket]"}], 
   RowBox[{"1", ",", "3"}]], "\[CircleTimes]", "b2"}]], "Output",
 CellChangeTimes->{
  3.478789988790701*^9, {3.478790022562835*^9, 3.478790028135393*^9}, 
   3.478790253526878*^9, {3.478790292774306*^9, 3.47879034248463*^9}, 
   3.478796838049679*^9, 3.478799285748732*^9, 3.47879944374016*^9, 
   3.478801495013516*^9, 3.478801795548826*^9, 3.478805329266252*^9, 
   3.47880694323681*^9, 3.478860372985902*^9, 3.478865776964237*^9, 
   3.47887724443462*^9, 3.478931077801718*^9, 3.478973091241711*^9, 
   3.479020089627142*^9, 3.479024523526748*^9, 3.479046992336578*^9, 
   3.479054582351473*^9, 3.479103673398998*^9, 3.479112700711698*^9, 
   3.479148910086011*^9, 3.479189612420646*^9, 3.479201571304802*^9, 
   3.479225801739592*^9, 3.47929943296416*^9, 3.479324884943485*^9, 
   3.479326920949213*^9, 3.47935895213806*^9, 3.479454101250252*^9, 
   3.479919164271716*^9, 3.480327561123009*^9, 3.480328342838203*^9, 
   3.480333482464508*^9, 3.480333979377077*^9, 3.480334705290739*^9, 
   3.48033511767255*^9, 3.480661313334152*^9, 3.480661698340159*^9, 
   3.480662412217813*^9, 3.5180811337768917`*^9, 3.613716843338478*^9, 
   3.6137185483894157`*^9, 3.6143025869271383`*^9, 3.61430294957185*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "a2", "\[CircleTimes]", "a1", "\[CircleTimes]", "b1", "\[CircleTimes]", 
    "b2"}], "\[RightAngleBracket]"}], 
  RowBox[{"3", ",", "4"}]]], "Input",
 CellChangeTimes->{{3.47880150387023*^9, 3.478801516665344*^9}, 
   3.480327127004421*^9, 3.480327313391903*^9, 3.480327388432004*^9, {
   3.480327564575472*^9, 3.480327568756652*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", ",", "b1"}], "\[RightAngleBracket]"}], " ", 
  RowBox[{"a2", "\[CircleTimes]", "b2"}]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGBQB+KvN0/2er5+6eixdeEGEN1tMj/LG0j7G7029gHSBQfn
e6WB6L+W7zKAdL1QX3sekH75d8+FDiA9MzE7ZC6QTg00cd8CpE9xlRRuA9I7
DHizDgJp68BzckeB9FcbXfG7QLo1a0b9QyDtLHVM9zOQDsyZyMv+5qXj3Pr8
JzxAOl3LYqcEkP4cLr/WBkhbfV8o5Qmkb96Vk/QC0k4vWfZGAmm2+SuMOoC0
mnOne/bbl46r/T03Gb176Zjw7ZaQMZC2/hw41RREF+VcBtE2N7X1zIB0I9u1
RBBtdE1rxVUgfeiNzw0QvU6v0/AakJ6gtpPX1OyV44HD+brz3rxynLejl2k+
kF68b5b+nrevHIM6HsaAaACSsq6/
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "a2", "\[CircleTimes]", "a1", "\[CircleTimes]", "b1", "\[CircleTimes]", 
    "b2"}], "\[RightAngleBracket]"}], 
  RowBox[{"3", ",", "4"}]]], "Input",
 CellChangeTimes->{{3.47880150387023*^9, 3.478801516665344*^9}, 
   3.480327127004421*^9, 3.480327313391903*^9, 3.480327388432004*^9, {
   3.480327564575472*^9, 3.480327568756652*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", ",", "b1"}], "\[RightAngleBracket]"}], " ", 
  RowBox[{"a2", "\[CircleTimes]", "b2"}]}]], "Output",
 CellChangeTimes->{3.6498993936587553`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"deg", "[", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", ",", "b1"}], "\[RightAngleBracket]"}], "]"}]], "Input",
 CellChangeTimes->{{3.478801526726493*^9, 3.478801536630222*^9}, 
   3.479721989955568*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBOIWK7UJnq9fOgpE628E0b4nrbK9gfS5pa+NfYD04zfz
vdKA9AThuHcZQDrr5sT2PCCdXLT3QgeQDjmRHzIXSCuymLlvAdJhu0sLtwHp
DwH8WQeBdEnBFbmjQHrlOl3xu0BaffqM+odAemrvMd3PQHoa+yRe9jcvHS/8
z3/CA6T3vrfaKQGkjc/Lr7UB0mF1i6Q8gXRxmLykF5BuSGPdGwmkF5ivNOoA
0qGbe9yz3750XOFisMXoHZA2f7YbRNeE3BUyBtIel8OnmgLpe8dyLoPoxTF6
emYg8fu/EkG0wk+tFVdB4iz+N0D0k7OdhteAtF/oTl5Ts1eOK5aW6M5788px
0s9epvlA+qT8C/09b185milJxYLoHcdsCxcavnYEAOh5ttE=
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", "\[CircleTimes]", 
    "b2"}], "\[RightAngleBracket]"}], 
  RowBox[{"7", ",", "8"}]]], "Input",
 CellChangeTimes->{{3.478790581795196*^9, 3.478790596719056*^9}, 
   3.478795994919985*^9, 3.48032712754038*^9, 3.480327320488069*^9, 
   3.480327388976086*^9, {3.480327666706746*^9, 3.480327669483344*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], " ", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", "b2", "\[RightAngleBracket]"}], 
   RowBox[{"1", ",", "2"}]]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGBQA+L0EyssXF6/dHR78M3VHUib2XB0ewDpzQ7Te7yB9LHN
7419gPT99wu90oC0zKVJ7XlAWq1g34UOIH3wfXHIXCDt22TmvgVIP/xTVbgN
SEes4M86CKQn3bkhdxRI78syE78LpFd+n1H/EEiXNp3S/QykFW0n87K/een4
fX7pEx4gveGa304JIO3xXnmtDZBue7RUyhNIPy5UlvQC0v9qOfdGAukvvzYa
dQBpt8O97tlvXzo+iXywz+jdS0f/PXeFjIH0lZCIqaZAenJt/mUQfeWRnp4Z
kL58VmfFVSB9QSr4BohmVOsxvAakVebs5jU1e+UYp1muO+/NK8fttf1M84H0
6+R7RnvevnKsvbMkHkQDAO/+sMA=
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", "\[CircleTimes]", 
    "b2"}], "\[RightAngleBracket]"}], 
  RowBox[{"7", ",", "8"}]]], "Input",
 CellChangeTimes->{{3.478790581795196*^9, 3.478790596719056*^9}, 
   3.478795994919985*^9, 3.48032712754038*^9, 3.480327320488069*^9, 
   3.480327388976086*^9, {3.480327666706746*^9, 3.480327669483344*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], " ", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", "b2", "\[RightAngleBracket]"}], 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]]}]], "Output",
 CellChangeTimes->{3.649899407587831*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", "\[CircleTimes]", 
    "b3"}], "\[RightAngleBracket]"}], 
  RowBox[{"7", ",", "8"}]]], "Input",
 CellChangeTimes->{{3.478790624057581*^9, 3.478790624296511*^9}, 
   3.478795995655398*^9, 3.480327128012437*^9, 3.480327320975968*^9, 
   3.480327389535987*^9, {3.480327675074647*^9, 3.480327677987661*^9}}],

Cell[BoxData[
 RowBox[{"a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", 
  "\[CircleTimes]", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", "b3", "\[RightAngleBracket]"}], 
   RowBox[{"1", ",", "2"}]]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGBQA+L90nI2Lq9fOqanBni4A+mSZdrdHkD6pY5TrzeQvhT4
wdgHSKdaLvJKA9KP9k1rzwPSS44dvNABpBNzSkLmAumLp83ctwBpEZXawm1A
WuMKf9ZBIB1efUvuKJBeW2MjfhdIJyfMqn8IpDuentX9DKTvG0/jZX/z0jFq
UsUTHiBteTV2pwSQjmhSX2sDpK3zlkl5AumLP9QkvYA0DzPv3kggvWrWJqMO
IC3dP9E9++1Lx8j9d/cbvXvpmKPyQMgYSMdPj5hqCqRbTuZfBtFxevp6ZkD6
zje9FVeB9AbN0BsgesKzXsNrQLrs0h5eU7NXjtv0KnXnvXnlmHl0AtN8IJ0j
pW685+0rR58jbAkgGgAgOqet
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", "\[CircleTimes]", 
    "b3"}], "\[RightAngleBracket]"}], 
  RowBox[{"7", ",", "8"}]]], "Input",
 CellChangeTimes->{{3.478790624057581*^9, 3.478790624296511*^9}, 
   3.478795995655398*^9, 3.480327128012437*^9, 3.480327320975968*^9, 
   3.480327389535987*^9, {3.480327675074647*^9, 3.480327677987661*^9}}],

Cell[BoxData[
 RowBox[{"a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", 
  "\[CircleTimes]", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", "b3", "\[RightAngleBracket]"}], 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]]}]], "Output",
 CellChangeTimes->{3.649899424154723*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", "\[CircleTimes]", 
    "b3"}], "\[RightAngleBracket]"}], 
  RowBox[{"8", ",", "9"}]]], "Input",
 CellChangeTimes->{{3.478790650148123*^9, 3.478790651810479*^9}, 
   3.478795996959204*^9, 3.480327128412362*^9, 3.480327321552152*^9, 
   3.480327390104204*^9, {3.480327682330564*^9, 3.480327685267444*^9}}],

Cell[BoxData[
 RowBox[{"a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", 
  "\[CircleTimes]", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", "b3", "\[RightAngleBracket]"}], 
   RowBox[{"2", ",", "3"}]]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGBQA2Kf8132Lq9fOp64tM3DHUgXtAV1ewDpbouGXm8g3cf4
xdgHSLc1LPJKA9JnGae35wHp6PhDFzqA9GSpipC5QPqZiLn7FiBd/aKucBuQ
ljETyjoIpF9vvSV3FEgvP2AvfhdI956fXf8QSHe6XtT9DKRLz0zjZX/z0tEm
u/oJD5Bm2Z64UwJIx/7RXmsDpD1+LpPyBNIBXeqSXkD6bQ/v3kggHe632agD
SKdrTnLPfvvS8ZDKhQNG71463ot6IGQMpP9XRU81BdIWogWXQbRaraGeGZCu
ttZfcRVIt/4NuwGi+Vf0G14D0l6G+3hNzV45zk6r0p335pVjkMQkpvlAWuht
ovGet68c7TJsE0A0AC5mpxk=
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", "\[CircleTimes]", 
    "b3"}], "\[RightAngleBracket]"}], 
  RowBox[{"8", ",", "9"}]]], "Input",
 CellChangeTimes->{{3.478790650148123*^9, 3.478790651810479*^9}, 
   3.478795996959204*^9, 3.480327128412362*^9, 3.480327321552152*^9, 
   3.480327390104204*^9, {3.480327682330564*^9, 3.480327685267444*^9}}],

Cell[BoxData[
 RowBox[{"a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", 
  "\[CircleTimes]", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", "b3", "\[RightAngleBracket]"}], 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}]]}]], "Output",
 CellChangeTimes->{3.6498994349698267`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a2", "\[CircleTimes]", "a3", "\[CircleTimes]", "b1"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"5", ",", "6"}]]], "Input",
 CellChangeTimes->{{3.478790664321226*^9, 3.478790680446085*^9}, 
   3.478795997966659*^9, 3.480327129316039*^9, 3.480327322535835*^9, 
   3.48032739075202*^9, {3.480327690115298*^9, 3.480327692867231*^9}}],

Cell[BoxData[
 RowBox[{"a2", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a3", ",", "b1"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGBQA+I5ZjecXV6/dBS45ebpDqRNpizr9gDSYq2re72BtFzt
F2MfIP12+yKvNCCdYzq9PQ9I1y87eqEDSM/aWBEyF0i/aLdw3wKk52rVF24D
0l0NIlkHgbTUg1tyR4G00wFP8btAev6X2fUPgfTL4qu6n4F0WchsXvY3Lx01
zOqe8ADpuG8pOyWAtOxEnbU2QLrsykopTyB9il1D0gtI83Pz7Y0E0rOltxt1
AOnUuVPds9++dFTovnzQ6N1LR8WWB0LGQDrjfPRUUyD9/3vRZRB9UdRMzwxI
XyrWX3EVSK+aGXEDRPed6Te8BqQ3he3nNTV75ai1qlp33ptXjskJk5nmA+mG
jG3Ge96+cgz5n5kAogF7gqor
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a2", "\[CircleTimes]", "a3", "\[CircleTimes]", "b1"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"5", ",", "6"}]]], "Input",
 CellChangeTimes->{{3.478790664321226*^9, 3.478790680446085*^9}, 
   3.478795997966659*^9, 3.480327129316039*^9, 3.480327322535835*^9, 
   3.48032739075202*^9, {3.480327690115298*^9, 3.480327692867231*^9}}],

Cell[BoxData[
 RowBox[{"a2", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a3", ",", "b1"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{3.649899444281193*^9}]
}, Open  ]],

Cell[TextData[{
 "(4)  If there are two factors (A \[CircleTimes]B) then we are done, except \
for the case in which we can simplify  ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"A", "\[CircleTimes]", "B"}], "\[RightAngleBracket]"}], 
    RowBox[{"a", ",", "b"}]], TraditionalForm]]],
 "  to  \[LeftAngleBracket]A,B\[RightAngleBracket],  ie.,  when  a,b  are the \
last slot of A and first slot of  B... "
}], "Text",
 CellChangeTimes->{{3.478521348524732*^9, 3.478521367997245*^9}, {
   3.478521995402616*^9, 3.478522005330361*^9}, {3.478522082794157*^9, 
   3.478522380056022*^9}, 3.478522415777293*^9, {3.478522542569283*^9, 
   3.478522547072749*^9}, {3.478522672464452*^9, 3.47852282811114*^9}, {
   3.478522866720887*^9, 3.478522910998042*^9}, {3.478523013006232*^9, 
   3.478523063845325*^9}, {3.478523294797873*^9, 3.478523315180198*^9}, {
   3.478523421036623*^9, 3.478523455373287*^9}, {3.478523509195832*^9, 
   3.478523578355614*^9}, {3.478523821778841*^9, 3.478524070826569*^9}, {
   3.478524122176394*^9, 3.478524185184386*^9}, {3.478524340830039*^9, 
   3.478524400607762*^9}, {3.478524843318779*^9, 3.478525228555697*^9}, {
   3.478525654133307*^9, 3.47852582850393*^9}, {3.47852588911241*^9, 
   3.47852622600454*^9}, {3.478526677795962*^9, 3.478526776484335*^9}, {
   3.478526889750424*^9, 3.478526949794981*^9}, {3.47852727452154*^9, 
   3.4785272751774*^9}, {3.478527306713869*^9, 3.47852733310468*^9}, {
   3.478527406985081*^9, 3.478527413939544*^9}, {3.478528120382391*^9, 
   3.47852812958848*^9}, {3.478528192756685*^9, 3.478528220109628*^9}, {
   3.478529193768579*^9, 3.478529219839461*^9}, {3.478529292912798*^9, 
   3.478529294543033*^9}, {3.478529493455744*^9, 3.47852950568608*^9}, {
   3.478532420268942*^9, 3.478532480480057*^9}, 3.478703460819037*^9, {
   3.478703667748659*^9, 3.4787036791852*^9}, {3.478703842688146*^9, 
   3.478703858827889*^9}, {3.478704637672439*^9, 3.478704863019877*^9}, {
   3.478704899735583*^9, 3.478704924252704*^9}, {3.478705143616218*^9, 
   3.478705179720568*^9}, {3.47877440798062*^9, 3.478774411074206*^9}, {
   3.478774469115074*^9, 3.478774563410726*^9}, {3.47877459743639*^9, 
   3.478774692612002*^9}, {3.478774754302787*^9, 3.47877476481211*^9}, {
   3.478774917100629*^9, 3.47877516066617*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", "\[CircleTimes]", 
    "b3"}], "\[RightAngleBracket]"}], 
  RowBox[{"3", ",", "4"}]]], "Input",
 CellChangeTimes->{{3.478790776585396*^9, 3.478790777863999*^9}, 
   3.478796046141747*^9, 3.480327130428318*^9, 3.480327323432009*^9, 
   3.480327391303904*^9, {3.480327700026625*^9, 3.480327708538939*^9}}],

Cell[BoxData[
 RowBox[{"a1", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a2", ",", "a3"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
  "b3"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGBQB+Kw1UX+Lq9fOp75E+flDqTn+F3s9gDS81b+7/UG0pc+
fTH2AdIPvi/ySgPSUpnT2/OAtLrDsQsdQNpQozJkLpBmP2zhvgVI86TVF24D
0uF3xbIOAunPArfljgLp3by+4neB9FOpOfUPgXQ9+zXdz0C6a918XvY3Lx0v
PG5+wgOkS5wzdkoA6RApg7U2QFq7bZWUJ5C+0aAt6QWkfdsF90YC6Q+btht1
AOmDltPcs9++dHwXfeCw0buXjoU7HggZA+mSHrljIHqfYcxUUyCtGV98GUQf
TbXWMwPSQvP1V1wF0nn7Im6A6JLqiYbXgPSXrv28pmavHBn+1urOe/PKUWXt
ZKb5QLpcMdRkz9tXjmH5O5JANAAz3a6B
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", "\[CircleTimes]", 
    "b3"}], "\[RightAngleBracket]"}], 
  RowBox[{"3", ",", "4"}]]], "Input",
 CellChangeTimes->{{3.478790776585396*^9, 3.478790777863999*^9}, 
   3.478796046141747*^9, 3.480327130428318*^9, 3.480327323432009*^9, 
   3.480327391303904*^9, {3.480327700026625*^9, 3.480327708538939*^9}}],

Cell[BoxData[
 RowBox[{"a1", "\[CircleTimes]", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a2", "\[CircleTimes]", "a3"}], "\[RightAngleBracket]"}], 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}]], "\[CircleTimes]", "b3"}]], "Output",
 CellChangeTimes->{3.649899454825564*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"deg", "[", 
  RowBox[{"{", 
   RowBox[{"a2", ",", "a3"}], "}"}], "]"}], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a2", "\[CircleTimes]", "a3"}], "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"2", ",", "3"}], "}"}]]}], "Input",
 CellChangeTimes->{{3.6498996044834013`*^9, 3.6498996355566187`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{{3.649899628043116*^9, 3.6498996380935583`*^9}}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a2", "\[CircleTimes]", "a3"}], "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"2", ",", "3"}], "}"}]]], "Output",
 CellChangeTimes->{{3.649899628043116*^9, 3.64989963809625*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a2", "\[CircleTimes]", "a3"}], "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"2", ",", "3"}], "}"}]]], "Input"],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a2", "\[CircleTimes]", "a3"}], "\[RightAngleBracket]"}], 
  RowBox[{"{", 
   RowBox[{"2", ",", "3"}], "}"}]]], "Output",
 CellChangeTimes->{3.649899533921767*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", "\[CircleTimes]", 
    "b3"}], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "2"}]]], "Input",
 CellChangeTimes->{{3.478790793909844*^9, 3.478790795428518*^9}, 
   3.478796046684781*^9, 3.48032713082141*^9, 3.480327325728226*^9, 
   3.480327391775853*^9, {3.48032771361015*^9, 3.480327715955114*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"rev", "[", "a2", "]"}], ",", "a1"}], "\[RightAngleBracket]"}], 
  "\[CircleTimes]", "a3", "\[CircleTimes]", "b3"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGBQB2Kf6r5Al9cvHXk15ni5A+mt6h+6PYB08lu7Pm8gfXzi
D2MfIB1+f4lXGpA+ZDy7PQ9Ib99+7EIHkLY6UBMyF6Tuo4X7FiBdqdRYuA1I
J4iIZx0E0llOt+WOAmnfRl/xu0D6t8Oc+odAenf8Td3PQPrmmQW87G9eOgqn
tDzhAdI11dk7JYC08xyDtTZA+gj3ailPIL1IQkfSC0hbKQvtjQTS5312GHUA
6RMrZrlnv33p+HbN8iNG7146Tg17LGQMpAWmPDgMol83xkw1BdLNm4ovg+hT
B+30zID0tuv6K64C6dxHETdA9CmjyYbXgLTD/v28pmavHKOi63XnvXnluO7j
FKb5QNo6eYPJnrevHAUuPk4C0QC9grD1
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3", "\[CircleTimes]", 
    "b3"}], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "7"}]]], "Input",
 CellChangeTimes->{{3.478790808674733*^9, 3.478790810065416*^9}, {
   3.478792855019357*^9, 3.4787928551399*^9}, 3.478796047164878*^9, 
   3.480327131236445*^9, 3.480327326335884*^9, 3.480327392183814*^9, {
   3.48032772053826*^9, 3.480327724274888*^9}}],

Cell[BoxData[
 RowBox[{"a2", "\[CircleTimes]", "a3", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", ",", "b3"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQAOJnojnBLq9fOn5iEwx2BdLv7B56uQNpQW7uHg8gvdP9
eJ83kD5m/NPYB0jvU1rqlQakhapmt+cB6TNSpy50AOm83NqQuUD6Q46V+xYg
/X9RU+E2IJ3QIJl1EEhb1t6WOwqk2Tn8xO8C6XMFc+ofAmnvVzd1PwPpJPsl
vOxvXjoa/mp5wgOko9lydkoAaWENw7U2QNpBdJ2UJ5A+t0pf0gtIz9gkujcS
SPOl7TLqANIHdWe7Z7996Rhwf+FRo3cvHb3YnwkZA+l3F9cdANHSj+KnmgLp
pPSyyyDaw9FezwxI3z1suOIqkBYViLwBou/+mmJ4DUgfeHOA19TsleP9GQ26
8968cnSaNo1pPpD2OiFhuuftK8cL8/iTQTQAfMCv/Q==
  "]]
}, Closed]],

Cell["\<\
(5)  If there are more than two factors (A \[CircleTimes]...\[CircleTimes]B) \
then we are more-or-less done, because slot a is stuck in A, and slot b is \
stuck in B.  The exceptions are if  A  and/or B  happen to be
vectors (deg=1).  A vector slot is never stuck, so we can move it next to the \
other factor then let rule ( 4) take over. Moving is simple: either A goes to \
the end or B goes to the front... \
\>", "Text",
 CellChangeTimes->{{3.478521348524732*^9, 3.478521367997245*^9}, {
   3.478521995402616*^9, 3.478522005330361*^9}, {3.478522082794157*^9, 
   3.478522380056022*^9}, 3.478522415777293*^9, {3.478522542569283*^9, 
   3.478522547072749*^9}, {3.478522672464452*^9, 3.47852282811114*^9}, {
   3.478522866720887*^9, 3.478522910998042*^9}, {3.478523013006232*^9, 
   3.478523063845325*^9}, {3.478523294797873*^9, 3.478523315180198*^9}, {
   3.478523421036623*^9, 3.478523455373287*^9}, {3.478523509195832*^9, 
   3.478523578355614*^9}, {3.478523821778841*^9, 3.478524070826569*^9}, {
   3.478524122176394*^9, 3.478524185184386*^9}, {3.478524340830039*^9, 
   3.478524400607762*^9}, {3.478524843318779*^9, 3.478525228555697*^9}, {
   3.478525654133307*^9, 3.47852582850393*^9}, {3.47852588911241*^9, 
   3.47852622600454*^9}, {3.478526677795962*^9, 3.478526776484335*^9}, {
   3.478526889750424*^9, 3.478526949794981*^9}, {3.47852727452154*^9, 
   3.4785272751774*^9}, {3.478527306713869*^9, 3.47852733310468*^9}, {
   3.478527406985081*^9, 3.478527413939544*^9}, {3.478528120382391*^9, 
   3.47852812958848*^9}, {3.478528192756685*^9, 3.478528220109628*^9}, {
   3.478529193768579*^9, 3.478529219839461*^9}, {3.478529292912798*^9, 
   3.478529294543033*^9}, {3.478529493455744*^9, 3.47852950568608*^9}, {
   3.478532420268942*^9, 3.478532480480057*^9}, 3.478703460819037*^9, {
   3.478703667748659*^9, 3.4787036791852*^9}, {3.478703842688146*^9, 
   3.478703858827889*^9}, {3.478704637672439*^9, 3.478704863019877*^9}, {
   3.478704899735583*^9, 3.478704924252704*^9}, {3.478705143616218*^9, 
   3.478705179720568*^9}, {3.47877440798062*^9, 3.478774411074206*^9}, {
   3.478774469115074*^9, 3.478774563410726*^9}, {3.47877459743639*^9, 
   3.478774692612002*^9}, {3.478774754302787*^9, 3.47877476481211*^9}, {
   3.478774917100629*^9, 3.47877516066617*^9}, {3.47877528971135*^9, 
   3.478775353645328*^9}, {3.478775397574053*^9, 3.47877546704609*^9}, {
   3.478775524905524*^9, 3.478775538054849*^9}, {3.478775586959894*^9, 
   3.478775587391773*^9}, {3.478775619782037*^9, 3.478775639489953*^9}, {
   3.478775829402097*^9, 3.478775884863727*^9}, {3.4787759181688*^9, 
   3.478775942564816*^9}, {3.478776140178443*^9, 3.478776156021148*^9}, {
   3.478776270972966*^9, 3.478776327267707*^9}, {3.478776363339581*^9, 
   3.478776387461995*^9}, {3.478776747178831*^9, 3.478776747658465*^9}, {
   3.478776864818019*^9, 3.478776939472709*^9}, {3.478776979069476*^9, 
   3.47877698098864*^9}, {3.478779040090289*^9, 3.478779040201643*^9}, {
   3.478780233359973*^9, 3.478780234063417*^9}, 3.479724880551213*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "a1", "\[CircleTimes]", "b2", "\[CircleTimes]", "c2", "\[CircleTimes]", 
    "b1"}], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "6"}]]], "Input",
 CellChangeTimes->{{3.480329581452703*^9, 3.480329616862804*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", ",", "b1"}], "\[RightAngleBracket]"}], " ", 
  RowBox[{"b2", "\[CircleTimes]", "c2"}]}]], "Output",
 CellChangeTimes->{3.48032961835051*^9, 3.48032978579747*^9, 
  3.480333483010028*^9, 3.480333979711149*^9, 3.480334705988516*^9, 
  3.480661313562273*^9, 3.480661698833179*^9, 3.480662412709634*^9, 
  3.518081134091086*^9, 3.613716844097787*^9, 3.613718548762475*^9, 
  3.614302638485876*^9, 3.614303005187697*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", "\[CircleTimes]", "a2"}], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "3"}]]], "Input",
 CellChangeTimes->{
  3.478796048260702*^9, {3.47879692131766*^9, 3.478796930683838*^9}, 
   3.480327131987901*^9, 3.480327327383676*^9, 3.480327393151536*^9, {
   3.4803277341549*^9, 3.480327736722433*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"a2", ",", "a1"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{
  3.478792938373188*^9, {3.478796903501752*^9, 3.478796931469626*^9}, 
   3.47880565173772*^9, 3.478806943897583*^9, 3.478860373166071*^9, 
   3.478877244866159*^9, 3.478931078333794*^9, 3.478973091933939*^9, 
   3.479020089832836*^9, 3.479024524126813*^9, 3.479046992803829*^9, 
   3.479054582907464*^9, 3.479103674541708*^9, 3.479112700932586*^9, 
   3.479148910824005*^9, 3.479189613247729*^9, 3.479201572170897*^9, 
   3.479225803392266*^9, 3.479299433647387*^9, 3.479324885535508*^9, 
   3.479326921626234*^9, 3.479358952785601*^9, 3.479454102045663*^9, 
   3.479919164864333*^9, 3.480327738090411*^9, 3.480328343260921*^9, 
   3.480333483019799*^9, 3.480333979718702*^9, 3.480334705996022*^9, 
   3.480661313567891*^9, 3.480661699068343*^9, 3.480662412775571*^9, 
   3.518081134124764*^9, 3.613716844137842*^9, 3.613718548807694*^9, 
   3.614303006654192*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a3", "\[CircleTimes]", "a2", "\[CircleTimes]", "b1"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "6"}]]], "Input",
 CellChangeTimes->{{3.478792987978164*^9, 3.478793025696587*^9}, 
   3.478796048732454*^9, 3.480327132388091*^9, 3.480327327879864*^9, 
   3.480327393767947*^9, {3.480327741498867*^9, 3.480327744378631*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"b1", ",", "a3"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
  "a2"}]], "Output",
 CellChangeTimes->{{3.478793001231934*^9, 3.478793027823653*^9}, 
   3.478793158278163*^9, 3.478796939620594*^9, 3.478805654167576*^9, 
   3.478806943939525*^9, 3.478860373171731*^9, 3.478877244871023*^9, 
   3.478931078436752*^9, 3.478973092047286*^9, 3.479020089839789*^9, 
   3.479024524134472*^9, 3.479046992810249*^9, 3.479054582912988*^9, 
   3.479103674559801*^9, 3.479112700937394*^9, 3.479148910927915*^9, 
   3.479189613272741*^9, 3.479201572186336*^9, 3.479225803492591*^9, 
   3.479299433665899*^9, 3.479324885680512*^9, 3.479326921642538*^9, 
   3.479358952800929*^9, 3.479454102062771*^9, 3.479919164976152*^9, 
   3.48032774517038*^9, 3.480328343266353*^9, 3.48033348302669*^9, 
   3.480333979728057*^9, 3.480334706003771*^9, 3.480661313573129*^9, 
   3.480661699086755*^9, 3.480662412842615*^9, 3.518081134159486*^9, 
   3.613716844172585*^9, 3.613718548853714*^9, 3.6143030189468203`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a3", "\[CircleTimes]", "b1"}], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "4"}]]], "Input",
 CellChangeTimes->{{3.478793219832663*^9, 3.478793230836743*^9}, 
   3.478796049204024*^9, 3.480327132795746*^9, 3.480327328343644*^9, 
   3.480327394239693*^9, {3.480327749042666*^9, 3.480327758250295*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"b1", ",", "a3"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{3.480327759522251*^9, 3.480328343270481*^9, 
  3.480333483114669*^9, 3.480333979801209*^9, 3.480334706069717*^9, 
  3.480661313578278*^9, 3.480661699093596*^9, 3.480662412910603*^9, 
  3.518081134165489*^9, 3.6137168442371197`*^9, 3.6137185488625526`*^9, 
  3.614303019124321*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", "\[CircleTimes]", "b3"}], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "4"}]]], "Input",
 CellChangeTimes->{{3.478793506028116*^9, 3.478793508570309*^9}, 
   3.478796049668247*^9, 3.48032713321978*^9, 3.480327328783528*^9, 
   3.480327394615523*^9, {3.480327762826647*^9, 3.480327766230231*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"b3", ",", "a1"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.478793509871037*^9, 3.47879352577863*^9}, 
   3.478793569471668*^9, 3.478796952651477*^9, 3.478805657403955*^9, 
   3.478806944070928*^9, 3.478860373182387*^9, 3.478877244997713*^9, 
   3.478931078587418*^9, 3.478973092175946*^9, 3.479020089852843*^9, 
   3.479024524149829*^9, 3.479046992822741*^9, 3.479054582922974*^9, 
   3.479103675002016*^9, 3.479112700948036*^9, 3.479148911049579*^9, 
   3.479189613565684*^9, 3.4792015725912*^9, 3.479225803703109*^9, 
   3.479299433790437*^9, 3.4793248859981*^9, 3.479326921766843*^9, 
   3.479358952831295*^9, 3.479454102250682*^9, 3.479919165003091*^9, 
   3.480327767322176*^9, 3.480328343352885*^9, 3.480333483121556*^9, 
   3.480333979811182*^9, 3.480334706077189*^9, 3.480661313633831*^9, 
   3.480661699099784*^9, 3.480662412968846*^9, 3.518081134171376*^9, 
   3.613716844277506*^9, 3.613718548871229*^9, 3.6143030191369257`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", "\[CircleTimes]", "b1"}], "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "1"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"b1", "\[CircleTimes]", "a1"}], "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "1"}]]}], "Input",
 CellChangeTimes->{{3.478796976547698*^9, 3.478797003981385*^9}, {
  3.480327133948648*^9, 3.480327134524475*^9}, {3.480327329408144*^9, 
  3.480327329919838*^9}, {3.480327395143816*^9, 3.480327395712205*^9}, {
  3.480327770665564*^9, 3.480327779706548*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"a1", ",", "b1"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.478796981907117*^9, 3.478797006046705*^9}, 
   3.478805659343068*^9, 3.478805829381598*^9, 3.47880588586365*^9, 
   3.478806944085017*^9, 3.478860373238648*^9, 3.478877245004467*^9, 
   3.478931078604802*^9, 3.478973092194102*^9, 3.479020089923781*^9, 
   3.47902452420255*^9, 3.47904699282925*^9, 3.479054582928316*^9, 
   3.479103675192117*^9, 3.479112700953462*^9, 3.479148911064179*^9, 
   3.479189613741955*^9, 3.479201572608844*^9, 3.479225803719292*^9, 
   3.479299433805781*^9, 3.479324886176899*^9, 3.47932692178181*^9, 
   3.479358952939754*^9, 3.479454102443397*^9, 3.479919165115262*^9, 
   3.480327781533226*^9, 3.480328343359197*^9, 3.480333483128592*^9, 
   3.48033397982136*^9, 3.48033470608503*^9, 3.480661313640093*^9, 
   3.480661699158541*^9, 3.480662413022108*^9, 3.518081134235318*^9, 
   3.6137168443496733`*^9, 3.613718548880096*^9, 3.6143030191464567`*^9}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"a1", ",", "b1"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{{3.478796981907117*^9, 3.478797006046705*^9}, 
   3.478805659343068*^9, 3.478805829381598*^9, 3.47880588586365*^9, 
   3.478806944085017*^9, 3.478860373238648*^9, 3.478877245004467*^9, 
   3.478931078604802*^9, 3.478973092194102*^9, 3.479020089923781*^9, 
   3.47902452420255*^9, 3.47904699282925*^9, 3.479054582928316*^9, 
   3.479103675192117*^9, 3.479112700953462*^9, 3.479148911064179*^9, 
   3.479189613741955*^9, 3.479201572608844*^9, 3.479225803719292*^9, 
   3.479299433805781*^9, 3.479324886176899*^9, 3.47932692178181*^9, 
   3.479358952939754*^9, 3.479454102443397*^9, 3.479919165115262*^9, 
   3.480327781533226*^9, 3.480328343359197*^9, 3.480333483128592*^9, 
   3.48033397982136*^9, 3.48033470608503*^9, 3.480661313640093*^9, 
   3.480661699158541*^9, 3.480662413022108*^9, 3.518081134235318*^9, 
   3.6137168443496733`*^9, 3.613718548880096*^9, 3.614303019150558*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "b1", "\[CircleTimes]", "b2", "\[CircleTimes]", "b3", "\[CircleTimes]", 
    "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "2"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "b1", "\[CircleTimes]", "b2", "\[CircleTimes]", "b3", "\[CircleTimes]", 
    "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "3"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "b1", "\[CircleTimes]", "b2", "\[CircleTimes]", "b3", "\[CircleTimes]", 
    "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "4"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "b1", "\[CircleTimes]", "b2", "\[CircleTimes]", "b3", "\[CircleTimes]", 
    "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "5"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "b1", "\[CircleTimes]", "b2", "\[CircleTimes]", "b3", "\[CircleTimes]", 
    "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "6"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "b1", "\[CircleTimes]", "b2", "\[CircleTimes]", "b3", "\[CircleTimes]", 
    "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "7"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "b1", "\[CircleTimes]", "b2", "\[CircleTimes]", "b3", "\[CircleTimes]", 
    "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "8"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "b1", "\[CircleTimes]", "b2", "\[CircleTimes]", "b3", "\[CircleTimes]", 
    "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "9"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "b1", "\[CircleTimes]", "b2", "\[CircleTimes]", "b3", "\[CircleTimes]", 
    "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "10"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "b1", "\[CircleTimes]", "b2", "\[CircleTimes]", "b3", "\[CircleTimes]", 
    "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "11"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "b1", "\[CircleTimes]", "b2", "\[CircleTimes]", "b3", "\[CircleTimes]", 
    "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "1"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "b1", "\[CircleTimes]", "b2", "\[CircleTimes]", "b3", "\[CircleTimes]", 
    "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "2"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "b1", "\[CircleTimes]", "b2", "\[CircleTimes]", "b3", "\[CircleTimes]", 
    "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "3"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "b1", "\[CircleTimes]", "b2", "\[CircleTimes]", "b3", "\[CircleTimes]", 
    "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "4"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "b1", "\[CircleTimes]", "b2", "\[CircleTimes]", "b3", "\[CircleTimes]", 
    "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "5"}]], "\[IndentingNewLine]", 
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "b1", "\[CircleTimes]", "b2", "\[CircleTimes]", "b3", "\[CircleTimes]", 
    "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "6"}]]}], "Input",
 CellChangeTimes->{{3.478712529057115*^9, 3.478712545049593*^9}, {
  3.478712925896194*^9, 3.478712934415722*^9}, {3.478712969275464*^9, 
  3.478712981670915*^9}, {3.478713219264134*^9, 3.478713242903277*^9}, {
  3.478713282127799*^9, 3.478713300850892*^9}, {3.478713417834646*^9, 
  3.478713430663587*^9}, {3.47879730552779*^9, 3.478797309007191*^9}, {
  3.480327135599194*^9, 3.480327139119985*^9}, {3.480327330957662*^9, 
  3.480327334225576*^9}, {3.480327396620656*^9, 3.480327399960286*^9}, {
  3.480327795543531*^9, 3.48032792996422*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"rev", "[", "b2", "]"}], ",", "b1"}], "\[RightAngleBracket]"}], 
  "\[CircleTimes]", "b3", "\[CircleTimes]", "a1", "\[CircleTimes]", "a2", 
  "\[CircleTimes]", "a3"}]], "Output",
 CellChangeTimes->{
  3.478712542321618*^9, {3.478712908408585*^9, 3.47871294753567*^9}, 
   3.478713212768693*^9, 3.478713245004771*^9, 3.478713432708729*^9, 
   3.478713515548508*^9, 3.478713627576997*^9, 3.478713730296814*^9, 
   3.478714077040328*^9, 3.478714996119923*^9, 3.478717210351562*^9, 
   3.478797363596096*^9, 3.478806378783657*^9, 3.478806944258501*^9, 
   3.478860373319091*^9, 3.478865785925978*^9, 3.478877245141698*^9, 
   3.478931078769544*^9, 3.478973092365045*^9, 3.479020090017297*^9, 
   3.479024524261106*^9, 3.479046992943892*^9, 3.47905458300411*^9, 
   3.47910367540748*^9, 3.479112701039324*^9, 3.479148911221959*^9, 
   3.479189613934828*^9, 3.479201572779746*^9, 3.479225803876946*^9, 
   3.479299433978653*^9, 3.479324886462104*^9, 3.479326921946436*^9, 
   3.479358953128906*^9, 3.479454102885436*^9, 3.479919165281301*^9, 
   3.480327937912575*^9, 3.480328343449685*^9, 3.480333483221357*^9, 
   3.480333979910086*^9, 3.480334706173668*^9, 3.480661313717154*^9, 
   3.480661699222722*^9, 3.480662413108255*^9, 3.518081134309325*^9, 
   3.613716844398032*^9, 3.6137185488979816`*^9, 3.6143030191599607`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"b2", ",", "b1"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
  "b3", "\[CircleTimes]", "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", 
  "a3"}]], "Output",
 CellChangeTimes->{
  3.478712542321618*^9, {3.478712908408585*^9, 3.47871294753567*^9}, 
   3.478713212768693*^9, 3.478713245004771*^9, 3.478713432708729*^9, 
   3.478713515548508*^9, 3.478713627576997*^9, 3.478713730296814*^9, 
   3.478714077040328*^9, 3.478714996119923*^9, 3.478717210351562*^9, 
   3.478797363596096*^9, 3.478806378783657*^9, 3.478806944258501*^9, 
   3.478860373319091*^9, 3.478865785925978*^9, 3.478877245141698*^9, 
   3.478931078769544*^9, 3.478973092365045*^9, 3.479020090017297*^9, 
   3.479024524261106*^9, 3.479046992943892*^9, 3.47905458300411*^9, 
   3.47910367540748*^9, 3.479112701039324*^9, 3.479148911221959*^9, 
   3.479189613934828*^9, 3.479201572779746*^9, 3.479225803876946*^9, 
   3.479299433978653*^9, 3.479324886462104*^9, 3.479326921946436*^9, 
   3.479358953128906*^9, 3.479454102885436*^9, 3.479919165281301*^9, 
   3.480327937912575*^9, 3.480328343449685*^9, 3.480333483221357*^9, 
   3.480333979910086*^9, 3.480334706173668*^9, 3.480661313717154*^9, 
   3.480661699222722*^9, 3.480662413108255*^9, 3.518081134309325*^9, 
   3.613716844398032*^9, 3.6137185488979816`*^9, 3.614303019165298*^9}],

Cell[BoxData[
 RowBox[{"b2", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"b1", ",", "b3"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
  "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}]], "Output",
 CellChangeTimes->{
  3.478712542321618*^9, {3.478712908408585*^9, 3.47871294753567*^9}, 
   3.478713212768693*^9, 3.478713245004771*^9, 3.478713432708729*^9, 
   3.478713515548508*^9, 3.478713627576997*^9, 3.478713730296814*^9, 
   3.478714077040328*^9, 3.478714996119923*^9, 3.478717210351562*^9, 
   3.478797363596096*^9, 3.478806378783657*^9, 3.478806944258501*^9, 
   3.478860373319091*^9, 3.478865785925978*^9, 3.478877245141698*^9, 
   3.478931078769544*^9, 3.478973092365045*^9, 3.479020090017297*^9, 
   3.479024524261106*^9, 3.479046992943892*^9, 3.47905458300411*^9, 
   3.47910367540748*^9, 3.479112701039324*^9, 3.479148911221959*^9, 
   3.479189613934828*^9, 3.479201572779746*^9, 3.479225803876946*^9, 
   3.479299433978653*^9, 3.479324886462104*^9, 3.479326921946436*^9, 
   3.479358953128906*^9, 3.479454102885436*^9, 3.479919165281301*^9, 
   3.480327937912575*^9, 3.480328343449685*^9, 3.480333483221357*^9, 
   3.480333979910086*^9, 3.480334706173668*^9, 3.480661313717154*^9, 
   3.480661699222722*^9, 3.480662413108255*^9, 3.518081134309325*^9, 
   3.613716844398032*^9, 3.6137185488979816`*^9, 3.614303019169918*^9}],

Cell[BoxData[
 RowBox[{"b2", "\[CircleTimes]", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"b3", "\[CircleTimes]", "b1"}], "\[RightAngleBracket]"}], 
   RowBox[{"2", ",", "4"}]], "\[CircleTimes]", "a1", "\[CircleTimes]", "a2", 
  "\[CircleTimes]", "a3"}]], "Output",
 CellChangeTimes->{
  3.478712542321618*^9, {3.478712908408585*^9, 3.47871294753567*^9}, 
   3.478713212768693*^9, 3.478713245004771*^9, 3.478713432708729*^9, 
   3.478713515548508*^9, 3.478713627576997*^9, 3.478713730296814*^9, 
   3.478714077040328*^9, 3.478714996119923*^9, 3.478717210351562*^9, 
   3.478797363596096*^9, 3.478806378783657*^9, 3.478806944258501*^9, 
   3.478860373319091*^9, 3.478865785925978*^9, 3.478877245141698*^9, 
   3.478931078769544*^9, 3.478973092365045*^9, 3.479020090017297*^9, 
   3.479024524261106*^9, 3.479046992943892*^9, 3.47905458300411*^9, 
   3.47910367540748*^9, 3.479112701039324*^9, 3.479148911221959*^9, 
   3.479189613934828*^9, 3.479201572779746*^9, 3.479225803876946*^9, 
   3.479299433978653*^9, 3.479324886462104*^9, 3.479326921946436*^9, 
   3.479358953128906*^9, 3.479454102885436*^9, 3.479919165281301*^9, 
   3.480327937912575*^9, 3.480328343449685*^9, 3.480333483221357*^9, 
   3.480333979910086*^9, 3.480334706173668*^9, 3.480661313717154*^9, 
   3.480661699222722*^9, 3.480662413108255*^9, 3.518081134309325*^9, 
   3.613716844398032*^9, 3.6137185488979816`*^9, 3.614303019174478*^9}],

Cell[BoxData[
 RowBox[{"b2", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"b3", ",", "b1"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
  "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}]], "Output",
 CellChangeTimes->{
  3.478712542321618*^9, {3.478712908408585*^9, 3.47871294753567*^9}, 
   3.478713212768693*^9, 3.478713245004771*^9, 3.478713432708729*^9, 
   3.478713515548508*^9, 3.478713627576997*^9, 3.478713730296814*^9, 
   3.478714077040328*^9, 3.478714996119923*^9, 3.478717210351562*^9, 
   3.478797363596096*^9, 3.478806378783657*^9, 3.478806944258501*^9, 
   3.478860373319091*^9, 3.478865785925978*^9, 3.478877245141698*^9, 
   3.478931078769544*^9, 3.478973092365045*^9, 3.479020090017297*^9, 
   3.479024524261106*^9, 3.479046992943892*^9, 3.47905458300411*^9, 
   3.47910367540748*^9, 3.479112701039324*^9, 3.479148911221959*^9, 
   3.479189613934828*^9, 3.479201572779746*^9, 3.479225803876946*^9, 
   3.479299433978653*^9, 3.479324886462104*^9, 3.479326921946436*^9, 
   3.479358953128906*^9, 3.479454102885436*^9, 3.479919165281301*^9, 
   3.480327937912575*^9, 3.480328343449685*^9, 3.480333483221357*^9, 
   3.480333979910086*^9, 3.480334706173668*^9, 3.480661313717154*^9, 
   3.480661699222722*^9, 3.480662413108255*^9, 3.518081134309325*^9, 
   3.613716844398032*^9, 3.6137185488979816`*^9, 3.614303019178289*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a1", ",", "b1"}], "\[RightAngleBracket]"}], " ", 
  RowBox[{
  "b2", "\[CircleTimes]", "b3", "\[CircleTimes]", "a2", "\[CircleTimes]", 
   "a3"}]}]], "Output",
 CellChangeTimes->{
  3.478712542321618*^9, {3.478712908408585*^9, 3.47871294753567*^9}, 
   3.478713212768693*^9, 3.478713245004771*^9, 3.478713432708729*^9, 
   3.478713515548508*^9, 3.478713627576997*^9, 3.478713730296814*^9, 
   3.478714077040328*^9, 3.478714996119923*^9, 3.478717210351562*^9, 
   3.478797363596096*^9, 3.478806378783657*^9, 3.478806944258501*^9, 
   3.478860373319091*^9, 3.478865785925978*^9, 3.478877245141698*^9, 
   3.478931078769544*^9, 3.478973092365045*^9, 3.479020090017297*^9, 
   3.479024524261106*^9, 3.479046992943892*^9, 3.47905458300411*^9, 
   3.47910367540748*^9, 3.479112701039324*^9, 3.479148911221959*^9, 
   3.479189613934828*^9, 3.479201572779746*^9, 3.479225803876946*^9, 
   3.479299433978653*^9, 3.479324886462104*^9, 3.479326921946436*^9, 
   3.479358953128906*^9, 3.479454102885436*^9, 3.479919165281301*^9, 
   3.480327937912575*^9, 3.480328343449685*^9, 3.480333483221357*^9, 
   3.480333979910086*^9, 3.480334706173668*^9, 3.480661313717154*^9, 
   3.480661699222722*^9, 3.480662413108255*^9, 3.518081134309325*^9, 
   3.613716844398032*^9, 3.6137185488979816`*^9, 3.61430301918182*^9}],

Cell[BoxData[
 RowBox[{"b2", "\[CircleTimes]", "b3", "\[CircleTimes]", "a1", 
  "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"rev", "[", "a2", "]"}], ",", "b1"}], "\[RightAngleBracket]"}], 
  "\[CircleTimes]", "a3"}]], "Output",
 CellChangeTimes->{
  3.478712542321618*^9, {3.478712908408585*^9, 3.47871294753567*^9}, 
   3.478713212768693*^9, 3.478713245004771*^9, 3.478713432708729*^9, 
   3.478713515548508*^9, 3.478713627576997*^9, 3.478713730296814*^9, 
   3.478714077040328*^9, 3.478714996119923*^9, 3.478717210351562*^9, 
   3.478797363596096*^9, 3.478806378783657*^9, 3.478806944258501*^9, 
   3.478860373319091*^9, 3.478865785925978*^9, 3.478877245141698*^9, 
   3.478931078769544*^9, 3.478973092365045*^9, 3.479020090017297*^9, 
   3.479024524261106*^9, 3.479046992943892*^9, 3.47905458300411*^9, 
   3.47910367540748*^9, 3.479112701039324*^9, 3.479148911221959*^9, 
   3.479189613934828*^9, 3.479201572779746*^9, 3.479225803876946*^9, 
   3.479299433978653*^9, 3.479324886462104*^9, 3.479326921946436*^9, 
   3.479358953128906*^9, 3.479454102885436*^9, 3.479919165281301*^9, 
   3.480327937912575*^9, 3.480328343449685*^9, 3.480333483221357*^9, 
   3.480333979910086*^9, 3.480334706173668*^9, 3.480661313717154*^9, 
   3.480661699222722*^9, 3.480662413108255*^9, 3.518081134309325*^9, 
   3.613716844398032*^9, 3.6137185488979816`*^9, 3.614303019185389*^9}],

Cell[BoxData[
 RowBox[{"b2", "\[CircleTimes]", "b3", "\[CircleTimes]", "a1", 
  "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"a2", ",", "b1"}], "\[RightAngleBracket]"}], "\[CircleTimes]", 
  "a3"}]], "Output",
 CellChangeTimes->{
  3.478712542321618*^9, {3.478712908408585*^9, 3.47871294753567*^9}, 
   3.478713212768693*^9, 3.478713245004771*^9, 3.478713432708729*^9, 
   3.478713515548508*^9, 3.478713627576997*^9, 3.478713730296814*^9, 
   3.478714077040328*^9, 3.478714996119923*^9, 3.478717210351562*^9, 
   3.478797363596096*^9, 3.478806378783657*^9, 3.478806944258501*^9, 
   3.478860373319091*^9, 3.478865785925978*^9, 3.478877245141698*^9, 
   3.478931078769544*^9, 3.478973092365045*^9, 3.479020090017297*^9, 
   3.479024524261106*^9, 3.479046992943892*^9, 3.47905458300411*^9, 
   3.47910367540748*^9, 3.479112701039324*^9, 3.479148911221959*^9, 
   3.479189613934828*^9, 3.479201572779746*^9, 3.479225803876946*^9, 
   3.479299433978653*^9, 3.479324886462104*^9, 3.479326921946436*^9, 
   3.479358953128906*^9, 3.479454102885436*^9, 3.479919165281301*^9, 
   3.480327937912575*^9, 3.480328343449685*^9, 3.480333483221357*^9, 
   3.480333979910086*^9, 3.480334706173668*^9, 3.480661313717154*^9, 
   3.480661699222722*^9, 3.480662413108255*^9, 3.518081134309325*^9, 
   3.613716844398032*^9, 3.6137185488979816`*^9, 3.6143030191890717`*^9}],

Cell[BoxData[
 RowBox[{"b2", "\[CircleTimes]", "b3", "\[CircleTimes]", "a1", 
  "\[CircleTimes]", "a2", "\[CircleTimes]", 
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"b1", ",", "a3"}], "\[RightAngleBracket]"}]}]], "Output",
 CellChangeTimes->{
  3.478712542321618*^9, {3.478712908408585*^9, 3.47871294753567*^9}, 
   3.478713212768693*^9, 3.478713245004771*^9, 3.478713432708729*^9, 
   3.478713515548508*^9, 3.478713627576997*^9, 3.478713730296814*^9, 
   3.478714077040328*^9, 3.478714996119923*^9, 3.478717210351562*^9, 
   3.478797363596096*^9, 3.478806378783657*^9, 3.478806944258501*^9, 
   3.478860373319091*^9, 3.478865785925978*^9, 3.478877245141698*^9, 
   3.478931078769544*^9, 3.478973092365045*^9, 3.479020090017297*^9, 
   3.479024524261106*^9, 3.479046992943892*^9, 3.47905458300411*^9, 
   3.47910367540748*^9, 3.479112701039324*^9, 3.479148911221959*^9, 
   3.479189613934828*^9, 3.479201572779746*^9, 3.479225803876946*^9, 
   3.479299433978653*^9, 3.479324886462104*^9, 3.479326921946436*^9, 
   3.479358953128906*^9, 3.479454102885436*^9, 3.479919165281301*^9, 
   3.480327937912575*^9, 3.480328343449685*^9, 3.480333483221357*^9, 
   3.480333979910086*^9, 3.480334706173668*^9, 3.480661313717154*^9, 
   3.480661699222722*^9, 3.480662413108255*^9, 3.518081134309325*^9, 
   3.613716844398032*^9, 3.6137185488979816`*^9, 3.614303019192528*^9}],

Cell[BoxData[
 RowBox[{"b2", "\[CircleTimes]", "b3", "\[CircleTimes]", "a1", 
  "\[CircleTimes]", "a2", "\[CircleTimes]", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"a3", "\[CircleTimes]", "b1"}], "\[RightAngleBracket]"}], 
   RowBox[{"2", ",", "4"}]]}]], "Output",
 CellChangeTimes->{
  3.478712542321618*^9, {3.478712908408585*^9, 3.47871294753567*^9}, 
   3.478713212768693*^9, 3.478713245004771*^9, 3.478713432708729*^9, 
   3.478713515548508*^9, 3.478713627576997*^9, 3.478713730296814*^9, 
   3.478714077040328*^9, 3.478714996119923*^9, 3.478717210351562*^9, 
   3.478797363596096*^9, 3.478806378783657*^9, 3.478806944258501*^9, 
   3.478860373319091*^9, 3.478865785925978*^9, 3.478877245141698*^9, 
   3.478931078769544*^9, 3.478973092365045*^9, 3.479020090017297*^9, 
   3.479024524261106*^9, 3.479046992943892*^9, 3.47905458300411*^9, 
   3.47910367540748*^9, 3.479112701039324*^9, 3.479148911221959*^9, 
   3.479189613934828*^9, 3.479201572779746*^9, 3.479225803876946*^9, 
   3.479299433978653*^9, 3.479324886462104*^9, 3.479326921946436*^9, 
   3.479358953128906*^9, 3.479454102885436*^9, 3.479919165281301*^9, 
   3.480327937912575*^9, 3.480328343449685*^9, 3.480333483221357*^9, 
   3.480333979910086*^9, 3.480334706173668*^9, 3.480661313717154*^9, 
   3.480661699222722*^9, 3.480662413108255*^9, 3.518081134309325*^9, 
   3.613716844398032*^9, 3.6137185488979816`*^9, 3.614303019195966*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
    RowBox[{"rev", "[", "b2", "]"}], ",", "b1"}], "\[RightAngleBracket]"}], 
  "\[CircleTimes]", "b3", "\[CircleTimes]", "a1", "\[CircleTimes]", "a2", 
  "\[CircleTimes]", "a3"}]], "Output",
 CellChangeTimes->{
  3.478712542321618*^9, {3.478712908408585*^9, 3.47871294753567*^9}, 
   3.478713212768693*^9, 3.478713245004771*^9, 3.478713432708729*^9, 
   3.478713515548508*^9, 3.478713627576997*^9, 3.478713730296814*^9, 
   3.478714077040328*^9, 3.478714996119923*^9, 3.478717210351562*^9, 
   3.478797363596096*^9, 3.478806378783657*^9, 3.478806944258501*^9, 
   3.478860373319091*^9, 3.478865785925978*^9, 3.478877245141698*^9, 
   3.478931078769544*^9, 3.478973092365045*^9, 3.479020090017297*^9, 
   3.479024524261106*^9, 3.479046992943892*^9, 3.47905458300411*^9, 
   3.47910367540748*^9, 3.479112701039324*^9, 3.479148911221959*^9, 
   3.479189613934828*^9, 3.479201572779746*^9, 3.479225803876946*^9, 
   3.479299433978653*^9, 3.479324886462104*^9, 3.479326921946436*^9, 
   3.479358953128906*^9, 3.479454102885436*^9, 3.479919165281301*^9, 
   3.480327937912575*^9, 3.480328343449685*^9, 3.480333483221357*^9, 
   3.480333979910086*^9, 3.480334706173668*^9, 3.480661313717154*^9, 
   3.480661699222722*^9, 3.480662413108255*^9, 3.518081134309325*^9, 
   3.613716844398032*^9, 3.6137185488979816`*^9, 3.614303019199394*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[LeftAngleBracket]\"\>", "\[InvisibleSpace]", 
   RowBox[{
   "b1", "\[CircleTimes]", "b2", "\[CircleTimes]", "b3", "\[CircleTimes]", 
    "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[InvisibleSpace]", 
   SubscriptBox["\<\"\[RightAngleBracket]\"\>", 
    RowBox[{"2", ",", "2"}]], 
   "\[InvisibleSpace]", "\<\"  \[LongLeftArrow] Contraction slots must \
differ.\"\>"}],
  SequenceForm["\[LeftAngleBracket]", 
   CircleTimes[$CellContext`b1, $CellContext`b2, $CellContext`b3, \
$CellContext`a1, $CellContext`a2, $CellContext`a3], 
   Subscript["\[RightAngleBracket]", 2, 2], 
   "  \[LongLeftArrow] Contraction slots must differ."],
  Editable->False]], "Print",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQBuJHbY7dcq9fOh6LnzUVRPs7rFwMol+sDd8Aoq/uW3Ub
RNtN2esnD6SNrCYlKwDprY732tyB9B776rfeQLrlmKKJD5DetHqLVxqQbg3y
eJ8BpHnfrmnPA9Lxr99d6ADSJQ4LQuYC6YAPvu5bgHRc8pTCbUB6b7xW1kEg
PX3HG7mjQNrFuEP8LpBenbum/iFI39a/up+B9KHX13nZ37x0PH59zRMeIH2/
dtZOCSBdOz9srQ2Qzn36UsoTSEcGhkl6Aem4ndZ7I4G0fcRHow4g3Wp40D37
7UvH+VF+D4zevXRk6PslZAykRb+UTTUF0m7BnZdBNOPFAD0zIH2x3XHFVSD9
NrzoBogOlF9neA1Ii1Ve5TU1e+VY3tSrO+/NK8f+w3OZ5gPpTY1pqXvevnIE
ALmuxJM=
  "]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.478712542321618*^9, {3.478712908408585*^9, 3.47871294753567*^9}, 
   3.478713212768693*^9, 3.478713245004771*^9, 3.478713432708729*^9, 
   3.478713515548508*^9, 3.478713627576997*^9, 3.478713730296814*^9, 
   3.478714077040328*^9, 3.478714996119923*^9, 3.478717210351562*^9, 
   3.478797363596096*^9, 3.478806378783657*^9, 3.478806944258501*^9, 
   3.478860373319091*^9, 3.478865785925978*^9, 3.478877245141698*^9, 
   3.478931078769544*^9, 3.478973092365045*^9, 3.479020090017297*^9, 
   3.479024524261106*^9, 3.479046992943892*^9, 3.47905458300411*^9, 
   3.47910367540748*^9, 3.479112701039324*^9, 3.479148911221959*^9, 
   3.479189613934828*^9, 3.479201572779746*^9, 3.479225803876946*^9, 
   3.479299433978653*^9, 3.479324886462104*^9, 3.479326921946436*^9, 
   3.479358953128906*^9, 3.479454102885436*^9, 3.479919165281301*^9, 
   3.480327937912575*^9, 3.480328343449685*^9, 3.480333483221357*^9, 
   3.480333979910086*^9, 3.480334706173668*^9, 3.480661313717154*^9, 
   3.480661699222722*^9, 3.480662413108255*^9, 3.518081134309325*^9, 
   3.613716844398032*^9, 3.6137185488979816`*^9, 3.6143030192073812`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "b1", "\[CircleTimes]", "b3", "\[CircleTimes]", "a1", "\[CircleTimes]", 
   "a2", "\[CircleTimes]", "a3"}], " ", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", "b2", "\[RightAngleBracket]"}], 
   RowBox[{"1", ",", "2"}]]}]], "Output",
 CellChangeTimes->{
  3.478712542321618*^9, {3.478712908408585*^9, 3.47871294753567*^9}, 
   3.478713212768693*^9, 3.478713245004771*^9, 3.478713432708729*^9, 
   3.478713515548508*^9, 3.478713627576997*^9, 3.478713730296814*^9, 
   3.478714077040328*^9, 3.478714996119923*^9, 3.478717210351562*^9, 
   3.478797363596096*^9, 3.478806378783657*^9, 3.478806944258501*^9, 
   3.478860373319091*^9, 3.478865785925978*^9, 3.478877245141698*^9, 
   3.478931078769544*^9, 3.478973092365045*^9, 3.479020090017297*^9, 
   3.479024524261106*^9, 3.479046992943892*^9, 3.47905458300411*^9, 
   3.47910367540748*^9, 3.479112701039324*^9, 3.479148911221959*^9, 
   3.479189613934828*^9, 3.479201572779746*^9, 3.479225803876946*^9, 
   3.479299433978653*^9, 3.479324886462104*^9, 3.479326921946436*^9, 
   3.479358953128906*^9, 3.479454102885436*^9, 3.479919165281301*^9, 
   3.480327937912575*^9, 3.480328343449685*^9, 3.480333483221357*^9, 
   3.480333979910086*^9, 3.480334706173668*^9, 3.480661313717154*^9, 
   3.480661699222722*^9, 3.480662413108255*^9, 3.518081134309325*^9, 
   3.613716844398032*^9, 3.6137185488979816`*^9, 3.6143030192109127`*^9}],

Cell[BoxData[
 RowBox[{"b1", "\[CircleTimes]", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"b2", "\[CircleTimes]", "b3"}], "\[RightAngleBracket]"}], 
   RowBox[{"1", ",", "3"}]], "\[CircleTimes]", "a1", "\[CircleTimes]", "a2", 
  "\[CircleTimes]", "a3"}]], "Output",
 CellChangeTimes->{
  3.478712542321618*^9, {3.478712908408585*^9, 3.47871294753567*^9}, 
   3.478713212768693*^9, 3.478713245004771*^9, 3.478713432708729*^9, 
   3.478713515548508*^9, 3.478713627576997*^9, 3.478713730296814*^9, 
   3.478714077040328*^9, 3.478714996119923*^9, 3.478717210351562*^9, 
   3.478797363596096*^9, 3.478806378783657*^9, 3.478806944258501*^9, 
   3.478860373319091*^9, 3.478865785925978*^9, 3.478877245141698*^9, 
   3.478931078769544*^9, 3.478973092365045*^9, 3.479020090017297*^9, 
   3.479024524261106*^9, 3.479046992943892*^9, 3.47905458300411*^9, 
   3.47910367540748*^9, 3.479112701039324*^9, 3.479148911221959*^9, 
   3.479189613934828*^9, 3.479201572779746*^9, 3.479225803876946*^9, 
   3.479299433978653*^9, 3.479324886462104*^9, 3.479326921946436*^9, 
   3.479358953128906*^9, 3.479454102885436*^9, 3.479919165281301*^9, 
   3.480327937912575*^9, 3.480328343449685*^9, 3.480333483221357*^9, 
   3.480333979910086*^9, 3.480334706173668*^9, 3.480661313717154*^9, 
   3.480661699222722*^9, 3.480662413108255*^9, 3.518081134309325*^9, 
   3.613716844398032*^9, 3.6137185488979816`*^9, 3.614303019214738*^9}],

Cell[BoxData[
 RowBox[{"b1", "\[CircleTimes]", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"b2", "\[CircleTimes]", "b3"}], "\[RightAngleBracket]"}], 
   RowBox[{"1", ",", "4"}]], "\[CircleTimes]", "a1", "\[CircleTimes]", "a2", 
  "\[CircleTimes]", "a3"}]], "Output",
 CellChangeTimes->{
  3.478712542321618*^9, {3.478712908408585*^9, 3.47871294753567*^9}, 
   3.478713212768693*^9, 3.478713245004771*^9, 3.478713432708729*^9, 
   3.478713515548508*^9, 3.478713627576997*^9, 3.478713730296814*^9, 
   3.478714077040328*^9, 3.478714996119923*^9, 3.478717210351562*^9, 
   3.478797363596096*^9, 3.478806378783657*^9, 3.478806944258501*^9, 
   3.478860373319091*^9, 3.478865785925978*^9, 3.478877245141698*^9, 
   3.478931078769544*^9, 3.478973092365045*^9, 3.479020090017297*^9, 
   3.479024524261106*^9, 3.479046992943892*^9, 3.47905458300411*^9, 
   3.47910367540748*^9, 3.479112701039324*^9, 3.479148911221959*^9, 
   3.479189613934828*^9, 3.479201572779746*^9, 3.479225803876946*^9, 
   3.479299433978653*^9, 3.479324886462104*^9, 3.479326921946436*^9, 
   3.479358953128906*^9, 3.479454102885436*^9, 3.479919165281301*^9, 
   3.480327937912575*^9, 3.480328343449685*^9, 3.480333483221357*^9, 
   3.480333979910086*^9, 3.480334706173668*^9, 3.480661313717154*^9, 
   3.480661699222722*^9, 3.480662413108255*^9, 3.518081134309325*^9, 
   3.613716844398032*^9, 3.6137185488979816`*^9, 3.614303019218319*^9}],

Cell[BoxData[
 RowBox[{"b1", "\[CircleTimes]", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"b2", "\[CircleTimes]", "b3"}], "\[RightAngleBracket]"}], 
   RowBox[{"1", ",", "5"}]], "\[CircleTimes]", "a1", "\[CircleTimes]", "a2", 
  "\[CircleTimes]", "a3"}]], "Output",
 CellChangeTimes->{
  3.478712542321618*^9, {3.478712908408585*^9, 3.47871294753567*^9}, 
   3.478713212768693*^9, 3.478713245004771*^9, 3.478713432708729*^9, 
   3.478713515548508*^9, 3.478713627576997*^9, 3.478713730296814*^9, 
   3.478714077040328*^9, 3.478714996119923*^9, 3.478717210351562*^9, 
   3.478797363596096*^9, 3.478806378783657*^9, 3.478806944258501*^9, 
   3.478860373319091*^9, 3.478865785925978*^9, 3.478877245141698*^9, 
   3.478931078769544*^9, 3.478973092365045*^9, 3.479020090017297*^9, 
   3.479024524261106*^9, 3.479046992943892*^9, 3.47905458300411*^9, 
   3.47910367540748*^9, 3.479112701039324*^9, 3.479148911221959*^9, 
   3.479189613934828*^9, 3.479201572779746*^9, 3.479225803876946*^9, 
   3.479299433978653*^9, 3.479324886462104*^9, 3.479326921946436*^9, 
   3.479358953128906*^9, 3.479454102885436*^9, 3.479919165281301*^9, 
   3.480327937912575*^9, 3.480328343449685*^9, 3.480333483221357*^9, 
   3.480333979910086*^9, 3.480334706173668*^9, 3.480661313717154*^9, 
   3.480661699222722*^9, 3.480662413108255*^9, 3.518081134309325*^9, 
   3.613716844398032*^9, 3.6137185488979816`*^9, 3.61430301922184*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"deg", "[", "b4", "]"}], "=", "4"}], ";"}]], "Input",
 CellChangeTimes->{{3.478797761962152*^9, 3.478797772458724*^9}, 
   3.479721990005664*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"deg", "[", "b2", "]"}]], "Input",
 CellChangeTimes->{{3.478797796119135*^9, 3.478797800500991*^9}, 
   3.479721990055765*^9}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.478797797381857*^9, 3.478797801136241*^9}, 
   3.478806945462684*^9, 3.478860373763539*^9, 3.478877245544117*^9, 
   3.478931079950076*^9, 3.478973093331696*^9, 3.479020090716056*^9, 
   3.479024524857269*^9, 3.479046993629607*^9, 3.479054583700191*^9, 
   3.479103676519484*^9, 3.47911270162759*^9, 3.479148912320823*^9, 
   3.479189615235149*^9, 3.479201573939596*^9, 3.479225805076538*^9, 
   3.479299435206493*^9, 3.479324887598939*^9, 3.479326923098595*^9, 
   3.479358954268649*^9, 3.479454103952496*^9, 3.479919166438817*^9, 
   3.480327944385062*^9, 3.480328344073918*^9, 3.480333483994043*^9, 
   3.480333980741535*^9, 3.480334706808246*^9, 3.480661314236832*^9, 
   3.480661699723294*^9, 3.480662413658542*^9, 3.5180811348027897`*^9, 
   3.6137168444705677`*^9, 3.613718548985668*^9, 3.614303019310894*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"b1", "\[CircleTimes]", "b2", "\[CircleTimes]", "b4"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"4", ",", "7"}]]], "Input",
 CellChangeTimes->{{3.478797637727507*^9, 3.47879770879271*^9}, 
   3.47879777833861*^9, {3.478797833583872*^9, 3.478797861224659*^9}, 
   3.480327146972314*^9, 3.480327341736086*^9, 3.480327404631934*^9, {
   3.480327952913675*^9, 3.48032795668938*^9}}],

Cell[BoxData[
 RowBox[{"b1", "\[CircleTimes]", "b2", "\[CircleTimes]", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", "b4", "\[RightAngleBracket]"}], 
   RowBox[{"1", ",", "4"}]]}]], "Output",
 CellChangeTimes->{
  3.478797585707375*^9, {3.478797642222572*^9, 3.478797709357577*^9}, 
   3.478797775725392*^9, {3.47879783448222*^9, 3.478797861676329*^9}, 
   3.478806406506452*^9, 3.478806945476551*^9, 3.478860373768501*^9, 
   3.478877245610375*^9, 3.478931079964132*^9, 3.478973093444019*^9, 
   3.479020090721984*^9, 3.479024524908592*^9, 3.479046993634168*^9, 
   3.479054583749442*^9, 3.479103676624192*^9, 3.479112701632091*^9, 
   3.479148912426234*^9, 3.479189615352168*^9, 3.479201574021863*^9, 
   3.479225805093213*^9, 3.479299435221667*^9, 3.479324887771353*^9, 
   3.479326923115317*^9, 3.479358954284322*^9, 3.479454103970963*^9, 
   3.479919166456025*^9, 3.480327957554191*^9, 3.480328344079915*^9, 
   3.48033348400098*^9, 3.480333980940415*^9, 3.480334706816804*^9, 
   3.480661314241146*^9, 3.4806616997274*^9, 3.480662413663153*^9, 
   3.5180811348085737`*^9, 3.6137168445411377`*^9, 3.613718548993548*^9, 
   3.614303019389907*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"b1", "\[CircleTimes]", "b4", "\[CircleTimes]", "b3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "7"}]]], "Input",
 CellChangeTimes->{{3.478797901719612*^9, 3.47879798473449*^9}, 
   3.480327147491851*^9, 3.480327342471661*^9, 3.480327405095536*^9, {
   3.480327960697735*^9, 3.480327968373096*^9}}],

Cell[BoxData[
 RowBox[{"b4", "\[CircleTimes]", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"b3", "\[CircleTimes]", "b1"}], "\[RightAngleBracket]"}], 
   RowBox[{"2", ",", "4"}]]}]], "Output",
 CellChangeTimes->{{3.478797894735054*^9, 3.478797986202793*^9}, 
   3.478806408793533*^9, 3.478806945490697*^9, 3.478860373773148*^9, 
   3.478877245708414*^9, 3.478931080071761*^9, 3.478973093462253*^9, 
   3.479020090728266*^9, 3.479024524964595*^9, 3.479046993638723*^9, 
   3.479054583798949*^9, 3.479103676638554*^9, 3.479112701636541*^9, 
   3.479148912442907*^9, 3.4791896153695*^9, 3.479201574037493*^9, 
   3.479225805191913*^9, 3.479299435331604*^9, 3.479324887787627*^9, 
   3.479326923228294*^9, 3.479358954393412*^9, 3.479454104090401*^9, 
   3.479919166570364*^9, 3.480327965892815*^9, 3.480328344085793*^9, 
   3.480333484007983*^9, 3.480333981022789*^9, 3.480334706825416*^9, 
   3.480661314245349*^9, 3.480661699731482*^9, 3.480662413667261*^9, 
   3.518081134814085*^9, 3.613716844577094*^9, 3.613718549001318*^9, 
   3.614303019463768*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"b1", "\[CircleTimes]", "b4"}], "\[RightAngleBracket]"}], 
  RowBox[{"1", ",", "4"}]]], "Input",
 CellChangeTimes->{{3.478798124786462*^9, 3.478798130991751*^9}, {
   3.478798213317982*^9, 3.478798272371724*^9}, 3.478806454962338*^9, 
   3.480327147971781*^9, 3.480327343167419*^9, 3.480327405679628*^9, {
   3.480327973081271*^9, 3.480327975969067*^9}}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"b4", "\[CircleTimes]", "b1"}], "\[RightAngleBracket]"}], 
  RowBox[{"3", ",", "5"}]]], "Output",
 CellChangeTimes->{3.478806410710271*^9, 3.478806457167666*^9, 
  3.478806544162221*^9, 3.478806945603244*^9, 3.478860373832308*^9, 
  3.478877245716193*^9, 3.478931080090056*^9, 3.478973093476425*^9, 
  3.479020090733829*^9, 3.479024525023221*^9, 3.479046993643193*^9, 
  3.479054583848398*^9, 3.479103676652859*^9, 3.479112701640879*^9, 
  3.479148912458041*^9, 3.479189615387087*^9, 3.479201574052787*^9, 
  3.479225805291668*^9, 3.479299435347313*^9, 3.479324887803758*^9, 
  3.479326923244966*^9, 3.479358954410304*^9, 3.479454104107545*^9, 
  3.479919166586379*^9, 3.480327976953038*^9, 3.4803283440916*^9, 
  3.480333484014946*^9, 3.480333981095518*^9, 3.480334706833979*^9, 
  3.480661314297157*^9, 3.480661699735529*^9, 3.480662413671345*^9, 
  3.518081134847835*^9, 3.6137168446499157`*^9, 3.613718549009313*^9, 
  3.614303019539138*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{"b4", "\[CircleTimes]", "b1"}], "\[RightAngleBracket]"}], 
  RowBox[{"4", ",", "5"}]]], "Input",
 CellChangeTimes->{{3.478798280467006*^9, 3.478798303724759*^9}, 
   3.48032714841155*^9, 3.480327343759692*^9, 3.480327406079493*^9, {
   3.480327980033588*^9, 3.480327985132487*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAngleBracket]", 
  RowBox[{"b4", ",", "b1"}], "\[RightAngleBracket]"}]], "Output",
 CellChangeTimes->{
  3.478798132766668*^9, {3.478798214816637*^9, 3.478798304323517*^9}, 
   3.478806557962252*^9, 3.478806945620685*^9, 3.4788603738401*^9, 
   3.478877245722957*^9, 3.478931080192803*^9, 3.478973093592186*^9, 
   3.479020090792177*^9, 3.479024525124348*^9, 3.479046993647657*^9, 
   3.479054583896764*^9, 3.47910367666684*^9, 3.479112701684582*^9, 
   3.479148912473371*^9, 3.479189615519898*^9, 3.479201574068154*^9, 
   3.479225805487634*^9, 3.479299435362025*^9, 3.479324887819592*^9, 
   3.479326923264589*^9, 3.479358954426923*^9, 3.47945410412452*^9, 
   3.479919166600678*^9, 3.480327983528902*^9, 3.480328344171256*^9, 
   3.480333484091416*^9, 3.480333981102731*^9, 3.480334706928727*^9, 
   3.480661314301434*^9, 3.480661699785402*^9, 3.48066241372437*^9, 
   3.51808113485357*^9, 3.613716844687543*^9, 3.613718549017015*^9, 
   3.614303019626771*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   RowBox[{
   "b1", "\[CircleTimes]", "b2", "\[CircleTimes]", "b3", "\[CircleTimes]", 
    "a1", "\[CircleTimes]", "a2", "\[CircleTimes]", "a3"}], 
   "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "4"}]]], "Input",
 CellChangeTimes->{
  3.478797321676679*^9, 3.480327150276598*^9, 3.480327345055865*^9, 
   3.480327406936035*^9, {3.480327989225117*^9, 3.480327991881452*^9}}],

Cell[BoxData[
 RowBox[{"b1", "\[CircleTimes]", 
  SubscriptBox[
   RowBox[{"\[LeftAngleBracket]", 
    RowBox[{"b2", "\[CircleTimes]", "b3"}], "\[RightAngleBracket]"}], 
   RowBox[{"1", ",", "3"}]], "\[CircleTimes]", "a1", "\[CircleTimes]", "a2", 
  "\[CircleTimes]", "a3"}]], "Output",
 CellChangeTimes->{3.478797410478551*^9, 3.478806562202849*^9, 
  3.478806945784753*^9, 3.47886037392698*^9, 3.478877245826279*^9, 
  3.478931080312867*^9, 3.478973093722149*^9, 3.479020090937022*^9, 
  3.479024525170819*^9, 3.47904699372063*^9, 3.479054583973341*^9, 
  3.47910367678334*^9, 3.479112701728319*^9, 3.479148912630954*^9, 
  3.479189615663598*^9, 3.479201574249619*^9, 3.479225805606025*^9, 
  3.479299435523124*^9, 3.479324887922287*^9, 3.47932692342854*^9, 
  3.47935895455665*^9, 3.479454104302413*^9, 3.479919166763987*^9, 
  3.480327992893189*^9, 3.480328344244158*^9, 3.48033348416772*^9, 
  3.480333981177793*^9, 3.48033470713891*^9, 3.480335334355951*^9, 
  3.480661314353136*^9, 3.480661699836727*^9, 3.480662413782046*^9, 
  3.518081134888496*^9, 3.613716844730328*^9, 3.613718549061551*^9, 
  3.614303019706378*^9}]
}, Closed]],

Cell[TextData[{
 "Nested slot-products are still a mess.  They should be expanded to enclose \
whole terms (I've done it backwards!!) and then the positions could be\n\
combined in a multi-slot-product  \[LeftAngleBracket] X ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[RightAngleBracket]", 
    RowBox[{"a1", ",", "b1", ",", " ", "a2", ",", "b2", ",", " ", "..."}]], 
   TraditionalForm]]],
 "  so that the user can count properly (not having to skip deleted pairs), \
and so that the position\npairs can be sorted into a canonical order.  That \
is how it should stay until a vector pair can be pulled out as a scalar \
slot-product.\n\nAn example of getting stuck if the brackets are around the \
wrong way:\nThe  {2,5}  could have been evaluated as a scalar  {3,6},  if it \
had been done first..."
}], "Text",
 CellChangeTimes->{{3.479045409757628*^9, 3.479045782216395*^9}, {
  3.47904584262782*^9, 3.479046056734394*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
     "c2", "\[CircleTimes]", "b1", "\[CircleTimes]", "b2", "\[CircleTimes]", 
      "c1", "\[CircleTimes]", "a2"}], "\[RightAngleBracket]"}], 
    RowBox[{"2", ",", "7"}]], "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "5"}]]], "Input",
 CellChangeTimes->{{3.479044782309101*^9, 3.479044816050037*^9}, {
  3.479045039927469*^9, 3.479045089448749*^9}, {3.47904512672886*^9, 
  3.479045187599796*^9}, {3.479045249600172*^9, 3.47904527126331*^9}, {
  3.479045327202708*^9, 3.479045345862676*^9}}],

Cell[BoxData[
 SubscriptBox[
  RowBox[{"\[LeftAngleBracket]", 
   SubscriptBox[
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{
     "c2", "\[CircleTimes]", "b1", "\[CircleTimes]", "b2", "\[CircleTimes]", 
      "c1", "\[CircleTimes]", "a2"}], "\[RightAngleBracket]"}], 
    RowBox[{"2", ",", "7"}]], "\[RightAngleBracket]"}], 
  RowBox[{"2", ",", "5"}]]], "Output",
 CellChangeTimes->{{3.479045328112684*^9, 3.47904534670163*^9}, 
   3.479046990232002*^9, 3.479054581662404*^9, 3.479103672353867*^9, 
   3.479112700405425*^9, 3.479148909122636*^9, 3.479189608985161*^9, 
   3.479201563629891*^9, 3.479225800247765*^9, 3.479299431873668*^9, 
   3.479324881806715*^9, 3.479326919843269*^9, 3.47935895104654*^9, 
   3.479454099522204*^9, 3.479919163310297*^9, 3.480325622040474*^9, 
   3.480328342229506*^9, 3.480333481631741*^9, 3.480333978788598*^9, 
   3.480334704273596*^9, 3.480335325793311*^9, 3.480661314410005*^9, 
   3.480661699892406*^9, 3.480662413846608*^9, 3.518081134922933*^9, 
   3.613716844809073*^9, 3.613718549069662*^9, 3.614302698544443*^9, 
   3.6143030264157963`*^9}]
}, Closed]],

Cell[BoxData[
 RowBox[{"ClearField", "[", 
  RowBox[{"{", 
   RowBox[{
   "a0", ",", "a1", ",", "a2", ",", "a3", ",", "b0", ",", "b1", ",", "b2", 
    ",", "b3", ",", "c0", ",", "c1", ",", "c2", ",", "c3"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.614302758200453*^9, 3.614302817091955*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "Subsection",
 CellChangeTimes->{{3.478784599907823*^9, 3.478784644560371*^9}, {
   3.47879586709443*^9, 3.478795867413355*^9}, {3.480396747732327*^9, 
   3.480396751587948*^9}, 3.655258475667034*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"TrueQ", "[", "$PrintDebugLocation", "]"}], ",", 
    RowBox[{"Print", "[", "\"\<End of Part1\>\"", "]"}]}], "]"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SaveInitTime", "[", "]"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.655258480662313*^9, 3.655258485506802*^9}, {
   3.6556613160909653`*^9, 3.655661321978612*^9}, {3.655661477528702*^9, 
   3.6556614894484367`*^9}, 3.656171046143669*^9, 3.656185384449448*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1883, 1270},
WindowMargins->{{272, Automatic}, {53, Automatic}},
Magnification:>1.25 Inherited,
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info3615308618-6396053"->{
  Cell[556981, 15352, 3523, 49, 31283, "Print",
   CellTags->"Info3615308618-6396053"],
  Cell[560637, 15410, 1181, 17, 10257, "Print",
   CellTags->"Info3615308618-6396053"]},
 "Info3654025352-1410783"->{
  Cell[146656, 4120, 3245, 47, 3103, "Print",
   CellGroupingRules->{GroupTogetherGrouping, 10000.},
   CellTags->"Info3654025352-1410783"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info3615308618-6396053", 1870124, 50387},
 {"Info3654025352-1410783", 1870330, 50392}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 249, 5, 121, "Input"],
Cell[832, 29, 56, 0, 38, "Output"],
Cell[891, 31, 58, 0, 38, "Output"],
Cell[952, 33, 50, 0, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1039, 38, 58, 1, 39, "Input"],
Cell[1100, 41, 50, 0, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1187, 46, 58, 0, 81, "Section"],
Cell[CellGroupData[{
Cell[1270, 50, 524, 7, 56, "Subsection"],
Cell[1797, 59, 704, 13, 1002750, "Text"],
Cell[2504, 74, 183, 4, 273588, "Input",
 InitializationCell->True],
Cell[2690, 80, 184, 4, 273588, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2911, 89, 612, 8, 45, "Subsection"],
Cell[CellGroupData[{
Cell[3548, 101, 211, 2, 44, "Subsubsection"],
Cell[3762, 105, 2416, 56, 2714750, "Input",
 InitializationCell->True],
Cell[6181, 163, 285, 6, 427481, "Text"],
Cell[6469, 171, 306, 6, 427481, "Text"],
Cell[6778, 179, 4118, 86, 3699252, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[10921, 269, 615, 14, 534351, "Input"],
Cell[CellGroupData[{
Cell[11561, 287, 1016, 19, 308046, "Print"],
Cell[12580, 308, 558, 8, 308046, "Print"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[13199, 323, 192, 2, 35, "Subsubsection"],
Cell[13394, 327, 1403, 31, 3047832, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[14822, 362, 334, 7, 1111962, "Input"],
Cell[CellGroupData[{
Cell[15181, 373, 125, 1, 308046, "Print"],
Cell[15309, 376, 136, 4, 308046, "Print"],
Cell[15448, 382, 150, 2, 308046, "Print"],
Cell[15601, 386, 108, 2, 308046, "Print"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[15770, 395, 165, 2, 35, "Subsubsection"],
Cell[15938, 399, 373, 6, 273588, "Text"],
Cell[16314, 407, 1533, 42, 847125, "Input",
 InitializationCell->True],
Cell[17850, 451, 6580, 186, 840908, "Input"],
Cell[CellGroupData[{
Cell[24455, 641, 202, 5, 273588, "Input"],
Cell[24660, 648, 4879, 136, 600571, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29576, 789, 263, 7, 273588, "Input"],
Cell[29842, 798, 4763, 133, 600571, "Output"]
}, Open  ]],
Cell[34620, 934, 170, 2, 273588, "Text"],
Cell[34793, 938, 371, 10, 322707, "Input",
 InitializationCell->True],
Cell[35167, 950, 184, 2, 273588, "Text"],
Cell[CellGroupData[{
Cell[35376, 956, 63, 1, 273588, "Input"],
Cell[35442, 959, 5022, 140, 600571, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[40513, 1105, 317, 4, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[40855, 1113, 245, 3, 88, "Item",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[41103, 1118, 265, 6, 273588, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[CellGroupData[{
Cell[41405, 1129, 326, 5, 72, "Item",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[41734, 1136, 309, 6, 7703, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[42046, 1144, 493, 12, 22863, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[42576, 1161, 324, 5, 72, "Item",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[42903, 1168, 373, 5, 273588, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[43279, 1175, 599, 13, 475210, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[43915, 1193, 222, 3, 72, "Item",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}],
Cell[44140, 1198, 656, 12, 840908, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}],
Cell[44799, 1212, 548, 10, 459671, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}],
Cell[45350, 1224, 976, 26, 273588, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[46363, 1255, 146, 2, 72, "Item",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}],
Cell[46512, 1259, 404, 11, 273588, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[46953, 1275, 99, 1, 72, "Item",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}],
Cell[47055, 1278, 107, 3, 7703, "Text"],
Cell[47165, 1283, 616, 19, 12035, "Input",
 InitializationCell->True],
Cell[47784, 1304, 634, 19, 12035, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[48443, 1327, 689, 20, 23846, "Input"],
Cell[49135, 1349, 60, 1, 7703, "Output"],
Cell[49198, 1352, 60, 1, 7703, "Output"],
Cell[49261, 1355, 60, 1, 7703, "Output"],
Cell[49324, 1358, 60, 1, 7703, "Output"]
}, Open  ]],
Cell[49399, 1362, 197, 4, 18066, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[49633, 1371, 112, 1, 72, "Item",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}],
Cell[49748, 1374, 123, 3, 12940, "Text"],
Cell[CellGroupData[{
Cell[49896, 1381, 156, 4, 7703, "Input"],
Cell[50055, 1387, 62, 1, 7703, "Output"]
}, Open  ]],
Cell[50132, 1391, 238, 6, 12035, "Input",
 InitializationCell->True],
Cell[50373, 1399, 386, 10, 12035, "Input",
 InitializationCell->True],
Cell[50762, 1411, 260, 8, 12035, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[51047, 1423, 494, 9, 34641, "Input"],
Cell[51544, 1434, 65, 1, 7703, "Output"],
Cell[51612, 1437, 77, 1, 7703, "Output"],
Cell[51692, 1440, 53, 1, 7703, "Output"],
Cell[51748, 1443, 29, 0, 7703, "Output"],
Cell[51780, 1445, 31, 0, 7703, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[51872, 1452, 78, 0, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[51975, 1456, 32, 0, 37, "Item"],
Cell[52010, 1458, 120, 3, 38, "Text"],
Cell[52133, 1463, 1646, 42, 249, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[53804, 1509, 24, 0, 38, "Text"],
Cell[CellGroupData[{
Cell[53853, 1513, 184, 5, 43, "Input"],
Cell[54040, 1520, 506, 10, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54583, 1535, 28, 0, 39, "Input"],
Cell[54614, 1537, 96, 3, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54747, 1545, 57, 1, 39, "Input"],
Cell[54807, 1548, 150, 6, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54994, 1559, 95, 3, 41, "Input"],
Cell[55092, 1564, 96, 3, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55225, 1572, 57, 1, 39, "Input"],
Cell[55285, 1575, 150, 6, 38, "Output"]
}, Open  ]]
}, Closed]],
Cell[55462, 1585, 1490, 39, 241, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[56977, 1628, 24, 0, 38, "Text"],
Cell[CellGroupData[{
Cell[57026, 1632, 184, 5, 43, "Input"],
Cell[57213, 1639, 506, 10, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57756, 1654, 28, 0, 39, "Input"],
Cell[57787, 1656, 96, 3, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57920, 1664, 57, 1, 39, "Input"],
Cell[57980, 1667, 150, 6, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58167, 1678, 95, 3, 41, "Input"],
Cell[58265, 1683, 96, 3, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58398, 1691, 57, 1, 39, "Input"],
Cell[58458, 1694, 150, 6, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58645, 1705, 68, 1, 39, "Input"],
Cell[58716, 1708, 401, 9, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59154, 1722, 28, 0, 39, "Input"],
Cell[59185, 1724, 29, 0, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59251, 1729, 128, 4, 41, "Input"],
Cell[59382, 1735, 248, 9, 57, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59703, 1752, 89, 2, 37, "Item"],
Cell[59795, 1756, 131, 3, 38, "Text"],
Cell[59929, 1761, 1448, 34, 249, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[61402, 1799, 24, 0, 38, "Text"],
Cell[61429, 1801, 358, 11, 39, "Text"],
Cell[CellGroupData[{
Cell[61812, 1816, 136, 3, 39, "Input"],
Cell[61951, 1821, 494, 11, 82, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62482, 1837, 30, 0, 39, "Input"],
Cell[62515, 1839, 62, 1, 44, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62614, 1845, 92, 2, 45, "Input"],
Cell[62709, 1849, 152, 6, 57, "Output"]
}, Open  ]],
Cell[62876, 1858, 40, 0, 37, "Text"],
Cell[62919, 1860, 156, 4, 39, "Input"],
Cell[CellGroupData[{
Cell[63100, 1868, 30, 0, 39, "Input"],
Cell[63133, 1870, 63, 1, 44, "Output"]
}, Open  ]],
Cell[63211, 1874, 128, 4, 63, "Text"],
Cell[63342, 1880, 182, 5, 67, "Input"]
}, Closed]],
Cell[63539, 1888, 264, 7, 51, "Input",
 InitializationCell->True],
Cell[63806, 1897, 248, 6, 59, "Input",
 InitializationCell->True],
Cell[64057, 1905, 248, 6, 59, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[64330, 1915, 24, 0, 38, "Text"],
Cell[64357, 1917, 361, 11, 94, "Input"],
Cell[CellGroupData[{
Cell[64743, 1932, 94, 2, 39, "Input"],
Cell[64840, 1936, 170, 5, 52, "Output"]
}, Open  ]],
Cell[65025, 1944, 312, 9, 94, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[65386, 1959, 1495, 44, 36, "Subsubsection"],
Cell[66884, 2005, 123, 4, 107, "Text"],
Cell[67010, 2011, 459, 13, 176, "Input",
 InitializationCell->True],
Cell[67472, 2026, 60, 0, 47, "Text"],
Cell[67535, 2028, 206, 5, 73, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[67766, 2037, 276, 4, 151, "Input"],
Cell[68045, 2043, 52, 0, 47, "Output"],
Cell[68100, 2045, 69, 0, 47, "Output"],
Cell[68172, 2047, 209, 2, 47, "Output"],
Cell[68384, 2051, 1785, 25, 47, "Output"]
}, Open  ]],
Cell[70184, 2079, 194, 4, 47, "Text"],
Cell[70381, 2085, 552, 14, 73, "Input",
 InitializationCell->True],
Cell[70936, 2101, 652, 17, 73, "Input",
 InitializationCell->True],
Cell[71591, 2120, 652, 17, 73, "Input",
 InitializationCell->True],
Cell[72246, 2139, 664, 17, 73, "Input",
 InitializationCell->True],
Cell[72913, 2158, 652, 17, 73, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[73590, 2179, 74, 1, 48, "Input"],
Cell[73667, 2182, 681, 19, 80, "Output"]
}, Open  ]],
Cell[74363, 2204, 63, 0, 47, "Text"],
Cell[CellGroupData[{
Cell[74451, 2208, 408, 8, 185, "Input"],
Cell[74862, 2218, 243, 7, 71, "Output"],
Cell[75108, 2227, 275, 9, 71, "Output"],
Cell[75386, 2238, 275, 9, 71, "Output"],
Cell[75664, 2249, 283, 9, 71, "Output"],
Cell[75950, 2260, 275, 9, 71, "Output"]
}, Open  ]],
Cell[76240, 2272, 201, 5, 73, "Input",
 InitializationCell->True],
Cell[76444, 2279, 204, 5, 73, "Input",
 InitializationCell->True],
Cell[76651, 2286, 204, 5, 73, "Input",
 InitializationCell->True],
Cell[76858, 2293, 216, 5, 73, "Input",
 InitializationCell->True],
Cell[77077, 2300, 204, 5, 73, "Input",
 InitializationCell->True],
Cell[77284, 2307, 220, 5, 73, "Input",
 InitializationCell->True],
Cell[77507, 2314, 222, 5, 73, "Input",
 InitializationCell->True],
Cell[77732, 2321, 222, 5, 73, "Input",
 InitializationCell->True],
Cell[77957, 2328, 230, 5, 73, "Input",
 InitializationCell->True],
Cell[78190, 2335, 222, 5, 73, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[78437, 2344, 172, 4, 48, "Input"],
Cell[78612, 2350, 1203, 32, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79852, 2387, 57, 1, 48, "Input"],
Cell[79912, 2390, 316, 10, 71, "Output"]
}, Open  ]],
Cell[80243, 2403, 47, 0, 47, "Text"],
Cell[CellGroupData[{
Cell[80315, 2407, 212, 5, 48, "Input"],
Cell[80530, 2414, 213, 5, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80780, 2424, 57, 1, 48, "Input"],
Cell[80840, 2427, 161, 6, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81038, 2438, 60, 1, 48, "Input"],
Cell[81101, 2441, 28, 0, 47, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81190, 2448, 668, 9, 56, "Subsection"],
Cell[81861, 2459, 258, 5, 120501, "Text"],
Cell[82122, 2466, 858, 21, 172141, "Input",
 InitializationCell->True],
Cell[82983, 2489, 417, 7, 120501, "Text"],
Cell[83403, 2498, 1054, 26, 222070, "Input",
 InitializationCell->True],
Cell[84460, 2526, 500, 9, 120501, "Text"],
Cell[84963, 2537, 236, 5, 71721, "Text"],
Cell[85202, 2544, 284, 7, 71721, "Input",
 InitializationCell->True],
Cell[85489, 2553, 282, 7, 71721, "Input",
 InitializationCell->True],
Cell[85774, 2562, 799, 14, 218871, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[86610, 2581, 709, 11, 45, "Subsection"],
Cell[87322, 2594, 603, 12, 1075, "Text"],
Cell[CellGroupData[{
Cell[87950, 2610, 80, 2, 272, "Input"],
Cell[88033, 2614, 2080, 54, 401, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90150, 2673, 115, 2, 272, "Input"],
Cell[90268, 2677, 8661, 228, 1262, "Output"]
}, Open  ]],
Cell[98944, 2908, 332, 7, 637, "Text"],
Cell[99279, 2917, 142, 4, 425, "Input",
 InitializationCell->True],
Cell[99424, 2923, 276, 5, 266, "Text"],
Cell[99703, 2930, 273, 6, 457, "Text"],
Cell[99979, 2938, 399, 9, 425, "Input",
 InitializationCell->True],
Cell[100381, 2949, 775, 18, 806, "Input",
 InitializationCell->True],
Cell[101159, 2969, 440, 11, 806, "Input",
 InitializationCell->True],
Cell[101602, 2982, 888, 21, 1172, "Input",
 InitializationCell->True],
Cell[102493, 3005, 1113, 25, 1360, "Input",
 InitializationCell->True],
Cell[103609, 3032, 1692, 35, 1360, "Input",
 InitializationCell->True],
Cell[105304, 3069, 491, 9, 540, "Text"],
Cell[105798, 3080, 944, 19, 425, "Input",
 InitializationCell->True],
Cell[106745, 3101, 945, 20, 637, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[107715, 3125, 217, 3, 272, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[107935, 3130, 1112, 34, 847125, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[109050, 3166, 438, 8, 291495, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[109491, 3176, 551, 11, 291495, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[110045, 3189, 446, 9, 273588, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[110494, 3200, 425, 7, 291495, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[110922, 3209, 373, 10, 291495, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[111310, 3222, 165, 2, 321, "Text"],
Cell[111478, 3226, 909, 19, 616, "Input",
 InitializationCell->True],
Cell[112390, 3247, 215, 4, 272, "Text"],
Cell[112608, 3253, 1015, 23, 647, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[113648, 3280, 192, 3, 272, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[113843, 3285, 1244, 37, 656663, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[115090, 3324, 580, 12, 291495, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[115673, 3338, 574, 13, 308046, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[116250, 3353, 445, 8, 273588, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Closed]],
Cell[116710, 3364, 404, 11, 332, "Text"],
Cell[117117, 3377, 703, 16, 477, "Input",
 InitializationCell->True],
Cell[117823, 3395, 89, 1, 272, "Text"],
Cell[CellGroupData[{
Cell[117937, 3400, 497, 10, 652, "Input"],
Cell[118437, 3412, 477, 11, 291, "Output"],
Cell[118917, 3425, 479, 11, 291, "Output"],
Cell[119399, 3438, 641, 15, 291, "Output"]
}, Open  ]],
Cell[120055, 3456, 705, 13, 722, "Text"],
Cell[120763, 3471, 673, 17, 806, "Input",
 InitializationCell->True],
Cell[121439, 3490, 1584, 40, 806, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[123048, 3534, 217, 3, 272, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[123268, 3539, 852, 20, 1026, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[124123, 3561, 732, 16, 272, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[124858, 3579, 1039, 24, 272, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[125900, 3605, 509, 11, 272, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[126412, 3618, 605, 12, 272, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[127020, 3632, 509, 11, 272, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[127532, 3645, 1100, 25, 1026, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[128635, 3672, 551, 12, 291, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[129189, 3686, 847, 18, 291, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[130039, 3706, 301, 6, 291, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[130343, 3714, 394, 7, 291, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[130740, 3723, 303, 6, 291, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[131080, 3734, 130, 3, 272, "Input"],
Cell[131213, 3739, 719, 19, 272, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131969, 3763, 371, 11, 272, "Input"],
Cell[132343, 3776, 97, 1, 272, "Output"]
}, Open  ]],
Cell[132455, 3780, 428, 8, 540, "Text"],
Cell[132886, 3790, 317, 7, 425, "Input",
 InitializationCell->True],
Cell[133206, 3799, 1894, 52, 1547, "Input",
 InitializationCell->True],
Cell[135103, 3853, 533, 18, 332, "Text"],
Cell[135639, 3873, 1652, 48, 1360, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[137316, 3925, 142, 2, 272, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[137461, 3929, 745, 22, 1026, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[138209, 3953, 633, 17, 272, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[138845, 3972, 633, 17, 272, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[139493, 3992, 277, 7, 425, "Input",
 InitializationCell->True],
Cell[139773, 4001, 113, 1, 272, "Text"],
Cell[139889, 4004, 467, 9, 425, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[140381, 4017, 430, 6, 272, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[140814, 4025, 225, 5, 272, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[141042, 4032, 5389, 80, 4165, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[146434, 4114, 219, 4, 272, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[146656, 4120, 3245, 47, 3103, "Print",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 CellTags->"Info3654025352-1410783"],
Cell[149904, 4169, 225, 5, 272, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[150132, 4176, 1101, 28, 652, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[151236, 4206, 570, 15, 272, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[151809, 4223, 714, 14, 272, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[152526, 4239, 5157, 104, 3452, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[157686, 4345, 1085, 28, 1220, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[158820, 4379, 379, 5, 45, "Subsection"],
Cell[159202, 4386, 872, 15, 88, "Text",
 InitializationCell->True],
Cell[160077, 4403, 213, 4, 38, "Text"],
Cell[160293, 4409, 275, 6, 59, "Input",
 InitializationCell->True],
Cell[160571, 4417, 341, 6, 59, "Input",
 InitializationCell->True],
Cell[160915, 4425, 277, 3, 38, "Text"],
Cell[161195, 4430, 190, 5, 59, "Input",
 InitializationCell->True],
Cell[161388, 4437, 278, 8, 39, "Input"],
Cell[161669, 4447, 709, 21, 114, "Input",
 InitializationCell->True],
Cell[162381, 4470, 226, 5, 63, "Text"],
Cell[162610, 4477, 618, 19, 114, "Input",
 InitializationCell->True],
Cell[163231, 4498, 446, 8, 110, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[CellGroupData[{
Cell[163702, 4510, 175, 5, 48, "Input"],
Cell[163880, 4517, 664, 11, 36, "Message"],
Cell[164547, 4530, 341, 11, 47, "Output"]
}, Open  ]],
Cell[164903, 4544, 538, 15, 73, "Input",
 InitializationCell->True],
Cell[165444, 4561, 443, 9, 73, "Input",
 InitializationCell->True],
Cell[165890, 4572, 1288, 37, 345, "Input",
 InitializationCell->True],
Cell[167181, 4611, 313, 6, 78, "Text"],
Cell[167497, 4619, 2483, 82, 1050, "Input",
 InitializationCell->True],
Cell[169983, 4703, 340, 6, 140, "Text"],
Cell[170326, 4711, 455, 10, 220, "Input",
 InitializationCell->True],
Cell[170784, 4723, 988, 25, 431, "Input",
 InitializationCell->True],
Cell[171775, 4750, 295, 6, 140, "Text"],
Cell[172073, 4758, 455, 10, 220, "Input",
 InitializationCell->True],
Cell[172531, 4770, 888, 23, 431, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[173444, 4797, 981, 24, 418, "Input"],
Cell[174428, 4823, 243, 6, 175, "Output"],
Cell[174674, 4831, 205, 5, 175, "Output"],
Cell[174882, 4838, 245, 6, 140, "Output"]
}, Open  ]],
Cell[175142, 4847, 237, 6, 220, "Input",
 InitializationCell->True],
Cell[175382, 4855, 312, 8, 220, "Input",
 InitializationCell->True],
Cell[175697, 4865, 103, 3, 175, "Text"],
Cell[175803, 4870, 422, 9, 175, "Input"],
Cell[176228, 4881, 643, 12, 332, "Text"],
Cell[176874, 4895, 2075, 43, 946, "Input",
 InitializationCell->True],
Cell[178952, 4940, 854, 22, 431, "Input",
 InitializationCell->True],
Cell[179809, 4964, 90, 1, 175, "Text"],
Cell[CellGroupData[{
Cell[179924, 4969, 310, 7, 303, "Input"],
Cell[CellGroupData[{
Cell[180259, 4980, 227, 3, 127, "Print"],
Cell[180489, 4985, 142, 2, 127, "Print"],
Cell[180634, 4989, 694, 20, 213, "Print"]
}, Open  ]],
Cell[181343, 5012, 77, 1, 175, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[181457, 5018, 279, 7, 303, "Input"],
Cell[181739, 5027, 123, 2, 175, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[181899, 5034, 515, 14, 418, "Input"],
Cell[CellGroupData[{
Cell[182439, 5052, 421, 6, 127, "Print"],
Cell[182863, 5060, 336, 5, 127, "Print"],
Cell[183202, 5067, 820, 21, 206, "Print"]
}, Open  ]],
Cell[184037, 5091, 514, 7, 175, "Output"]
}, Open  ]],
Cell[184566, 5101, 153, 3, 140, "Text"],
Cell[184722, 5106, 272, 9, 327, "Input",
 InitializationCell->True],
Cell[184997, 5117, 48, 0, 137, "Text"],
Cell[185048, 5119, 138, 4, 220, "Input",
 InitializationCell->True],
Cell[185189, 5125, 1566, 46, 946, "Input",
 InitializationCell->True],
Cell[186758, 5173, 1015, 32, 737, "Input",
 InitializationCell->True],
Cell[187776, 5207, 1340, 36, 737, "Input",
 InitializationCell->True],
Cell[189119, 5245, 1082, 33, 737, "Input",
 InitializationCell->True],
Cell[190204, 5280, 415, 12, 327, "Input",
 InitializationCell->True],
Cell[190622, 5294, 139, 4, 220, "Input",
 InitializationCell->True],
Cell[190764, 5300, 168, 5, 220, "Input",
 InitializationCell->True],
Cell[190935, 5307, 181, 2, 140, "Text"],
Cell[191119, 5311, 273, 8, 220, "Input",
 InitializationCell->True],
Cell[191395, 5321, 813, 13, 235, "Text"],
Cell[192211, 5336, 759, 18, 220, "Input",
 InitializationCell->True],
Cell[192973, 5356, 94, 2, 140, "Text"],
Cell[193070, 5360, 359, 10, 220, "Input",
 InitializationCell->True],
Cell[193432, 5372, 317, 6, 140, "Text"],
Cell[193752, 5380, 344, 8, 220, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[194133, 5393, 457, 7, 45, "Subsection"],
Cell[194593, 5402, 235, 3, 266, "Text"],
Cell[194831, 5407, 600, 16, 988, "Input",
 InitializationCell->True],
Cell[195434, 5425, 350, 6, 457, "Text"],
Cell[195787, 5433, 667, 16, 616, "Input",
 InitializationCell->True],
Cell[196457, 5451, 127, 2, 356, "Text"],
Cell[196587, 5455, 5533, 138, 4715, "Input",
 InitializationCell->True],
Cell[202123, 5595, 252, 5, 272, "Text"],
Cell[202378, 5602, 458, 11, 425, "Input",
 InitializationCell->True],
Cell[202839, 5615, 1395, 36, 1293, "Text"],
Cell[204237, 5653, 642, 13, 472, "Input"],
Cell[CellGroupData[{
Cell[204904, 5670, 149, 3, 272, "Input"],
Cell[205056, 5675, 395, 6, 382, "Print"]
}, Open  ]],
Cell[205466, 5684, 240, 5, 457, "Text"],
Cell[205709, 5691, 107, 2, 272, "Input"],
Cell[205819, 5695, 7274, 188, 5460, "Input",
 InitializationCell->True],
Cell[213096, 5885, 203, 4, 272, "Text"],
Cell[213302, 5891, 6056, 152, 3038, "Input",
 InitializationCell->True],
Cell[219361, 6045, 113, 1, 272, "Text"],
Cell[219477, 6048, 866, 16, 425, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[220368, 6068, 741, 20, 1026, "Input"],
Cell[221112, 6090, 272, 5, 272, "Output"],
Cell[221387, 6097, 324, 7, 272, "Output"],
Cell[221714, 6106, 425, 9, 272, "Output"],
Cell[222142, 6117, 716, 14, 291, "Output"]
}, Open  ]],
Cell[222873, 6134, 131, 1, 272, "Text"],
Cell[223007, 6137, 863, 16, 425, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[223895, 6157, 130, 2, 272, "Input"],
Cell[224028, 6161, 595, 17, 272, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[224660, 6183, 127, 2, 272, "Input"],
Cell[224790, 6187, 623, 13, 272, "Output"]
}, Open  ]],
Cell[225428, 6203, 292, 6, 272, "Text"],
Cell[225723, 6211, 342, 10, 272, "Input"],
Cell[226068, 6223, 129, 2, 356, "Text"],
Cell[226200, 6227, 3673, 103, 3408, "Input",
 InitializationCell->True],
Cell[229876, 6332, 737, 12, 647, "Text"],
Cell[230616, 6346, 699, 11, 647, "Text"],
Cell[231318, 6359, 689, 15, 425, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[232032, 6378, 327, 8, 272, "Input"],
Cell[232362, 6388, 347, 8, 272, "Output"]
}, Open  ]],
Cell[232724, 6399, 279, 3, 266, "Text"],
Cell[233006, 6404, 326, 6, 425, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[233369, 6415, 442, 6, 45, "Subsection"],
Cell[233814, 6423, 834, 14, 647, "Text"],
Cell[234651, 6439, 274, 7, 425, "Input",
 InitializationCell->True],
Cell[234928, 6448, 192, 4, 425, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[235145, 6456, 618, 15, 472, "Input"],
Cell[235766, 6473, 254, 6, 272, "Output"]
}, Open  ]],
Cell[236035, 6482, 393, 10, 425, "Input",
 InitializationCell->True],
Cell[236431, 6494, 668, 13, 425, "Input",
 InitializationCell->True],
Cell[237102, 6509, 386, 11, 472, "Input"],
Cell[CellGroupData[{
Cell[237513, 6524, 218, 4, 272, "Input"],
Cell[237734, 6530, 549, 11, 272, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[238320, 6546, 911, 23, 1026, "Input"],
Cell[239234, 6571, 516, 10, 272, "Output"],
Cell[239753, 6583, 737, 14, 272, "Output"],
Cell[240493, 6599, 1004, 19, 272, "Output"],
Cell[241500, 6620, 384, 6, 272, "Output"]
}, Open  ]],
Cell[241899, 6629, 269, 5, 457, "Text"],
Cell[242171, 6636, 308, 6, 457, "Text"],
Cell[242482, 6644, 1384, 40, 988, "Input",
 InitializationCell->True],
Cell[243869, 6686, 126, 1, 272, "Text"],
Cell[243998, 6689, 771, 19, 272, "Input"],
Cell[244772, 6710, 2034, 47, 472, "Input"],
Cell[246809, 6759, 126, 1, 272, "Text"],
Cell[246938, 6762, 657, 15, 425, "Input",
 InitializationCell->True],
Cell[247598, 6779, 788, 18, 425, "Input",
 InitializationCell->True],
Cell[248389, 6799, 1022, 22, 425, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[249436, 6825, 213, 4, 272, "Input"],
Cell[249652, 6831, 339, 7, 272, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[250028, 6843, 239, 5, 272, "Input"],
Cell[250270, 6850, 319, 7, 272, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[250626, 6862, 262, 5, 272, "Input"],
Cell[250891, 6869, 365, 8, 272, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[251293, 6882, 306, 7, 272, "Input"],
Cell[251602, 6891, 383, 8, 272, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[252022, 6904, 306, 7, 272, "Input"],
Cell[252331, 6913, 545, 11, 272, "Output"]
}, Open  ]],
Cell[252891, 6927, 253, 6, 425, "Input",
 InitializationCell->True],
Cell[253147, 6935, 194, 4, 272, "Text"],
Cell[253344, 6941, 510, 15, 425, "Input",
 InitializationCell->True],
Cell[253857, 6958, 469, 10, 425, "Input",
 InitializationCell->True],
Cell[254329, 6970, 339, 8, 425, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[254693, 6982, 276, 6, 272, "Input"],
Cell[254972, 6990, 438, 9, 272, "Output"]
}, Open  ]],
Cell[255425, 7002, 335, 9, 425, "Input",
 InitializationCell->True],
Cell[255763, 7013, 269, 7, 425, "Input",
 InitializationCell->True],
Cell[256035, 7022, 427, 12, 425, "Input",
 InitializationCell->True],
Cell[256465, 7036, 376, 9, 425, "Input",
 InitializationCell->True],
Cell[256844, 7047, 276, 7, 425, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[257145, 7058, 373, 9, 272, "Input"],
Cell[257521, 7069, 516, 15, 272, "Output"]
}, Open  ]],
Cell[258052, 7087, 277, 7, 616, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[258354, 7098, 263, 7, 272, "Input"],
Cell[258620, 7107, 419, 9, 272, "Output"]
}, Open  ]],
Cell[259054, 7119, 402, 11, 425, "Input",
 InitializationCell->True],
Cell[259459, 7132, 342, 10, 425, "Input",
 InitializationCell->True],
Cell[259804, 7144, 344, 8, 425, "Input",
 InitializationCell->True],
Cell[260151, 7154, 319, 8, 425, "Input",
 InitializationCell->True],
Cell[260473, 7164, 353, 9, 425, "Input",
 InitializationCell->True],
Cell[260829, 7175, 231, 5, 272, "Text"],
Cell[261063, 7182, 319, 8, 425, "Input",
 InitializationCell->True],
Cell[261385, 7192, 194, 2, 272, "Text"],
Cell[261582, 7196, 745, 18, 477, "Input",
 InitializationCell->True],
Cell[262330, 7216, 189, 4, 272, "Text"],
Cell[262522, 7222, 351, 7, 425, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[262910, 7234, 424, 5, 45, "Subsection"],
Cell[263337, 7241, 97, 1, 3847, "Text"],
Cell[263437, 7244, 329, 8, 8946, "Input",
 InitializationCell->True],
Cell[263769, 7254, 358, 6, 3945, "Text"],
Cell[264130, 7262, 430, 11, 6163, "Input",
 InitializationCell->True],
Cell[264563, 7275, 673, 12, 6565, "Text"],
Cell[265239, 7289, 313, 6, 6163, "Input",
 InitializationCell->True],
Cell[265555, 7297, 1005, 24, 17041, "Input",
 InitializationCell->True],
Cell[266563, 7323, 358, 6, 3945, "Text"],
Cell[266924, 7331, 488, 11, 6163, "Input",
 InitializationCell->True],
Cell[267415, 7344, 407, 7, 3945, "Text"],
Cell[267825, 7353, 280, 7, 6163, "Input",
 InitializationCell->True],
Cell[268108, 7362, 584, 13, 6163, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[268729, 7380, 316, 4, 45, "Subsection"],
Cell[CellGroupData[{
Cell[269070, 7388, 253, 5, 44, "Subsubsection"],
Cell[269326, 7395, 123, 1, 340, "Text"],
Cell[CellGroupData[{
Cell[269474, 7400, 465, 7, 1282, "Input"],
Cell[269942, 7409, 122, 2, 340, "Output"],
Cell[270067, 7413, 123, 2, 340, "Output"],
Cell[270193, 7417, 125, 2, 340, "Output"],
Cell[270321, 7421, 122, 2, 340, "Output"],
Cell[270446, 7425, 123, 2, 340, "Output"]
}, Open  ]],
Cell[270584, 7430, 107, 1, 340, "Text"],
Cell[CellGroupData[{
Cell[270716, 7435, 172, 4, 340, "Input"],
Cell[270891, 7441, 171, 4, 340, "Output"]
}, Open  ]],
Cell[271077, 7448, 120, 1, 340, "Text"],
Cell[271200, 7451, 722, 19, 340, "Input"],
Cell[CellGroupData[{
Cell[271947, 7474, 555, 14, 815, "Input"],
Cell[272505, 7490, 279, 7, 340, "Output"],
Cell[272787, 7499, 336, 9, 340, "Output"],
Cell[273126, 7510, 380, 11, 340, "Output"]
}, Open  ]],
Cell[273521, 7524, 114, 1, 340, "Text"],
Cell[CellGroupData[{
Cell[273660, 7529, 493, 13, 401, "Input"],
Cell[274156, 7544, 1373, 47, 340, "Output"]
}, Open  ]],
Cell[275544, 7594, 269, 5, 340, "Text"],
Cell[CellGroupData[{
Cell[275838, 7603, 564, 19, 340, "Input"],
Cell[276405, 7624, 460, 12, 340, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[276902, 7641, 125, 2, 340, "Input"],
Cell[277030, 7645, 643, 19, 340, "Output"]
}, Open  ]],
Cell[277688, 7667, 165, 3, 340, "Text"],
Cell[CellGroupData[{
Cell[277878, 7674, 418, 9, 340, "Input"],
Cell[278299, 7685, 538, 17, 340, "Output"]
}, Open  ]],
Cell[278852, 7705, 282, 5, 340, "Text"],
Cell[279137, 7712, 296, 7, 340, "Input"],
Cell[CellGroupData[{
Cell[279458, 7723, 493, 13, 401, "Input"],
Cell[279954, 7738, 995, 28, 340, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[280998, 7772, 214, 3, 35, "Subsubsection"],
Cell[281215, 7777, 324, 5, 332, "Text"],
Cell[CellGroupData[{
Cell[281564, 7786, 367, 8, 531, "Input",
 InitializationCell->True],
Cell[281934, 7796, 58, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[282029, 7802, 534, 15, 770, "Input",
 InitializationCell->True],
Cell[282566, 7819, 58, 1, 262, "Output"],
Cell[282627, 7822, 58, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[282722, 7828, 573, 14, 531, "Input",
 InitializationCell->True],
Cell[283298, 7844, 58, 1, 262, "Output"]
}, Open  ]],
Cell[283371, 7848, 835, 20, 626, "Text"],
Cell[CellGroupData[{
Cell[284231, 7872, 536, 13, 531, "Input",
 InitializationCell->True],
Cell[284770, 7887, 58, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[284865, 7893, 621, 15, 531, "Input",
 InitializationCell->True],
Cell[285489, 7910, 58, 1, 262, "Output"]
}, Open  ]],
Cell[285562, 7914, 134, 1, 340, "Text"],
Cell[CellGroupData[{
Cell[285721, 7919, 616, 16, 531, "Input",
 InitializationCell->True],
Cell[286340, 7937, 58, 1, 262, "Output"]
}, Open  ]],
Cell[286413, 7941, 1354, 33, 1525, "Input"],
Cell[287770, 7976, 1261, 29, 1235, "Input",
 InitializationCell->True],
Cell[289034, 8007, 293, 8, 531, "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[289376, 8021, 93, 1, 56, "Subsection"],
Cell[289472, 8024, 121, 3, 2020, "Text"],
Cell[289596, 8029, 226, 6, 3156, "Input",
 InitializationCell->True],
Cell[289825, 8037, 193, 6, 3156, "Input",
 InitializationCell->True],
Cell[290021, 8045, 374, 11, 3156, "Input",
 InitializationCell->True],
Cell[290398, 8058, 374, 11, 3156, "Input",
 InitializationCell->True],
Cell[290775, 8071, 295, 5, 4808, "Text"],
Cell[291073, 8078, 1790, 50, 15658, "Input",
 InitializationCell->True],
Cell[292866, 8130, 54, 0, 2020, "Text"],
Cell[292923, 8132, 1371, 34, 17075, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[294331, 8171, 387, 5, 45, "Subsection"],
Cell[CellGroupData[{
Cell[294743, 8180, 509, 7, 44, "Subsubsection"],
Cell[295255, 8189, 377, 7, 427481, "Text"],
Cell[CellGroupData[{
Cell[295657, 8200, 239, 5, 787856, "Input"],
Cell[295899, 8207, 146, 3, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[296082, 8215, 192, 4, 787856, "Input"],
Cell[296277, 8221, 583, 10, 308046, "Message"],
Cell[296863, 8233, 196, 3, 455460, "Output"]
}, Open  ]],
Cell[297074, 8239, 287, 6, 427481, "Text"],
Cell[CellGroupData[{
Cell[297386, 8249, 146, 3, 455460, "Input"],
Cell[297535, 8254, 177, 3, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[297749, 8262, 433, 10, 787856, "Input"],
Cell[298185, 8274, 269, 5, 455460, "Output"],
Cell[298457, 8281, 317, 8, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[298811, 8294, 239, 6, 455460, "Input"],
Cell[299053, 8302, 395, 11, 455460, "Output"]
}, Open  ]],
Cell[299463, 8316, 794, 12, 752063, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[300294, 8333, 271, 4, 35, "Subsubsection"],
Cell[300568, 8339, 145, 3, 4931, "Text"],
Cell[CellGroupData[{
Cell[300738, 8346, 346, 12, 4931, "Input"],
Cell[CellGroupData[{
Cell[301109, 8362, 72, 1, 4931, "Input"],
Cell[301184, 8365, 399, 9, 3553, "Print"],
Cell[301586, 8376, 35, 0, 4931, "Output"]
}, Open  ]]
}, Open  ]],
Cell[301648, 8380, 218, 7, 8563, "Input"],
Cell[CellGroupData[{
Cell[301891, 8391, 56, 1, 4931, "Input"],
Cell[301950, 8394, 515, 17, 6925, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[302502, 8416, 92, 2, 4931, "Input"],
Cell[302597, 8420, 711, 23, 6925, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[303345, 8448, 1310, 42, 18632, "Input"],
Cell[304658, 8492, 63, 1, 4931, "Output"],
Cell[304724, 8495, 396, 12, 5301, "Output"],
Cell[305123, 8509, 105, 3, 4931, "Output"],
Cell[305231, 8514, 440, 14, 5301, "Output"],
Cell[305674, 8530, 63, 1, 4931, "Output"]
}, Open  ]],
Cell[305752, 8534, 271, 7, 11831, "Input"],
Cell[CellGroupData[{
Cell[306048, 8545, 61, 1, 4931, "Input"],
Cell[306112, 8548, 32, 0, 4931, "Output"]
}, Open  ]],
Cell[306159, 8551, 711, 14, 15262, "Text"],
Cell[306873, 8567, 444, 8, 4931, "Text"],
Cell[CellGroupData[{
Cell[307342, 8579, 366, 10, 7703, "Input",
 InitializationCell->True],
Cell[307711, 8591, 58, 1, 262, "Output"]
}, Open  ]],
Cell[307784, 8595, 677, 12, 8282, "Text"],
Cell[308464, 8609, 519, 9, 8282, "Text"],
Cell[CellGroupData[{
Cell[309008, 8622, 948, 23, 11182, "Input",
 InitializationCell->True],
Cell[309959, 8647, 58, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[310054, 8653, 847, 19, 11182, "Input",
 InitializationCell->True],
Cell[310904, 8674, 59, 1, 262, "Output"],
Cell[310966, 8677, 59, 1, 262, "Output"]
}, Open  ]],
Cell[311040, 8681, 54, 0, 4931, "Text"],
Cell[311097, 8683, 892, 18, 4931, "Input"],
Cell[CellGroupData[{
Cell[312014, 8705, 283, 8, 7703, "Input",
 InitializationCell->True],
Cell[312300, 8715, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[312396, 8721, 444, 10, 7703, "Input",
 InitializationCell->True],
Cell[312843, 8733, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[312939, 8739, 406, 11, 7703, "Input",
 InitializationCell->True],
Cell[313348, 8752, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[313444, 8758, 403, 11, 7703, "Input",
 InitializationCell->True],
Cell[313850, 8771, 59, 1, 262, "Output"]
}, Open  ]],
Cell[313924, 8775, 514, 9, 8282, "Text"],
Cell[CellGroupData[{
Cell[314463, 8788, 1939, 53, 28808, "Input"],
Cell[316405, 8843, 399, 9, 4931, "Output"]
}, Open  ]],
Cell[316819, 8855, 58, 0, 4931, "Text"],
Cell[316880, 8857, 249, 9, 5301, "Input"],
Cell[CellGroupData[{
Cell[317154, 8870, 204, 6, 4931, "Input"],
Cell[317361, 8878, 209, 6, 4931, "Output"]
}, Open  ]],
Cell[317585, 8887, 423, 11, 7703, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[318033, 8902, 216, 5, 4931, "Input"],
Cell[318252, 8909, 275, 7, 4931, "Output"]
}, Open  ]],
Cell[318542, 8919, 529, 9, 11737, "Text"],
Cell[CellGroupData[{
Cell[319096, 8932, 267, 7, 7703, "Input",
 InitializationCell->True],
Cell[319366, 8941, 59, 1, 262, "Output"]
}, Open  ]],
Cell[319440, 8945, 726, 13, 11737, "Text"],
Cell[CellGroupData[{
Cell[320191, 8962, 1941, 47, 24726, "Input",
 InitializationCell->True],
Cell[322135, 9011, 59, 1, 262, "Output"],
Cell[322197, 9014, 59, 1, 262, "Output"]
}, Open  ]],
Cell[322271, 9018, 583, 10, 8282, "Text"],
Cell[CellGroupData[{
Cell[322879, 9032, 1086, 25, 11182, "Input",
 InitializationCell->True],
Cell[323968, 9059, 59, 1, 262, "Output"],
Cell[324030, 9062, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[324126, 9068, 1397, 33, 17947, "Input",
 InitializationCell->True],
Cell[325526, 9103, 59, 1, 262, "Output"],
Cell[325588, 9106, 59, 1, 262, "Output"]
}, Open  ]],
Cell[325662, 9110, 166, 2, 4931, "Text"],
Cell[CellGroupData[{
Cell[325853, 9116, 354, 10, 4931, "Input"],
Cell[326210, 9128, 200, 4, 4931, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[326447, 9137, 325, 10, 4931, "Input"],
Cell[326775, 9149, 218, 5, 4931, "Output"]
}, Open  ]],
Cell[327008, 9157, 231, 4, 4808, "Text"],
Cell[327242, 9163, 732, 13, 11737, "Text"],
Cell[CellGroupData[{
Cell[327999, 9180, 1906, 53, 11182, "Input",
 InitializationCell->True],
Cell[329908, 9235, 59, 1, 262, "Output"],
Cell[329970, 9238, 59, 1, 262, "Output"]
}, Open  ]],
Cell[330044, 9242, 220, 3, 4931, "Text"],
Cell[330267, 9247, 772, 21, 15262, "Input"],
Cell[CellGroupData[{
Cell[331064, 9272, 128, 2, 4931, "Input"],
Cell[331195, 9276, 1680, 52, 13378, "Output"]
}, Open  ]],
Cell[332890, 9331, 114, 1, 7703, "Text"],
Cell[CellGroupData[{
Cell[333029, 9336, 406, 8, 7703, "Input"],
Cell[333438, 9346, 212, 4, 7703, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[333687, 9355, 423, 9, 7703, "Input"],
Cell[334113, 9366, 144, 3, 7703, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[334294, 9374, 532, 10, 7703, "Input"],
Cell[334829, 9386, 148, 3, 7703, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[335014, 9394, 532, 10, 7703, "Input"],
Cell[335549, 9406, 122, 3, 7703, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[335708, 9414, 532, 10, 7703, "Input"],
Cell[336243, 9426, 122, 3, 7703, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[336402, 9434, 876, 16, 7703, "Input"],
Cell[337281, 9452, 320, 6, 7703, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[337638, 9463, 607, 12, 7703, "Input"],
Cell[338248, 9477, 122, 3, 7703, "Output"]
}, Open  ]],
Cell[338385, 9483, 113, 1, 7703, "Text"],
Cell[CellGroupData[{
Cell[338523, 9488, 444, 9, 7703, "Input"],
Cell[338970, 9499, 146, 3, 7703, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[339153, 9507, 643, 13, 7703, "Input"],
Cell[339799, 9522, 122, 3, 7703, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[339958, 9530, 607, 12, 7703, "Input"],
Cell[340568, 9544, 122, 3, 7703, "Output"]
}, Open  ]],
Cell[340705, 9550, 140, 1, 7703, "Text"],
Cell[CellGroupData[{
Cell[340870, 9555, 484, 10, 7703, "Input"],
Cell[341357, 9567, 122, 3, 7703, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[341516, 9575, 604, 11, 7703, "Input"],
Cell[342123, 9588, 125, 3, 7703, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[342285, 9596, 640, 12, 7703, "Input"],
Cell[342928, 9610, 147, 3, 7703, "Output"]
}, Open  ]],
Cell[343090, 9616, 231, 4, 7512, "Text"],
Cell[343324, 9622, 246, 3, 7703, "Text"],
Cell[343573, 9627, 598, 14, 7703, "Input"],
Cell[344174, 9643, 317, 6, 7703, "Text"],
Cell[344494, 9651, 628, 15, 12035, "Input",
 InitializationCell->True],
Cell[345125, 9668, 1925, 33, 65002, "Text"],
Cell[347053, 9703, 173, 2, 7703, "Text"],
Cell[CellGroupData[{
Cell[347251, 9709, 1855, 44, 17471, "Input",
 InitializationCell->True],
Cell[349109, 9755, 59, 1, 262, "Output"]
}, Open  ]],
Cell[349183, 9759, 217, 3, 7703, "Text"],
Cell[349403, 9764, 1190, 33, 34641, "Input"],
Cell[350596, 9799, 105, 1, 7512, "Text"],
Cell[CellGroupData[{
Cell[350726, 9804, 1085, 23, 34641, "Input"],
Cell[351814, 9829, 361, 5, 7703, "Output"],
Cell[352178, 9836, 359, 5, 7703, "Output"],
Cell[352540, 9843, 359, 5, 7703, "Output"],
Cell[352902, 9850, 359, 5, 7703, "Output"],
Cell[353264, 9857, 361, 5, 7703, "Output"],
Cell[353628, 9864, 359, 5, 7703, "Output"]
}, Open  ]],
Cell[354002, 9872, 160, 2, 7512, "Text"],
Cell[CellGroupData[{
Cell[354187, 9878, 1133, 23, 34641, "Input"],
Cell[355323, 9903, 278, 5, 7703, "Output"],
Cell[355604, 9910, 303, 6, 7703, "Output"],
Cell[355910, 9918, 305, 6, 7703, "Output"],
Cell[356218, 9926, 305, 6, 7703, "Output"],
Cell[356526, 9934, 336, 7, 7703, "Output"],
Cell[356865, 9943, 334, 7, 7703, "Output"]
}, Open  ]],
Cell[357214, 9953, 260, 5, 7512, "Text"],
Cell[357477, 9960, 404, 7, 12940, "Text"],
Cell[357884, 9969, 106, 1, 7512, "Text"],
Cell[357993, 9972, 498, 12, 12035, "Input",
 InitializationCell->True],
Cell[358494, 9986, 287, 6, 7703, "Text"],
Cell[CellGroupData[{
Cell[358806, 9996, 559, 14, 12035, "Input",
 InitializationCell->True],
Cell[359368, 10012, 59, 1, 262, "Output"]
}, Open  ]],
Cell[359442, 10016, 695, 11, 12940, "Text"],
Cell[CellGroupData[{
Cell[360162, 10031, 1035, 25, 12035, "Input",
 InitializationCell->True],
Cell[361200, 10058, 59, 1, 262, "Output"]
}, Open  ]],
Cell[361274, 10062, 283, 6, 7703, "Text"],
Cell[361560, 10070, 234, 4, 7703, "Text"],
Cell[CellGroupData[{
Cell[361819, 10078, 1231, 28, 12035, "Input",
 InitializationCell->True],
Cell[363053, 10108, 59, 1, 262, "Output"]
}, Open  ]],
Cell[363127, 10112, 182, 4, 7703, "Text"],
Cell[CellGroupData[{
Cell[363334, 10120, 1010, 25, 12035, "Input",
 InitializationCell->True],
Cell[364347, 10147, 59, 1, 262, "Output"]
}, Open  ]],
Cell[364421, 10151, 439, 8, 12940, "Text"],
Cell[CellGroupData[{
Cell[364885, 10163, 1782, 39, 22863, "Input",
 InitializationCell->True],
Cell[366670, 10204, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[366766, 10210, 1981, 44, 22863, "Input",
 InitializationCell->True],
Cell[368750, 10256, 59, 1, 262, "Output"]
}, Open  ]],
Cell[368824, 10260, 568, 9, 7703, "Text"],
Cell[CellGroupData[{
Cell[369417, 10273, 1927, 42, 13378, "Input",
 InitializationCell->True],
Cell[371347, 10317, 59, 1, 262, "Output"]
}, Open  ]],
Cell[371421, 10321, 303, 5, 7703, "Text"],
Cell[371727, 10328, 1171, 28, 29112, "Input"],
Cell[CellGroupData[{
Cell[372923, 10360, 928, 23, 23846, "Input"],
Cell[373854, 10385, 618, 17, 12120, "Output"],
Cell[374475, 10404, 676, 19, 12120, "Output"],
Cell[375154, 10425, 583, 16, 12120, "Output"],
Cell[375740, 10443, 698, 18, 12120, "Output"]
}, Open  ]],
Cell[376453, 10464, 1156, 18, 23671, "Text"],
Cell[377612, 10484, 772, 21, 13378, "Input"],
Cell[378387, 10507, 152, 2, 7703, "Text"],
Cell[378542, 10511, 838, 20, 23846, "Input"],
Cell[CellGroupData[{
Cell[379405, 10535, 395, 7, 18485, "Input"],
Cell[379803, 10544, 274, 5, 7703, "Output"],
Cell[380080, 10551, 274, 5, 7703, "Output"]
}, Open  ]],
Cell[380369, 10559, 123, 2, 7703, "Input"],
Cell[CellGroupData[{
Cell[380517, 10565, 406, 10, 13378, "Input"],
Cell[CellGroupData[{
Cell[380948, 10579, 615, 15, 5551, "Print"],
Cell[381566, 10596, 547, 17, 5551, "Print"],
Cell[382116, 10615, 565, 14, 5551, "Print"],
Cell[382684, 10631, 306, 9, 5551, "Print"],
Cell[382993, 10642, 583, 14, 5551, "Print"],
Cell[383579, 10658, 306, 9, 5551, "Print"],
Cell[383888, 10669, 788, 20, 5551, "Print"],
Cell[384679, 10691, 703, 20, 5551, "Print"],
Cell[385385, 10713, 759, 21, 5551, "Print"],
Cell[386147, 10736, 474, 15, 5551, "Print"],
Cell[386624, 10753, 761, 21, 5551, "Print"],
Cell[387388, 10776, 578, 17, 5551, "Print"],
Cell[387969, 10795, 854, 21, 5551, "Print"],
Cell[388826, 10818, 931, 28, 5551, "Print"],
Cell[389760, 10848, 1085, 27, 5551, "Print"],
Cell[390848, 10877, 1025, 30, 5551, "Print"],
Cell[391876, 10909, 617, 15, 5551, "Print"],
Cell[392496, 10926, 547, 17, 5551, "Print"],
Cell[393046, 10945, 565, 14, 5551, "Print"],
Cell[393614, 10961, 303, 9, 5551, "Print"],
Cell[393920, 10972, 585, 14, 5551, "Print"],
Cell[394508, 10988, 304, 9, 5551, "Print"],
Cell[394815, 10999, 1085, 27, 5551, "Print"],
Cell[395903, 11028, 946, 27, 5551, "Print"],
Cell[396852, 11057, 1566, 40, 5551, "Print"],
Cell[398421, 11099, 559, 17, 5551, "Print"],
Cell[398983, 11118, 617, 15, 5551, "Print"],
Cell[399603, 11135, 549, 17, 5551, "Print"],
Cell[400155, 11154, 565, 14, 5551, "Print"],
Cell[400723, 11170, 306, 9, 5551, "Print"],
Cell[401032, 11181, 583, 14, 5551, "Print"],
Cell[401618, 11197, 304, 9, 5551, "Print"]
}, Open  ]],
Cell[401937, 11209, 305, 6, 7703, "Output"],
Cell[CellGroupData[{
Cell[402267, 11219, 615, 15, 5551, "Print"],
Cell[402885, 11236, 549, 17, 5551, "Print"],
Cell[403437, 11255, 583, 14, 5551, "Print"],
Cell[404023, 11271, 304, 9, 5551, "Print"],
Cell[404330, 11282, 567, 14, 5551, "Print"],
Cell[404900, 11298, 304, 9, 5551, "Print"],
Cell[405207, 11309, 786, 20, 5551, "Print"],
Cell[405996, 11331, 705, 21, 5551, "Print"],
Cell[406704, 11354, 759, 21, 5551, "Print"],
Cell[407466, 11377, 578, 17, 5551, "Print"],
Cell[408047, 11396, 759, 21, 5551, "Print"],
Cell[408809, 11419, 474, 15, 5551, "Print"],
Cell[409286, 11436, 854, 21, 5551, "Print"],
Cell[410143, 11459, 931, 28, 5551, "Print"],
Cell[411077, 11489, 1085, 27, 5551, "Print"],
Cell[412165, 11518, 1036, 31, 5551, "Print"],
Cell[413204, 11551, 614, 15, 5551, "Print"],
Cell[413821, 11568, 549, 17, 5551, "Print"],
Cell[414373, 11587, 585, 14, 5551, "Print"],
Cell[414961, 11603, 304, 9, 5551, "Print"],
Cell[415268, 11614, 567, 14, 5551, "Print"],
Cell[415838, 11630, 306, 9, 5551, "Print"],
Cell[416147, 11641, 1087, 27, 5551, "Print"],
Cell[417237, 11670, 949, 27, 5551, "Print"],
Cell[418189, 11699, 1564, 40, 5551, "Print"],
Cell[419756, 11741, 561, 17, 5551, "Print"],
Cell[420320, 11760, 615, 15, 5551, "Print"],
Cell[420938, 11777, 549, 17, 5551, "Print"],
Cell[421490, 11796, 583, 14, 5551, "Print"],
Cell[422076, 11812, 304, 9, 5551, "Print"],
Cell[422383, 11823, 564, 14, 5551, "Print"],
Cell[422950, 11839, 303, 9, 5551, "Print"]
}, Open  ]],
Cell[423268, 11851, 303, 6, 7703, "Output"]
}, Open  ]],
Cell[423586, 11860, 125, 1, 7703, "Text"],
Cell[CellGroupData[{
Cell[423736, 11865, 500, 10, 13378, "Input"],
Cell[CellGroupData[{
Cell[424261, 11879, 583, 14, 5551, "Print"],
Cell[424847, 11895, 427, 12, 5551, "Print"]
}, Open  ]],
Cell[425289, 11910, 352, 6, 7703, "Output"],
Cell[CellGroupData[{
Cell[425666, 11920, 583, 14, 5551, "Print"],
Cell[426252, 11936, 429, 12, 5551, "Print"]
}, Open  ]],
Cell[426696, 11951, 352, 6, 7703, "Output"]
}, Open  ]],
Cell[427063, 11960, 124, 2, 7703, "Input"],
Cell[CellGroupData[{
Cell[427212, 11966, 182, 4, 7703, "Input"],
Cell[CellGroupData[{
Cell[427419, 11974, 864, 22, 5551, "Print"],
Cell[428286, 11998, 629, 18, 5551, "Print"],
Cell[428918, 12018, 635, 15, 5551, "Print"],
Cell[429556, 12035, 509, 15, 5551, "Print"],
Cell[430068, 12052, 605, 14, 5551, "Print"],
Cell[430676, 12068, 323, 9, 5551, "Print"]
}, Open  ]],
Cell[431014, 12080, 260, 6, 7703, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[431311, 12091, 144, 4, 7703, "Input"],
Cell[431458, 12097, 209, 5, 7703, "Output"]
}, Open  ]],
Cell[431682, 12105, 167, 2, 7703, "Text"],
Cell[CellGroupData[{
Cell[431874, 12111, 140, 2, 7703, "Input"],
Cell[432017, 12115, 3062, 85, 47563, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[435116, 12205, 135, 2, 7703, "Input"],
Cell[435254, 12209, 2882, 82, 47563, "Output"]
}, Open  ]],
Cell[438151, 12294, 147, 3, 7703, "Input"],
Cell[CellGroupData[{
Cell[438323, 12301, 476, 12, 13378, "Input"],
Cell[438802, 12315, 267, 4, 7703, "Output"],
Cell[439072, 12321, 265, 4, 7703, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[439374, 12330, 150, 3, 7703, "Input"],
Cell[439527, 12335, 240, 3, 7703, "Output"]
}, Open  ]],
Cell[439782, 12341, 399, 8, 12821, "Text"],
Cell[CellGroupData[{
Cell[440206, 12353, 861, 20, 17471, "Input",
 InitializationCell->True],
Cell[441070, 12375, 59, 1, 262, "Output"],
Cell[441132, 12378, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[441228, 12384, 503, 13, 12035, "Input",
 InitializationCell->True],
Cell[441734, 12399, 59, 1, 262, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[441842, 12406, 511, 7, 35, "Subsubsection"],
Cell[442356, 12415, 243, 5, 455460, "Input"],
Cell[CellGroupData[{
Cell[442624, 12424, 404, 10, 1111962, "Input"],
Cell[443031, 12436, 432, 10, 455460, "Output"],
Cell[443466, 12448, 295, 6, 455460, "Output"],
Cell[443764, 12456, 260, 5, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[444061, 12466, 376, 9, 787856, "Input"],
Cell[444440, 12477, 415, 8, 455460, "Output"],
Cell[444858, 12487, 464, 10, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[445359, 12502, 288, 6, 455460, "Input"],
Cell[445650, 12510, 1320, 22, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[447007, 12537, 115, 2, 455460, "Input"],
Cell[447125, 12541, 691, 14, 455460, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[447865, 12561, 34, 0, 35, "Subsubsection"],
Cell[447902, 12563, 131, 4, 2690, "Text"],
Cell[448036, 12569, 249, 6, 3790, "Text"],
Cell[448288, 12577, 90, 2, 2525, "Input",
 InitializationCell->True],
Cell[448381, 12581, 1346, 39, 5882, "Input",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[449776, 12626, 747, 12, 56, "Subsection"],
Cell[450526, 12640, 3895, 68, 12931, "Text"],
Cell[CellGroupData[{
Cell[454446, 12712, 190, 2, 2383, "Subsubsection"],
Cell[454639, 12716, 333, 7, 3362, "Text"],
Cell[CellGroupData[{
Cell[454997, 12727, 360, 9, 3156, "Input",
 InitializationCell->True],
Cell[455360, 12738, 59, 1, 262, "Output"]
}, Open  ]],
Cell[455434, 12742, 750, 17, 3156, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[456209, 12763, 1251, 33, 5995, "Input",
 InitializationCell->True],
Cell[457463, 12798, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[457559, 12804, 376, 9, 3156, "Input",
 InitializationCell->True],
Cell[457938, 12815, 59, 1, 262, "Output"]
}, Open  ]],
Cell[458012, 12819, 178, 4, 2020, "Text"],
Cell[CellGroupData[{
Cell[458215, 12827, 853, 24, 7352, "Input",
 InitializationCell->True],
Cell[459071, 12853, 59, 1, 262, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[459179, 12860, 187, 2, 2383, "Subsubsection"],
Cell[459369, 12864, 168, 4, 3362, "Text"],
Cell[CellGroupData[{
Cell[459562, 12872, 1945, 39, 10128, "Input",
 InitializationCell->True],
Cell[461510, 12913, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[461606, 12919, 2098, 46, 10128, "Input",
 InitializationCell->True],
Cell[463707, 12967, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[463803, 12973, 2236, 47, 10128, "Input",
 InitializationCell->True],
Cell[466042, 13022, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[466138, 13028, 1671, 37, 10128, "Input",
 InitializationCell->True],
Cell[467812, 13067, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[467908, 13073, 1846, 41, 8726, "Input",
 InitializationCell->True],
Cell[469757, 13116, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[469853, 13122, 2127, 44, 10128, "Input",
 InitializationCell->True],
Cell[471983, 13168, 59, 1, 262, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[472091, 13175, 100, 1, 1820, "Subsubsection"],
Cell[CellGroupData[{
Cell[472216, 13180, 180, 4, 2020, "Input"],
Cell[472399, 13186, 257, 5, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[472693, 13196, 468, 8, 2020, "Input"],
Cell[473164, 13206, 325, 6, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[473526, 13217, 789, 18, 3508, "Input"],
Cell[474318, 13237, 1403, 22, 2020, "Output"],
Cell[475724, 13261, 1403, 22, 2020, "Output"]
}, Open  ]],
Cell[477142, 13286, 106, 1, 2020, "Text"],
Cell[CellGroupData[{
Cell[477273, 13291, 792, 22, 4847, "Input"],
Cell[478068, 13315, 329, 8, 2020, "Output"]
}, Open  ]],
Cell[478412, 13326, 117, 1, 2020, "Text"],
Cell[CellGroupData[{
Cell[478554, 13331, 722, 21, 4847, "Input"],
Cell[479279, 13354, 326, 7, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[479642, 13366, 353, 9, 3508, "Input"],
Cell[479998, 13377, 797, 12, 2020, "Output"],
Cell[480798, 13391, 797, 12, 2020, "Output"]
}, Open  ]],
Cell[481610, 13406, 157, 2, 2020, "Text"],
Cell[CellGroupData[{
Cell[481792, 13412, 427, 11, 3508, "Input"],
Cell[482222, 13425, 295, 5, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[482554, 13435, 345, 9, 3508, "Input"],
Cell[482902, 13446, 275, 5, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[483214, 13456, 161, 3, 2020, "Input"],
Cell[483378, 13461, 481, 9, 1553, "Message"],
Cell[483862, 13472, 324, 6, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[484223, 13483, 127, 3, 2020, "Input"],
Cell[484353, 13488, 227, 4, 2020, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[484629, 13498, 205, 3, 2383, "Subsubsection"],
Cell[484837, 13503, 850, 14, 3362, "Text"],
Cell[485690, 13519, 837, 23, 3156, "Input",
 InitializationCell->True,
 CellID->1792294297],
Cell[CellGroupData[{
Cell[486552, 13546, 609, 11, 7632, "Input"],
Cell[487164, 13559, 257, 4, 2020, "Output"],
Cell[487424, 13565, 257, 4, 2020, "Output"],
Cell[487684, 13571, 274, 5, 2020, "Output"],
Cell[487961, 13578, 257, 4, 2020, "Output"],
Cell[488221, 13584, 276, 5, 2020, "Output"]
}, Open  ]],
Cell[488512, 13592, 487, 12, 4581, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[489024, 13608, 297, 7, 3508, "Input"],
Cell[489324, 13617, 233, 4, 2020, "Output"],
Cell[489560, 13623, 233, 4, 2020, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[489842, 13633, 106, 1, 1820, "Subsubsection"],
Cell[489951, 13636, 365, 7, 2020, "Text"],
Cell[490319, 13645, 1095, 25, 3156, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[491439, 13674, 401, 7, 3508, "Input"],
Cell[491843, 13683, 363, 6, 2020, "Output"],
Cell[492209, 13691, 394, 7, 2020, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[492652, 13704, 395, 5, 1820, "Subsubsection"],
Cell[493050, 13711, 564, 7, 2020, "Text"],
Cell[493617, 13720, 580, 14, 3156, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[494222, 13738, 283, 7, 3156, "Input",
 InitializationCell->True],
Cell[494508, 13747, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[494604, 13753, 198, 5, 2020, "Input"],
Cell[494805, 13760, 638, 9, 2020, "Output"]
}, Open  ]],
Cell[495458, 13772, 560, 7, 2020, "Text"],
Cell[496021, 13781, 199, 6, 3156, "Input",
 InitializationCell->True],
Cell[496223, 13789, 881, 13, 2020, "Text"],
Cell[CellGroupData[{
Cell[497129, 13806, 353, 8, 3156, "Input",
 InitializationCell->True],
Cell[497485, 13816, 59, 1, 262, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[497593, 13823, 308, 4, 1820, "Subsubsection"],
Cell[497904, 13829, 248, 5, 2020, "Text"],
Cell[CellGroupData[{
Cell[498177, 13838, 794, 21, 3156, "Input",
 InitializationCell->True],
Cell[498974, 13861, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[499070, 13867, 662, 19, 3156, "Input",
 InitializationCell->True],
Cell[499735, 13888, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[499831, 13894, 669, 16, 6252, "Input"],
Cell[500503, 13912, 439, 9, 2020, "Output"],
Cell[500945, 13923, 440, 9, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[501422, 13937, 714, 16, 6252, "Input"],
Cell[502139, 13955, 390, 8, 2020, "Output"],
Cell[502532, 13965, 391, 8, 2020, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[502972, 13979, 224, 3, 1820, "Subsubsection"],
Cell[CellGroupData[{
Cell[503221, 13986, 465, 11, 1002750, "Input",
 InitializationCell->True],
Cell[503689, 13999, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[503785, 14005, 571, 17, 1002750, "Input",
 InitializationCell->True],
Cell[504359, 14024, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[504455, 14030, 290, 8, 1002750, "Input",
 InitializationCell->True],
Cell[504748, 14040, 59, 1, 262, "Output"]
}, Open  ]],
Cell[504822, 14044, 364, 10, 1002750, "Input"],
Cell[CellGroupData[{
Cell[505211, 14058, 458, 11, 1002750, "Input"],
Cell[505672, 14071, 1506, 30, 1002750, "Output"]
}, Open  ]],
Cell[507193, 14104, 1003, 13, 1002750, "Text"],
Cell[CellGroupData[{
Cell[508221, 14121, 230, 5, 1002750, "Input"],
Cell[508454, 14128, 1144, 34, 1002750, "Output"]
}, Open  ]],
Cell[509613, 14165, 993, 13, 1002750, "Text"],
Cell[CellGroupData[{
Cell[510631, 14182, 588, 15, 1002750, "Input",
 InitializationCell->True],
Cell[511222, 14199, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[511318, 14205, 519, 16, 1002750, "Input"],
Cell[511840, 14223, 968, 21, 1002750, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[512857, 14250, 543, 8, 1820, "Subsubsection"],
Cell[513403, 14260, 315, 7, 718235, "Text"],
Cell[513721, 14269, 475, 6, 427481, "Text"],
Cell[514199, 14277, 554, 15, 787856, "Input"],
Cell[CellGroupData[{
Cell[514778, 14296, 566, 15, 787856, "Input"],
Cell[515347, 14313, 1250, 21, 455460, "Output"]
}, Open  ]],
Cell[516612, 14337, 743, 12, 427481, "Text"],
Cell[517358, 14351, 862, 16, 1304565, "Text"],
Cell[518223, 14369, 245, 6, 455460, "Input"],
Cell[CellGroupData[{
Cell[518493, 14379, 700, 19, 1111962, "Input"],
Cell[519196, 14400, 377, 6, 455460, "Output"]
}, Open  ]],
Cell[519588, 14409, 234, 4, 427481, "Text"],
Cell[CellGroupData[{
Cell[519847, 14417, 758, 21, 1111962, "Input"],
Cell[520608, 14440, 382, 6, 1002750, "Output"]
}, Open  ]],
Cell[521005, 14449, 160, 3, 1002750, "Text"],
Cell[CellGroupData[{
Cell[521190, 14456, 396, 10, 1002750, "Input"],
Cell[521589, 14468, 360, 9, 1002750, "Output"]
}, Open  ]],
Cell[521964, 14480, 344, 5, 1002750, "Text"],
Cell[CellGroupData[{
Cell[522333, 14489, 272, 8, 1002750, "Input"],
Cell[522608, 14499, 1176, 19, 1002750, "Output"]
}, Open  ]],
Cell[523799, 14521, 467, 8, 1002750, "Text"],
Cell[CellGroupData[{
Cell[524291, 14533, 648, 18, 1002750, "Input"],
Cell[524942, 14553, 1387, 25, 1002750, "Output"],
Cell[526332, 14580, 1484, 29, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[527853, 14614, 450, 12, 1002750, "Input"],
Cell[528306, 14628, 1176, 21, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[529519, 14654, 310, 7, 1002750, "Input"],
Cell[529832, 14663, 1806, 35, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[531675, 14703, 415, 9, 1002750, "Input"],
Cell[532093, 14714, 1094, 16, 1002750, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[533236, 14736, 225, 3, 1820, "Subsubsection"],
Cell[533464, 14741, 551, 9, 140078, "Text"],
Cell[CellGroupData[{
Cell[534040, 14754, 931, 22, 336212, "Input",
 InitializationCell->True],
Cell[534974, 14778, 59, 1, 262, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[535082, 14785, 100, 1, 1820, "Subsubsection"],
Cell[CellGroupData[{
Cell[535207, 14790, 161, 4, 455460, "Input"],
Cell[535371, 14796, 229, 4, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[535637, 14805, 193, 5, 455460, "Input"],
Cell[535833, 14812, 599, 11, 308046, "Message"],
Cell[536435, 14825, 371, 7, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[536843, 14837, 222, 6, 455460, "Input"],
Cell[537068, 14845, 319, 6, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[537424, 14856, 343, 9, 455460, "Input"],
Cell[537770, 14867, 771, 13, 455460, "Output"]
}, Open  ]],
Cell[538556, 14883, 216, 6, 711656, "Text"],
Cell[CellGroupData[{
Cell[538797, 14893, 401, 11, 455460, "Input"],
Cell[539201, 14906, 850, 17, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[540088, 14928, 266, 5, 787856, "Input"],
Cell[540357, 14935, 921, 20, 455460, "Output"],
Cell[541281, 14957, 948, 21, 455460, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[542278, 14984, 224, 3, 1820, "Subsubsection"],
Cell[542505, 14989, 607, 8, 1002750, "Text"],
Cell[CellGroupData[{
Cell[543137, 15001, 607, 17, 1002750, "Input",
 InitializationCell->True],
Cell[543747, 15020, 59, 1, 262, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[543855, 15027, 948, 29, 1971, "Subsubsection"],
Cell[544806, 15058, 16, 0, 1971, "Text"],
Cell[CellGroupData[{
Cell[544847, 15062, 1569, 38, 4581, "Input",
 InitializationCell->True],
Cell[546419, 15102, 59, 1, 262, "Output"]
}, Open  ]],
Cell[546493, 15106, 1820, 39, 2093, "Text"],
Cell[548316, 15147, 1241, 19, 3393, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[CellGroupData[{
Cell[549582, 15170, 1209, 34, 6252, "Input"],
Cell[550794, 15206, 344, 8, 2020, "Output"],
Cell[551141, 15216, 377, 9, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[551555, 15230, 622, 15, 2020, "Input"],
Cell[552180, 15247, 1094, 22, 2020, "Output"]
}, Open  ]],
Cell[553289, 15272, 120, 3, 2020, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[553446, 15280, 627, 16, 1971, "Subsubsection"],
Cell[554076, 15298, 2736, 45, 18215, "Text"],
Cell[CellGroupData[{
Cell[556837, 15347, 141, 3, 2020, "Input"],
Cell[556981, 15352, 3523, 49, 31283, "Print",
 CellTags->"Info3615308618-6396053"]
}, Open  ]],
Cell[CellGroupData[{
Cell[560541, 15406, 93, 2, 2020, "Input"],
Cell[560637, 15410, 1181, 17, 10257, "Print",
 CellTags->"Info3615308618-6396053"]
}, Open  ]],
Cell[561833, 15430, 596, 8, 2020, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[CellGroupData[{
Cell[562454, 15442, 1138, 26, 3156, "Input",
 InitializationCell->True],
Cell[563595, 15470, 59, 1, 262, "Output"]
}, Open  ]],
Cell[563669, 15474, 1288, 20, 3393, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[564960, 15496, 421, 7, 2020, "Text"],
Cell[565384, 15505, 3417, 96, 19853, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[568826, 15605, 260, 7, 2020, "Input"],
Cell[569089, 15614, 408, 6, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[569534, 15625, 240, 6, 2020, "Input"],
Cell[569777, 15633, 425, 8, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[570239, 15646, 470, 14, 2020, "Input"],
Cell[570712, 15662, 619, 11, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[571368, 15678, 307, 8, 2020, "Input"],
Cell[571678, 15688, 638, 10, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[572353, 15703, 258, 7, 2020, "Input"],
Cell[572614, 15712, 598, 9, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[573249, 15726, 382, 10, 2020, "Input"],
Cell[573634, 15738, 674, 9, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[574345, 15752, 329, 9, 2020, "Input"],
Cell[574677, 15763, 606, 9, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[575320, 15777, 340, 9, 2020, "Input"],
Cell[575663, 15788, 638, 9, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[576338, 15802, 292, 8, 2020, "Input"],
Cell[576633, 15812, 626, 9, 2020, "Output"]
}, Open  ]],
Cell[577274, 15824, 4327, 95, 19853, "Input",
 InitializationCell->True],
Cell[581604, 15921, 1937, 46, 10128, "Input",
 InitializationCell->True],
Cell[583544, 15969, 324, 4, 2020, "Text"],
Cell[583871, 15975, 677, 17, 6252, "Input"],
Cell[CellGroupData[{
Cell[584573, 15996, 379, 9, 2020, "Input"],
Cell[584955, 16007, 781, 12, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[585773, 16024, 217, 5, 2020, "Input"],
Cell[585993, 16031, 643, 10, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[586673, 16046, 254, 6, 2020, "Input"],
Cell[586930, 16054, 685, 13, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[587652, 16072, 254, 6, 2020, "Input"],
Cell[587909, 16080, 784, 16, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[588730, 16101, 238, 5, 2020, "Input"],
Cell[588971, 16108, 801, 15, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[589809, 16128, 239, 5, 2020, "Input"],
Cell[590051, 16135, 793, 16, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[590881, 16156, 326, 8, 2020, "Input"],
Cell[591210, 16166, 1003, 19, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[592250, 16190, 277, 7, 2020, "Input"],
Cell[592530, 16199, 600, 9, 2020, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[593179, 16214, 563, 7, 2383, "Subsubsection"],
Cell[593745, 16223, 287, 6, 2020, "Text"],
Cell[594035, 16231, 537, 9, 2020, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[594575, 16242, 2146, 53, 7352, "Input",
 InitializationCell->True],
Cell[596724, 16297, 1636, 41, 8726, "Input",
 InitializationCell->True],
Cell[598363, 16340, 254, 3, 2020, "Text"],
Cell[598620, 16345, 449, 9, 4581, "Input",
 InitializationCell->True],
Cell[599072, 16356, 236, 3, 2020, "Text"],
Cell[599311, 16361, 190, 5, 3156, "Input",
 InitializationCell->True],
Cell[599504, 16368, 667, 17, 3508, "Input"],
Cell[CellGroupData[{
Cell[600196, 16389, 341, 6, 2020, "Input"],
Cell[600540, 16397, 511, 10, 2020, "Output"]
}, Open  ]],
Cell[601066, 16410, 273, 5, 2020, "Text"],
Cell[CellGroupData[{
Cell[601364, 16419, 884, 20, 9082, "Input"],
Cell[602251, 16441, 890, 15, 2020, "Output"],
Cell[603144, 16458, 889, 15, 2020, "Output"],
Cell[604036, 16475, 900, 15, 2020, "Output"],
Cell[604939, 16492, 923, 16, 2020, "Output"],
Cell[605865, 16510, 904, 15, 2020, "Output"]
}, Open  ]],
Cell[606784, 16528, 287, 5, 2020, "Text"],
Cell[CellGroupData[{
Cell[607096, 16537, 1489, 36, 13182, "Input"],
Cell[608588, 16575, 698, 12, 1002750, "Output"],
Cell[609289, 16589, 698, 12, 1002750, "Output"],
Cell[609990, 16603, 700, 12, 1002750, "Output"],
Cell[610693, 16617, 698, 12, 1002750, "Output"],
Cell[611394, 16631, 698, 12, 1002750, "Output"],
Cell[612095, 16645, 721, 13, 1002750, "Output"],
Cell[612819, 16660, 731, 13, 1002750, "Output"],
Cell[613553, 16675, 669, 11, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[614259, 16691, 289, 7, 1002750, "Input"],
Cell[614551, 16700, 180, 4, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[614768, 16709, 359, 8, 1002750, "Input"],
Cell[615130, 16719, 215, 5, 1002750, "Output"]
}, Open  ]],
Cell[615360, 16727, 130, 3, 1002750, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[615539, 16736, 761, 11, 45, "Subsection"],
Cell[616303, 16749, 362, 6, 3393, "Text"],
Cell[616668, 16757, 313, 8, 3156, "Input",
 InitializationCell->True],
Cell[616984, 16767, 222, 6, 3156, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[617231, 16777, 378, 10, 3156, "Input",
 InitializationCell->True],
Cell[617612, 16789, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[617708, 16795, 920, 23, 3156, "Input",
 InitializationCell->True],
Cell[618631, 16820, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[618727, 16826, 725, 19, 3156, "Input",
 InitializationCell->True],
Cell[619455, 16847, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[619551, 16853, 1045, 25, 3156, "Input",
 InitializationCell->True],
Cell[620599, 16880, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[620695, 16886, 140, 2, 2020, "Input"],
Cell[620838, 16890, 1911, 52, 4737, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[622798, 16948, 867, 13, 45, "Subsection"],
Cell[623668, 16963, 740, 19, 2093, "Text"],
Cell[CellGroupData[{
Cell[624433, 16986, 171, 2, 2383, "Subsubsection"],
Cell[CellGroupData[{
Cell[624629, 16992, 79, 2, 4931, "Input"],
Cell[624711, 16996, 215, 5, 3393, "Message"],
Cell[624929, 17003, 187, 6, 4931, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[625153, 17014, 56, 1, 4931, "Input"],
Cell[625212, 17017, 28, 0, 4931, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[625277, 17022, 58, 1, 4931, "Input"],
Cell[625338, 17025, 45, 1, 4931, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[625420, 17031, 79, 2, 4931, "Input"],
Cell[625502, 17035, 80, 2, 4931, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[625619, 17042, 103, 3, 4931, "Input"],
Cell[625725, 17047, 80, 2, 4931, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[625842, 17054, 594, 19, 11182, "Input",
 InitializationCell->True],
Cell[626439, 17075, 59, 1, 262, "Output"],
Cell[626501, 17078, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[626597, 17084, 594, 19, 11182, "Input",
 InitializationCell->True],
Cell[627194, 17105, 59, 1, 262, "Output"],
Cell[627256, 17108, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[627352, 17114, 431, 13, 11182, "Input",
 InitializationCell->True],
Cell[627786, 17129, 59, 1, 262, "Output"],
Cell[627848, 17132, 59, 1, 262, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[627956, 17139, 384, 5, 1820, "Subsubsection"],
Cell[CellGroupData[{
Cell[628365, 17148, 842, 16, 3156, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[629210, 17166, 720, 11, 2020, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[629945, 17180, 212, 6, 3156, "Input",
 InitializationCell->True],
Cell[630160, 17188, 123, 1, 2020, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[630286, 17191, 238, 4, 3393, "Text"],
Cell[630527, 17197, 443, 15, 3156, "Input",
 InitializationCell->True],
Cell[630973, 17214, 160, 5, 3156, "Input",
 InitializationCell->True],
Cell[631136, 17221, 330, 8, 3156, "Input",
 InitializationCell->True],
Cell[631469, 17231, 258, 7, 3156, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[631752, 17242, 822, 16, 2020, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[632577, 17260, 905, 14, 2020, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[633497, 17277, 205, 5, 3156, "Input",
 InitializationCell->True],
Cell[633705, 17284, 683, 9, 2020, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[634391, 17295, 316, 8, 3156, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[634732, 17307, 344, 8, 4737, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[635079, 17317, 2604, 73, 14257, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[637698, 17393, 155, 3, 2020, "Text"],
Cell[637856, 17398, 1095, 25, 3156, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[638976, 17427, 401, 7, 3508, "Input"],
Cell[639380, 17436, 315, 6, 2020, "Output"],
Cell[639698, 17444, 348, 7, 2020, "Output"]
}, Open  ]],
Cell[640061, 17454, 711, 9, 2020, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[640775, 17465, 2076, 49, 8726, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[642876, 17518, 540, 14, 4847, "Input"],
Cell[643419, 17534, 568, 10, 2020, "Output"],
Cell[643990, 17546, 568, 10, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[644595, 17561, 434, 10, 4847, "Input"],
Cell[645032, 17573, 774, 22, 2978, "Output"],
Cell[645809, 17597, 634, 17, 2978, "Output"]
}, Open  ]],
Cell[646458, 17617, 326, 4, 2020, "Text"],
Cell[646787, 17623, 687, 14, 8852, "Text"],
Cell[CellGroupData[{
Cell[647499, 17641, 857, 21, 4847, "Input"],
Cell[648359, 17664, 321, 7, 2020, "Output"],
Cell[648683, 17673, 321, 7, 2020, "Output"]
}, Open  ]],
Cell[649019, 17683, 314, 6, 2020, "Text"],
Cell[CellGroupData[{
Cell[649358, 17693, 149, 4, 2020, "Input"],
Cell[649510, 17699, 232, 6, 2020, "Output"]
}, Open  ]],
Cell[649757, 17708, 335, 5, 2020, "Text"],
Cell[CellGroupData[{
Cell[650117, 17717, 747, 21, 6252, "Input"],
Cell[650867, 17740, 276, 6, 2020, "Output"],
Cell[651146, 17748, 274, 6, 2020, "Output"],
Cell[651423, 17756, 274, 6, 2020, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[651746, 17768, 254, 4, 1820, "Subsubsection"],
Cell[CellGroupData[{
Cell[652025, 17776, 364, 7, 2020, "Input"],
Cell[652392, 17785, 580, 13, 2978, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[653009, 17803, 283, 6, 2020, "Input"],
Cell[653295, 17811, 1169, 25, 2978, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[654501, 17841, 507, 7, 2020, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[655011, 17850, 947, 18, 3508, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[655961, 17870, 1534, 26, 2978, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[657498, 17898, 1534, 26, 2978, "Output",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[659035, 17926, 415, 6, 2020, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[CellGroupData[{
Cell[659487, 17937, 706, 16, 3508, "Input"],
Cell[660196, 17955, 1072, 19, 2978, "Output"],
Cell[661271, 17976, 1071, 19, 2978, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[662379, 18000, 698, 20, 3508, "Input"],
Cell[663080, 18022, 1114, 24, 2978, "Output"],
Cell[664197, 18048, 622, 9, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[664856, 18062, 642, 17, 2020, "Input"],
Cell[665501, 18081, 595, 9, 2020, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[666145, 18096, 179, 2, 1820, "Subsubsection"],
Cell[CellGroupData[{
Cell[666349, 18102, 463, 11, 4847, "Input"],
Cell[666815, 18115, 1312, 30, 2978, "Output"]
}, Open  ]],
Cell[668142, 18148, 420, 7, 2020, "Text"],
Cell[CellGroupData[{
Cell[668587, 18159, 264, 7, 2020, "Input"],
Cell[668854, 18168, 879, 18, 2837, "Print"],
Cell[669736, 18188, 794, 12, 2020, "Output"]
}, Open  ]],
Cell[670545, 18203, 241, 5, 2020, "Text"],
Cell[CellGroupData[{
Cell[670811, 18212, 224, 6, 2020, "Input"],
Cell[671038, 18220, 683, 12, 2020, "Output"]
}, Open  ]],
Cell[671736, 18235, 377, 12, 4847, "Input"],
Cell[CellGroupData[{
Cell[672138, 18251, 351, 8, 2020, "Input"],
Cell[672492, 18261, 1345, 23, 2978, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[673874, 18289, 249, 6, 2020, "Input"],
Cell[674126, 18297, 653, 15, 2978, "Output"]
}, Open  ]],
Cell[674794, 18315, 181, 2, 2020, "Text"],
Cell[CellGroupData[{
Cell[675000, 18321, 251, 6, 2020, "Input"],
Cell[675254, 18329, 1097, 23, 2837, "Print"],
Cell[676354, 18354, 487, 7, 2020, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[676890, 18367, 434, 6, 1820, "Subsubsection"],
Cell[677327, 18375, 560, 10, 6163, "Text"],
Cell[CellGroupData[{
Cell[677912, 18389, 271, 4, 6252, "Input"],
Cell[678186, 18395, 80, 2, 2020, "Output"],
Cell[678269, 18399, 28, 0, 2020, "Output"],
Cell[678300, 18401, 28, 0, 2020, "Output"],
Cell[678331, 18403, 87, 1, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[678455, 18409, 375, 10, 4847, "Input"],
Cell[678833, 18421, 142, 4, 2020, "Output"],
Cell[678978, 18427, 142, 4, 2020, "Output"],
Cell[679123, 18433, 80, 2, 2020, "Output"]
}, Open  ]],
Cell[679218, 18438, 42, 0, 2020, "Text"],
Cell[679263, 18440, 170, 5, 3156, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[679458, 18449, 892, 17, 3156, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[680353, 18468, 720, 11, 2020, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[681088, 18482, 278, 7, 3156, "Input",
 InitializationCell->True],
Cell[681369, 18491, 591, 8, 2020, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[681963, 18501, 443, 15, 3156, "Input",
 InitializationCell->True],
Cell[682409, 18518, 160, 5, 3156, "Input",
 InitializationCell->True],
Cell[682572, 18525, 382, 9, 3156, "Input",
 InitializationCell->True],
Cell[682957, 18536, 309, 8, 3156, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[683291, 18548, 884, 19, 2020, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[684178, 18569, 962, 15, 2020, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[685155, 18587, 254, 6, 3156, "Input",
 InitializationCell->True],
Cell[685412, 18595, 683, 9, 2020, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[686098, 18606, 294, 8, 3156, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[686417, 18618, 1412, 23, 6163, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}],
Cell[687832, 18643, 3493, 97, 18438, "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->True],
Cell[691328, 18742, 711, 9, 2020, "Text",
 CellGroupingRules->{GroupTogetherGrouping, 10000.}]
}, Open  ]],
Cell[692054, 18754, 2122, 49, 8726, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[694201, 18807, 585, 14, 4847, "Input"],
Cell[694789, 18823, 725, 15, 2837, "Print"],
Cell[695517, 18840, 510, 8, 2020, "Output"],
Cell[696030, 18850, 722, 15, 2837, "Print"],
Cell[696755, 18867, 512, 8, 2020, "Output"]
}, Open  ]],
Cell[697282, 18878, 397, 8, 2020, "Input"],
Cell[CellGroupData[{
Cell[697704, 18890, 223, 6, 2020, "Input"],
Cell[697930, 18898, 369, 10, 2978, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[698336, 18913, 249, 7, 2020, "Input"],
Cell[698588, 18922, 998, 26, 2978, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[699623, 18953, 157, 5, 2020, "Input"],
Cell[699783, 18960, 3024, 97, 5821, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[702844, 19062, 314, 9, 2020, "Input"],
Cell[703161, 19073, 242, 3, 2020, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[703464, 19083, 125, 3, 45, "Subsection"],
Cell[CellGroupData[{
Cell[703614, 19090, 36, 0, 44, "Subsubsection"],
Cell[703653, 19092, 453, 10, 5921, "Text"],
Cell[CellGroupData[{
Cell[704131, 19106, 67, 1, 1616, "Text"],
Cell[704201, 19109, 1123, 37, 97197, "Text"]
}, Closed]],
Cell[705339, 19149, 119, 3, 1391, "Text"],
Cell[705461, 19154, 537, 16, 1616, "Input"],
Cell[CellGroupData[{
Cell[706023, 19174, 361, 9, 3878, "Input"],
Cell[706387, 19185, 467, 14, 1616, "Output"],
Cell[706857, 19201, 467, 14, 1616, "Output"],
Cell[707327, 19217, 467, 14, 1616, "Output"]
}, Open  ]],
Cell[707809, 19234, 36, 0, 1577, "Text"],
Cell[707848, 19236, 450, 14, 2525, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[708323, 19254, 358, 9, 3878, "Input"],
Cell[708684, 19265, 467, 14, 1616, "Output"],
Cell[709154, 19281, 467, 14, 1616, "Output"],
Cell[709624, 19297, 467, 14, 1616, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[710128, 19316, 444, 14, 2807, "Input"],
Cell[710575, 19332, 81, 2, 1616, "Output"],
Cell[710659, 19336, 81, 2, 1616, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[710777, 19343, 65, 1, 1616, "Text"],
Cell[CellGroupData[{
Cell[710867, 19348, 191, 5, 1616, "Input"],
Cell[711061, 19355, 369, 10, 1616, "Output"]
}, Open  ]],
Cell[711445, 19368, 938, 26, 6106, "Input"],
Cell[712386, 19396, 60, 0, 1971, "Text"],
Cell[CellGroupData[{
Cell[712471, 19400, 632, 14, 9082, "Input"],
Cell[713106, 19416, 187, 6, 2020, "Output"],
Cell[713296, 19424, 135, 4, 2020, "Output"],
Cell[713434, 19430, 137, 4, 2020, "Output"],
Cell[713574, 19436, 137, 4, 2020, "Output"],
Cell[713714, 19442, 144, 4, 2020, "Output"],
Cell[713861, 19448, 147, 4, 2020, "Output"]
}, Open  ]],
Cell[714023, 19455, 65, 0, 2020, "Text"],
Cell[CellGroupData[{
Cell[714113, 19459, 99, 2, 2020, "Input"],
Cell[714215, 19463, 143, 4, 2020, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[714419, 19474, 42, 0, 35, "Subsubsection"],
Cell[714464, 19476, 394, 8, 5995, "Text"],
Cell[714861, 19486, 98, 2, 2525, "Input",
 InitializationCell->True],
Cell[714962, 19490, 240, 7, 2525, "Input",
 InitializationCell->True],
Cell[715205, 19499, 1030, 30, 8103, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[716260, 19533, 64, 1, 1616, "Text"],
Cell[CellGroupData[{
Cell[716349, 19538, 832, 27, 3878, "Input"],
Cell[717184, 19567, 135, 4, 1616, "Output"],
Cell[717322, 19573, 135, 4, 1616, "Output"],
Cell[717460, 19579, 135, 4, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[717632, 19588, 1185, 37, 4847, "Input"],
Cell[718820, 19627, 81, 2, 2020, "Output"],
Cell[718904, 19631, 81, 2, 2020, "Output"],
Cell[718988, 19635, 81, 2, 2020, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[719118, 19643, 65, 1, 2020, "Text"],
Cell[CellGroupData[{
Cell[719208, 19648, 535, 16, 11831, "Input"],
Cell[719746, 19666, 154, 5, 4931, "Output"],
Cell[719903, 19673, 154, 5, 4931, "Output"],
Cell[720060, 19680, 154, 5, 4931, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[720251, 19690, 345, 10, 8563, "Input"],
Cell[720599, 19702, 154, 5, 4931, "Output"],
Cell[720756, 19709, 154, 5, 4931, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[720947, 19719, 235, 7, 4931, "Input"],
Cell[721185, 19728, 402, 13, 4931, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[721624, 19746, 181, 5, 4931, "Input"],
Cell[721808, 19753, 402, 13, 4931, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[722247, 19771, 157, 4, 4931, "Input"],
Cell[722407, 19777, 28, 0, 4931, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[722472, 19782, 248, 7, 4931, "Input"],
Cell[722723, 19791, 28, 0, 4931, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[722788, 19796, 222, 6, 4931, "Input"],
Cell[723013, 19804, 648, 19, 4931, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[723698, 19828, 191, 5, 4931, "Input"],
Cell[723892, 19835, 462, 13, 4931, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[724415, 19855, 40, 0, 35, "Subsubsection"],
Cell[724458, 19857, 96, 2, 2525, "Input",
 InitializationCell->True],
Cell[724557, 19861, 236, 7, 2525, "Input",
 InitializationCell->True],
Cell[724796, 19870, 834, 24, 6981, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[725655, 19898, 65, 1, 1616, "Text"],
Cell[CellGroupData[{
Cell[725745, 19903, 529, 16, 11831, "Input"],
Cell[726277, 19921, 154, 5, 4931, "Output"],
Cell[726434, 19928, 154, 5, 4931, "Output"],
Cell[726591, 19935, 154, 5, 4931, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[726782, 19945, 189, 5, 4931, "Input"],
Cell[726974, 19952, 462, 13, 4931, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[727473, 19970, 189, 5, 4931, "Input"],
Cell[727665, 19977, 321, 10, 4931, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[728023, 19992, 246, 7, 4931, "Input"],
Cell[728272, 20001, 321, 10, 4931, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[728630, 20016, 391, 11, 11831, "Input"],
Cell[729024, 20029, 50, 1, 4931, "Output"],
Cell[729077, 20032, 50, 1, 4931, "Output"],
Cell[729130, 20035, 50, 1, 4931, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[729241, 20043, 37, 0, 35, "Subsubsection"],
Cell[729281, 20045, 162, 4, 2715, "Text"],
Cell[729446, 20051, 122, 3, 1616, "Text"],
Cell[729571, 20056, 299, 8, 3665, "Input",
 InitializationCell->True],
Cell[729873, 20066, 1078, 32, 6981, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[730976, 20102, 64, 1, 1616, "Text"],
Cell[CellGroupData[{
Cell[731065, 20107, 292, 8, 2807, "Input"],
Cell[731360, 20117, 74, 1, 1616, "Output"],
Cell[731437, 20120, 74, 1, 1616, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[731548, 20126, 500, 15, 2807, "Input"],
Cell[732051, 20143, 81, 2, 1616, "Output"],
Cell[732135, 20147, 81, 2, 1616, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[732265, 20155, 65, 1, 1616, "Text"],
Cell[CellGroupData[{
Cell[732355, 20160, 583, 17, 11831, "Input"],
Cell[732941, 20179, 246, 7, 4931, "Output"],
Cell[733190, 20188, 246, 7, 4931, "Output"],
Cell[733439, 20197, 246, 7, 4931, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[733722, 20209, 186, 5, 4931, "Input"],
Cell[733911, 20216, 246, 7, 4931, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[734194, 20228, 243, 7, 4931, "Input"],
Cell[734440, 20237, 246, 7, 4931, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[734723, 20249, 382, 11, 11831, "Input"],
Cell[735108, 20262, 50, 1, 4931, "Output"],
Cell[735161, 20265, 50, 1, 4931, "Output"],
Cell[735214, 20268, 50, 1, 4931, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[735337, 20277, 1011, 15, 56, "Subsection"],
Cell[736351, 20294, 763, 14, 18291, "Text"],
Cell[737117, 20310, 600, 9, 8282, "Text"],
Cell[737720, 20321, 418, 11, 7703, "Input",
 InitializationCell->True],
Cell[738141, 20334, 376, 10, 7703, "Input",
 InitializationCell->True],
Cell[738520, 20346, 518, 14, 7703, "Input",
 InitializationCell->True],
Cell[739041, 20362, 521, 14, 7703, "Input",
 InitializationCell->True],
Cell[739565, 20378, 734, 11, 8282, "Text"],
Cell[740302, 20391, 161, 3, 4931, "Input"],
Cell[740466, 20396, 516, 10, 11182, "Input",
 InitializationCell->True],
Cell[740985, 20408, 267, 5, 4931, "Text"],
Cell[741255, 20415, 338, 10, 7703, "Input",
 InitializationCell->True],
Cell[741596, 20427, 695, 12, 11737, "Text"],
Cell[CellGroupData[{
Cell[742316, 20443, 807, 23, 15262, "Input"],
Cell[743126, 20468, 332, 7, 4931, "Output"],
Cell[743461, 20477, 152, 2, 4931, "Output"],
Cell[743616, 20481, 149, 2, 4931, "Output"]
}, Open  ]],
Cell[743780, 20486, 470, 8, 4931, "Text"],
Cell[744253, 20496, 503, 9, 8282, "Text"],
Cell[744759, 20507, 456, 10, 7703, "Input",
 InitializationCell->True],
Cell[745218, 20519, 451, 10, 7703, "Input",
 InitializationCell->True],
Cell[745672, 20531, 382, 5, 4931, "Text"],
Cell[746057, 20538, 708, 17, 11182, "Input",
 InitializationCell->True],
Cell[746768, 20557, 716, 17, 11182, "Input",
 InitializationCell->True],
Cell[747487, 20576, 470, 8, 4931, "Text"],
Cell[747960, 20586, 619, 13, 7703, "Input",
 InitializationCell->True],
Cell[748582, 20601, 632, 13, 7703, "Input",
 InitializationCell->True],
Cell[749217, 20616, 571, 13, 5108, "Text"],
Cell[749791, 20631, 392, 11, 7703, "Input",
 InitializationCell->True],
Cell[750186, 20644, 384, 11, 7703, "Input",
 InitializationCell->True],
Cell[750573, 20657, 188, 4, 4931, "Text"],
Cell[750764, 20663, 110, 1, 4931, "Text"],
Cell[750877, 20666, 827, 19, 11182, "Input",
 InitializationCell->True],
Cell[751707, 20687, 257, 6, 8206, "Text"],
Cell[CellGroupData[{
Cell[751989, 20697, 638, 18, 11182, "Input",
 InitializationCell->True],
Cell[752630, 20717, 59, 1, 262, "Output"],
Cell[752692, 20720, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[752788, 20726, 831, 23, 11182, "Input",
 InitializationCell->True],
Cell[753622, 20751, 59, 1, 262, "Output"],
Cell[753684, 20754, 59, 1, 262, "Output"]
}, Open  ]],
Cell[753758, 20758, 95, 1, 4808, "Text"],
Cell[CellGroupData[{
Cell[753878, 20763, 671, 18, 8563, "Input",
 InitializationCell->True],
Cell[754552, 20783, 59, 1, 262, "Output"]
}, Open  ]],
Cell[754626, 20787, 241, 3, 4931, "Text"],
Cell[CellGroupData[{
Cell[754892, 20794, 693, 19, 7703, "Input",
 InitializationCell->True],
Cell[755588, 20815, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[755684, 20821, 751, 19, 7703, "Input",
 InitializationCell->True],
Cell[756438, 20842, 59, 1, 262, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[756546, 20849, 904, 13, 45, "Subsection"],
Cell[757453, 20864, 282, 5, 2020, "Text"],
Cell[CellGroupData[{
Cell[757760, 20873, 211, 2, 2383, "Subsubsection"],
Cell[757974, 20877, 302, 6, 3393, "Text"],
Cell[758279, 20885, 847, 23, 4581, "Input",
 InitializationCell->True],
Cell[759129, 20910, 7861, 155, 23993, "Input",
 InitializationCell->True],
Cell[766993, 21067, 2489, 52, 11516, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[769519, 21124, 327, 6, 1820, "Subsubsection"],
Cell[CellGroupData[{
Cell[769871, 21134, 1380, 37, 4581, "Input",
 InitializationCell->True],
Cell[771254, 21173, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[771350, 21179, 1456, 41, 4581, "Input",
 InitializationCell->True],
Cell[772809, 21222, 59, 1, 262, "Output"]
}, Open  ]],
Cell[772883, 21226, 1010, 20, 3553, "Text"],
Cell[773896, 21248, 1542, 42, 14257, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[775463, 21294, 109, 4, 2020, "Text"],
Cell[775575, 21300, 112, 3, 2020, "Text"],
Cell[775690, 21305, 89, 2, 2020, "Input"],
Cell[775782, 21309, 416, 14, 3508, "Input"],
Cell[776201, 21325, 390, 13, 3508, "Input"],
Cell[CellGroupData[{
Cell[776616, 21342, 273, 8, 3508, "Input"],
Cell[776892, 21352, 110, 3, 2020, "Output"],
Cell[777005, 21357, 86, 2, 2020, "Output"]
}, Open  ]],
Cell[777106, 21362, 109, 2, 2020, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[777252, 21369, 112, 4, 2020, "Text"],
Cell[777367, 21375, 115, 3, 2020, "Text"],
Cell[777485, 21380, 89, 2, 2020, "Input"],
Cell[777577, 21384, 330, 10, 3508, "Input"],
Cell[777910, 21396, 325, 10, 3508, "Input"],
Cell[CellGroupData[{
Cell[778260, 21410, 273, 8, 3508, "Input"],
Cell[778536, 21420, 187, 6, 2020, "Output"],
Cell[778726, 21428, 135, 4, 2020, "Output"]
}, Open  ]],
Cell[778876, 21435, 109, 2, 2020, "Input"]
}, Open  ]],
Cell[779000, 21440, 934, 14, 2020, "Text"],
Cell[779937, 21456, 1690, 44, 17075, "Input",
 InitializationCell->True],
Cell[781630, 21502, 1795, 47, 17363, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[783462, 21554, 97, 1, 1820, "Subsubsection"],
Cell[CellGroupData[{
Cell[783584, 21559, 786, 18, 1002750, "Input"],
Cell[784373, 21579, 355, 8, 1002750, "Output"],
Cell[784731, 21589, 218, 4, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[784986, 21598, 274, 7, 1002750, "Input"],
Cell[785263, 21607, 613, 10, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[785913, 21622, 315, 6, 1002750, "Input"],
Cell[786231, 21630, 595, 9, 1002750, "Output"],
Cell[786829, 21641, 500, 8, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[787366, 21654, 346, 6, 1002750, "Input"],
Cell[787715, 21662, 601, 9, 1002750, "Output"],
Cell[788319, 21673, 710, 15, 1002750, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[789078, 21694, 100, 1, 1820, "Subsubsection"],
Cell[789181, 21697, 379, 7, 420265, "Input"],
Cell[CellGroupData[{
Cell[789585, 21708, 147, 3, 175097, "Input"],
Cell[789735, 21713, 98, 1, 175097, "Output"]
}, Open  ]],
Cell[789848, 21717, 204, 3, 170775, "Text"],
Cell[CellGroupData[{
Cell[790077, 21724, 516, 12, 175097, "Input"],
Cell[790596, 21738, 662, 14, 126176, "Print"],
Cell[791261, 21754, 817, 19, 294190, "Output"]
}, Open  ]],
Cell[792093, 21776, 159, 2, 170775, "Text"],
Cell[CellGroupData[{
Cell[792277, 21782, 690, 13, 175097, "Input"],
Cell[792970, 21797, 682, 14, 126176, "Print"],
Cell[793655, 21813, 3456, 93, 554776, "Output"]
}, Open  ]],
Cell[797126, 21909, 392, 8, 403827, "Text"],
Cell[CellGroupData[{
Cell[797543, 21921, 495, 11, 175097, "Input"],
Cell[798041, 21934, 496, 11, 126176, "Print"],
Cell[798540, 21947, 28304, 811, 3204496, "Output"]
}, Open  ]],
Cell[826859, 22761, 135, 1, 175097, "Text"],
Cell[CellGroupData[{
Cell[827019, 22766, 130, 3, 175097, "Input"],
Cell[CellGroupData[{
Cell[827174, 22773, 186, 2, 126176, "Print"],
Cell[827363, 22777, 342, 8, 126176, "Print"]
}, Open  ]],
Cell[827720, 22788, 77, 1, 175097, "Output"]
}, Open  ]],
Cell[827812, 22792, 548, 10, 294190, "Text"],
Cell[CellGroupData[{
Cell[828385, 22806, 129, 2, 175097, "Input"],
Cell[828517, 22810, 1129, 26, 175097, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[829683, 22841, 140, 2, 175097, "Input"],
Cell[829826, 22845, 214, 4, 175097, "Output"]
}, Open  ]],
Cell[830055, 22852, 412, 13, 186557, "Text"],
Cell[CellGroupData[{
Cell[830492, 22869, 367, 9, 175097, "Input"],
Cell[830862, 22880, 538, 12, 126176, "Print"],
Cell[831403, 22894, 26760, 750, 2601172, "Output"]
}, Open  ]],
Cell[858178, 23647, 179, 4, 1002750, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[858406, 23657, 852, 13, 45, "Subsection"],
Cell[859261, 23672, 260, 5, 112063, "Text"],
Cell[CellGroupData[{
Cell[859546, 23681, 245, 3, 136620, "Subsubsection"],
Cell[859794, 23686, 399, 6, 304135, "Input",
 InitializationCell->True],
Cell[860196, 23694, 247, 5, 294190, "Text"],
Cell[860446, 23701, 964, 24, 304135, "Input",
 InitializationCell->True],
Cell[861413, 23727, 6722, 129, 1624053, "Input",
 InitializationCell->True],
Cell[868138, 23858, 2724, 57, 1023422, "Input",
 InitializationCell->True],
Cell[870865, 23917, 100, 1, 175097, "Text"],
Cell[CellGroupData[{
Cell[870990, 23922, 1699, 46, 304135, "Input",
 InitializationCell->True],
Cell[872692, 23970, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[872788, 23976, 1771, 52, 304135, "Input",
 InitializationCell->True],
Cell[874562, 24030, 59, 1, 262, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[874670, 24037, 97, 1, 109296, "Subsubsection"],
Cell[CellGroupData[{
Cell[874792, 24042, 140, 2, 175097, "Input"],
Cell[CellGroupData[{
Cell[874957, 24048, 310, 6, 126176, "Print"],
Cell[875270, 24056, 591, 12, 126176, "Print"]
}, Open  ]],
Cell[875876, 24071, 151, 2, 175097, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[876064, 24078, 105, 2, 175097, "Input"],
Cell[876172, 24082, 125, 2, 175097, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[876334, 24089, 250, 6, 175097, "Input"],
Cell[876587, 24097, 767, 16, 371962, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[877391, 24118, 530, 12, 661902, "Input"],
Cell[CellGroupData[{
Cell[877946, 24134, 308, 6, 126176, "Print"],
Cell[878257, 24142, 589, 12, 1002750, "Print"]
}, Open  ]],
Cell[878861, 24157, 349, 5, 1002750, "Output"],
Cell[879213, 24164, 340, 5, 1002750, "Output"],
Cell[879556, 24171, 392, 7, 1002750, "Output"],
Cell[879951, 24180, 392, 7, 1002750, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[880404, 24194, 794, 10, 45, "Subsection"],
Cell[881201, 24206, 191, 4, 112063, "Text"],
Cell[881395, 24212, 556, 15, 346983, "Input"],
Cell[881954, 24229, 116, 1, 112063, "Text"],
Cell[CellGroupData[{
Cell[882095, 24234, 559, 15, 213468, "Input"],
Cell[882657, 24251, 311, 8, 125950, "Output"],
Cell[882971, 24261, 337, 9, 125950, "Output"]
}, Open  ]],
Cell[883323, 24273, 130, 1, 112063, "Text"],
Cell[CellGroupData[{
Cell[883478, 24278, 573, 16, 126176, "Input"],
Cell[884054, 24296, 104, 2, 112063, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[884195, 24303, 559, 15, 213468, "Input"],
Cell[884757, 24320, 70, 1, 112063, "Output"],
Cell[884830, 24323, 70, 1, 112063, "Output"]
}, Open  ]],
Cell[884915, 24327, 186, 4, 112063, "Text"],
Cell[885104, 24333, 446, 12, 346983, "Input"],
Cell[CellGroupData[{
Cell[885575, 24349, 559, 15, 213468, "Input"],
Cell[886137, 24366, 288, 8, 125950, "Output"],
Cell[886428, 24376, 311, 9, 125950, "Output"]
}, Open  ]],
Cell[886754, 24388, 130, 1, 112063, "Text"],
Cell[CellGroupData[{
Cell[886909, 24393, 618, 17, 126176, "Input"],
Cell[887530, 24412, 102, 2, 112063, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[887669, 24419, 559, 15, 213468, "Input"],
Cell[888231, 24436, 70, 1, 112063, "Output"],
Cell[888304, 24439, 72, 1, 112063, "Output"]
}, Open  ]],
Cell[888391, 24443, 105, 1, 109296, "Text"],
Cell[CellGroupData[{
Cell[888521, 24448, 152, 3, 112063, "Input"],
Cell[888676, 24453, 117, 2, 112063, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[888830, 24460, 952, 23, 134588, "Input",
 InitializationCell->True],
Cell[889785, 24485, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[889881, 24491, 834, 22, 134588, "Input",
 InitializationCell->True],
Cell[890718, 24515, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[890814, 24521, 928, 22, 134588, "Input",
 InitializationCell->True],
Cell[891745, 24545, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[891841, 24551, 881, 22, 134588, "Input",
 InitializationCell->True],
Cell[892725, 24575, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[892821, 24581, 559, 15, 213468, "Input"],
Cell[893383, 24598, 70, 1, 112063, "Output"],
Cell[893456, 24601, 70, 1, 112063, "Output"]
}, Open  ]],
Cell[893541, 24605, 607, 16, 346983, "Input"],
Cell[CellGroupData[{
Cell[894173, 24625, 2554, 67, 849932, "Input"],
Cell[896730, 24694, 267, 7, 112063, "Output"]
}, Open  ]],
Cell[897012, 24704, 528, 13, 194647, "Input"],
Cell[CellGroupData[{
Cell[897565, 24721, 2948, 77, 849932, "Input"],
Cell[900516, 24800, 242, 6, 112063, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[900795, 24811, 2202, 54, 581190, "Input"],
Cell[903000, 24867, 182, 4, 112063, "Output"]
}, Open  ]],
Cell[903197, 24874, 567, 11, 427481, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[903801, 24890, 1249, 18, 262, "Subsection"],
Cell[905053, 24910, 489, 9, 3393, "Text"],
Cell[905545, 24921, 209, 3, 2020, "Text"],
Cell[905757, 24926, 1822, 41, 12931, "Input",
 InitializationCell->True],
Cell[907582, 24969, 205, 3, 2020, "Text"],
Cell[907790, 24974, 1842, 42, 11801, "Input"],
Cell[CellGroupData[{
Cell[909657, 25020, 806, 22, 4847, "Input"],
Cell[910466, 25044, 662, 17, 2020, "Output"],
Cell[911131, 25063, 351, 7, 2020, "Output"],
Cell[911485, 25072, 351, 7, 2020, "Output"]
}, Open  ]],
Cell[911851, 25082, 191, 2, 2020, "Text"],
Cell[CellGroupData[{
Cell[912067, 25088, 1102, 33, 6252, "Input"],
Cell[913172, 25123, 328, 7, 2020, "Output"],
Cell[913503, 25132, 331, 7, 2020, "Output"],
Cell[913837, 25141, 331, 7, 2020, "Output"]
}, Open  ]],
Cell[914183, 25151, 539, 9, 2020, "Text"],
Cell[914725, 25162, 392, 9, 3156, "Input",
 InitializationCell->True],
Cell[915120, 25173, 526, 7, 2020, "Text"],
Cell[915649, 25182, 511, 14, 2020, "Input"],
Cell[916163, 25198, 622, 15, 4581, "Input",
 InitializationCell->True],
Cell[916788, 25215, 685, 11, 2020, "Text"],
Cell[CellGroupData[{
Cell[917498, 25230, 699, 19, 3508, "Input"],
Cell[918200, 25251, 340, 5, 2020, "Output"],
Cell[918543, 25258, 338, 5, 2020, "Output"]
}, Open  ]],
Cell[918896, 25266, 594, 8, 2020, "Text"],
Cell[919493, 25276, 1192, 31, 4581, "Input",
 InitializationCell->True],
Cell[920688, 25309, 677, 11, 2020, "Text"],
Cell[921368, 25322, 332, 5, 2020, "Text"],
Cell[921703, 25329, 122, 2, 2020, "Text"],
Cell[921828, 25333, 183, 3, 2020, "Text"],
Cell[922014, 25338, 97, 1, 1002750, "Text"],
Cell[922114, 25341, 125, 2, 1002750, "Text"],
Cell[922242, 25345, 136, 2, 1002750, "Text"],
Cell[922381, 25349, 677, 11, 1002750, "Text"],
Cell[923061, 25362, 3175, 66, 1002750, "Input"],
Cell[926239, 25430, 1297, 34, 1002750, "Input"],
Cell[927539, 25466, 652, 10, 1002750, "Text"],
Cell[CellGroupData[{
Cell[928216, 25480, 3435, 72, 1002750, "Input",
 InitializationCell->True],
Cell[931654, 25554, 59, 1, 262, "Output"]
}, Open  ]],
Cell[931728, 25558, 378, 5, 1002750, "Text"],
Cell[932109, 25565, 1131, 26, 1002750, "Input",
 InitializationCell->True],
Cell[933243, 25593, 1547, 35, 1002750, "Input"],
Cell[934793, 25630, 382, 5, 1002750, "Text"],
Cell[935178, 25637, 1289, 28, 1002750, "Input"],
Cell[CellGroupData[{
Cell[936492, 25669, 533, 14, 1002750, "Input"],
Cell[937028, 25685, 561, 12, 1002750, "Print"],
Cell[937592, 25699, 2193, 58, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[939822, 25762, 99, 1, 1002750, "Subsubsection"],
Cell[939924, 25765, 166, 2, 1002750, "Text"],
Cell[CellGroupData[{
Cell[940115, 25771, 781, 20, 1002750, "Input"],
Cell[940899, 25793, 245, 6, 1002750, "Output"],
Cell[941147, 25801, 3462, 97, 1002750, "Print"],
Cell[944612, 25900, 245, 6, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[944894, 25911, 321, 7, 1002750, "Input"],
Cell[945218, 25920, 92, 1, 1002750, "Output"],
Cell[945313, 25923, 92, 1, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[945442, 25929, 482, 14, 1002750, "Input"],
Cell[945927, 25945, 123, 2, 1002750, "Output"],
Cell[946053, 25949, 124, 2, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[946214, 25956, 1516, 39, 1002750, "Input"],
Cell[947733, 25997, 728, 16, 1002750, "Print"],
Cell[948464, 26015, 193, 3, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[948694, 26023, 1491, 39, 1002750, "Input"],
Cell[950188, 26064, 731, 16, 1002750, "Print"],
Cell[950922, 26082, 166, 2, 1002750, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[951149, 26091, 1889, 38, 306, "Subsection"],
Cell[953041, 26131, 2320, 43, 1572, "Text"],
Cell[955364, 26176, 100, 1, 340, "Text"],
Cell[955467, 26179, 349, 7, 571, "Text"],
Cell[CellGroupData[{
Cell[955841, 26190, 799, 19, 1085, "Input"],
Cell[956643, 26211, 264, 5, 340, "Output"],
Cell[956910, 26218, 386, 8, 157, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[957333, 26231, 672, 18, 243, "Input",
 InitializationCell->True],
Cell[958008, 26251, 59, 1, 140, "Output"]
}, Open  ]],
Cell[958082, 26255, 86, 1, 1293, "Input"],
Cell[CellGroupData[{
Cell[958193, 26260, 301, 4, 1526, "Subsubsection"],
Cell[CellGroupData[{
Cell[958519, 26268, 1187, 28, 5540, "Input"],
Cell[959709, 26298, 202, 3, 140, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[959948, 26306, 1437, 35, 782, "Input",
 InitializationCell->True],
Cell[961388, 26343, 59, 1, 140, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[961484, 26349, 1284, 29, 590, "Input",
 InitializationCell->True],
Cell[962771, 26380, 59, 1, 140, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[962879, 26387, 254, 3, 165, "Subsubsection"],
Cell[963136, 26392, 532, 14, 2270, "Input",
 InitializationCell->True],
Cell[963671, 26408, 159, 3, 1293, "Text"],
Cell[CellGroupData[{
Cell[963855, 26415, 1018, 22, 2270, "Input",
 InitializationCell->True],
Cell[964876, 26439, 59, 1, 262, "Output"]
}, Open  ]],
Cell[964950, 26443, 250, 6, 1293, "Text",
 CellID->1452602318],
Cell[965203, 26451, 120, 1, 1293, "Text"],
Cell[965326, 26454, 601, 13, 2020, "Input",
 InitializationCell->True],
Cell[965930, 26469, 392, 10, 2020, "Input",
 InitializationCell->True],
Cell[966325, 26481, 158, 3, 1293, "Text"],
Cell[CellGroupData[{
Cell[966508, 26488, 631, 17, 2270, "Input",
 InitializationCell->True],
Cell[967142, 26507, 59, 1, 262, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[967250, 26514, 154, 2, 1165, "Subsubsection"],
Cell[967407, 26518, 138, 4, 291495, "Text"],
Cell[CellGroupData[{
Cell[967570, 26526, 424, 9, 313672, "Input"],
Cell[967997, 26537, 336, 7, 196796, "Output"],
Cell[968336, 26546, 470, 12, 196796, "Output"]
}, Open  ]],
Cell[968821, 26561, 167, 2, 175097, "Text"],
Cell[CellGroupData[{
Cell[969013, 26567, 237, 4, 186557, "Input"],
Cell[CellGroupData[{
Cell[969275, 26575, 288, 5, 126176, "Print"],
Cell[969566, 26582, 598, 14, 126176, "Print"]
}, Open  ]],
Cell[970179, 26599, 250, 4, 175097, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[970478, 26609, 167, 2, 1165, "Subsubsection"],
Cell[970648, 26613, 127, 1, 1293, "Text"],
Cell[CellGroupData[{
Cell[970800, 26618, 406, 12, 1293, "Input"],
Cell[971209, 26632, 322, 10, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[971568, 26647, 367, 11, 1293, "Input"],
Cell[971938, 26660, 293, 9, 1293, "Output"]
}, Open  ]],
Cell[972246, 26672, 324, 11, 1293, "Input"],
Cell[CellGroupData[{
Cell[972595, 26687, 368, 11, 1293, "Input"],
Cell[972966, 26700, 344, 10, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[973347, 26715, 1072, 33, 2246, "Input"],
Cell[974422, 26750, 279, 6, 1293, "Output"],
Cell[974704, 26758, 281, 6, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[975022, 26769, 259, 7, 1293, "Input"],
Cell[975284, 26778, 6337, 204, 6675, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[981658, 26987, 639, 18, 2246, "Input"],
Cell[982300, 27007, 230, 6, 1293, "Output"],
Cell[982533, 27015, 233, 6, 1293, "Output"]
}, Open  ]],
Cell[982781, 27024, 129, 2, 1293, "Input"],
Cell[CellGroupData[{
Cell[982935, 27030, 360, 10, 1293, "Input"],
Cell[983298, 27042, 386, 10, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[983721, 27057, 153, 3, 1293, "Input"],
Cell[983877, 27062, 6323, 203, 6675, "Output"]
}, Open  ]],
Cell[990215, 27268, 264, 5, 1293, "Text"],
Cell[990482, 27275, 504, 14, 1293, "Input"],
Cell[CellGroupData[{
Cell[991011, 27293, 980, 25, 4002, "Input"],
Cell[991994, 27320, 305, 7, 1293, "Output"],
Cell[992302, 27329, 307, 7, 1293, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[992658, 27342, 373, 5, 1165, "Subsubsection"],
Cell[993034, 27349, 594, 14, 1002750, "Text"],
Cell[CellGroupData[{
Cell[993653, 27367, 415, 12, 1002750, "Input"],
Cell[994071, 27381, 97, 1, 1002750, "Output"],
Cell[994171, 27384, 98, 1, 1002750, "Output"]
}, Closed]],
Cell[994284, 27388, 201, 3, 1002750, "Text"],
Cell[CellGroupData[{
Cell[994510, 27395, 1167, 23, 1002750, "Input",
 InitializationCell->True],
Cell[995680, 27420, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[995776, 27426, 853, 23, 1002750, "Input",
 InitializationCell->True],
Cell[996632, 27451, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[996728, 27457, 694, 19, 1002750, "Input",
 InitializationCell->True],
Cell[997425, 27478, 59, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[997521, 27484, 945, 25, 1002750, "Input",
 InitializationCell->True],
Cell[998469, 27511, 59, 1, 262, "Output"]
}, Open  ]],
Cell[998543, 27515, 1860, 45, 1002750, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1000428, 27564, 1441, 35, 1002750, "Input"],
Cell[1001872, 27601, 565, 13, 1002750, "Output"],
Cell[1002440, 27616, 601, 14, 1002750, "Output"],
Cell[1003044, 27632, 602, 14, 1002750, "Output"],
Cell[1003649, 27648, 631, 15, 1002750, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1004329, 27669, 648, 14, 1293, "Subsubsection"],
Cell[1004980, 27685, 232, 5, 1002750, "Text"],
Cell[1005215, 27692, 2059, 32, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1007299, 27728, 1786, 39, 1002750, "Input",
 InitializationCell->True],
Cell[1009088, 27769, 59, 1, 262, "Output"]
}, Open  ]],
Cell[1009162, 27773, 1949, 28, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1011136, 27805, 1711, 34, 1002750, "Input",
 InitializationCell->True],
Cell[1012850, 27841, 59, 1, 262, "Output"]
}, Open  ]],
Cell[1012924, 27845, 224, 5, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1013173, 27854, 418, 11, 1002750, "Input"],
Cell[1013594, 27867, 247, 6, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1013878, 27878, 489, 13, 1002750, "Input"],
Cell[1014370, 27893, 284, 7, 1002750, "Output"],
Cell[1014657, 27902, 195, 4, 1002750, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1014901, 27912, 98, 1, 1165, "Subsubsection"],
Cell[CellGroupData[{
Cell[1015024, 27917, 917, 23, 1002750, "Input"],
Cell[1015944, 27942, 384, 10, 1002750, "Output"],
Cell[1016331, 27954, 298, 7, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1016666, 27966, 768, 19, 1002750, "Input"],
Cell[1017437, 27987, 436, 9, 1002750, "Output"]
}, Open  ]]
}, Closed]],
Cell[1017900, 28000, 172, 2, 1165, "Subsubsection"],
Cell[CellGroupData[{
Cell[1018097, 28006, 342, 5, 1165, "Subsubsection"],
Cell[1018442, 28013, 171, 4, 1002750, "Text"],
Cell[1018616, 28019, 158, 4, 1002750, "Text"],
Cell[1018777, 28025, 949, 26, 1002750, "Input"],
Cell[1019729, 28053, 228, 5, 1002750, "Text"],
Cell[1019960, 28060, 712, 20, 1002750, "Input"],
Cell[1020675, 28082, 1773, 41, 1002750, "Input"],
Cell[CellGroupData[{
Cell[1022473, 28127, 1078, 27, 1002750, "Input"],
Cell[1023554, 28156, 363, 8, 1002750, "Output"],
Cell[1023920, 28166, 362, 8, 1002750, "Output"],
Cell[1024285, 28176, 554, 15, 1002750, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1024888, 28197, 363, 4, 1165, "Subsubsection"],
Cell[1025254, 28203, 124, 1, 1002750, "Text"],
Cell[1025381, 28206, 227, 5, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1025633, 28215, 933, 20, 1002750, "Input",
 InitializationCell->True],
Cell[1026569, 28237, 388, 11, 262, "Output"]
}, Open  ]],
Cell[1026972, 28251, 848, 22, 1002750, "Input",
 InitializationCell->True],
Cell[1027823, 28275, 737, 19, 1002750, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1028597, 28299, 214, 3, 1165, "Subsubsection"],
Cell[1028814, 28304, 534, 9, 3078, "Text"],
Cell[1029351, 28315, 1649, 37, 9327, "Input"],
Cell[CellGroupData[{
Cell[1031025, 28356, 521, 12, 2246, "Input"],
Cell[1031549, 28370, 451, 9, 1293, "Output"],
Cell[1032003, 28381, 451, 9, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1032491, 28395, 381, 10, 2246, "Input"],
Cell[1032875, 28407, 329, 7, 1293, "Output"],
Cell[1033207, 28416, 513, 10, 891, "Message"],
Cell[1033723, 28428, 329, 7, 1293, "Output"]
}, Open  ]],
Cell[1034067, 28438, 231, 5, 2172, "Text"],
Cell[CellGroupData[{
Cell[1034323, 28447, 247, 6, 1293, "Input"],
Cell[1034573, 28455, 302, 7, 1293, "Output"]
}, Open  ]],
Cell[1034890, 28465, 179, 2, 1293, "Text"],
Cell[CellGroupData[{
Cell[1035094, 28471, 377, 10, 2246, "Input"],
Cell[1035474, 28483, 205, 5, 1293, "Output"],
Cell[1035682, 28490, 205, 5, 1293, "Output"]
}, Open  ]],
Cell[1035902, 28498, 227, 3, 1293, "Text"],
Cell[CellGroupData[{
Cell[1036154, 28505, 599, 15, 2246, "Input"],
Cell[1036756, 28522, 308, 7, 1293, "Output"],
Cell[1037067, 28531, 308, 7, 1293, "Output"]
}, Open  ]],
Cell[1037390, 28541, 277, 3, 1293, "Text"],
Cell[CellGroupData[{
Cell[1037692, 28548, 647, 15, 2246, "Input"],
Cell[1038342, 28565, 349, 7, 1293, "Output"],
Cell[1038694, 28574, 349, 7, 2020, "Output"]
}, Open  ]],
Cell[1039058, 28584, 268, 3, 2020, "Text"],
Cell[CellGroupData[{
Cell[1039351, 28591, 697, 16, 3508, "Input"],
Cell[1040051, 28609, 258, 7, 2020, "Output"],
Cell[1040312, 28618, 260, 7, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1040609, 28630, 498, 13, 3508, "Input"],
Cell[1041110, 28645, 202, 5, 2020, "Output"],
Cell[1041315, 28652, 200, 5, 2020, "Output"]
}, Open  ]],
Cell[1041530, 28660, 16, 0, 1971, "Text"],
Cell[1041549, 28662, 365, 10, 3508, "Input"],
Cell[CellGroupData[{
Cell[1041939, 28676, 740, 17, 3618, "Input"],
Cell[1042682, 28695, 572, 16, 2270, "Output"],
Cell[1043257, 28713, 794, 23, 2270, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1044088, 28741, 511, 16, 2020, "Input"],
Cell[1044602, 28759, 573, 18, 2020, "Output"]
}, Open  ]],
Cell[1045190, 28780, 305, 6, 2020, "Text"],
Cell[1045498, 28788, 916, 23, 2837, "Input"],
Cell[1046417, 28813, 178, 4, 2020, "Text"],
Cell[CellGroupData[{
Cell[1046620, 28821, 684, 18, 4965, "Input"],
Cell[1047307, 28841, 629, 19, 2270, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1047985, 28866, 346, 6, 1165, "Subsubsection"],
Cell[1048334, 28874, 957, 17, 1002750, "Text"],
Cell[1049294, 28893, 976, 24, 1002750, "Input"],
Cell[1050273, 28919, 178, 4, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1050476, 28927, 670, 17, 1002750, "Input"],
Cell[1051149, 28946, 557, 16, 1002750, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1051755, 28968, 480, 8, 1165, "Subsubsection"],
Cell[1052238, 28978, 431, 10, 181433, "Text"],
Cell[1052672, 28990, 747, 12, 416928, "Text"],
Cell[CellGroupData[{
Cell[1053444, 29006, 2275, 56, 358550, "Input"],
Cell[1055722, 29064, 126, 2, 175097, "Output"]
}, Open  ]],
Cell[1055863, 29069, 602, 16, 420265, "Input"],
Cell[1056468, 29087, 126, 2, 175097, "Input"],
Cell[CellGroupData[{
Cell[1056619, 29093, 396, 9, 186557, "Input"],
Cell[CellGroupData[{
Cell[1057040, 29106, 1255, 34, 126176, "Print"],
Cell[1058298, 29142, 865, 26, 126176, "Print"]
}, Open  ]],
Cell[1059178, 29171, 519, 11, 186557, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1059734, 29187, 428, 9, 186557, "Input"],
Cell[1060165, 29198, 427, 10, 186557, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1060641, 29214, 246, 3, 1165, "Subsubsection"],
Cell[1060890, 29219, 2189, 57, 1130470, "Text"]
}, Closed]],
Cell[1063094, 29279, 60, 1, 1010, "Input"],
Cell[CellGroupData[{
Cell[1063179, 29284, 521, 8, 1526, "Subsubsection"],
Cell[1063703, 29294, 577, 11, 1002750, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1064317, 29310, 478, 8, 1165, "Subsubsection"],
Cell[CellGroupData[{
Cell[1064820, 29322, 613, 15, 1553, "Input"],
Cell[1065436, 29339, 123, 2, 1293, "Output"]
}, Open  ]],
Cell[1065574, 29344, 304, 6, 1293, "Text"],
Cell[1065881, 29352, 631, 15, 1293, "Input"],
Cell[1066515, 29369, 542, 9, 1293, "Text"],
Cell[1067060, 29380, 873, 22, 1293, "Input"],
Cell[1067936, 29404, 159, 3, 1293, "Text"],
Cell[CellGroupData[{
Cell[1068120, 29411, 1189, 27, 4002, "Input"],
Cell[1069312, 29440, 414, 8, 1293, "Output"],
Cell[1069729, 29450, 416, 8, 1293, "Output"]
}, Open  ]],
Cell[1070160, 29461, 282, 5, 1293, "Text"],
Cell[1070445, 29468, 2784, 53, 4002, "Input"],
Cell[1073232, 29523, 305, 5, 1293, "Text"],
Cell[1073540, 29530, 6152, 143, 21465, "Input"],
Cell[CellGroupData[{
Cell[1079717, 29677, 729, 19, 1453, "Input"],
Cell[1080449, 29698, 780, 21, 1526, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1081278, 29725, 441, 8, 1165, "Subsubsection"],
Cell[CellGroupData[{
Cell[1081744, 29737, 1863, 48, 229472, "Input"],
Cell[1083610, 29787, 453, 7, 112063, "Output"]
}, Open  ]],
Cell[1084078, 29797, 407, 7, 112063, "Text"],
Cell[1084488, 29806, 186, 4, 112063, "Text"],
Cell[CellGroupData[{
Cell[1084699, 29814, 955, 25, 134588, "Input"],
Cell[1085657, 29841, 411, 6, 112063, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1086117, 29853, 97, 1, 1165, "Subsubsection"],
Cell[1086217, 29856, 239, 5, 1293, "Text"],
Cell[1086459, 29863, 172, 3, 1293, "Input"],
Cell[CellGroupData[{
Cell[1086656, 29870, 1659, 43, 2570, "Input"],
Cell[1088318, 29915, 1111, 25, 1526, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1089466, 29945, 826, 22, 1526, "Input"],
Cell[1090295, 29969, 477, 10, 1293, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1090821, 29985, 465, 7, 1165, "Subsubsection"],
Cell[1091289, 29994, 344, 7, 188282, "Text"],
Cell[CellGroupData[{
Cell[1091658, 30005, 541, 15, 132182, "Input",
 InitializationCell->True],
Cell[1092202, 30022, 59, 1, 262, "Output"]
}, Open  ]],
Cell[1092276, 30026, 524, 8, 188282, "Text"],
Cell[1092803, 30036, 2103, 48, 268970, "Input",
 InitializationCell->True],
Cell[1094909, 30086, 758, 14, 336212, "Text"],
Cell[CellGroupData[{
Cell[1095692, 30104, 2139, 51, 134588, "Input",
 InitializationCell->True],
Cell[1097834, 30157, 59, 1, 262, "Output"]
}, Open  ]],
Cell[1097908, 30161, 581, 8, 112063, "Text"],
Cell[CellGroupData[{
Cell[1098514, 30173, 2044, 50, 229472, "Input",
 InitializationCell->True],
Cell[1100561, 30225, 59, 1, 262, "Output"]
}, Open  ]],
Cell[1100635, 30229, 464, 6, 112063, "Text"],
Cell[CellGroupData[{
Cell[1101124, 30239, 2194, 53, 229472, "Input",
 InitializationCell->True],
Cell[1103321, 30294, 59, 1, 262, "Output"]
}, Open  ]],
Cell[1103395, 30298, 419, 5, 112063, "Text"],
Cell[CellGroupData[{
Cell[1103839, 30307, 2244, 55, 229472, "Input",
 InitializationCell->True],
Cell[1106086, 30364, 59, 1, 262, "Output"]
}, Open  ]],
Cell[1106160, 30368, 803, 15, 336212, "Text"],
Cell[CellGroupData[{
Cell[1106988, 30387, 1663, 34, 134588, "Input",
 InitializationCell->True],
Cell[1108654, 30423, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1108729, 30427, 581, 8, 112063, "Text"],
Cell[CellGroupData[{
Cell[1109335, 30439, 1543, 32, 134588, "Input",
 InitializationCell->True],
Cell[1110881, 30473, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1110956, 30477, 464, 6, 112063, "Text"],
Cell[CellGroupData[{
Cell[1111445, 30487, 1687, 35, 134588, "Input",
 InitializationCell->True],
Cell[1113135, 30524, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1113210, 30528, 419, 5, 112063, "Text"],
Cell[CellGroupData[{
Cell[1113654, 30537, 1677, 36, 134588, "Input",
 InitializationCell->True],
Cell[1115334, 30575, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1115409, 30579, 981, 21, 341985, "Text"],
Cell[1116393, 30602, 1266, 28, 346983, "Input"],
Cell[1117662, 30632, 682, 17, 119397, "Text"],
Cell[1118347, 30651, 1309, 28, 346983, "Input"],
Cell[CellGroupData[{
Cell[1119681, 30683, 999, 27, 268970, "Input"],
Cell[1120683, 30712, 75, 1, 112063, "Output"],
Cell[1120761, 30715, 75, 1, 112063, "Output"]
}, Open  ]],
Cell[1120851, 30719, 281, 5, 109296, "Text"],
Cell[1121135, 30726, 331, 6, 112063, "Text"],
Cell[1121469, 30734, 601, 10, 112063, "Text"],
Cell[1122073, 30746, 1753, 36, 268970, "Input",
 InitializationCell->True],
Cell[1123829, 30784, 295, 6, 112063, "Text"],
Cell[CellGroupData[{
Cell[1124149, 30794, 147, 3, 112063, "Input"],
Cell[1124299, 30799, 501, 9, 77121, "Message"],
Cell[1124803, 30810, 148, 3, 112063, "Output"]
}, Open  ]],
Cell[1124966, 30816, 303, 5, 112063, "Text"],
Cell[1125272, 30823, 252, 3, 109296, "Text"],
Cell[CellGroupData[{
Cell[1125549, 30830, 2233, 55, 229472, "Input",
 InitializationCell->True],
Cell[1127785, 30887, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1127882, 30893, 1698, 44, 229472, "Input",
 InitializationCell->True],
Cell[1129583, 30939, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1129658, 30943, 478, 8, 109296, "Text"],
Cell[CellGroupData[{
Cell[1130161, 30955, 2501, 56, 229472, "Input",
 InitializationCell->True],
Cell[1132665, 31013, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1132740, 31017, 507, 8, 109296, "Text"],
Cell[CellGroupData[{
Cell[1133272, 31029, 2136, 52, 229472, "Input",
 InitializationCell->True],
Cell[1135411, 31083, 60, 1, 262, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1135520, 31090, 348, 9, 1293, "Subsubsection"],
Cell[1135871, 31101, 158, 3, 1002750, "Text"],
Cell[1136032, 31106, 704, 18, 1002750, "Input"],
Cell[CellGroupData[{
Cell[1136761, 31128, 518, 14, 1002750, "Input"],
Cell[1137282, 31144, 348, 8, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1137667, 31157, 437, 10, 1002750, "Input"],
Cell[1138107, 31169, 321, 6, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1138465, 31180, 376, 9, 1002750, "Input"],
Cell[1138844, 31191, 327, 9, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1139208, 31205, 353, 8, 1002750, "Input"],
Cell[1139564, 31215, 197, 5, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1139798, 31225, 435, 12, 1002750, "Input"],
Cell[1140236, 31239, 401, 12, 1002750, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1140686, 31257, 98, 1, 1165, "Subsubsection"],
Cell[1140787, 31260, 511, 14, 1002750, "Input"],
Cell[CellGroupData[{
Cell[1141323, 31278, 1118, 26, 1002750, "Input"],
Cell[1142444, 31306, 342, 7, 1002750, "Output"],
Cell[1142789, 31315, 342, 7, 1002750, "Output"],
Cell[1143134, 31324, 342, 7, 1002750, "Output"],
Cell[1143479, 31333, 342, 7, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1143858, 31345, 1196, 26, 1002750, "Input"],
Cell[1145057, 31373, 399, 8, 1002750, "Output"],
Cell[1145459, 31383, 399, 8, 1002750, "Output"],
Cell[1145861, 31393, 476, 10, 1002750, "Output"],
Cell[1146340, 31405, 476, 10, 1002750, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1146865, 31421, 460, 8, 1165, "Subsubsection"],
Cell[1147328, 31431, 220, 4, 1002750, "Text"],
Cell[1147551, 31437, 279, 5, 1002750, "Text"],
Cell[1147833, 31444, 463, 8, 1002750, "Text"],
Cell[1148299, 31454, 1000, 28, 1002750, "Input",
 InitializationCell->True],
Cell[1149302, 31484, 555, 9, 1002750, "Text"],
Cell[1149860, 31495, 3443, 71, 1002750, "Input",
 InitializationCell->True],
Cell[1153306, 31568, 698, 12, 1002750, "Text"],
Cell[1154007, 31582, 241, 3, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1154273, 31589, 2250, 52, 1002750, "Input",
 InitializationCell->True],
Cell[1156526, 31643, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1156601, 31647, 287, 3, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1156913, 31654, 2309, 54, 1002750, "Input",
 InitializationCell->True],
Cell[1159225, 31710, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1159300, 31714, 338, 4, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1159663, 31722, 2411, 53, 1002750, "Input",
 InitializationCell->True],
Cell[1162077, 31777, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1162152, 31781, 387, 5, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1162564, 31790, 2477, 55, 1002750, "Input",
 InitializationCell->True],
Cell[1165044, 31847, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1165119, 31851, 1003, 16, 1002750, "Text"],
Cell[1166125, 31869, 241, 3, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1166391, 31876, 1753, 35, 1002750, "Input",
 InitializationCell->True],
Cell[1168147, 31913, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1168222, 31917, 287, 3, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1168534, 31924, 1887, 38, 1002750, "Input",
 InitializationCell->True],
Cell[1170424, 31964, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1170499, 31968, 338, 4, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1170862, 31976, 1819, 36, 1002750, "Input",
 InitializationCell->True],
Cell[1172684, 32014, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1172759, 32018, 387, 5, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1173171, 32027, 1853, 37, 1002750, "Input",
 InitializationCell->True],
Cell[1175027, 32066, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1175102, 32070, 717, 20, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1175844, 32094, 253, 6, 1002750, "Input"],
Cell[1176100, 32102, 206, 5, 1002750, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1176355, 32113, 98, 1, 1165, "Subsubsection"],
Cell[1176456, 32116, 388, 10, 304135, "Input"],
Cell[CellGroupData[{
Cell[1176869, 32130, 1569, 43, 614163, "Input"],
Cell[1178441, 32175, 612, 14, 196796, "Output"],
Cell[1179056, 32191, 648, 15, 196796, "Output"],
Cell[1179707, 32208, 574, 12, 196796, "Output"],
Cell[1180284, 32222, 612, 14, 196796, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1180933, 32241, 695, 17, 443821, "Input"],
Cell[CellGroupData[{
Cell[1181653, 32262, 2808, 75, 149246, "Print"],
Cell[1184464, 32339, 1443, 41, 149246, "Print"],
Cell[1185910, 32382, 2808, 75, 149246, "Print"],
Cell[1188721, 32459, 1772, 50, 149246, "Print"]
}, Open  ]],
Cell[1190508, 32512, 564, 15, 196796, "Output"]
}, Open  ]],
Cell[1191087, 32530, 244, 6, 291495, "Text"],
Cell[CellGroupData[{
Cell[1191356, 32540, 408, 12, 196796, "Input"],
Cell[1191767, 32554, 520, 14, 196796, "Output"]
}, Open  ]],
Cell[1192302, 32571, 190, 4, 175097, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1192529, 32580, 427, 8, 1165, "Subsubsection"],
Cell[1192959, 32590, 534, 9, 2172, "Text"],
Cell[1193496, 32601, 488, 8, 1293, "Text"],
Cell[1193987, 32611, 827, 16, 6483, "Text"],
Cell[1194817, 32629, 457, 15, 1293, "Input"],
Cell[1195277, 32646, 744, 17, 6675, "Input"],
Cell[1196024, 32665, 211, 5, 1293, "Input"],
Cell[1196238, 32672, 844, 13, 2152, "Text"],
Cell[1197085, 32687, 287, 7, 2020, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1197397, 32698, 403, 9, 1293, "Input"],
Cell[1197803, 32709, 279, 6, 1293, "Output"]
}, Open  ]],
Cell[1198097, 32718, 349, 7, 1293, "Text"],
Cell[1198449, 32727, 737, 19, 2932, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1199211, 32750, 376, 9, 2246, "Input"],
Cell[1199590, 32761, 185, 4, 1293, "Output"],
Cell[1199778, 32767, 182, 4, 1293, "Output"]
}, Open  ]],
Cell[1199975, 32774, 598, 10, 2152, "Text"],
Cell[1200576, 32786, 798, 22, 4706, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1201399, 32812, 226, 5, 1293, "Input"],
Cell[1201628, 32819, 476, 15, 1293, "Output"]
}, Open  ]],
Cell[1202119, 32837, 693, 11, 2152, "Text"],
Cell[1202815, 32850, 682, 16, 1293, "Input"],
Cell[CellGroupData[{
Cell[1203522, 32870, 361, 9, 1293, "Input"],
Cell[1203886, 32881, 289, 6, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1204212, 32892, 171, 4, 1293, "Input"],
Cell[1204386, 32898, 266, 8, 1293, "Output"]
}, Open  ]],
Cell[1204667, 32909, 1202, 18, 3945, "Text"],
Cell[1205872, 32929, 142, 2, 1293, "Input"],
Cell[1206017, 32933, 1074, 24, 2020, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1207116, 32961, 243, 4, 1293, "Input"],
Cell[1207362, 32967, 385, 7, 1293, "Output"]
}, Open  ]],
Cell[1207762, 32977, 193, 2, 1293, "Text"],
Cell[1207958, 32981, 185, 4, 1293, "Text"],
Cell[1208146, 32987, 282, 6, 1293, "Text"],
Cell[1208431, 32995, 610, 17, 1293, "Input"],
Cell[1209044, 33014, 644, 15, 5813, "Input"],
Cell[CellGroupData[{
Cell[1209713, 33033, 448, 9, 2246, "Input"],
Cell[1210164, 33044, 255, 6, 1293, "Output"],
Cell[1210422, 33052, 257, 6, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1210716, 33063, 800, 19, 2246, "Input"],
Cell[1211519, 33084, 256, 6, 1293, "Output"],
Cell[1211778, 33092, 255, 6, 1293, "Output"]
}, Open  ]],
Cell[1212048, 33101, 112, 1, 1293, "Text"],
Cell[1212163, 33104, 964, 15, 3032, "Text"],
Cell[1213130, 33121, 1304, 32, 3837, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1214459, 33157, 1233, 28, 2246, "Input"],
Cell[1215695, 33187, 848, 20, 1293, "Output"]
}, Open  ]],
Cell[1216558, 33210, 146, 2, 1262, "Text"],
Cell[1216707, 33214, 892, 13, 2172, "Text"],
Cell[1217602, 33229, 487, 8, 1293, "Text"],
Cell[1218092, 33239, 1084, 16, 3078, "Text"],
Cell[1219179, 33257, 809, 13, 3945, "Text"],
Cell[1219991, 33272, 637, 16, 2020, "Input",
 InitializationCell->True],
Cell[1220631, 33290, 331, 6, 1293, "Text"],
Cell[1220965, 33298, 490, 13, 2020, "Input",
 InitializationCell->True],
Cell[1221458, 33313, 133, 1, 1293, "Text"],
Cell[1221594, 33316, 598, 14, 2020, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1222217, 33334, 584, 15, 1293, "Input"],
Cell[1222804, 33351, 508, 11, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1223349, 33367, 94, 1, 1293, "Input"],
Cell[1223446, 33370, 440, 14, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1223923, 33389, 148, 2, 1293, "Input"],
Cell[1224074, 33393, 463, 14, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1224574, 33412, 216, 4, 1293, "Input"],
Cell[1224793, 33418, 314, 8, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1225144, 33431, 389, 9, 1293, "Input"],
Cell[1225536, 33442, 313, 8, 1293, "Output"]
}, Open  ]],
Cell[1225864, 33453, 395, 7, 2152, "Text"],
Cell[CellGroupData[{
Cell[1226284, 33464, 518, 10, 2246, "Input"],
Cell[1226805, 33476, 2784, 83, 2035, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1229626, 33564, 159, 3, 1293, "Input"],
Cell[1229788, 33569, 342, 9, 1293, "Output"]
}, Open  ]],
Cell[1230145, 33581, 130, 1, 1293, "Text"],
Cell[1230278, 33584, 177, 4, 1293, "Text"],
Cell[1230458, 33590, 1027, 20, 2020, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1231510, 33614, 383, 5, 3103, "Input"],
Cell[1231896, 33621, 540, 16, 1293, "Output"],
Cell[1232439, 33639, 374, 10, 1293, "Output"],
Cell[1232816, 33651, 266, 6, 1293, "Output"]
}, Open  ]],
Cell[1233097, 33660, 182, 2, 1293, "Text"],
Cell[1233282, 33664, 287, 5, 1293, "Text"],
Cell[CellGroupData[{
Cell[1233594, 33673, 650, 18, 1293, "Input"],
Cell[1234247, 33693, 234, 6, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1234518, 33704, 652, 19, 1293, "Input"],
Cell[1235173, 33725, 231, 6, 1293, "Output"]
}, Open  ]],
Cell[1235419, 33734, 604, 10, 2152, "Text"],
Cell[1236026, 33746, 1917, 42, 7371, "Input",
 InitializationCell->True],
Cell[1237946, 33790, 439, 8, 2172, "Text"],
Cell[1238388, 33800, 2156, 45, 10206, "Input"],
Cell[CellGroupData[{
Cell[1240569, 33849, 1202, 32, 3103, "Input"],
Cell[CellGroupData[{
Cell[1241796, 33885, 327, 7, 932, "Print"],
Cell[1242126, 33894, 558, 16, 932, "Print"],
Cell[1242687, 33912, 392, 10, 932, "Print"],
Cell[1243082, 33924, 487, 12, 932, "Print"]
}, Open  ]],
Cell[1243584, 33939, 728, 20, 1293, "Output"],
Cell[1244315, 33961, 354, 6, 1293, "Output"]
}, Open  ]],
Cell[1244684, 33970, 294, 5, 1293, "Text"],
Cell[CellGroupData[{
Cell[1245003, 33979, 516, 12, 1293, "Input"],
Cell[1245522, 33993, 304, 7, 1293, "Output"]
}, Open  ]],
Cell[1245841, 34003, 1310, 20, 3032, "Text"],
Cell[1247154, 34025, 725, 17, 2020, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1247904, 34046, 231, 3, 2246, "Input"],
Cell[1248138, 34051, 232, 5, 1293, "Output"],
Cell[1248373, 34058, 297, 8, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1248707, 34071, 312, 8, 1293, "Input"],
Cell[1249022, 34081, 299, 8, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1249358, 34094, 149, 3, 1293, "Input"],
Cell[1249510, 34099, 166, 4, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1249713, 34108, 215, 4, 1293, "Input"],
Cell[1249931, 34114, 197, 5, 1293, "Output"]
}, Open  ]],
Cell[1250143, 34122, 1362, 20, 2152, "Text"],
Cell[1251508, 34144, 1009, 24, 3837, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1252542, 34172, 129, 1, 2246, "Input"],
Cell[1252674, 34175, 180, 4, 1293, "Output"],
Cell[1252857, 34181, 412, 13, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1253306, 34199, 170, 3, 1293, "Input"],
Cell[1253479, 34204, 137, 3, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1253653, 34212, 291, 7, 1293, "Input"],
Cell[1253947, 34221, 181, 5, 1293, "Output"]
}, Open  ]],
Cell[1254143, 34229, 384, 12, 1293, "Input"],
Cell[CellGroupData[{
Cell[1254552, 34245, 496, 15, 1293, "Input"],
Cell[1255051, 34262, 212, 6, 1293, "Output"]
}, Open  ]],
Cell[1255278, 34271, 1595, 26, 2246, "Text"],
Cell[1256876, 34299, 1472, 34, 5585, "Input",
 InitializationCell->True],
Cell[1258351, 34335, 1178, 18, 2172, "Text"],
Cell[1259532, 34355, 1856, 43, 7553, "Input"],
Cell[CellGroupData[{
Cell[1261413, 34402, 1851, 52, 3103, "Input"],
Cell[1263267, 34456, 222, 4, 1293, "Output"],
Cell[1263492, 34462, 225, 4, 1293, "Output"],
Cell[1263720, 34468, 225, 4, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1263982, 34477, 704, 19, 1293, "Input"],
Cell[CellGroupData[{
Cell[1264711, 34500, 379, 9, 932, "Print"],
Cell[1265093, 34511, 660, 19, 932, "Print"],
Cell[1265756, 34532, 327, 9, 932, "Print"]
}, Open  ]],
Cell[1266098, 34544, 146, 3, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1266281, 34552, 480, 14, 1293, "Input"],
Cell[CellGroupData[{
Cell[1266786, 34570, 272, 7, 932, "Print"],
Cell[1267061, 34579, 435, 13, 932, "Print"],
Cell[1267499, 34594, 248, 7, 932, "Print"]
}, Open  ]],
Cell[1267762, 34604, 100, 1, 1293, "Output"]
}, Open  ]],
Cell[1267877, 34608, 153, 2, 1293, "Text"],
Cell[1268033, 34612, 107, 1, 1262, "Text"],
Cell[CellGroupData[{
Cell[1268165, 34617, 1277, 43, 2246, "Input"],
Cell[1269445, 34662, 417, 13, 1293, "Output"],
Cell[1269865, 34677, 415, 13, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1270317, 34695, 862, 26, 1293, "Input"],
Cell[1271182, 34723, 207, 5, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1271426, 34733, 778, 24, 1293, "Input"],
Cell[1272207, 34759, 183, 5, 1293, "Output"]
}, Open  ]],
Cell[1272405, 34767, 712, 12, 2981, "Text"],
Cell[CellGroupData[{
Cell[1273142, 34783, 837, 22, 2270, "Input",
 InitializationCell->True],
Cell[1273982, 34807, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1274057, 34811, 1474, 24, 6527, "Text"],
Cell[1275534, 34837, 199, 4, 1293, "Text"],
Cell[1275736, 34843, 2213, 49, 5585, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1277974, 34896, 681, 22, 2246, "Input"],
Cell[1278658, 34920, 94, 1, 1293, "Output"],
Cell[1278755, 34923, 251, 8, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1279043, 34936, 257, 7, 1293, "Input"],
Cell[1279303, 34945, 136, 3, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1279476, 34953, 484, 13, 1293, "Input"],
Cell[1279963, 34968, 237, 7, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1280237, 34980, 504, 15, 1293, "Input"],
Cell[1280744, 34997, 319, 10, 1293, "Output"]
}, Open  ]],
Cell[1281078, 35010, 174, 2, 1293, "Text"],
Cell[1281255, 35014, 101, 1, 1262, "Text"],
Cell[CellGroupData[{
Cell[1281381, 35019, 439, 12, 1293, "Input"],
Cell[1281823, 35033, 231, 6, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1282091, 35044, 422, 12, 1293, "Input"],
Cell[1282516, 35058, 205, 5, 1293, "Output"]
}, Open  ]],
Cell[1282736, 35066, 306, 7, 2172, "Text"],
Cell[1283045, 35075, 1798, 31, 7371, "Text"],
Cell[1284846, 35108, 2174, 44, 4706, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1287045, 35156, 133, 3, 1293, "Input"],
Cell[1287181, 35161, 87, 2, 1293, "Output"]
}, Open  ]],
Cell[1287283, 35166, 433, 8, 1293, "Text"],
Cell[CellGroupData[{
Cell[1287741, 35178, 1045, 31, 2246, "Input"],
Cell[1288789, 35211, 380, 12, 1293, "Output"],
Cell[1289172, 35225, 380, 12, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1289589, 35242, 537, 17, 1293, "Input"],
Cell[1290129, 35261, 425, 15, 1293, "Output"]
}, Open  ]],
Cell[1290569, 35279, 463, 8, 3032, "Text"],
Cell[1291035, 35289, 143, 2, 1293, "Input"],
Cell[1291181, 35293, 7251, 155, 19741, "Input",
 InitializationCell->True],
Cell[1298435, 35450, 262, 5, 1293, "Text"],
Cell[1298700, 35457, 9823, 215, 35916, "Input"],
Cell[CellGroupData[{
Cell[1308548, 35676, 704, 19, 1293, "Input"],
Cell[CellGroupData[{
Cell[1309277, 35699, 442, 9, 932, "Print"],
Cell[1309722, 35710, 721, 19, 932, "Print"],
Cell[1310446, 35731, 519, 13, 932, "Print"],
Cell[1310968, 35746, 676, 17, 932, "Print"],
Cell[1311647, 35765, 839, 23, 932, "Print"],
Cell[1312489, 35790, 390, 9, 932, "Print"],
Cell[1312882, 35801, 406, 9, 932, "Print"],
Cell[1313291, 35812, 617, 16, 932, "Print"],
Cell[1313911, 35830, 550, 14, 932, "Print"],
Cell[1314464, 35846, 615, 16, 932, "Print"],
Cell[1315082, 35864, 540, 13, 932, "Print"],
Cell[1315625, 35879, 468, 9, 932, "Print"],
Cell[1316096, 35890, 514, 13, 932, "Print"],
Cell[1316613, 35905, 433, 10, 932, "Print"],
Cell[1317049, 35917, 486, 10, 932, "Print"],
Cell[1317538, 35929, 801, 20, 1103, "Print"],
Cell[1318342, 35951, 409, 9, 932, "Print"],
Cell[1318754, 35962, 469, 9, 932, "Print"]
}, Open  ]],
Cell[1319238, 35974, 921, 24, 1453, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1320196, 36003, 557, 17, 1453, "Input"],
Cell[1320756, 36022, 740, 21, 1453, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1321533, 36048, 454, 13, 1453, "Input"],
Cell[1321990, 36063, 605, 17, 1453, "Output"]
}, Open  ]],
Cell[1322610, 36083, 298, 5, 1262, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1322945, 36093, 213, 3, 1165, "Subsubsection"],
Cell[1323161, 36098, 198, 5, 2152, "Text"],
Cell[CellGroupData[{
Cell[1323384, 36107, 252, 4, 2246, "Input"],
Cell[1323639, 36113, 104, 2, 1293, "Output"]
}, Open  ]],
Cell[1323758, 36118, 161, 3, 1293, "Text"],
Cell[CellGroupData[{
Cell[1323944, 36125, 912, 25, 4135, "Input"],
Cell[1324859, 36152, 170, 4, 1293, "Output"],
Cell[1325032, 36158, 230, 6, 1293, "Output"],
Cell[CellGroupData[{
Cell[1325287, 36168, 1329, 35, 1035, "Print"],
Cell[1326619, 36205, 1103, 30, 932, "Print"],
Cell[1327725, 36237, 2811, 74, 1907, "Print"],
Cell[1330539, 36313, 1325, 39, 1103, "Print"],
Cell[1331867, 36354, 499, 12, 1010, "Print"],
Cell[1332369, 36368, 429, 12, 932, "Print"],
Cell[1332801, 36382, 2979, 77, 3156, "Print"],
Cell[1335783, 36461, 1450, 42, 1722, "Print"],
Cell[1337236, 36505, 497, 12, 1577, "Print"],
Cell[1337736, 36519, 564, 16, 1456, "Print"]
}, Open  ]],
Cell[1338315, 36538, 744, 21, 2270, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1339096, 36564, 781, 22, 3726, "Input"],
Cell[1339880, 36588, 233, 6, 2020, "Output"]
}, Open  ]],
Cell[1340128, 36597, 231, 5, 2020, "Text"],
Cell[CellGroupData[{
Cell[1340384, 36606, 814, 21, 6460, "Input"],
Cell[1341201, 36629, 179, 4, 2020, "Output"],
Cell[CellGroupData[{
Cell[1341405, 36637, 2784, 73, 2978, "Print"],
Cell[1344192, 36712, 1599, 44, 1722, "Print"],
Cell[1345794, 36758, 2954, 76, 3156, "Print"],
Cell[1348751, 36836, 1702, 47, 1722, "Print"],
Cell[1350456, 36885, 1304, 34, 1616, "Print"],
Cell[1351763, 36921, 1107, 30, 1456, "Print"],
Cell[1352873, 36953, 472, 11, 1577, "Print"],
Cell[1353348, 36966, 540, 15, 1456, "Print"]
}, Open  ]],
Cell[1353903, 36984, 770, 22, 2270, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1354710, 37011, 781, 22, 3726, "Input"],
Cell[1355494, 37035, 227, 6, 2020, "Output"]
}, Open  ]],
Cell[1355736, 37044, 108, 1, 2020, "Text"],
Cell[1355847, 37047, 623, 15, 3508, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1356519, 37068, 1396, 19, 1971, "Subsection"],
Cell[CellGroupData[{
Cell[1357940, 37091, 355, 5, 168, "Subsubsection"],
Cell[1358298, 37098, 569, 14, 6163, "Input",
 InitializationCell->True],
Cell[1358870, 37114, 289, 5, 3847, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1359196, 37124, 307, 4, 135, "Subsubsection"],
Cell[CellGroupData[{
Cell[1359528, 37132, 1021, 23, 220, "Input",
 InitializationCell->True],
Cell[1360552, 37157, 60, 1, 140, "Output"]
}, Open  ]],
Cell[1360627, 37161, 89, 2, 1293, "Text"],
Cell[CellGroupData[{
Cell[1360741, 37167, 52, 1, 1293, "Input"],
Cell[1360796, 37170, 32, 0, 140, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1360865, 37175, 495, 15, 220, "Input",
 InitializationCell->True],
Cell[1361363, 37192, 60, 1, 140, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1361460, 37198, 851, 19, 220, "Input",
 InitializationCell->True],
Cell[1362314, 37219, 60, 1, 140, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1362411, 37225, 639, 17, 220, "Input",
 InitializationCell->True],
Cell[1363053, 37244, 60, 1, 140, "Output"]
}, Open  ]],
Cell[1363128, 37248, 289, 5, 1262, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1363454, 37258, 471, 11, 1616, "Subsubsection"],
Cell[1363928, 37271, 442, 7, 1293, "Text"],
Cell[1364373, 37280, 28, 0, 140, "Output"],
Cell[CellGroupData[{
Cell[1364426, 37284, 547, 11, 235, "Input",
 InitializationCell->True],
Cell[1364976, 37297, 60, 1, 140, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1365073, 37303, 975, 20, 245, "Input",
 InitializationCell->True],
Cell[1366051, 37325, 60, 1, 140, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1366148, 37331, 888, 18, 243, "Input",
 InitializationCell->True],
Cell[1367039, 37351, 60, 1, 140, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1367136, 37357, 175, 4, 1378, "Input"],
Cell[1367314, 37363, 141, 2, 1293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1367492, 37370, 585, 16, 2385, "Input"],
Cell[1368080, 37388, 487, 13, 1453, "Output"],
Cell[1368570, 37403, 487, 13, 1453, "Output"]
}, Open  ]],
Cell[1369072, 37419, 289, 5, 1262, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1369398, 37429, 556, 9, 1553, "Subsubsection"],
Cell[1369957, 37440, 1135, 24, 11707, "Text"],
Cell[1371095, 37466, 215, 3, 2020, "Text"],
Cell[1371313, 37471, 877, 14, 4808, "Text"],
Cell[CellGroupData[{
Cell[1372215, 37489, 1274, 29, 3508, "Input"],
Cell[1373492, 37520, 974, 18, 273588, "Output"],
Cell[1374469, 37540, 974, 18, 273588, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1375480, 37563, 762, 16, 273588, "Input"],
Cell[1376245, 37581, 762, 14, 273588, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1377044, 37600, 1856, 39, 475210, "Input"],
Cell[1378903, 37641, 974, 18, 273588, "Output"],
Cell[1379880, 37661, 978, 18, 273588, "Output"]
}, Open  ]],
Cell[1380873, 37682, 282, 6, 455460, "Text"],
Cell[CellGroupData[{
Cell[1381180, 37692, 616, 16, 273588, "Input"],
Cell[1381799, 37710, 661, 13, 273588, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1382497, 37728, 661, 17, 273588, "Input"],
Cell[1383161, 37747, 665, 13, 273588, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1383863, 37765, 603, 17, 273588, "Input"],
Cell[1384469, 37784, 665, 13, 273588, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1385171, 37802, 599, 16, 273588, "Input"],
Cell[1385773, 37820, 653, 13, 273588, "Output"]
}, Open  ]],
Cell[1386441, 37836, 319, 8, 273588, "Input"],
Cell[1386763, 37846, 266, 3, 273588, "Text"],
Cell[1387032, 37851, 358, 7, 459671, "Text"],
Cell[CellGroupData[{
Cell[1387415, 37862, 1516, 35, 475210, "Input",
 InitializationCell->True],
Cell[1388934, 37899, 60, 1, 262, "Output"],
Cell[1388997, 37902, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1389072, 37906, 199, 3, 266835, "Text"],
Cell[CellGroupData[{
Cell[1389296, 37913, 789, 20, 273588, "Input",
 InitializationCell->True],
Cell[1390088, 37935, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1390163, 37939, 420, 7, 2020, "Text"],
Cell[CellGroupData[{
Cell[1390608, 37950, 2190, 47, 4581, "Input",
 InitializationCell->True],
Cell[1392801, 37999, 60, 1, 262, "Output"],
Cell[1392864, 38002, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1392939, 38006, 357, 6, 2020, "Text"],
Cell[1393299, 38014, 644, 10, 3393, "Text"],
Cell[CellGroupData[{
Cell[1393968, 38028, 1441, 27, 3156, "Input",
 InitializationCell->True],
Cell[1395412, 38057, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1395487, 38061, 173, 4, 2020, "Text"],
Cell[CellGroupData[{
Cell[1395685, 38069, 1874, 35, 3156, "Input",
 InitializationCell->True],
Cell[1397562, 38106, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1397637, 38110, 319, 7, 3308, "Text"],
Cell[CellGroupData[{
Cell[1397981, 38121, 1135, 29, 3156, "Input",
 InitializationCell->True],
Cell[1399119, 38152, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1399194, 38156, 358, 6, 2020, "Text"],
Cell[1399555, 38164, 645, 16, 2020, "Input"],
Cell[1400203, 38182, 228, 4, 2020, "Text"],
Cell[1400434, 38188, 384, 7, 2020, "Text"],
Cell[1400821, 38197, 1266, 18, 3393, "Text"],
Cell[CellGroupData[{
Cell[1402112, 38219, 2042, 35, 3156, "Input",
 InitializationCell->True],
Cell[1404157, 38256, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1404232, 38260, 167, 2, 1971, "Text"],
Cell[1404402, 38264, 108, 1, 1971, "Text"],
Cell[CellGroupData[{
Cell[1404535, 38269, 660, 17, 3156, "Input",
 InitializationCell->True],
Cell[1405198, 38288, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1405273, 38292, 1076, 16, 3393, "Text"],
Cell[CellGroupData[{
Cell[1406374, 38312, 597, 17, 2020, "Input"],
Cell[1406974, 38331, 645, 22, 1456, "Print"]
}, Open  ]],
Cell[1407634, 38356, 99, 1, 2020, "Text"],
Cell[CellGroupData[{
Cell[1407758, 38361, 1341, 29, 3156, "Input",
 InitializationCell->True],
Cell[1409102, 38392, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1409199, 38398, 997, 25, 3156, "Input",
 InitializationCell->True],
Cell[1410199, 38425, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1410274, 38429, 1003, 15, 2020, "Text"],
Cell[CellGroupData[{
Cell[1411302, 38448, 1178, 25, 3156, "Input",
 InitializationCell->True],
Cell[1412483, 38475, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1412580, 38481, 886, 22, 3156, "Input",
 InitializationCell->True],
Cell[1413469, 38505, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1413544, 38509, 96, 1, 2020, "Text"],
Cell[CellGroupData[{
Cell[1413665, 38514, 1227, 24, 3156, "Input",
 InitializationCell->True],
Cell[1414895, 38540, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1414992, 38546, 879, 20, 3156, "Input",
 InitializationCell->True],
Cell[1415874, 38568, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1415971, 38574, 1199, 25, 3156, "Input",
 InitializationCell->True],
Cell[1417173, 38601, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1417270, 38607, 907, 22, 3156, "Input",
 InitializationCell->True],
Cell[1418180, 38631, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1418255, 38635, 167, 2, 2020, "Text"],
Cell[1418425, 38639, 504, 13, 6252, "Input"],
Cell[1418932, 38654, 209, 4, 2020, "Input"],
Cell[CellGroupData[{
Cell[1419166, 38662, 959, 22, 6252, "Input"],
Cell[1420128, 38686, 329, 7, 273588, "Output"],
Cell[1420460, 38695, 341, 8, 273588, "Output"],
Cell[1420804, 38705, 329, 7, 273588, "Output"],
Cell[1421136, 38714, 339, 8, 273588, "Output"]
}, Open  ]],
Cell[1421490, 38725, 193, 3, 2020, "Text"],
Cell[1421686, 38730, 855, 22, 7632, "Input"],
Cell[1422544, 38754, 125, 2, 2020, "Input"],
Cell[1422672, 38758, 312, 5, 2020, "Input"],
Cell[CellGroupData[{
Cell[1423009, 38767, 301, 6, 2020, "Input"],
Cell[1423313, 38775, 366, 8, 2020, "Output"]
}, Open  ]],
Cell[1423694, 38786, 352, 6, 2020, "Input"],
Cell[CellGroupData[{
Cell[1424071, 38796, 235, 5, 2020, "Input"],
Cell[1424309, 38803, 320, 7, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1424666, 38815, 302, 6, 2020, "Input"],
Cell[1424971, 38823, 277, 6, 2020, "Output"]
}, Open  ]],
Cell[1425263, 38832, 170, 3, 2020, "Input"],
Cell[1425436, 38837, 243, 5, 1971, "Text"],
Cell[1425682, 38844, 289, 5, 1971, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1426008, 38854, 1053, 22, 1293, "Subsubsection"],
Cell[1427064, 38878, 513, 9, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1427602, 38891, 581, 15, 1002750, "Input",
 InitializationCell->True],
Cell[1428186, 38908, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1428283, 38914, 759, 20, 1002750, "Input",
 InitializationCell->True],
Cell[1429045, 38936, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1429120, 38940, 360, 7, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1429505, 38951, 1304, 30, 1002750, "Input",
 InitializationCell->True],
Cell[1430812, 38983, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1430909, 38989, 1271, 33, 1002750, "Input",
 InitializationCell->True],
Cell[1432183, 39024, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1432258, 39028, 95, 1, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1432378, 39033, 1046, 26, 1002750, "Input",
 InitializationCell->True],
Cell[1433427, 39061, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1433502, 39065, 144, 2, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1433671, 39071, 994, 27, 1002750, "Input",
 InitializationCell->True],
Cell[1434668, 39100, 60, 1, 262, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1434777, 39107, 124, 2, 1165, "Subsubsection"],
Cell[1434904, 39111, 868, 22, 1034221, "Input"],
Cell[CellGroupData[{
Cell[1435797, 39137, 749, 17, 521160, "Input"],
Cell[1436549, 39156, 503, 13, 322707, "Output"],
Cell[1437055, 39171, 524, 13, 322707, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1437616, 39189, 567, 12, 307493, "Input"],
Cell[1438186, 39203, 507, 12, 322707, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1438730, 39220, 322, 8, 307493, "Input"],
Cell[1439055, 39230, 388, 11, 322707, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1439480, 39246, 664, 13, 307493, "Input"],
Cell[1440147, 39261, 407, 10, 322707, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1440591, 39276, 404, 10, 307493, "Input"],
Cell[1440998, 39288, 388, 11, 322707, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1441423, 39304, 165, 3, 273588, "Input"],
Cell[1441591, 39309, 72, 1, 273588, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1441700, 39315, 182, 3, 1002750, "Input"],
Cell[1441885, 39320, 121, 2, 455460, "Output"]
}, Open  ]],
Cell[1442021, 39325, 261, 6, 455460, "Input"],
Cell[1442285, 39333, 289, 5, 416928, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1442611, 39343, 883, 17, 1293, "Subsubsection"],
Cell[1443497, 39362, 622, 14, 3546, "Text"],
Cell[CellGroupData[{
Cell[1444144, 39380, 1381, 34, 3546, "Input",
 InitializationCell->True],
Cell[1445528, 39416, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1445625, 39422, 1080, 29, 3546, "Input",
 InitializationCell->True],
Cell[1446708, 39453, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1446805, 39459, 1446, 34, 3546, "Input",
 InitializationCell->True],
Cell[1448254, 39495, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1448351, 39501, 1149, 29, 3546, "Input",
 InitializationCell->True],
Cell[1449503, 39532, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1449578, 39536, 386, 7, 3393, "Text"],
Cell[CellGroupData[{
Cell[1449989, 39547, 1714, 49, 4847, "Input"],
Cell[1451706, 39598, 382, 8, 2020, "Output"],
Cell[1452091, 39608, 382, 8, 2020, "Output"],
Cell[1452476, 39618, 384, 8, 2020, "Output"]
}, Open  ]],
Cell[1452875, 39629, 413, 8, 3362, "Text"],
Cell[1453291, 39639, 853, 16, 4931, "Text"],
Cell[1454147, 39657, 1003, 24, 2383, "Input"],
Cell[1455153, 39683, 1229, 29, 2383, "Input"],
Cell[1456385, 39714, 1240, 27, 2383, "Input"],
Cell[1457628, 39743, 1297, 35, 2383, "Input"],
Cell[1458928, 39780, 1414, 37, 2383, "Input"],
Cell[1460345, 39819, 1032, 28, 2383, "Input"],
Cell[1461380, 39849, 1455, 41, 2383, "Input"],
Cell[1462838, 39892, 1592, 43, 2383, "Input"],
Cell[1464433, 39937, 248, 4, 1971, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1464718, 39946, 124, 2, 1165, "Subsubsection"],
Cell[1464845, 39950, 120, 1, 266835, "Text"],
Cell[1464968, 39953, 507, 13, 656663, "Input"],
Cell[CellGroupData[{
Cell[1465500, 39970, 348, 6, 475210, "Input"],
Cell[1465851, 39978, 257, 6, 307493, "Output"],
Cell[1466111, 39986, 351, 9, 307493, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1466499, 40000, 435, 9, 656663, "Input"],
Cell[1466937, 40011, 261, 6, 307493, "Output"],
Cell[1467201, 40019, 360, 10, 307493, "Output"],
Cell[1467564, 40031, 450, 12, 307493, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1468051, 40048, 523, 11, 656663, "Input"],
Cell[1468577, 40061, 329, 9, 513408, "Output"],
Cell[1468909, 40072, 426, 12, 513408, "Output"],
Cell[1469338, 40086, 520, 15, 513408, "Output"]
}, Open  ]],
Cell[1469873, 40104, 492, 8, 752063, "Text"],
Cell[1470368, 40114, 606, 16, 455460, "Input"],
Cell[1470977, 40132, 599, 15, 455460, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1471613, 40152, 124, 2, 1165, "Subsubsection"],
Cell[1471740, 40156, 493, 14, 475210, "Input"],
Cell[CellGroupData[{
Cell[1472258, 40174, 390, 8, 475210, "Input"],
Cell[1472651, 40184, 300, 7, 273588, "Output"],
Cell[1472954, 40193, 302, 7, 273588, "Output"]
}, Open  ]],
Cell[1473271, 40203, 251, 6, 1002750, "Input"],
Cell[1473525, 40211, 289, 5, 1002750, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1473851, 40221, 690, 14, 1293, "Subsubsection"],
Cell[1474544, 40237, 16, 0, 266835, "Text"],
Cell[1474563, 40239, 2069, 34, 1752182, "Text"],
Cell[CellGroupData[{
Cell[1476657, 40277, 658, 17, 328582, "Input",
 InitializationCell->True],
Cell[1477318, 40296, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1477415, 40302, 3517, 54, 273588, "Input",
 InitializationCell->True],
Cell[1480935, 40358, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1481010, 40362, 114, 1, 266835, "Text"],
Cell[CellGroupData[{
Cell[1481149, 40367, 131, 2, 273588, "Input"],
Cell[1481283, 40371, 6437, 187, 4976516, "Output"]
}, Open  ]],
Cell[1487735, 40561, 91, 1, 1002750, "Text"],
Cell[1487829, 40564, 124, 2, 1002750, "Input"],
Cell[1487956, 40568, 124, 2, 1002750, "Input"],
Cell[1488083, 40572, 752, 17, 1002750, "Input"],
Cell[1488838, 40591, 263, 6, 1002750, "Input"],
Cell[CellGroupData[{
Cell[1489126, 40601, 122, 2, 1002750, "Input"],
Cell[1489251, 40605, 139, 2, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1489427, 40612, 232, 5, 1002750, "Input"],
Cell[1489662, 40619, 418, 7, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1490117, 40631, 280, 5, 1002750, "Input"],
Cell[1490400, 40638, 294, 5, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1490731, 40648, 278, 5, 1002750, "Input"],
Cell[1491012, 40655, 292, 5, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1491341, 40665, 145, 4, 1002750, "Input"],
Cell[1491489, 40671, 239, 6, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1491765, 40682, 321, 7, 1002750, "Input"],
Cell[1492089, 40691, 374, 8, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1492500, 40704, 246, 6, 1002750, "Input"],
Cell[1492749, 40712, 127, 2, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1492913, 40719, 219, 6, 1002750, "Input"],
Cell[1493135, 40727, 264, 6, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1493436, 40738, 338, 6, 1002750, "Input"],
Cell[1493777, 40746, 340, 7, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1494154, 40758, 252, 6, 1002750, "Input"],
Cell[1494409, 40766, 292, 6, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1494738, 40777, 315, 7, 1002750, "Input"],
Cell[1495056, 40786, 305, 6, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1495398, 40797, 364, 8, 1002750, "Input"],
Cell[1495765, 40807, 330, 7, 1002750, "Output"]
}, Open  ]],
Cell[1496110, 40817, 208, 5, 1002750, "Input"],
Cell[CellGroupData[{
Cell[1496343, 40826, 198, 5, 1002750, "Input"],
Cell[1496544, 40833, 287, 6, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1496868, 40844, 264, 6, 1002750, "Input"],
Cell[1497135, 40852, 293, 6, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1497465, 40863, 266, 6, 1002750, "Input"],
Cell[1497734, 40871, 290, 6, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1498061, 40882, 271, 6, 1002750, "Input"],
Cell[1498335, 40890, 195, 3, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1498567, 40898, 145, 3, 1002750, "Input"],
Cell[1498715, 40903, 142, 2, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1498894, 40910, 245, 5, 1002750, "Input"],
Cell[1499142, 40917, 139, 2, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1499318, 40924, 557, 13, 1002750, "Input"],
Cell[1499878, 40939, 411, 10, 1002750, "Output"],
Cell[1500292, 40951, 411, 10, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1500740, 40966, 557, 13, 1002750, "Input"],
Cell[1501300, 40981, 411, 10, 1002750, "Output"],
Cell[1501714, 40993, 411, 10, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1502162, 41008, 556, 13, 1002750, "Input"],
Cell[1502721, 41023, 490, 11, 1002750, "Output"],
Cell[1503214, 41036, 599, 16, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1503850, 41057, 573, 14, 1002750, "Input"],
Cell[1504426, 41073, 507, 12, 1002750, "Output"],
Cell[1504936, 41087, 575, 15, 1002750, "Output"]
}, Open  ]],
Cell[1505526, 41105, 320, 7, 1002750, "Input"],
Cell[CellGroupData[{
Cell[1505871, 41116, 120, 2, 1002750, "Input"],
Cell[1505994, 41120, 138, 2, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1506169, 41127, 394, 9, 1002750, "Input"],
Cell[1506566, 41138, 311, 5, 1002750, "Output"],
Cell[1506880, 41145, 311, 5, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1507228, 41155, 451, 8, 1002750, "Input"],
Cell[1507682, 41165, 581, 10, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1508300, 41180, 256, 6, 1002750, "Input"],
Cell[1508559, 41188, 358, 9, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1508954, 41202, 369, 7, 1002750, "Input"],
Cell[1509326, 41211, 301, 6, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1509664, 41222, 245, 5, 1002750, "Input"],
Cell[1509912, 41229, 168, 2, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1510117, 41236, 242, 5, 1002750, "Input"],
Cell[1510362, 41243, 261, 5, 1002750, "Output"]
}, Open  ]],
Cell[1510638, 41251, 102, 1, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1510765, 41256, 474, 10, 1002750, "Input"],
Cell[1511242, 41268, 284, 6, 1002750, "Output"],
Cell[1511529, 41276, 286, 6, 1002750, "Output"]
}, Open  ]],
Cell[1511830, 41285, 289, 5, 1002750, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1512156, 41295, 313, 6, 1243, "Subsubsection"],
Cell[1512472, 41303, 764, 14, 7401, "Text"],
Cell[CellGroupData[{
Cell[1513261, 41321, 1172, 23, 3156, "Input",
 InitializationCell->True],
Cell[1514436, 41346, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1514511, 41350, 228, 4, 2020, "Input"],
Cell[1514742, 41356, 642, 11, 3393, "Text"],
Cell[1515387, 41369, 233, 3, 2020, "Text"],
Cell[1515623, 41374, 579, 10, 3393, "Text"],
Cell[CellGroupData[{
Cell[1516227, 41388, 713, 18, 3508, "Input"],
Cell[1516943, 41408, 281, 6, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1517261, 41419, 772, 19, 3508, "Input"],
Cell[1518036, 41440, 303, 7, 2020, "Output"]
}, Open  ]],
Cell[1518354, 41450, 185, 4, 1971, "Text"],
Cell[1518542, 41456, 144, 2, 2020, "Text"],
Cell[1518689, 41460, 793, 15, 3156, "Input",
 InitializationCell->True],
Cell[1519485, 41477, 123, 1, 1971, "Text"],
Cell[1519611, 41480, 288, 7, 3156, "Input",
 InitializationCell->True],
Cell[1519902, 41489, 157, 2, 1971, "Text"],
Cell[1520062, 41493, 524, 12, 3156, "Input",
 InitializationCell->True],
Cell[1520589, 41507, 441, 12, 3156, "Input",
 InitializationCell->True],
Cell[1521033, 41521, 234, 6, 3156, "Input",
 InitializationCell->True],
Cell[1521270, 41529, 560, 16, 4581, "Input",
 InitializationCell->True],
Cell[1521833, 41547, 251, 3, 2020, "Text"],
Cell[CellGroupData[{
Cell[1522109, 41554, 251, 5, 3508, "Input"],
Cell[1522363, 41561, 340, 7, 2020, "Output"],
Cell[1522706, 41570, 268, 5, 2020, "Output"]
}, Open  ]],
Cell[1522989, 41578, 135, 1, 2020, "Text"],
Cell[CellGroupData[{
Cell[1523149, 41583, 550, 13, 3508, "Input"],
Cell[1523702, 41598, 243, 4, 2020, "Output"],
Cell[1523948, 41604, 244, 4, 2020, "Output"]
}, Open  ]],
Cell[1524207, 41611, 312, 8, 3508, "Input"],
Cell[CellGroupData[{
Cell[1524544, 41623, 431, 10, 3508, "Input"],
Cell[1524978, 41635, 275, 7, 2020, "Output"],
Cell[1525256, 41644, 272, 6, 2020, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1525565, 41655, 848, 21, 6252, "Input"],
Cell[1526416, 41678, 367, 8, 1002750, "Output"],
Cell[1526786, 41688, 367, 8, 1002750, "Output"],
Cell[1527156, 41698, 364, 7, 1002750, "Output"],
Cell[1527523, 41707, 364, 7, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1527924, 41719, 898, 25, 1002750, "Input"],
Cell[1528825, 41746, 96, 1, 1002750, "Output"],
Cell[1528924, 41749, 96, 1, 1002750, "Output"],
Cell[1529023, 41752, 95, 1, 1002750, "Output"],
Cell[1529121, 41755, 95, 1, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1529253, 41761, 912, 25, 1002750, "Input"],
Cell[1530168, 41788, 97, 1, 1002750, "Output"],
Cell[1530268, 41791, 100, 1, 1002750, "Output"],
Cell[1530371, 41794, 98, 1, 1002750, "Output"],
Cell[1530472, 41797, 97, 1, 1002750, "Output"]
}, Open  ]],
Cell[1530584, 41801, 289, 5, 1002750, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1530910, 41811, 823, 16, 1293, "Subsubsection"],
Cell[1531736, 41829, 1247, 20, 834922, "Text"],
Cell[1532986, 41851, 391, 7, 459671, "Text"],
Cell[CellGroupData[{
Cell[1533402, 41862, 648, 17, 273588, "Input",
 InitializationCell->True],
Cell[1534053, 41881, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1534150, 41887, 474, 13, 273588, "Input",
 InitializationCell->True],
Cell[1534627, 41902, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1534724, 41908, 1250, 30, 656663, "Input",
 InitializationCell->True],
Cell[1535977, 41940, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1536052, 41944, 180, 4, 273588, "Text"],
Cell[CellGroupData[{
Cell[1536257, 41952, 1477, 33, 475210, "Input",
 InitializationCell->True],
Cell[1537737, 41987, 60, 1, 262, "Output"],
Cell[1537800, 41990, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1537897, 41996, 1644, 36, 475210, "Input",
 InitializationCell->True],
Cell[1539544, 42034, 60, 1, 262, "Output"],
Cell[1539607, 42037, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1539682, 42041, 230, 5, 1002750, "Text"],
Cell[1539915, 42048, 168, 3, 273588, "Text"],
Cell[CellGroupData[{
Cell[1540108, 42055, 1066, 28, 475210, "Input",
 InitializationCell->True],
Cell[1541177, 42085, 60, 1, 262, "Output"],
Cell[1541240, 42088, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1541315, 42092, 205, 4, 1002750, "Text"],
Cell[1541523, 42098, 1428, 33, 1002750, "Input"],
Cell[1542954, 42133, 1580, 36, 1002750, "Input"],
Cell[1544537, 42171, 105, 1, 1002750, "Text"],
Cell[1544645, 42174, 1480, 36, 1002750, "Input"],
Cell[1546128, 42212, 1631, 38, 1002750, "Input"],
Cell[1547762, 42252, 153, 2, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1547940, 42258, 136, 2, 1002750, "Input"],
Cell[1548079, 42262, 2850, 82, 1002750, "Output"]
}, Open  ]],
Cell[1550944, 42347, 249, 5, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1551218, 42356, 274, 5, 1002750, "Input"],
Cell[1551495, 42363, 137, 3, 1002750, "Output"],
Cell[1551635, 42368, 198, 5, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1551870, 42378, 417, 13, 1002750, "Input"],
Cell[1552290, 42393, 99, 1, 1002750, "Output"],
Cell[1552392, 42396, 98, 1, 1002750, "Output"]
}, Open  ]],
Cell[1552505, 42400, 126, 1, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1552656, 42405, 510, 14, 1002750, "Input"],
Cell[1553169, 42421, 151, 2, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1553357, 42428, 302, 10, 1002750, "Input"],
Cell[1553662, 42440, 281, 9, 1002750, "Output"]
}, Open  ]],
Cell[1553958, 42452, 533, 13, 1002750, "Input"],
Cell[CellGroupData[{
Cell[1554516, 42469, 486, 11, 1002750, "Input"],
Cell[1555005, 42482, 430, 10, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1555472, 42497, 716, 13, 1002750, "Input"],
Cell[1556191, 42512, 421, 11, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1556649, 42528, 780, 16, 1002750, "Input"],
Cell[1557432, 42546, 192, 5, 1002750, "Output"]
}, Open  ]],
Cell[1557639, 42554, 187, 2, 1002750, "Text"],
Cell[1557829, 42558, 378, 6, 1002750, "Text"],
Cell[1558210, 42566, 124, 2, 1002750, "Input"],
Cell[1558337, 42570, 123, 2, 1002750, "Input"],
Cell[CellGroupData[{
Cell[1558485, 42576, 274, 6, 1002750, "Input"],
Cell[1558762, 42584, 253, 6, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1559052, 42595, 276, 6, 1002750, "Input"],
Cell[1559331, 42603, 177, 4, 1002750, "Output"]
}, Open  ]],
Cell[1559523, 42610, 936, 23, 1002750, "Input"],
Cell[CellGroupData[{
Cell[1560484, 42637, 127, 2, 1002750, "Input"],
Cell[1560614, 42641, 220, 4, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1560871, 42650, 480, 12, 1002750, "Input"],
Cell[1561354, 42664, 830, 12, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1562221, 42681, 547, 12, 1002750, "Input"],
Cell[1562771, 42695, 381, 8, 1002750, "Output"],
Cell[1563155, 42705, 190, 3, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1563382, 42713, 167, 3, 1002750, "Input"],
Cell[1563552, 42718, 246, 3, 455460, "Output"]
}, Open  ]],
Cell[1563813, 42724, 321, 6, 427481, "Text"],
Cell[CellGroupData[{
Cell[1564159, 42734, 868, 19, 1111962, "Input"],
Cell[1565030, 42755, 413, 9, 455460, "Output"],
Cell[1565446, 42766, 220, 4, 455460, "Output"],
Cell[1565669, 42772, 415, 9, 455460, "Output"]
}, Open  ]],
Cell[1566099, 42784, 253, 5, 427481, "Text"],
Cell[1566355, 42791, 412, 10, 455460, "Input"],
Cell[CellGroupData[{
Cell[1566792, 42805, 1450, 32, 787856, "Input"],
Cell[1568245, 42839, 319, 6, 455460, "Output"],
Cell[1568567, 42847, 319, 6, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1568923, 42858, 868, 19, 1111962, "Input"],
Cell[1569794, 42879, 94, 1, 455460, "Output"],
Cell[1569891, 42882, 94, 1, 455460, "Output"],
Cell[1569988, 42885, 287, 6, 455460, "Output"]
}, Open  ]],
Cell[1570290, 42894, 373, 7, 427481, "Text"],
Cell[CellGroupData[{
Cell[1570688, 42905, 1344, 32, 1753501, "Input"],
Cell[1572035, 42939, 416, 8, 455460, "Output"],
Cell[1572454, 42949, 426, 8, 455460, "Output"],
Cell[1572883, 42959, 416, 8, 455460, "Output"],
Cell[1573302, 42969, 440, 9, 455460, "Output"],
Cell[1573745, 42980, 425, 8, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1574207, 42993, 1617, 35, 787856, "Input"],
Cell[1575827, 43030, 102, 2, 455460, "Output"],
Cell[1575932, 43034, 102, 2, 455460, "Output"]
}, Open  ]],
Cell[1576049, 43039, 373, 7, 427481, "Text"],
Cell[CellGroupData[{
Cell[1576447, 43050, 1344, 32, 1753501, "Input"],
Cell[1577794, 43084, 72, 1, 455460, "Output"],
Cell[1577869, 43087, 70, 1, 455460, "Output"],
Cell[1577942, 43090, 70, 1, 455460, "Output"],
Cell[1578015, 43093, 70, 1, 455460, "Output"],
Cell[1578088, 43096, 277, 6, 455460, "Output"]
}, Open  ]],
Cell[1578380, 43105, 309, 6, 455460, "Text"],
Cell[CellGroupData[{
Cell[1578714, 43115, 264, 6, 455460, "Input"],
Cell[1578981, 43123, 264, 6, 1002750, "Output"]
}, Open  ]],
Cell[1579260, 43132, 181, 4, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1579466, 43140, 786, 19, 1002750, "Input"],
Cell[1580255, 43161, 436, 7, 1002750, "Output"],
Cell[1580694, 43170, 437, 8, 1002750, "Output"],
Cell[1581134, 43180, 439, 8, 1002750, "Output"],
Cell[1581576, 43190, 437, 8, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1582050, 43203, 685, 17, 1421072, "Input"],
Cell[1582738, 43222, 355, 7, 455460, "Output"],
Cell[1583096, 43231, 352, 6, 455460, "Output"],
Cell[1583451, 43239, 353, 7, 455460, "Output"],
Cell[1583807, 43248, 352, 7, 427481, "Output"]
}, Open  ]],
Cell[1584174, 43258, 95, 1, 266835, "Text"],
Cell[CellGroupData[{
Cell[1584294, 43263, 1033, 26, 322707, "Input",
 InitializationCell->True],
Cell[1585330, 43291, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1585427, 43297, 913, 24, 322707, "Input",
 InitializationCell->True],
Cell[1586343, 43323, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1586440, 43329, 890, 24, 322707, "Input",
 InitializationCell->True],
Cell[1587333, 43355, 60, 1, 262, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1587442, 43362, 692, 9, 1165, "Subsubsection"],
Cell[1588137, 43373, 16, 0, 416928, "Text"],
Cell[1588156, 43375, 1231, 20, 1313918, "Text"],
Cell[1589390, 43397, 123, 2, 455460, "Input"],
Cell[1589516, 43401, 735, 17, 787856, "Input"],
Cell[1590254, 43420, 411, 7, 427481, "Text"],
Cell[1590668, 43429, 730, 18, 787856, "Input"],
Cell[1591401, 43449, 487, 11, 455460, "Input"],
Cell[1591891, 43462, 1480, 38, 787856, "Input"],
Cell[1593374, 43502, 336, 6, 427481, "Text"],
Cell[1593713, 43510, 138, 1, 427481, "Text"],
Cell[1593854, 43513, 259, 6, 455460, "Input"],
Cell[1594116, 43521, 1259, 29, 787856, "Input"],
Cell[1595378, 43552, 289, 5, 416928, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1595704, 43562, 428, 11, 1293, "Subsubsection"],
Cell[1596135, 43575, 1524, 24, 718235, "Text"],
Cell[CellGroupData[{
Cell[1597684, 43603, 426, 12, 455460, "Input",
 InitializationCell->True],
Cell[1598113, 43617, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1598210, 43623, 424, 12, 455460, "Input",
 InitializationCell->True],
Cell[1598637, 43637, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1598712, 43641, 145, 2, 427481, "Text"],
Cell[CellGroupData[{
Cell[1598882, 43647, 363, 10, 455460, "Input"],
Cell[1599248, 43659, 1111, 28, 692108, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1600396, 43692, 372, 11, 455460, "Input"],
Cell[1600771, 43705, 995, 26, 692108, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1601803, 43736, 404, 12, 455460, "Input"],
Cell[1602210, 43750, 995, 26, 692108, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1603242, 43781, 550, 16, 455460, "Input"],
Cell[1603795, 43799, 1431, 38, 692108, "Output"]
}, Open  ]],
Cell[1605241, 43840, 219, 4, 455460, "Text"],
Cell[CellGroupData[{
Cell[1605485, 43848, 581, 17, 1111962, "Input"],
Cell[1606069, 43867, 208, 4, 455460, "Output"],
Cell[1606280, 43873, 208, 4, 455460, "Output"],
Cell[1606491, 43879, 308, 8, 455460, "Output"]
}, Open  ]],
Cell[1606814, 43890, 1348, 18, 427481, "Text"],
Cell[CellGroupData[{
Cell[1608187, 43912, 596, 15, 534351, "Input",
 InitializationCell->True],
Cell[1608786, 43929, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1608861, 43933, 289, 5, 416928, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1609187, 43943, 343, 5, 1243, "Subsubsection"],
Cell[1609533, 43950, 207, 4, 1002750, "Text"],
Cell[CellGroupData[{
Cell[1609765, 43958, 221, 4, 1002750, "Input"],
Cell[1609989, 43964, 120, 2, 1002750, "Output"],
Cell[1610112, 43968, 120, 2, 1002750, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1610269, 43975, 1074, 26, 1002750, "Input",
 InitializationCell->True],
Cell[1611346, 44003, 60, 1, 262, "Output"],
Cell[1611409, 44006, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1611506, 44012, 798, 21, 1002750, "Input",
 InitializationCell->True],
Cell[1612307, 44035, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1612404, 44041, 1625, 33, 1002750, "Input",
 InitializationCell->True],
Cell[1614032, 44076, 60, 1, 262, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1614141, 44083, 100, 1, 1165, "Subsubsection"],
Cell[CellGroupData[{
Cell[1614266, 44088, 317, 6, 455460, "Input"],
Cell[1614586, 44096, 459, 9, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1615082, 44110, 251, 5, 455460, "Input"],
Cell[1615336, 44117, 297, 5, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1615670, 44127, 186, 5, 480457, "Input"],
Cell[1615859, 44134, 152, 3, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1616048, 44142, 193, 5, 455460, "Input"],
Cell[1616244, 44149, 189, 4, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1616470, 44158, 201, 5, 455460, "Input"],
Cell[1616674, 44165, 246, 5, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1616957, 44175, 223, 5, 455460, "Input"],
Cell[1617183, 44182, 366, 8, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1617586, 44195, 269, 5, 455460, "Input"],
Cell[1617858, 44202, 321, 7, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1618216, 44214, 200, 5, 455460, "Input"],
Cell[1618419, 44221, 251, 6, 455460, "Output"]
}, Open  ]],
Cell[1618685, 44230, 289, 5, 416928, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1619011, 44240, 570, 9, 1243, "Subsubsection"],
Cell[1619584, 44251, 371, 7, 1002750, "Text"],
Cell[1619958, 44260, 339, 6, 1002750, "Text"],
Cell[1620300, 44268, 645, 15, 1002750, "Input"],
Cell[1620948, 44285, 339, 6, 1002750, "Text"],
Cell[1621290, 44293, 553, 14, 1002750, "Input"],
Cell[1621846, 44309, 1134, 19, 1002750, "Text"],
Cell[1622983, 44330, 108, 1, 1002750, "Text"],
Cell[1623094, 44333, 1367, 27, 1002750, "Input"],
Cell[1624464, 44362, 108, 1, 1002750, "Text"],
Cell[1624575, 44365, 706, 18, 1002750, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1625318, 44388, 147, 2, 1165, "Subsubsection"],
Cell[1625468, 44392, 489, 14, 787856, "Input"],
Cell[CellGroupData[{
Cell[1625982, 44410, 1116, 29, 1753501, "Input"],
Cell[1627101, 44441, 329, 5, 455460, "Output"],
Cell[1627433, 44448, 306, 4, 455460, "Output"],
Cell[1627742, 44454, 306, 4, 455460, "Output"],
Cell[1628051, 44460, 306, 4, 455460, "Output"],
Cell[1628360, 44466, 307, 4, 455460, "Output"]
}, Open  ]],
Cell[1628682, 44473, 462, 13, 787856, "Input"],
Cell[CellGroupData[{
Cell[1629169, 44490, 540, 11, 787856, "Input"],
Cell[1629712, 44503, 618, 11, 455460, "Output"],
Cell[1630333, 44516, 616, 11, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1630986, 44532, 471, 11, 787856, "Input"],
Cell[1631460, 44545, 434, 9, 455460, "Output"],
Cell[1631897, 44556, 434, 9, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1632368, 44570, 433, 9, 1111962, "Input"],
Cell[1632804, 44581, 290, 7, 455460, "Output"]
}, Open  ]],
Cell[1633109, 44591, 288, 5, 427481, "Text"],
Cell[1633400, 44598, 108, 1, 427481, "Text"],
Cell[1633511, 44601, 1172, 29, 1642397, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1634708, 44634, 1263, 31, 1421072, "Input"],
Cell[1635974, 44667, 530, 12, 455460, "Output"],
Cell[1636507, 44681, 328, 7, 455460, "Output"],
Cell[1636838, 44690, 236, 4, 455460, "Output"],
Cell[1637077, 44696, 406, 9, 455460, "Output"]
}, Open  ]],
Cell[1637498, 44708, 646, 10, 718235, "Text"],
Cell[1638147, 44720, 231, 7, 455460, "Text"],
Cell[1638381, 44729, 353, 9, 455460, "Input",
 InitializationCell->True],
Cell[1638737, 44740, 406, 7, 427481, "Text"],
Cell[1639146, 44749, 828, 21, 1111962, "Input"],
Cell[1639977, 44772, 1082, 25, 1421072, "Input",
 InitializationCell->True],
Cell[1641062, 44799, 470, 8, 427481, "Text"],
Cell[1641535, 44809, 1147, 26, 1421072, "Input",
 InitializationCell->True],
Cell[1642685, 44837, 91, 1, 427481, "Text"],
Cell[1642779, 44840, 628, 16, 455460, "Input"],
Cell[CellGroupData[{
Cell[1643432, 44860, 611, 15, 1421072, "Input"],
Cell[1644046, 44877, 229, 4, 455460, "Output"]
}, Open  ]],
Cell[1644290, 44884, 353, 9, 455460, "Text"],
Cell[1644646, 44895, 358, 9, 455460, "Input",
 InitializationCell->True],
Cell[1645007, 44906, 620, 16, 455460, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1645652, 44926, 887, 22, 1421072, "Input"],
Cell[1646542, 44950, 263, 4, 455460, "Output"],
Cell[1646808, 44956, 261, 4, 455460, "Output"]
}, Open  ]],
Cell[1647084, 44963, 935, 16, 1354432, "Text"],
Cell[1648022, 44981, 239, 3, 427481, "Text"],
Cell[1648264, 44986, 2061, 45, 787856, "Input"],
Cell[1650328, 45033, 323, 6, 718235, "Text"],
Cell[1650654, 45041, 108, 1, 427481, "Text"],
Cell[1650765, 45044, 1959, 42, 787856, "Input"],
Cell[1652727, 45088, 992, 17, 1367753, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1653756, 45110, 98, 1, 1165, "Subsubsection"],
Cell[1653857, 45113, 438, 12, 787856, "Input"],
Cell[1654298, 45127, 57, 1, 455460, "Input"],
Cell[CellGroupData[{
Cell[1654380, 45132, 1171, 28, 2075027, "Input"],
Cell[1655554, 45162, 206, 4, 455460, "Output"],
Cell[1655763, 45168, 251, 5, 455460, "Output"],
Cell[1656017, 45175, 224, 4, 455460, "Output"],
Cell[1656244, 45181, 282, 6, 455460, "Output"],
Cell[1656529, 45189, 282, 6, 455460, "Output"],
Cell[1656814, 45197, 251, 5, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1657102, 45207, 377, 8, 1111962, "Input"],
Cell[CellGroupData[{
Cell[1657504, 45219, 613, 15, 308046, "Print"],
Cell[1658120, 45236, 547, 17, 308046, "Print"],
Cell[1658670, 45255, 561, 14, 308046, "Print"],
Cell[1659234, 45271, 304, 9, 308046, "Print"],
Cell[1659541, 45282, 1029, 28, 308046, "Print"],
Cell[1660573, 45312, 302, 9, 308046, "Print"],
Cell[1660878, 45323, 1205, 31, 308046, "Print"],
Cell[1662086, 45356, 559, 17, 308046, "Print"],
Cell[1662648, 45375, 613, 15, 308046, "Print"],
Cell[1663264, 45392, 549, 17, 308046, "Print"],
Cell[1663816, 45411, 561, 14, 308046, "Print"],
Cell[1664380, 45427, 303, 9, 308046, "Print"],
Cell[1664686, 45438, 1029, 28, 308046, "Print"],
Cell[1665718, 45468, 302, 9, 308046, "Print"],
Cell[1666023, 45479, 613, 15, 308046, "Print"],
Cell[1666639, 45496, 487, 15, 308046, "Print"],
Cell[1667129, 45513, 1029, 28, 308046, "Print"],
Cell[1668161, 45543, 304, 9, 308046, "Print"],
Cell[1668468, 45554, 613, 15, 308046, "Print"],
Cell[1669084, 45571, 487, 15, 308046, "Print"],
Cell[1669574, 45588, 1031, 28, 308046, "Print"],
Cell[1670608, 45618, 302, 9, 308046, "Print"]
}, Open  ]],
Cell[1670925, 45630, 202, 4, 455460, "Output"]
}, Open  ]],
Cell[1671142, 45637, 93, 1, 416928, "Text"],
Cell[CellGroupData[{
Cell[1671260, 45642, 377, 8, 1111962, "Input"],
Cell[CellGroupData[{
Cell[1671662, 45654, 1233, 31, 308046, "Print"],
Cell[1672898, 45687, 561, 17, 308046, "Print"],
Cell[1673462, 45706, 617, 15, 308046, "Print"],
Cell[1674082, 45723, 551, 17, 308046, "Print"],
Cell[1674636, 45742, 565, 14, 308046, "Print"],
Cell[1675204, 45758, 306, 9, 308046, "Print"],
Cell[1675513, 45769, 664, 17, 308046, "Print"],
Cell[1676180, 45788, 304, 9, 308046, "Print"]
}, Open  ]],
Cell[1676499, 45800, 226, 4, 455460, "Output"]
}, Open  ]],
Cell[1676740, 45807, 174, 5, 787856, "Input"],
Cell[1676917, 45814, 551, 9, 718235, "Text"],
Cell[1677471, 45825, 137, 1, 427481, "Text"],
Cell[1677611, 45828, 108, 1, 427481, "Text"],
Cell[CellGroupData[{
Cell[1677744, 45833, 592, 15, 455460, "Input"],
Cell[1678339, 45850, 677, 13, 455460, "Output"]
}, Open  ]],
Cell[1679031, 45866, 507, 9, 718235, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1679575, 45880, 150, 2, 1165, "Subsubsection"],
Cell[1679728, 45884, 1281, 24, 2170546, "Text"],
Cell[1681012, 45910, 647, 19, 455460, "Input"],
Cell[1681662, 45931, 320, 4, 427481, "Text"],
Cell[1681985, 45937, 824, 20, 1111962, "Input"],
Cell[1682812, 45959, 474, 9, 750713, "Text"],
Cell[CellGroupData[{
Cell[1683311, 45972, 440, 12, 787856, "Input"],
Cell[1683754, 45986, 171, 2, 455460, "Output"],
Cell[1683928, 45990, 230, 5, 455460, "Output"]
}, Open  ]],
Cell[1684173, 45998, 259, 3, 427481, "Text"],
Cell[CellGroupData[{
Cell[1684457, 46005, 216, 4, 455460, "Input"],
Cell[1684676, 46011, 195, 5, 455460, "Output"]
}, Open  ]],
Cell[1684886, 46019, 199, 3, 427481, "Text"],
Cell[CellGroupData[{
Cell[1685110, 46026, 369, 11, 787856, "Input"],
Cell[1685482, 46039, 72, 1, 455460, "Output"],
Cell[1685557, 46042, 148, 4, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1685742, 46051, 229, 5, 455460, "Input"],
Cell[1685974, 46058, 456, 8, 308046, "Message"],
Cell[1686433, 46068, 333, 8, 455460, "Output"]
}, Open  ]],
Cell[1686781, 46079, 251, 3, 427481, "Text"],
Cell[CellGroupData[{
Cell[1687057, 46086, 673, 22, 1421072, "Input"],
Cell[1687733, 46110, 125, 2, 455460, "Output"],
Cell[1687861, 46114, 198, 5, 455460, "Output"],
Cell[1688062, 46121, 127, 2, 455460, "Output"],
Cell[1688192, 46125, 200, 5, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1688429, 46135, 163, 4, 455460, "Input"],
Cell[1688595, 46141, 458, 8, 308046, "Message"],
Cell[1689056, 46151, 305, 8, 455460, "Output"]
}, Open  ]],
Cell[1689376, 46162, 116, 1, 427481, "Text"],
Cell[1689495, 46165, 231, 5, 455460, "Input"],
Cell[1689729, 46172, 608, 11, 1017890, "Text"],
Cell[1690340, 46185, 144, 5, 711656, "Text"],
Cell[1690487, 46192, 108, 1, 427481, "Text"],
Cell[CellGroupData[{
Cell[1690620, 46197, 561, 14, 455460, "Input"],
Cell[1691184, 46213, 685, 13, 455460, "Output"]
}, Open  ]],
Cell[1691884, 46229, 106, 1, 427481, "Text"],
Cell[1691993, 46232, 108, 1, 427481, "Text"],
Cell[CellGroupData[{
Cell[1692126, 46237, 1929, 47, 787856, "Input"],
Cell[1694058, 46286, 685, 13, 455460, "Output"],
Cell[1694746, 46301, 677, 13, 455460, "Output"]
}, Open  ]],
Cell[1695438, 46317, 108, 1, 427481, "Text"],
Cell[CellGroupData[{
Cell[1695571, 46322, 1690, 39, 787856, "Input"],
Cell[1697264, 46363, 681, 13, 455460, "Output"],
Cell[1697948, 46378, 681, 13, 455460, "Output"]
}, Open  ]],
Cell[1698644, 46394, 108, 1, 427481, "Text"],
Cell[CellGroupData[{
Cell[1698777, 46399, 1701, 41, 787856, "Input"],
Cell[1700481, 46442, 661, 13, 455460, "Output"],
Cell[1701145, 46457, 661, 13, 455460, "Output"]
}, Open  ]],
Cell[1701821, 46473, 121, 1, 427481, "Text"],
Cell[1701945, 46476, 108, 1, 427481, "Text"],
Cell[CellGroupData[{
Cell[1702078, 46481, 967, 24, 455460, "Input"],
Cell[1703048, 46507, 665, 13, 455460, "Output"]
}, Open  ]],
Cell[1703728, 46523, 504, 9, 718235, "Text"],
Cell[1704235, 46534, 108, 1, 427481, "Text"],
Cell[CellGroupData[{
Cell[1704368, 46539, 710, 18, 455460, "Input"],
Cell[1705081, 46559, 677, 13, 455460, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1705807, 46578, 100, 1, 1165, "Subsubsection"],
Cell[1705910, 46581, 1175, 28, 1753501, "Input"],
Cell[CellGroupData[{
Cell[1707110, 46613, 771, 18, 1421072, "Input"],
Cell[1707884, 46633, 372, 7, 455460, "Output"],
Cell[1708259, 46642, 374, 7, 455460, "Output"],
Cell[1708636, 46651, 372, 7, 455460, "Output"],
Cell[1709011, 46660, 372, 7, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1709420, 46672, 397, 9, 787856, "Input"],
Cell[1709820, 46683, 384, 8, 455460, "Output"],
Cell[1710207, 46693, 384, 8, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1710628, 46706, 750, 15, 1421072, "Input"],
Cell[1711381, 46723, 224, 5, 455460, "Output"],
Cell[1711608, 46730, 222, 5, 455460, "Output"],
Cell[1711833, 46737, 224, 5, 455460, "Output"],
Cell[1712060, 46744, 222, 5, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1712319, 46754, 750, 15, 1421072, "Input"],
Cell[1713072, 46771, 492, 9, 455460, "Output"],
Cell[1713567, 46782, 492, 9, 455460, "Output"],
Cell[1714062, 46793, 492, 9, 455460, "Output"],
Cell[1714557, 46804, 492, 9, 455460, "Output"]
}, Open  ]],
Cell[1715064, 46816, 289, 5, 416928, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1715390, 46826, 212, 4, 1243, "Subsubsection"],
Cell[1715605, 46832, 652, 11, 1017890, "Text"],
Cell[CellGroupData[{
Cell[1716282, 46847, 811, 22, 534351, "Input",
 InitializationCell->True],
Cell[1717096, 46871, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1717193, 46877, 601, 15, 455460, "Input",
 InitializationCell->True],
Cell[1717797, 46894, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1717894, 46900, 742, 22, 534351, "Input",
 InitializationCell->True],
Cell[1718639, 46924, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1718736, 46930, 682, 17, 455460, "Input",
 InitializationCell->True],
Cell[1719421, 46949, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1719496, 46953, 289, 5, 416928, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1719822, 46963, 798, 17, 1391, "Subsubsection"],
Cell[1720623, 46982, 1353, 42, 1367753, "Text"],
Cell[1721979, 47026, 420, 7, 427481, "Text"],
Cell[CellGroupData[{
Cell[1722424, 47037, 1213, 25, 534351, "Input",
 InitializationCell->True],
Cell[1723640, 47064, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1723737, 47070, 706, 17, 802200, "Input"],
Cell[1724446, 47089, 1323, 36, 367737, "Print"],
Cell[1725772, 47127, 320, 5, 455460, "Output"]
}, Open  ]],
Cell[1726107, 47135, 2331, 34, 718235, "Text"],
Cell[CellGroupData[{
Cell[1728463, 47173, 905, 22, 534351, "Input",
 InitializationCell->True],
Cell[1729371, 47197, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1729468, 47203, 694, 18, 534351, "Input",
 InitializationCell->True],
Cell[1730165, 47223, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1730240, 47227, 58, 1, 455460, "Input"],
Cell[CellGroupData[{
Cell[1730323, 47232, 1675, 42, 2137113, "Input"],
Cell[1732001, 47276, 379, 7, 455460, "Output"],
Cell[1732383, 47285, 384, 8, 455460, "Output"],
Cell[1732770, 47295, 403, 7, 455460, "Output"],
Cell[1733176, 47304, 438, 9, 455460, "Output"]
}, Open  ]],
Cell[1733629, 47316, 289, 5, 416928, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1733955, 47326, 685, 14, 151, "Subsubsection"],
Cell[1734643, 47342, 191, 4, 2020, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1734859, 47350, 2321, 45, 6347, "Input",
 InitializationCell->True],
Cell[1737183, 47397, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1737280, 47403, 2512, 50, 6347, "Input",
 InitializationCell->True],
Cell[1739795, 47455, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1739892, 47461, 2000, 39, 6347, "Input",
 InitializationCell->True],
Cell[1741895, 47502, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1741992, 47508, 1950, 38, 6347, "Input",
 InitializationCell->True],
Cell[1743945, 47548, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1744042, 47554, 2022, 40, 5585, "Input",
 InitializationCell->True],
Cell[1746067, 47596, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1746164, 47602, 1851, 35, 5585, "Input",
 InitializationCell->True],
Cell[1748018, 47639, 60, 1, 262, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1748115, 47645, 2066, 40, 5585, "Input",
 InitializationCell->True],
Cell[1750184, 47687, 60, 1, 262, "Output"]
}, Open  ]],
Cell[1750259, 47691, 289, 5, 1262, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[1750585, 47701, 198, 3, 1165, "Subsubsection"],
Cell[1750786, 47706, 125, 2, 455460, "Input"],
Cell[1750914, 47710, 302, 7, 455460, "Input"],
Cell[1751219, 47719, 713, 21, 1421072, "Input"],
Cell[CellGroupData[{
Cell[1751957, 47744, 293, 7, 480457, "Input"],
Cell[1752253, 47753, 216, 5, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1752506, 47763, 408, 9, 814312, "Input"],
Cell[1752917, 47774, 154, 3, 455460, "Output"],
Cell[1753074, 47779, 154, 3, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1753265, 47787, 408, 9, 814312, "Input"],
Cell[1753676, 47798, 448, 9, 455460, "Output"],
Cell[1754127, 47809, 416, 7, 455460, "Output"]
}, Open  ]],
Cell[1754558, 47819, 1860, 27, 427481, "Text"],
Cell[CellGroupData[{
Cell[1756443, 47850, 343, 7, 480457, "Input"],
Cell[1756789, 47859, 308, 8, 480457, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1757134, 47872, 343, 7, 480457, "Input"],
Cell[1757480, 47881, 937, 17, 308046, "Print"],
Cell[1758420, 47900, 1199, 18, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1759656, 47923, 302, 7, 455460, "Input"],
Cell[1759961, 47932, 725, 15, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1760723, 47952, 300, 6, 455460, "Input"],
Cell[1761026, 47960, 705, 15, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1761768, 47980, 325, 7, 455460, "Input"],
Cell[1762096, 47989, 456, 10, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1762589, 48004, 325, 7, 455460, "Input"],
Cell[1762917, 48013, 1030, 27, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1763984, 48045, 1366, 37, 2404345, "Input"],
Cell[1765353, 48084, 179, 4, 455460, "Output"],
Cell[1765535, 48090, 179, 4, 455460, "Output"],
Cell[1765717, 48096, 220, 5, 455460, "Output"],
Cell[1765940, 48103, 222, 6, 455460, "Output"],
Cell[1766165, 48111, 218, 5, 455460, "Output"],
Cell[1766386, 48118, 246, 6, 455460, "Output"],
Cell[1766635, 48126, 246, 6, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1766918, 48137, 1366, 37, 2404345, "Input"],
Cell[1768287, 48176, 1253, 19, 455460, "Output"],
Cell[1769543, 48197, 1253, 19, 455460, "Output"],
Cell[1770799, 48218, 1292, 20, 455460, "Output"],
Cell[1772094, 48240, 1296, 21, 455460, "Output"],
Cell[1773393, 48263, 1291, 20, 455460, "Output"],
Cell[1774687, 48285, 1322, 21, 455460, "Output"],
Cell[1776012, 48308, 1319, 21, 455460, "Output"]
}, Open  ]],
Cell[1777346, 48332, 1812, 26, 427481, "Text"],
Cell[CellGroupData[{
Cell[1779183, 48362, 485, 10, 480457, "Input"],
Cell[1779671, 48374, 222, 6, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1779930, 48385, 485, 10, 480457, "Input"],
Cell[1780418, 48397, 696, 16, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1781151, 48418, 432, 9, 480457, "Input"],
Cell[1781586, 48429, 263, 7, 513408, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1781886, 48441, 432, 9, 480457, "Input"],
Cell[1782321, 48452, 1072, 23, 308046, "Print"],
Cell[1783396, 48477, 1101, 16, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1784534, 48498, 428, 9, 480457, "Input"],
Cell[1784965, 48509, 291, 7, 513408, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1785293, 48521, 428, 9, 480457, "Input"],
Cell[1785724, 48532, 1262, 20, 480457, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1787023, 48557, 409, 9, 480457, "Input"],
Cell[1787435, 48568, 274, 7, 513408, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1787746, 48580, 409, 9, 480457, "Input"],
Cell[1788158, 48591, 645, 14, 480457, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1788840, 48610, 256, 6, 480457, "Input"],
Cell[1789099, 48618, 478, 9, 455460, "Output"]
}, Open  ]],
Cell[1789592, 48630, 1813, 26, 427481, "Text"],
Cell[CellGroupData[{
Cell[1791430, 48660, 432, 9, 480457, "Input"],
Cell[1791865, 48671, 222, 6, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1792124, 48682, 432, 9, 480457, "Input"],
Cell[1792559, 48693, 1327, 22, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1793923, 48720, 512, 11, 480457, "Input"],
Cell[1794438, 48733, 246, 6, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1794721, 48744, 512, 11, 480457, "Input"],
Cell[1795236, 48757, 1317, 22, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1796590, 48784, 506, 10, 480457, "Input"],
Cell[1797099, 48796, 302, 7, 513408, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1797438, 48808, 506, 10, 480457, "Input"],
Cell[1797947, 48820, 1376, 22, 480457, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1799360, 48847, 412, 9, 480457, "Input"],
Cell[1799775, 48858, 612, 13, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1800424, 48876, 412, 9, 480457, "Input"],
Cell[1800839, 48887, 218, 5, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1801094, 48897, 234, 5, 455460, "Input"],
Cell[1801331, 48904, 486, 9, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1801854, 48918, 434, 9, 480457, "Input"],
Cell[1802291, 48929, 658, 14, 480457, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1802986, 48948, 434, 9, 480457, "Input"],
Cell[1803423, 48959, 287, 7, 513408, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1803747, 48971, 435, 9, 480457, "Input"],
Cell[1804185, 48982, 657, 14, 480457, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1804879, 49001, 435, 9, 480457, "Input"],
Cell[1805317, 49012, 290, 7, 513408, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1805644, 49024, 435, 9, 480457, "Input"],
Cell[1806082, 49035, 657, 14, 480457, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1806776, 49054, 435, 9, 480457, "Input"],
Cell[1807214, 49065, 292, 7, 513408, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1807543, 49077, 405, 8, 480457, "Input"],
Cell[1807951, 49087, 584, 12, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1808572, 49104, 405, 8, 480457, "Input"],
Cell[1808980, 49114, 192, 4, 455460, "Output"]
}, Open  ]],
Cell[1809187, 49121, 2318, 37, 513408, "Text"],
Cell[CellGroupData[{
Cell[1811530, 49162, 435, 9, 480457, "Input"],
Cell[1811968, 49173, 619, 13, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1812624, 49191, 435, 9, 480457, "Input"],
Cell[1813062, 49202, 302, 7, 513408, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1813401, 49214, 372, 9, 834922, "Input"],
Cell[1813776, 49225, 141, 3, 455460, "Output"],
Cell[1813920, 49230, 260, 6, 513408, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1814217, 49241, 194, 5, 513408, "Input"],
Cell[1814414, 49248, 237, 6, 513408, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1814688, 49259, 433, 9, 480457, "Input"],
Cell[1815124, 49270, 651, 14, 455460, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1815812, 49289, 482, 10, 480457, "Input"],
Cell[1816297, 49301, 628, 12, 1002750, "Output"]
}, Closed]],
Cell[1816940, 49316, 3033, 43, 692108, "Text"],
Cell[CellGroupData[{
Cell[1819998, 49363, 293, 7, 480457, "Input"],
Cell[1820294, 49372, 490, 9, 1002750, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[1820821, 49386, 378, 8, 385057, "Input"],
Cell[1821202, 49396, 998, 16, 1002750, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[1822237, 49417, 406, 8, 385057, "Input"],
Cell[1822646, 49427, 1059, 17, 1002750, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[1823742, 49449, 378, 7, 385057, "Input"],
Cell[1824123, 49458, 412, 7, 1002750, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[1824572, 49470, 377, 7, 385057, "Input"],
Cell[1824952, 49479, 1015, 15, 1002750, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[1826004, 49499, 602, 12, 718235, "Input"],
Cell[1826609, 49513, 1016, 15, 1002750, "Output"],
Cell[1827628, 49530, 1014, 15, 1002750, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[1828679, 49550, 5028, 120, 5457133, "Input"],
Cell[1833710, 49672, 1402, 23, 455460, "Output"],
Cell[1835115, 49697, 1368, 22, 455460, "Output"],
Cell[1836486, 49721, 1365, 21, 455460, "Output"],
Cell[1837854, 49744, 1426, 23, 480457, "Output"],
Cell[1839283, 49769, 1365, 21, 455460, "Output"],
Cell[1840651, 49792, 1368, 23, 455460, "Output"],
Cell[1842022, 49817, 1400, 23, 455460, "Output"],
Cell[1843425, 49842, 1370, 22, 455460, "Output"],
Cell[1844798, 49866, 1365, 21, 455460, "Output"],
Cell[1846166, 49889, 1426, 23, 480457, "Output"],
Cell[1847595, 49914, 1400, 23, 455460, "Output"],
Cell[1848998, 49939, 1210, 26, 308046, "Print"],
Cell[1850211, 49967, 1177, 17, 455460, "Output"],
Cell[1851391, 49986, 1417, 24, 480457, "Output"],
Cell[1852811, 50012, 1426, 23, 480457, "Output"],
Cell[1854240, 50037, 1426, 23, 480457, "Output"],
Cell[1855669, 50062, 1425, 23, 480457, "Output"]
}, Open  ]],
Cell[1857109, 50088, 191, 5, 455460, "Input"],
Cell[CellGroupData[{
Cell[1857325, 50097, 149, 3, 455460, "Input"],
Cell[1857477, 50102, 867, 12, 1002750, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[1858381, 50119, 453, 9, 385057, "Input"],
Cell[1858837, 50130, 1155, 19, 1002750, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[1860029, 50154, 383, 8, 385057, "Input"],
Cell[1860415, 50164, 1071, 18, 1002750, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[1861523, 50187, 428, 8, 385057, "Input"],
Cell[1861954, 50197, 1019, 17, 1002750, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[1863010, 50219, 355, 7, 385057, "Input"],
Cell[1863368, 50228, 993, 16, 1002750, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[1864398, 50249, 440, 10, 385057, "Input"],
Cell[1864841, 50261, 1127, 19, 1002750, "Output"]
}, Closed]],
Cell[1865983, 50283, 931, 17, 1884487, "Text"],
Cell[CellGroupData[{
Cell[1866939, 50304, 624, 13, 480457, "Input"],
Cell[1867566, 50319, 1090, 20, 1002750, "Output"]
}, Closed]],
Cell[1868671, 50342, 300, 7, 364368, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1869020, 50355, 209, 3, 210, "Subsection"],
Cell[1869232, 50360, 527, 12, 327, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}
]
*)

